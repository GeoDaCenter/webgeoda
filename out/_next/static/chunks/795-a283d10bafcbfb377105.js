(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[795],{5318:function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}},t.exports.default=t.exports,t.exports.__esModule=!0},8:function(t){function e(n){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?(t.exports=e=function(t){return typeof t},t.exports.default=t.exports,t.exports.__esModule=!0):(t.exports=e=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.default=t.exports,t.exports.__esModule=!0),e(n)}t.exports=e,t.exports.default=t.exports,t.exports.__esModule=!0},1836:function(t,e,n){"use strict";n.d(e,{Z:function(){return A}});var r=n(3630);const i=()=>{},o=1,s=2,a=3,u={transitionEasing:t=>t,transitionInterruption:o,onTransitionStart:i,onTransitionInterrupt:i,onTransitionEnd:i};class c{constructor(t,e={}){this.ControllerState=t,this.props={...u,...e},this.propsInTransition=null,this.transition=new r.Z(e.timeline),this.onViewStateChange=e.onViewStateChange||i,this.onStateChange=e.onStateChange||i,this._onTransitionUpdate=this._onTransitionUpdate.bind(this)}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(t={...u,...t},this.props=t,this._shouldIgnoreViewportChange(n,t))return e;if(this._isTransitionEnabled(t)){const{interruption:r,endProps:i}=this.transition.settings,o={...n,...r===s?i:this.propsInTransition||n};this._triggerTransition(o,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!!this.transition.inProgress&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?this.transition.settings.interruption===a||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=new this.ControllerState(t),r=new this.ControllerState(e).shortestPathFrom(n),{transitionInterpolator:i}=e,o=i.getDuration?i.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=e.transitionInterpolator.initializeProps(t,r);this.propsInTransition={},this.duration=o,this.transition.start({duration:o,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)}),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t(e)}}_onTransitionUpdate(t){const{time:e,settings:{interpolator:n,startProps:r,endProps:i,duration:o,easing:s}}=t,a=s(e/o),u=n.interpolateProps(r,i,a);this.propsInTransition=new this.ControllerState({...this.props,...u}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}}var l=n(6507),f=n(4034);const h=["longitude","latitude","zoom","bearing","pitch"],d=["longitude","latitude","zoom"];class p extends l.Z{constructor(t={}){super((Array.isArray(t)?t:t.transitionProps)||{compare:h,extract:h,required:d}),this.opts=t}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:r,around:i}=this.opts;if(r&&i){const o=r(t),s=r(e),a=o.unproject(i);n.start.around=i,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const r={};for(const i of this._propsToExtract)r[i]=(0,f.t7)(t[i]||0,e[i]||0,n);if(e.aroundPosition){const i=this.opts.makeViewport({...e,...r});Object.assign(r,i.panByPosition(e.aroundPosition,(0,f.t7)(t.around,e.around,n)))}return r}}const g={transitionDuration:0},m={transitionDuration:300,transitionEasing:t=>t,transitionInterruption:o},y=t=>1-(1-t)*(1-t),v=["wheel"],b=["panstart","panmove","panend"],x=["pinchstart","pinchmove","pinchend"],w=["tripanstart","tripanmove","tripanend"],_=["doubletap"],E=["keydown"];class A{constructor(t,e={}){this.ControllerState=t,this.controllerState=null,this.controllerStateProps=null,this.eventManager=null,this.transitionManager=new c(t,{...e,onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)});const n=this.linearTransitionProps;this._transition=n&&{...m,transitionInterpolator:new p({transitionProps:n})},this._events=null,this._interactionState={isDragging:!1},this._customEvents=[],this.onViewStateChange=null,this.onStateChange=null,this.handleEvent=this.handleEvent.bind(this),this.setProps(e)}get linearTransitionProps(){return null}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.setProps(this.controllerStateProps)}finalize(){for(const t in this._events)this._events[t]&&this.eventManager.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){const{ControllerState:e}=this;this.controllerState=new e({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state});const n=this._eventStartBlocked;switch(t.type){case"panstart":return!n&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!n&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!n&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}getCenter(t){const{x:e,y:n}=this.controllerStateProps,{offsetCenter:r}=t;return[r.x-e,r.y-n]}isPointInBounds(t,e){const{width:n,height:r}=this.controllerStateProps;if(e&&e.handled)return!1;const i=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=r;return i&&e&&e.stopPropagation(),i}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){"onViewStateChange"in t&&(this.onViewStateChange=t.onViewStateChange),"onStateChange"in t&&(this.onStateChange=t.onStateChange),"makeViewport"in t&&(this.makeViewport=t.makeViewport),"dragMode"in t&&(this.dragMode=t.dragMode),this.controllerStateProps=t,"eventManager"in t&&this.eventManager!==t.eventManager&&(this.eventManager=t.eventManager,this._events={},this.toggleEvents(this._customEvents,!0)),"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:e}=t;!0===e&&(e=300),this.inertia=e;const{scrollZoom:n=!0,dragPan:r=!0,dragRotate:i=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:u=!0}=t,c=Boolean(this.onViewStateChange);this.toggleEvents(v,c&&n),this.toggleEvents(b,c&&(r||i)),this.toggleEvents(x,c&&(s||a)),this.toggleEvents(w,c&&a),this.toggleEvents(_,c&&o),this.toggleEvents(E,c&&u),this.scrollZoom=n,this.dragPan=r,this.dragRotate=i,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=u}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e={},n={}){const r={...t.getViewportProps(),...e},i=this.controllerState!==t;if(this._state=t.getState(),this._setInteractionState(n),i){const t=this.controllerState?this.controllerState.getViewportProps():null;this.onViewStateChange&&this.onViewStateChange({viewState:r,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange&&(t.interactionState=this._interactionState,this.onViewStateChange(t))}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange&&this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const r=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(r,g,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,g,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.pan({pos:r}).panEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:y},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,g,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),r=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],i=this.controllerState.rotate({pos:r}).rotateEnd();this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:y},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:r=!1}=this.scrollZoom,{delta:i}=t;let o=2/(1+Math.exp(-Math.abs(i*n)));i<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:r?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,g,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,g,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),r=[n[0],n[1]+=t.velocityY*e/2],i=this.controllerState.rotate({pos:r});this.updateViewport(i,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:y},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,g,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:this._startPinchRotation-n})}return this.updateViewport(e,g,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),this._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e,_lastPinchEvent:n}=this;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const r=this.getCenter(t);let i=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);i=i.zoom({pos:r,scale:a}).zoomEnd(),this.updateViewport(i,{...this._getTransitionProps({around:r}),transitionDuration:e,transitionEasing:y},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return this._startPinchRotation=null,this._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),r=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:r,rotateSpeedX:i,rotateSpeedY:o}=this.keyboard,{controllerState:s}=this;let a;const u={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),u.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),u.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(i),u.isRotating=!0):(a=s.moveLeft(r),u.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(i),u.isRotating=!0):(a=s.moveRight(r),u.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),u.isRotating=!0):(a=s.moveUp(r),u.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),u.isRotating=!0):(a=s.moveDown(r),u.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),u),!0}_getTransitionProps(t){const{_transition:e}=this;return e?t?{...e,transitionInterpolator:new p({...t,transitionProps:this.linearTransitionProps,makeViewport:this.controllerState.makeViewport})}:e:g}}},6442:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});class r{constructor(t){this._viewportProps=this._applyConstraints(t)}getViewportProps(){return this._viewportProps}getState(){return this._state}shortestPathFrom(t){return this._viewportProps}_applyConstraints(t){return t}}},3803:function(t,e,n){"use strict";n.d(e,{z:function(){return o},Z:function(){return s}});var r=n(744);let i={};function o(t){i=t}function s(t){r.Z.level>0&&i[t]&&i[t].call(...arguments)}},8918:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(5522),i=n(3803),o=n(1855);class s extends r.Z{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}renderLayers(){return null}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"===typeof t){const e={data:this.props.data,target:[]};return(n,r)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,r)}return t}getSubLayerProps(t={}){const{opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:f,positionFormat:h,modelMatrix:d,extensions:p,fetch:g,_subLayerProps:m}=this.props,y={opacity:e,pickable:n,visible:r,parameters:i,getPolygonOffset:o,highlightedObjectIndex:s,autoHighlight:a,highlightColor:u,coordinateSystem:c,coordinateOrigin:l,wrapLongitude:f,positionFormat:h,modelMatrix:d,extensions:p,fetch:g},v=m&&m[t.id],b=v&&v.updateTriggers,x=t.id||"sublayer";if(v){const e=this.constructor._propTypes,n=t.type?t.type._propTypes:{};for(const t in v){const r=n[t]||e[t];r&&"accessor"===r.type&&(v[t]=this.getSubLayerAccessor(v[t]))}}Object.assign(y,t,v),y.id="".concat(this.props.id,"-").concat(x),y.updateTriggers={all:this.props.updateTriggers.all,...t.updateTriggers,...b};for(const w of p){const t=w.getSubLayerProps.call(this,w);t&&Object.assign(y,t,{updateTriggers:Object.assign(y.updateTriggers,t.updateTriggers)})}return y}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_renderLayers(){let{subLayers:t}=this.internalState;const e=!t||this.needsUpdate();e&&(t=this.renderLayers(),t=(0,o.x)(t,Boolean),this.internalState.subLayers=t),(0,i.Z)("compositeLayer.renderLayers",this,e,t);for(const n of t)n.parent=this}}s.layerName="CompositeLayer"},4088:function(t,e,n){"use strict";n.d(e,{Df:function(){return i},zG:function(){return o},FP:function(){return s}});var r=n(744);const i={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(i,"IDENTITY",{get:()=>r.Z.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")()||0});const o={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},s={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}}},8646:function(t,e,n){"use strict";n.d(e,{Z:function(){return te}});let r=1,i=1;class o{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=t,s=r++,a={time:0,delay:e,duration:n,rate:i,repeat:o};return this._setChannelTime(a,this.time),this.channels.set(s,a),s}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const r of e)this._setChannelTime(r,this.time);const n=this.animations.values();for(const r of n){const{animation:t,channel:e}=r;t.setTime(this.getTime(e))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=i++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}var s=n(5409),a=n(744),u=n(3803),c=n(1855),l=n(6203),f=n(9787);class h{constructor(t,e,n){this.id=t,this.context=n,this._loadCount=0,this._subscribers=new Set,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let r=t;"string"===typeof t&&(r=(0,f.z)(t)),r instanceof Promise?(this.isLoaded=!1,this._loader=r.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=null,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=null,this._content=t);for(const i of this._subscribers)i.onChange(this.getData())}}class d{constructor({gl:t,protocol:e}){this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:r=!0}){let i=this._resources[t];i?i.setData(e,n):(i=new h(t,e,this._context),this._resources[t]=i),i.persistent=r}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t];n.resource&&n.resource.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:r="default"}){const{_resources:i,protocol:o}=this;t.startsWith(o)&&(i[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=i[t];if(this._track(n,r,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,r){const i=this._consumers,o=i[t]=i[t]||{},s=o[e]||{};s.resource&&(s.resource.unsubscribe(s),s.resource=null,this.prune()),n&&(o[e]=s,s.onChange=r,s.resource=n,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}var p=n(9225),g=n(358);var m={name:"geometry",vs:"\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry;\n",fs:"\n#define SMOOTH_EDGE_RADIUS 0.5\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n"},y=n(8020);const v=[m,y.Z],b=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function x(t){const e=g.Z.getDefaultProgramManager(t);for(const n of v)e.addDefaultModule(n);for(const n of b)e.addShaderHook(n);return e}const w=Object.seal({layerManager:null,resourceManager:null,deck:null,gl:null,stats:null,shaderCache:null,pickingFBO:null,mousePosition:null,userData:{}});class _{constructor(t,{deck:e,stats:n,viewport:r,timeline:i}={}){this.lastRenderedLayers=[],this.layers=[],this.resourceManager=new d({gl:t,protocol:"deck://"}),this.context={...w,layerManager:this,gl:t,deck:e,programManager:t&&x(t),stats:n||new l.jk({id:"deck.gl"}),viewport:r||new p.Z({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:i||new o,resourceManager:this.resourceManager},this._nextLayers=null,this._needsRedraw="Initial render",this._needsUpdate=!1,this._debug=!1,this.activateViewport=this.activateViewport.bind(this),Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const r=n.getNeedsRedraw(t);e=e||r}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this.lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t=null}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){(0,u.Z)("layerManager.setLayers",this,e,t),this.lastRenderedLayers=t,t=(0,c.x)(t,Boolean);for(const n of t)n.context=this.context;return this._updateLayers(this.layers,t),this}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this.lastRenderedLayers,t)),this._nextLayers=null}activateViewport(t){return(0,u.Z)("layerManager.activateViewport",this,t),t&&(this.context.viewport=t),this}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const o of t)n[o.id]?a.Z.warn("Multiple old layers with same id ".concat(o.id))():n[o.id]=o;const r=[];this._updateSublayersRecursively(e,n,r),this._finalizeOldLayers(n);let i=!1;for(const o of r)if(o.hasUniformTransition()){i=!0;break}this._needsUpdate=i,this.layers=r}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&a.Z.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let o=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),o=i.isComposite&&i.getSubLayers()}catch(r){this._handleError("matching",r,i)}o&&this._updateSublayersRecursively(o,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=s.d.INITIALIZED}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle=s.d.MATCHED,e!==t&&(t.lifecycle=s.d.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle=s.d.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=s.d.FINALIZED}catch(e){this._handleError("finalization",e,t)}}}var E=n(6871);class A{constructor(t={}){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="Initial render",this._needsUpdate=!0,this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers)this.controllers[t]&&this.controllers[t].finalize();this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return"string"===typeof t?this.views.find((e=>e.id===t)):t}getViewState(t){const e=this.getView(t),n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),r={x:t[0],y:t[1]};for(let i=n.length-1;i>=0;--i){const o=n[i];if(o.containsPixel(r)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){"views"in t&&this._setViews(t.views),"viewState"in t&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=(0,c.x)(t,Boolean);this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){if(t){!(0,E.v)(t,this.viewState)&&this.setNeedsUpdate("viewState changed"),this.viewState=t}else a.Z.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){e.viewId=t,this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange(e)}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>t._getViewport(e,{width:e.width,height:e.height}),...e})}_updateController(t,e,n,r){let i=t.controller;return i?(i={...e,...t.props,...i,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height},r?r.setProps(i):r=this._createController(t,i),r):null}_rebuildViewports(){const{width:t,height:e,views:n}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let o=n.length;o--;){const s=n[o],a=this.getViewState(s),u=s.makeViewport({width:t,height:e,viewState:a});let c=r[s.id];s.controller&&!c&&(i=!0),!i&&s.controller||!c||(c.finalize(),c=null),this.controllers[s.id]=this._updateController(s,a,u,c),this._viewports.unshift(u)}for(const o in r)r[o]&&!this.controllers[o]&&r[o].finalize();this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,r)=>!t[r].equals(e[r])))}}var O=n(4897),S=n(6935),C=n(4034),M=n(1836),P=n(6442),k=n(7013),T=n(5304);const D=0,F=0,j=1.5,L=0,R=20,I=0,N=60;class B extends P.Z{constructor({makeViewport:t,width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s=F,pitch:a=D,altitude:u=j,maxZoom:c=R,minZoom:l=L,maxPitch:f=N,minPitch:h=I,startPanLngLat:d,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v,normalize:b}={}){(0,T.Z)(Number.isFinite(i)),(0,T.Z)(Number.isFinite(r)),(0,T.Z)(Number.isFinite(o)),super({width:e,height:n,latitude:r,longitude:i,zoom:o,bearing:s,pitch:a,altitude:u,maxZoom:c,minZoom:l,maxPitch:f,minPitch:h,normalize:b}),this._state={startPanLngLat:d,startZoomLngLat:p,startRotatePos:g,startBearing:m,startPitch:y,startZoom:v},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this._state.startPanLngLat||this._unproject(e);if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startBearing:i,startPitch:o}=this._state;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let s;return s=t?this._calculateNewPitchAndBearing({...this._getRotationParams(t,r),startBearing:i,startPitch:o}):{bearing:i+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:r,startZoomLngLat:i}=this._state;Number.isFinite(r)||(r=this._viewportProps.zoom,i=this._unproject(e)||this._unproject(t));const o=this._calculateNewZoom({scale:n,startZoom:r}),s=this.makeViewport({...this._viewportProps,zoom:o});return this._getUpdatedState({zoom:o,...s.panByPosition(i,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this._viewportProps.bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this._viewportProps.pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{bearing:r,longitude:i}=n;return Math.abs(r-e.bearing)>180&&(n.bearing=r<0?r+360:r-360),Math.abs(i-e.longitude)>180&&(n.longitude=i<0?i+360:i-360),n}_zoomFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this._viewportProps;return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r}=t;t.zoom=(0,C.uZ)(r,n,e);const{maxPitch:i,minPitch:o,pitch:s}=t;t.pitch=(0,C.uZ)(s,o,i);const{normalize:a=!0}=t;return a&&Object.assign(t,(0,k.QA)(t)),t}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps,i=e+Math.log2(t);return(0,C.uZ)(i,r,n)}_calculateNewPitchAndBearing({deltaScaleX:t,deltaScaleY:e,startBearing:n,startPitch:r}){e=(0,C.uZ)(e,-1,1);const{minPitch:i,maxPitch:o}=this._viewportProps;let s=r;return e>0?s=r+e*(o-r):e<0&&(s=r-e*(i-r)),{pitch:s,bearing:n+180*t}}_getRotationParams(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[1],o=e[1],{width:s,height:a}=this._viewportProps,u=n/s;let c=0;return r>0?Math.abs(a-o)>5&&(c=r/(o-a)*1.2):r<0&&o>5&&(c=1-i/o),c=Math.min(1,Math.max(-1,c)),{deltaScaleX:u,deltaScaleY:c}}}class z extends M.Z{constructor(t){t.dragMode=t.dragMode||"pan",super(B,t)}setProps(t){const e=this.controllerStateProps;super.setProps(t);(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...this.controllerStateProps,...this._state}))}get linearTransitionProps(){return["longitude","latitude","zoom","bearing","pitch"]}}class $ extends O.Z{constructor(t){super({...t,type:S.Z})}get controller(){return this._getControllerProps({type:z})}}$.displayName="MapView";var U=n(4912);const V=[255,255,255],Z=1;let W=0;class q{constructor(t={}){const{color:e=V}=t,{intensity:n=Z}=t;this.id=t.id||"ambient-".concat(W++),this.color=e,this.intensity=n,this.type="ambient"}}var G=n(1681);const H=[255,255,255],X=1,Y=[0,0,-1];let K=0;class J{constructor(t={}){const{color:e=H}=t,{intensity:n=X}=t,{direction:r=Y}=t,{_shadow:i=!1}=t;this.id=t.id||"directional-".concat(K++),this.color=e,this.intensity=n,this.type="directional",this.direction=new G.Z(r).normalize().toArray(),this.shadow=i}getProjectedLight(){return this}}class Q{constructor(t={}){const{id:e="effect"}=t;this.id=e,this.props={...t}}preRender(){}getModuleParameters(){}cleanup(){}}var tt=n(5451);var et=n(9450),nt=n(6047);class rt extends class{constructor(t,e={}){const{id:n="pass"}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(){}cleanup(){}}{render(t){const e=this.gl;return(0,et.dR)(e,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{viewports:e,views:n,onViewportActive:r,clearCanvas:i=!0}=t;t.pass=t.pass||"unknown";const o=this.gl;i&&function(t){const e=t.drawingBufferWidth,n=t.drawingBufferHeight;(0,et.dR)(t,{viewport:[0,0,e,n]}),t.clear(16640)}(o);const s=[];for(const a of e){const e=a.viewport||a,i=n&&n[e.id];r(e);const u=this._getDrawLayerParams(e,t);t.view=i;const c=e.subViewports||[e];for(const n of c){t.viewport=n;const e=this._drawLayersInViewport(o,t,u);s.push(e)}}return s}_getDrawLayerParams(t,{layers:e,pass:n,layerFilter:r,effects:i,moduleParameters:o}){const s=[],a=it(),u={viewport:t,isPicking:n.startsWith("picking"),renderPass:n};for(let c=0;c<e.length;c++){const t=e[c],l=this._shouldDrawLayer(t,u,r),f={shouldDrawLayer:l,layerRenderIndex:a(t,l)};l&&(f.moduleParameters=this._getModuleParameters(t,i,n,o),f.layerParameters=this.getLayerParameters(t,c)),s[c]=f}return s}_drawLayersInViewport(t,{layers:e,pass:n,viewport:r,view:i},o){const s=function(t,{viewport:e}){const n=t.canvas?t.canvas.clientHeight||t.canvas.height:100,r=e,i=(0,et.w)(t);return[r.x*i,(n-r.y-r.height)*i,r.width*i,r.height*i]}(t,{viewport:r});if(i&&i.props.clear){const e=!0===i.props.clear?{color:!0,depth:!0}:i.props.clear;(0,et.s8)(t,{scissorTest:!0,scissor:s},(()=>(0,nt.Z)(t,e)))}const a={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};(0,et.dR)(t,{viewport:s});for(let c=0;c<e.length;c++){const t=e[c],{shouldDrawLayer:i,layerRenderIndex:s,moduleParameters:l,layerParameters:f}=o[c];if(i&&t.props.pickable&&a.pickableCount++,t.isComposite)a.compositeCount++;else if(i){a.visibleCount++,l.viewport=r;try{t.drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:f})}catch(u){t.raiseError(u,"drawing ".concat(t," to ").concat(n))}}}return a}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e){return t.props.parameters}_shouldDrawLayer(t,e,n){if(!(this.shouldDrawLayer(t)&&t.props.visible))return!1;if(e.layer=t,n&&!n(e))return!1;let r=t.parent;for(;r;){if(!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,r){const i=Object.assign(Object.create(t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:(0,et.w)(this.gl)});if(e)for(const o of e)Object.assign(i,o.getModuleParameters(t));return Object.assign(i,this.getModuleParameters(t,e),r)}}function it(t=0,e={}){const n={},r=(i,o)=>{const s=i.props._offset,a=i.id,u=i.parent&&i.parent.id;let c;if(u&&!(u in e)&&r(i.parent,!1),u in n){const t=n[u]=n[u]||it(e[u],e);c=t(i,o),n[a]=t}else Number.isFinite(s)?(c=s+(e[u]||0),n[a]=null):c=t;return o&&c>=t&&(t=c+1),e[a]=c,c};return r}var ot=n(9830),st=n(3849);class at extends rt{constructor(t,e){super(t,e),this.shadowMap=new U.Z(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new ot.Z(t,{format:33189,width:1,height:1}),this.fbo=new st.Z(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;(0,et.s8)(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],r=(0,et.w)(this.gl),i=n.width*r,o=n.height*r;i===e.width&&o===e.height||e.resize({width:i,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}var ut=n(4088),ct=n(8177);const lt=(0,ct.Z)((function({viewport:t,center:e}){return new tt.Z(t.viewProjectionMatrix).invert().transform(e)})),ft=(0,ct.Z)((function({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,o=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,r,i]=t,o=(0,k.CT)([n,r,i],e);if(Number.isFinite(i))return o;return[o[0],o[1],0]}(t,r)));for(const s of e){const e=s.clone().translate(new G.Z(t.center).negate()),r=o.map((t=>e.transform(t))),i=(new tt.Z).ortho({left:Math.min(...r.map((t=>t[0]))),right:Math.max(...r.map((t=>t[0]))),bottom:Math.min(...r.map((t=>t[1]))),top:Math.max(...r.map((t=>t[1]))),near:Math.min(...r.map((t=>-t[2]))),far:Math.max(...r.map((t=>-t[2])))});n.push(i.multiplyRight(s))}return n})),ht=[0,0,0,1],dt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];var pt={name:"shadow",dependencies:[y.Z],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>{if(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0){const{shadowEnabled:n=!0}=t;return n&&t.shadowMatrices&&t.shadowMatrices.length>0?function(t={},e={}){const n={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||ht,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=lt({viewport:t.viewport,center:e.project_uCenter}),i=[],o=ft({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let s=0;s<t.shadowMatrices.length;s++){const n=o[s],a=n.clone().translate(new G.Z(t.viewport.center).negate());e.project_uCoordinateSystem===ut.Df.LNGLAT&&e.project_uProjectionMode===ut.zG.WEB_MERCATOR?(o[s]=a,i[s]=r):(o[s]=n.clone().multiplyRight(dt),i[s]=a.transform(r))}for(let s=0;s<o.length;s++)n["shadow_uViewProjectionMatrices[".concat(s,"]")]=o[s],n["shadow_uProjectCenters[".concat(s,"]")]=i[s],t.shadowMaps&&t.shadowMaps.length>0?n["shadow_uShadowMap".concat(s)]=t.shadowMaps[s]:n["shadow_uShadowMap".concat(s)]=t.dummyShadowMap;return n}(t,e):{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1}}return{}}};const gt={color:[255,255,255],intensity:1},mt=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],yt=[0,0,0,200/255];class vt extends Q{constructor(t){super(t),this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowColor=yt,this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.shadow=!1,this.programManager=null;for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow))}preRender(t,{layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o}){if(this.shadow){this.shadowMatrices=this._createLightMatrix(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=g.Z.getDefaultProgramManager(t),pt&&this.programManager.addDefaultModule(pt)),this.dummyShadowMap||(this.dummyShadowMap=new U.Z(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++){this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:r,onViewportActive:i,views:o,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(pt),this.programManager=null)}_createLightMatrix(){const t=[];for(const e of this.directionalLights){const n=(new tt.Z).lookAt({eye:new G.Z(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new at(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new q(gt),this.directionalLights.push(new J(mt[0]),new J(mt[1])))}}const bt=new vt;class xt{constructor(){this.effects=[],this._internalEffects=[],this._needsRedraw="Initial render",this.setEffects()}setProps(t){"effects"in t&&(t.effects.length===this.effects.length&&(0,E.v)(t.effects,this.effects)||(this.setEffects(t.effects),this._needsRedraw="effects changed"))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._internalEffects}finalize(){this.cleanup()}setEffects(t=[]){this.cleanup(),this.effects=t,this._createInternalEffects()}cleanup(){for(const t of this.effects)t.cleanup();for(const t of this._internalEffects)t.cleanup();this.effects.length=0,this._internalEffects.length=0}_createInternalEffects(){this._internalEffects=this.effects.slice(),this.effects.some((t=>t instanceof vt))||this._internalEffects.push(bt)}}class wt extends rt{}const _t={blendFunc:[1,0,32771,0],blendEquation:32774};class Et extends rt{render(t){t.pickingFBO?(this.useAlpha=!0,this._drawPickingBuffer(t)):(this.useAlpha=!1,super.render(t))}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pickingFBO:o,deviceRect:{x:s,y:a,width:u,height:c},pass:l="picking",redrawReason:f,pickZ:h}){const d=this.gl;return this.pickZ=h,(0,et.s8)(d,{scissorTest:!0,scissor:[s,a,u,c],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],..._t,blend:!h},(()=>{super.render({target:o,layers:t,layerFilter:e,views:n,viewports:r,onViewportActive:i,pass:l,redrawReason:f})}))}shouldDrawLayer(t){return t.props.pickable}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e){const n=this.pickZ?{blend:!1}:{..._t,blend:!0,blendColor:[0,0,0,this.useAlpha?(e+1)/255:1]};return{...t.props.parameters,...n}}}class At{constructor(t){this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new wt(t),this.pickLayersPass=new Et(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){"layerFilter"in t&&this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),"drawPickingColors"in t&&this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass;t.layerFilter=this.layerFilter,t.effects=t.effects||[],t.target=t.target||st.Z.getDefaultFramebuffer(this.gl),this._preRender(t.effects,t);const n=this.lastPostProcessEffect?this.renderBuffers[0]:t.target,r=e.render({...t,target:n});this._postRender(t.effects,t),this.renderCount++,(0,u.Z)("deckRenderer.renderLayers",this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){let n=null;for(const r of t)r.preRender(this.gl,e),r.postRender&&(n=r);n&&this._resizeRenderBuffers(),this.lastPostProcessEffect=n}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new st.Z(this.gl),new st.Z(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,r={inputBuffer:n[0],swapBuffer:n[1],target:null};for(const i of t)if(i.postRender){if(i===this.lastPostProcessEffect){r.target=e.target,i.postRender(this.gl,r);break}const t=i.postRender(this.gl,r);r.inputBuffer=t,r.swapBuffer=t===n[0]?n[1]:n[0]}}}var Ot=n(1953);const St={pickedColor:null,pickedLayer:null,pickedObjectIndex:-1};function Ct({pickedColors:t,layers:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){if(t){const{x:s,y:u,width:c,height:l}=o;let f=i*i,h=-1,d=0;for(let e=0;e<l;e++){const i=e+u-r,o=i*i;if(o>f)d+=4*c;else for(let e=0;e<c;e++){if(t[d+3]-1>=0){const t=e+s-n,r=t*t+o;r<=f&&(f=r,h=d)}d+=4}}if(h>=0){const n=t[h+3]-1,r=t.slice(h,h+4),i=e[n];if(i){const t=i.decodePickingColor(r),e=Math.floor(h/4/c);return{pickedColor:r,pickedLayer:i,pickedObjectIndex:t,pickedX:s+(h/4-e*c),pickedY:u+e}}a.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return St}function Mt({pickInfo:t,mode:e,viewports:n,layerFilter:r,pixelRatio:i,x:o,y:s,z:a}){const u=t&&t.pickedLayer,c=function(t,e,n){for(let r=t.length-1;r>=0;r--){const i=t[r];if(i.containsPixel(e)&&(!n||n(i)))return i}return t[0]}(n,{x:o,y:s},r&&u&&(t=>r({layer:u,viewport:t,isPicking:!0,renderPass:"picking:".concat(e)}))),l=c&&c.unproject([o-c.x,s-c.y],{targetZ:a});return{color:null,layer:null,viewport:c,index:-1,picked:!1,x:o,y:s,pixel:[o,s],coordinate:l,devicePixel:t&&[t.pickedX,t.pickedY],pixelRatio:i}}function Pt(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,u=s?[s]:[];if("hover"===r){const t=n.index,e=n.layerId,r=s&&s.props.id;if(r!==e||a!==t){if(r!==e){const t=i.find((t=>t.props.id===e));t&&u.unshift(t)}n.layerId=r,n.index=a,n.info=null}}const c=Mt(t),l=new Map;return l.set(null,c),u.forEach((t=>{let e={...c};t===s&&(e.color=o,e.index=a,e.picked=!0),e=kt({layer:t,info:e,mode:r}),t===s&&"hover"===r&&(n.info=e),l.set(e.layer.id,e),"hover"===r&&e.layer.updateAutoHighlight(e)})),l}function kt({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}class Tt{constructor(t){this.gl=t,this.pickingFBO=null,this.pickLayersPass=new Et(t),this.layerFilter=null,this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:r},i=this.lastPickedInfo.info){const o=i&&i.layer&&i.layer.id,s=i&&i.viewport&&i.viewport.id,a=o?n.find((t=>t.id===o)):null,u=s&&r.find((t=>t.id===s))||r[0],c=u&&u.unproject([t-u.x,e-u.y]),l={x:t,y:e,viewport:u,coordinate:c,layer:a};return a?{...i,...l}:Object.assign(l,{color:null,object:null,index:-1})}_resizeBuffer(){const{gl:t}=this;return this.pickingFBO||(this.pickingFBO=new st.Z(t),st.Z.isSupported(t,{colorBufferFloat:!0})&&(this.depthFBO=new st.Z(t),this.depthFBO.attach({36064:new U.Z(t,{format:(0,et.D0)(t)?34836:6408,type:5126})}))),this.pickingFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO&&this.depthFBO.resize({width:t.canvas.width,height:t.canvas.height}),this.pickingFBO}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>t.isPickable()&&!t.isComposite));return e.length>255?(a.Z.warn("Too many pickable layers, only picking the first 255")(),e.slice(0,255)):e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:r,y:i,radius:o=0,depth:s=1,mode:a="query",unproject3D:u,onViewportActive:c}){if(!(t=this._getPickable(t)))return{result:[],emptyInfo:Mt({viewports:n,x:r,y:i})};this._resizeBuffer();const l=(0,et.w)(this.gl),f=(0,et.JY)(this.gl,[r,i],!0),h=[f.x+Math.floor(f.width/2),f.y+Math.floor(f.height/2)],d=Math.round(o*l),{width:p,height:g}=this.pickingFBO,m=this._getPickingRect({deviceX:h[0],deviceY:h[1],deviceRadius:d,deviceWidth:p,deviceHeight:g});let y;const v=[],b={};for(let x=0;x<s;x++){const o=Ct({pickedColors:m&&this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:c,deviceRect:m,pass:"picking:".concat(a),redrawReason:a}),layers:t,deviceX:h[0],deviceY:h[1],deviceRadius:d,deviceRect:m});let f;if(o.pickedLayer&&u&&this.depthFBO){f=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:n,onViewportActive:c,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},pass:"picking:".concat(a),redrawReason:"pick-z",pickZ:!0})[0]*n[0].distanceScales.metersPerUnit[2]+n[0].position[2]}if(o.pickedColor&&x+1<s){const e=o.pickedColor[3]-1;b[e]=!0,t[e].disablePickingIndex(o.pickedObjectIndex)}y=Pt({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:t,layerFilter:this.layerFilter,viewports:n,x:r,y:i,z:f,pixelRatio:l});for(const t of y.values())t.layer&&v.push(t);if(!o.pickedColor)break}for(const x in b)t[x].restorePickingColors();return{result:v,emptyInfo:y&&y.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:r,y:i,width:o=1,height:s=1,mode:u="query",maxObjects:c=null,onViewportActive:l}){if(!(t=this._getPickable(t)))return[];this._resizeBuffer();const f=(0,et.w)(this.gl),h=(0,et.JY)(this.gl,[r,i],!0),d=h.x,p=h.y+h.height,g=(0,et.JY)(this.gl,[r+o,i+s],!0),m=g.x+g.width,y=g.y,v={x:d,y:y,width:m-d,height:p-y},b=function({pickedColors:t,layers:e}){const n=new Map;if(t)for(let r=0;r<t.length;r+=4){const i=t[r+3]-1;if(i>=0){const o=t.slice(r,r+4),s=o.join(",");if(!n.has(s)){const t=e[i];t?n.set(s,{pickedColor:o,pickedLayer:t,pickedObjectIndex:t.decodePickingColor(o)}):a.Z.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}({pickedColors:this._drawAndSample({layers:t,views:e,viewports:n,onViewportActive:l,deviceRect:v,pass:"picking:".concat(u),redrawReason:u}),layers:t}),x=new Map,w=Number.isFinite(c);for(let a=0;a<b.length&&!(w&&x.size>=c);a++){const t=b[a];let e={color:t.pickedColor,layer:null,index:t.pickedObjectIndex,picked:!0,x:r,y:i,width:o,height:s,pixelRatio:f};e=kt({layer:t.pickedLayer,info:e,mode:u}),x.has(e.object)||x.set(e.object,e)}return Array.from(x.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:r,deviceRect:i,pass:o,redrawReason:s,pickZ:a}){if(t.length<1)return null;const u=a?this.depthFBO:this.pickingFBO;this.pickLayersPass.render({layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:r,pickingFBO:u,deviceRect:i,pass:o,redrawReason:s,pickZ:a});const{x:c,y:l,width:f,height:h}=i,d=new(a?Float32Array:Uint8Array)(f*h*4);return(0,Ot.z6)(u,{sourceX:c,sourceY:l,sourceWidth:f,sourceHeight:h,target:d}),d}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:r,deviceHeight:i}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(r,t+n+1)-o,u=Math.min(i,e+n+1)-s;return a<=0||u<=0?null:{x:o,y:s,width:a,height:u}}}const Dt={zIndex:1,position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:0,left:0,display:"none"};class Ft{constructor(t){const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Dt),e.appendChild(this.el)),this.isVisible=!1}setTooltip(t,e,n){const r=this.el;if("string"===typeof t)r.innerText=t;else{if(!t)return this.isVisible=!1,void(r.style.display="none");"text"in t&&(r.innerText=t.text),"html"in t&&(r.innerHTML=t.html),"className"in t&&(r.className=t.className),Object.assign(r.style,t.style)}this.isVisible=!0,r.style.display="block",r.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}remove(){this.el&&this.el.remove()}}var jt=n(6610),Lt=n(6228),Rt=n(8949),It=n(9718);var Nt={name:"JSON",extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse};const Bt="8.5.10",zt=It.CO.deck&&It.CO.deck.VERSION;if(zt&&zt!==Bt)throw new Error("deck.gl - multiple versions detected: ".concat(zt," vs ").concat(Bt));zt||(a.Z.log(1,"deck.gl ".concat(Bt))(),It.CO.deck=Object.assign(It.CO.deck||{},{VERSION:Bt,version:Bt,log:a.Z,_registerLoggers:u.z}),(0,Lt.fh)([Nt,[Rt.S,{imagebitmap:{premultiplyAlpha:"none"}}]]));var $t=It.CO.deck,Ut=n(9835),Vt=n(2525),Zt=n(7577),Wt=n(4211),qt=n(6948);class Gt extends Zt.Z{static isSupported(t,e=[]){const n=(0,et.D0)(t),r=(0,Wt.ag)(t,qt.h.TIMER_QUERY);let i=n||r;for(const o of e)switch(o){case"queries":i=i&&n;break;case"timers":i=i&&r;break;default:(0,Vt.h)(!1)}return i}constructor(t,e={}){super(t,e),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery({conservative:t=!1}={}){return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,r)=>{const i=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(r("Timed out"),this._pollingPromise=null):requestAnimationFrame(i)};requestAnimationFrame(i)})),this._pollingPromise}_createHandle(){return Gt.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Ht=(0,It.jU)()&&"undefined"!==typeof document;let Xt=0;class Yt{constructor(t={}){const{onCreateContext:e=(t=>(0,et.s9)(t)),onAddHTML:n=null,onInitialize:r=(()=>{}),onRender:i=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:u={},debug:c=!1,createFramebuffer:l=!1,autoResizeViewport:f=!0,autoResizeDrawingBuffer:h=!0,stats:d=Ut.l.get("animation-loop-"+Xt++)}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(et.cM.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:r,onRender:i,onFinalize:o,onError:s,gl:a,glOptions:u,debug:c,createFramebuffer:l},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=d,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:f,autoResizeDrawingBuffer:h,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return(0,Vt.h)("string"===typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(t={}){if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Gt.isSupported(this.gl,["timers"])?new Gt(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(...t){return this.props.onCreateContext(...t)}onInitialize(...t){return this.props.onInitialize(...t)}onRender(...t){return this.props.onRender(...t)}onFinalize(...t){return this.props.onFinalize(...t)}getHTMLControlValue(t,e=1){const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return et.cM.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Ht?new Promise(((t,e)=>{Ht&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(...t){this.display?this.display._renderFrame(...t):this.onRender(...t)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"===typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!==typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?(0,et.yW)(this.props.gl,t):this.onCreateContext(t),!(0,et.UF)(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");(0,et.kL)(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:r}=this.gl;return r&&r.clientHeight?n=r.clientWidth/r.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&(0,et.aQ)(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new st.Z(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var Kt=n(2317);function Jt(){}const Qt={id:"",width:"100%",height:"100%",pickingRadius:0,layerFilter:null,glOptions:{},gl:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},onWebGLInitialized:Jt,onResize:Jt,onViewStateChange:Jt,onInteractionStateChange:Jt,onBeforeRender:Jt,onAfterRender:Jt,onLoad:Jt,onError:(t,e)=>a.Z.error(t)(),_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",debug:!1,drawPickingColors:!1};class te{constructor(t){t={...Qt,...t},this.props={},this.width=0,this.height=0,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this._needsRedraw=!0,this._pickRequest={},this._lastPointerDownInfo=null,this.viewState=null,this.interactiveState={isHovering:!1,isDragging:!1},this._onEvent=this._onEvent.bind(this),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),t.viewState&&t.initialViewState&&a.Z.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===(0,It.qs)()&&a.Z.warn("IE 11 support will be deprecated in v8.0")(),t.gl||"undefined"!==typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new l.jk({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&jt.Z.setProps(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager&&(this.layerManager.finalize(),this.layerManager=null,this.viewManager.finalize(),this.viewManager=null,this.effectManager.finalize(),this.effectManager=null,this.deckRenderer.finalize(),this.deckRenderer=null,this.deckPicker.finalize(),this.deckPicker=null,this.eventManager.destroy(),this.eventManager=null,this.tooltip.remove(),this.tooltip=null),this.props.canvas||this.props.gl||!this.canvas||(this.canvas.parentElement.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&a.Z.removed("onLayerHover","onHover")(),"onLayerClick"in t&&a.Z.removed("onLayerClick","onClick")(),t.initialViewState&&!(0,E.v)(this.props.initialViewState,t.initialViewState)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),r=this.layerManager.needsRedraw(t),i=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||r||i||o,e}redraw(t){if(!this.layerManager)return;const e=t||this.needsRedraw({clearRedrawFlags:!0});e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}getViews(){return this.viewManager.views}getViewports(t){return this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_pick(t,e,n){const{stats:r}=this;r.get("Pick Count").incrementCount(),r.get(e).timeStart();const i=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,...n});return r.get(e).timeEnd(),i}_createCanvas(t){let e=t.canvas;if("string"===typeof e&&(e=document.getElementById(e),(0,T.Z)(e)),!e){e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay";(t.parent||document.body).appendChild(e)}return Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;let{width:e,height:n}=t;(e||0===e)&&(e=Number.isFinite(e)?"".concat(e,"px"):e,this.canvas.style.width=e),(n||0===n)&&(n=Number.isFinite(n)?"".concat(n,"px"):n,this.canvas.style.position="absolute",this.canvas.style.height=n)}_updateCanvasSize(){if(this._checkForCanvasSizeChange()){const{width:t,height:e}=this;this.viewManager.setProps({width:t,height:e}),this.props.onResize({width:this.width,height:this.height})}}_checkForCanvasSizeChange(){const{canvas:t}=this;if(!t)return!1;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;return(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,!0)}_createAnimationLoop(t){const{width:e,height:n,gl:r,glOptions:i,debug:o,onError:s,onBeforeRender:a,onAfterRender:u,useDevicePixels:c,autoResizeDrawingBuffer:l}=t;return new Yt({width:e,height:n,useDevicePixels:c,autoResizeDrawingBuffer:l,autoResizeViewport:!1,gl:r,onCreateContext:t=>(0,et.s9)({...i,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:u,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new $({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_onPointerMove(t){const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t,e.mode="hover"}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:e,emptyInfo:n}=this._pick("pickObject","pickObject Time",t);this.interactiveState.isHovering=e.length>0;let r=n,i=!1;for(const o of e)r=o,i=o.layer.onHover(o,t.event);if(!i&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.interactiveState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,(0,et.yW)(t,{enable:!0,copyState:!0})),this.tooltip=new Ft(this.canvas),(0,et.dR)(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new o;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Kt.Q(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const r in ut.FP)this.eventManager.on(r,this._onEvent);this.viewManager=new A({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new _(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new xt,this.deckRenderer=new At(t),this.deckPicker=new Tt(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;(0,et.dR)(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",redrawReason:t,effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),a.Z.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(!1),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.interactiveState.isDragging=t.isDragging,this.props.onInteractionStateChange(t)}_onEvent(t){const e=ut.FP[t.type],n=t.offsetCenter;if(!e||!n)return;const r=this.layerManager.getLayers(),i=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:r,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=i,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let u=!1;s&&(u=s.call(o,i,t)),!u&&a&&a(i,t)}_onPointerDown(t){const e=t.offsetCenter;this._lastPointerDownInfo=this.pickObject({x:e.x,y:e.y,radius:this.props.pickingRadius})}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=Ut.l.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}te.getPropTypes=function(t){return{id:t.string,width:t.oneOfType([t.number,t.string]),height:t.oneOfType([t.number,t.string]),layers:t.oneOfType([t.object,t.array]),layerFilter:t.func,views:t.oneOfType([t.object,t.array]),viewState:t.object,effects:t.arrayOf(t.instanceOf(Q)),controller:t.oneOfType([t.func,t.bool,t.object]),gl:t.object,glOptions:t.object,parameters:t.object,pickingRadius:t.number,useDevicePixels:t.oneOfType([t.bool,t.number]),touchAction:t.string,eventRecognizerOptions:t.object,onWebGLInitialized:t.func,onResize:t.func,onViewStateChange:t.func,onInteractionStateChange:t.func,onBeforeRender:t.func,onAfterRender:t.func,onLoad:t.func,onError:t.func,debug:t.bool,drawPickingColors:t.bool,_framebuffer:t.object,_animate:t.bool,_pickable:t.bool,_typedArrayManagerProps:t.object}},te.defaultProps=Qt,te.VERSION=$t.VERSION},5522:function(t,e,n){"use strict";n.d(e,{Z:function(){return le}});var r=n(4088),i=n(4211),o=n(6948),s=n(3478);class a{constructor(t,e){this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:r}=e;let i=n;if(n&&n.length!==r){i=new Float32Array(r);const t=e.elementOffset||0;for(let e=0;e<r;++e)i[e]=n[t+e]}return i}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}var u=n(6610),c=n(5126),l=n(744);function f(t){return t.stride||t.size*t.bytesPerElement}function h(t,e){e.offset&&l.Z.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=f(t),r=("vertexOffset"in e?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:r,stride:n}}var d=n(5304),p=n(8550),g=n(1855);const m=[],y=[[0,1/0]];function v({source:t,target:e,start:n=0,end:r,size:i,getData:o}){r=r||e.length;const s=t.length,a=r-n;if(s>a)return void e.set(t.subarray(0,a),n);if(e.set(t,n),!o)return;let u=s;for(;u<a;){const r=o(u,t);for(let t=0;t<i;t++)e[n+u]=r[t]||0,u++}}const b={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function x(t,e){return t?(Number.isFinite(t)&&(t={duration:t}),t.type=t.type||"interpolation",{...b[t.type],...e,...t}):null}function w(t,e){return e.getBuffer()?[e.getBuffer(),{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function _(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function E(t){t.push(t.shift())}function A(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,s=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*s}function O({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:o=(t=>t)}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*s,u=n.byteOffset,c=n.startIndices,l=i&&c,f=A(n,e),h=n.state.constant;if(!l&&r>=f)return;const d=h?n.value:n.getBuffer().getData({srcByteOffset:u});if(n.settings.normalized&&!h){const t=o;o=(e,r)=>n._normalizeConstant(t(e,r))}const p=h?(t,e)=>o(d,e):(t,e)=>o(d.subarray(t,t+a),e),g=t.getData({length:r}),m=new Float32Array(f);!function({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:o}){if(!Array.isArray(o))return v({source:t,target:e,size:n,getData:r}),e;let s=0,a=0;const u=r&&((t,e)=>r(t+a,e)),c=Math.min(i.length,o.length);for(let l=1;l<c;l++){const r=i[l]*n,c=o[l]*n;v({source:t.subarray(s,r),target:e,start:a,end:c,size:n,getData:u}),s=r,a=c}a<e.length&&v({source:[],target:e,start:a,size:n,getData:u})}({source:g,target:m,sourceStartIndices:i,targetStartIndices:c,size:a,getData:p}),t.byteLength<m.byteLength+u&&t.reallocate(m.byteLength+u),t.subData({data:m,offset:u})}class S extends class{constructor(t,e){this.gl=t,this.id=e.id,this.size=e.size;const n=e.logicalType||e.type,r=5130===n;let{defaultValue:s}=e;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),e.defaultValue=s;let a=n;r?a=5126:!a&&e.isIndexed?a=t&&(0,i.U6)(t,o.h.ELEMENT_INDEX_UINT32)?5125:5123:a||(a=5126),e.logicalType=n,e.type=a;let u=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(n||a||5126);this.shaderAttributes={},this.doublePrecision=r,r&&!1===e.fp64&&(u=Float32Array),e.bytesPerElement=u.BYTES_PER_ELEMENT,this.defaultType=u,this.value=null,this.settings=e,this.state={externalBuffer:null,bufferAccessor:e,allocatedValue:null,constant:!1},this._buffer=null,this.setData(e)}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new s.Z(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*f(t):0}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),u.Z.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},r=this.value instanceof Float64Array,i=function(t,e){const n=h(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new a(this,i.high),n["".concat(t,"64Low")]=r?new a(this,i.low):new Float32Array(this.size),n}if(e){const n=h(this.getAccessor(),e);return{[t]:new a(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}setData(t){const{state:e}=this;ArrayBuffer.isView(t)?t={value:t}:t instanceof s.Z&&(t={buffer:t});const n={...this.settings,...t};if(e.bufferAccessor=n,t.constant){let n=t.value;n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this._normalizeConstant(n));if(!(!e.constant||!this._areValuesEqual(n,this.value)))return!1;e.externalBuffer=null,e.constant=!0,this.value=n}else if(t.buffer){const r=t.buffer;e.externalBuffer=r,e.constant=!1,this.value=t.value;const i=t.value instanceof Float64Array;n.type=t.type||r.accessor.type,n.bytesPerElement=r.accessor.BYTES_PER_ELEMENT*(i?2:1),n.stride=f(n)}else if(t.value){this._checkExternalBuffer(t);let r=t.value;e.externalBuffer=null,e.constant=!1,this.value=r,n.bytesPerElement=r.BYTES_PER_ELEMENT,n.stride=f(n);const{buffer:i,byteOffset:o}=this;this.doublePrecision&&r instanceof Float64Array&&(r=(0,c.TK)(r,n));const s=r.byteLength+o+2*n.stride;i.byteLength<s&&i.reallocate(s),i.setAccessor(null),i.subData({data:r,offset:o}),n.type=t.type||i.accessor.type}return!0}updateSubBuffer(t={}){const{value:e}=this,{startOffset:n=0,endOffset:r}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?(0,c.TK)(e,{size:this.size,startIndex:n,endIndex:r}):e.subarray(n,r),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate({numInstances:t,copy:e=!1}){const{state:n}=this,r=n.allocatedValue,i=u.Z.allocate(r,t+1,{size:this.size,type:this.defaultType,copy:e});this.value=i;const{buffer:o,byteOffset:s}=this;return o.byteLength<i.byteLength+s&&(o.reallocate(i.byteLength+s),e&&r&&o.subData({data:r instanceof Float64Array?(0,c.TK)(r,this):r,offset:s})),n.allocatedValue=i,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!t.constant&&e){const n=this.defaultType;let r=!1;if(this.doublePrecision&&(r=e.BYTES_PER_ELEMENT<4),r)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||l.Z.warn("Attribute ".concat(this.id," is normalized"))()}}_normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:r,size:i}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=r[0],e;switch(i){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:r[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:r[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:r[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:r[0];break;default:let o=i;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:r[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}}{constructor(t,e={}){super(t,e);const{transition:n=!1,noAlloc:r=!1,update:i=null,accessor:o=null,transform:s=null,startIndices:a=null}=e;Object.assign(this.settings,{transition:n,noAlloc:r,update:i||o&&this._autoUpdater,accessor:o,transform:s}),Object.assign(this.state,{lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:y,startIndices:a}),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!==typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return x(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===y)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const r=t[o];r[1]<e[0]?(n.push(r),i=o+1):r[0]>e[1]?n.push(r):e=[Math.min(r[0],e[0]),Math.max(r[1],e[1])]}return n.splice(i,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=y}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=m}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}update(t){this.setData(t)}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&(!!n.update&&(super.allocate({numInstances:t,copy:e.updateRanges!==y}),!0))}updateBuffer({numInstances:t,data:e,props:n,context:r}){if(!this.needsUpdate())return!1;const{state:{updateRanges:i},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of i)o.call(r,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of i){const r=Number.isFinite(e)?this.getVertexOffset(e):0,i=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:r,endOffset:i})}else;this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){if(void 0===t||"function"===typeof t)return!1;return this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:r}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(r.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;n.binaryValue=t,this.setNeedsRedraw(),ArrayBuffer.isView(t)&&(t={value:t});if(r.transform||e!==this.startIndices){(0,d.Z)(ArrayBuffer.isView(t.value),"invalid ".concat(r.accessor));const i=t.size&&t.size!==this.size;return n.binaryAccessor=(0,p.jr)(t.value,{size:t.size||this.size,stride:t.stride,offset:t.offset,startIndices:e,nested:i}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?e[t]:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:r,props:i,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:u,size:c,startIndices:l}=t,{accessor:f,transform:h}=s,m=a.binaryAccessor||("function"===typeof f?f:i[f]);(0,d.Z)("function"===typeof m,'accessor "'.concat(f,'" is not a function'));let y=t.getVertexOffset(n);const{iterable:v,objectInfo:b}=(0,p.jB)(e,n,r);for(const d of v){b.index++;let e=m(d,b);if(h&&(e=h.call(this,e)),l){const n=(b.index<l.length-1?l[b.index+1]:o)-l[b.index];if(e&&Array.isArray(e[0])){let n=y;for(const r of e)t._normalizeValue(r,u,n),n+=c}else e&&e.length>c?u.set(e,y):(t._normalizeValue(e,b.target,0),(0,g.k)({target:u,source:b.target,start:y,count:n}));y+=n*c}else t._normalizeValue(e,u,y),y+=c}}_validateAttributeUpdaters(){const{settings:t}=this;if(!(t.noAlloc||"function"===typeof t.update))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}var C=n(3803),M=n(9047);const P="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",k=`#version 300 es\n${P}`;function T(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;if(!e.includes(r)||!i||!o)return null;return{qualifier:r,type:i,name:o.split(";")[0]}}function D(t={}){const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return 300===e?k:e>300?`#version ${e}\n${P}`:"void main() {gl_FragColor = vec4(0);}";const o=function(t,e){switch(e){case"float":return`vec4(${t}, 0.0, 0.0, 1.0)`;case"vec2":return`vec4(${t}, 0.0, 1.0)`;case"vec3":return`vec4(${t}, 1.0)`;case"vec4":return t;default:return(0,M.Z)(!1),null}}(n,r);return e>=300?`#version ${e} ${300===e?"es":""}\nin ${r} ${n};\nout vec4 ${i};\nvoid main() {\n  ${i} = ${o};\n}`:`varying ${r} ${n};\nvoid main() {\n  gl_FragColor = ${o};\n}`}var F=n(9450),j=n(1053),L=n(2525);class R{constructor(t,e={}){this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(t={}){const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(t={}){const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:r}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:r}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof s.Z?n:n.buffer:null}getData(t={}){const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(t={}){this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&(0,L.h)((0,F.D0)(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const r in this.feedbackMap){const t=this.feedbackMap[r];r in e&&(n[t]=r)}Object.assign(n,t.feedbackBuffers);for(const r in n){const t=n[r];if("string"===typeof t){const i=e[t],{byteLength:o,usage:s,accessor:a}=i;n[r]=this._createNewBuffer(r,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(t={}){const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,{model:e}){const{program:n}=e;t.transformFeedback=new j.Z(this.gl,{program:n,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const r in this.feedbackMap){const i=this.feedbackMap[r];e[r]=t.feedbackBuffers[i],n[i]=t.sourceBuffers[r],(0,L.h)(n[i]instanceof s.Z)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new s.Z(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}var I=n(1953),N=n(4912),B=n(3849),z=n(5432);function $(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}var U=n(6713);const V={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null};function Z({vs:t,sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}){let i=Object.keys(e).length,o=null;const s={};let a=t,u={};if(i>0||n){const t=a.split("\n"),c=t.slice();if(t.forEach(((t,r,a)=>{if(i>0){const n=function(t,e){const n={},r=function(t){return T(t,["attribute","in"])}(t);if(!r)return null;const{type:i,name:o}=r;if(o&&e[o]){const e=`// ${t} => Replaced by Transform with a sampler`,{samplerName:r,sizeName:s,uniformDeclerations:a}=function(t){const e=`transform_uSampler_${t}`,n=`transform_uSize_${t}`;return{samplerName:e,sizeName:n,uniformDeclerations:`  uniform sampler2D ${e};\n  uniform vec2 ${n};`}}(o),u=`  ${i} ${o} = transform_getInput(${r}, ${s}).${function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return(0,M.Z)(!1),null}}(i)};\n`;n[r]=o;return{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":u},samplerTextureMap:n}}return null}(t,e);if(n){const{updatedLine:t,inject:e}=n;c[r]=t,u=(0,U.Lm)([u,e]),Object.assign(s,n.samplerTextureMap),i--}}n&&!o&&(o=function(t,e){const n=T(t,["varying","out"]);if(!n)return null;return n.name===e?n.type:null}(t,n))})),n){(0,L.h)(r);const t=`transform_uSize_${n}`,e={"vs:#decl":`uniform vec2 ${t};\n`,"vs:#main-start":`     vec2 transform_position = transform_getPos(${t});\n     gl_Position = vec4(transform_position, 0, 1.);\n`};u=(0,U.Lm)([u,e])}a=c.join("\n")}return{vs:a,targetTextureType:o,inject:u,samplerTextureMap:s}}const W={10241:9728,10240:9728,10242:33071,10243:33071};class q{constructor(t,e={}){this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(t={}){const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(t={}){const{sourceBuffers:e,sourceTextures:n,framebuffer:r,targetTexture:i}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let u=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const e in this.samplerTextureMap){const t=this.samplerTextureMap[e];s[e]=n[t]}this._setSourceTextureParameters();const t=function({sourceTextureMap:t,targetTextureVarying:e,targetTexture:n}){const r={};let i,o;e&&(({width:i,height:o}=n),r[`transform_uSize_${e}`]=[i,o]);for(const s in t)({width:i,height:o}=t[s]),r[`transform_uSize_${s}`]=[i,o];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:i});Object.assign(s,t)}return this.hasTargetTexture&&(u=!1,a.viewport=[0,0,r.width,r.height]),{attributes:o,framebuffer:r,uniforms:s,discard:u,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(t={}){this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData({packed:t=!1}={}){const{framebuffer:e}=this.bindings[this.currentIndex],n=(0,I.z6)(e);if(!t)return n;const r=n.constructor,i=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return(0,M.Z)(!1),null}}(this.targetTextureType),o=new r(n.length*i/4);let s=0;for(let a=0;a<n.length;a+=4)for(let t=0;t<i;t++)o[s++]=n[a+t];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(t={}){const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof N.Z)return n;const r=e[n];return r?(this._targetRefTexName=n,this._createNewTexture(r)):null}_setupTextures(t={}){const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:r}=t,i=this._createTargetTexture({sourceTextures:n,textureOrReference:r});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:i}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!==typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new s.Z(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:r,targetTexture:i}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,r),Object.assign(t.sourceBuffers,n),i){t.targetTexture=i;const{width:e,height:n}=i,{framebuffer:r}=t;r?(r.update({attachments:{36064:i},resizeAttachments:!1}),r.resize({width:e,height:n})):t.framebuffer=new B.Z(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:i}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const n in e)e[n].setParameters(W)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);e[this._swapTexture]=t.targetTexture;return{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=(0,z.h)(t,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(t={}){const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:r,uniforms:i,targetTextureType:o,inject:s,samplerTextureMap:a}=Z({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),u=(0,U.Lm)([t.inject||{},s]);this.targetTextureType=o,this.samplerTextureMap=a;return{vs:r,fs:t._fs||D({version:$(r),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[V].concat(t.modules||[]):t.modules,uniforms:i,inject:u}}}var G=n(4538),H=n(1113);class X{static isSupported(t){return(0,F.D0)(t)}constructor(t,e={}){this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(t={}){const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();(0,L.h)(t,"Nothing to swap")}getBuffer(t=null){return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(t={}){const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(t={}){"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(t={}){const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new H.Z(e,Object.assign({},t,{fs:t.fs||D({version:$(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=r.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){if(!(0,G.nK)(t.feedbackBuffers)||!(0,G.nK)(t.feedbackMap)||t.varyings&&t.varyings.length>0)return!0;return!1})(e)&&(this.bufferTransform=new R(t,e)),function(t){if(!(0,G.nK)(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)return!0;return!1}(e)&&(this.textureTransform=new q(t,e)),(0,L.h)(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=Object.assign(e,r.getDrawOptions(e));return e}}var Y=n(3630);const K="\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n";const J={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="interpolation",this.transition=new Y.Z(n),this.attribute=e,this.attributeInTransition=new S(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=_(e.size);return new X(t,{vs:K,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const r={byteLength:0,usage:35050};this.buffers=[new s.Z(t,r),new s.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();const{gl:n,buffers:r,attribute:i}=this;E(r);const o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of r)O({buffer:s,...o});this.currentStartIndices=i.startIndices,this.currentLength=A(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aFrom:r[0],aTo:w(0,i)},feedbackBuffers:{vCurrent:r[1]}})}update(){const t=this.transition.update();if(t){const{time:t,settings:{duration:e,easing:n}}=this.transition,r=n(t/e);this.transform.run({uniforms:{time:r}})}return t}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete()}},spring:class{constructor({gl:t,attribute:e,timeline:n}){this.gl=t,this.type="spring",this.transition=new Y.Z(n),this.attribute=e,this.attributeInTransition=new S(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new N.Z(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new B.Z(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const r=_(e.size);return new X(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}(t,e,this.framebuffer);const r={byteLength:0,usage:35050};this.buffers=[new s.Z(t,r),new s.Z(t,r),new s.Z(t,r)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:r,attribute:i}=this,o={numInstances:e,attribute:i,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const s of r)O({buffer:s,...o});this.currentStartIndices=i.startIndices,this.currentLength=A(i,e),this.attributeInTransition.update({buffer:r[1],value:i.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/i.size),sourceBuffers:{aTo:w(0,i)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:r}=this;if(!r.update())return!1;e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.settings.stiffness,damping:r.settings.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),E(t),this.attributeInTransition.update({buffer:t[1],value:this.attribute.value});return(0,I.z6)(n)[0]>0||r.end(),!0}cancel(){for(this.transition.cancel(),this.transform.delete();this.buffers.length;)this.buffers.pop().delete();this.texture.delete(),this.texture=null,this.framebuffer.delete(),this.framebuffer=null}}};class Q{constructor(t,{id:e,timeline:n}){this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=X.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const r in t){const n=t[r],i=n.getTransitionSetting(e);i&&this._updateAttribute(r,n,i)}for(const r in this.transitions){const n=t[r];n&&n.getTransitionSetting(e)||this._removeTransition(r)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const e in this.transitions){this.transitions[e].update()&&(this.needsRedraw=!0)}const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const r=this.transitions[t];let i=!r||r.type!==n.type;if(i){if(!this.isSupported)return void l.Z.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();r&&this._removeTransition(t);const o=J[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):(l.Z.error("unsupported transition type '".concat(n.type,"'"))(),i=!1)}(i||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const tt="attributeManager.invalidate";class et{constructor(t,{id:e="attribute-manager",stats:n,timeline:r}={}){this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.accessors={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new Q(t,{id:"".concat(e,"-transitions"),timeline:r}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(t=!0){return this.needsRedraw=!0,this}add(t,e){this._add(t,e)}addInstanced(t,e){this._add(t,e,{instanced:1})}remove(t){for(let e=0;e<t.length;e++){const n=t[e];void 0!==this.attributes[n]&&(this.attributes[n].delete(),delete this.attributes[n])}}invalidate(t,e){const n=this._invalidateTrigger(t,e);(0,C.Z)(tt,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);(0,C.Z)(tt,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:r,props:i={},buffers:o={},context:s={}}={}){let a=!1;(0,C.Z)("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const u in this.attributes){const r=this.attributes[u],c=r.settings.accessor;r.startIndices=n,i[u]&&l.Z.removed("props.".concat(u),"data.attributes.".concat(u))(),r.setExternalBuffer(o[u])||r.setBinaryValue(o[c],t.startIndices)||!o[c]&&r.setConstantValue(i[c])||r.needsUpdate()&&(a=!0,this._updateAttribute({attribute:r,numInstances:e,data:t,props:i,context:s})),this.needsRedraw|=r.needsRedraw()}a&&(0,C.Z)("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:r})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,r={...n.getAttributes()};for(const i in e){const o=e[i];o.needsRedraw(t)&&!n.hasAttribute(i)&&(r[i]=o)}return r}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const r in t)e[r]||Object.assign(n,t[r].getShaderAttributes());return n}getAccessors(){return this.updateTriggers}_add(t,e,n={}){e&&l.Z.warn("AttributeManager.add({updaters}) - updater map no longer supported")();for(const r in t){const e=t[r];this.attributes[r]=this._createAttribute(r,e,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const r={...e,id:t,isIndexed:e.isIndexed||e.elements||!1,constant:e.constant||!1,size:(e.elements?1:e.size)||1,value:e.value||null,divisor:e.instanced||n.instanced?1:e.divisor||0};return new S(this.gl,r)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes){this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}))}this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:r}=this,i=r[t];return i&&i.forEach((t=>{const r=n[t];r&&r.setNeedsUpdate(r.id,e)})),i}_updateAttribute(t){const{attribute:e,numInstances:n}=t;if((0,C.Z)("attribute.updateStart",e),e.constant)return void e.setConstantValue(e.value);e.allocate(n)&&(0,C.Z)("attribute.allocate",e,n);e.updateBuffer(t)&&(this.needsRedraw=!0,(0,C.Z)("attribute.updateEnd",e,n))}}var nt=n(4034);class rt extends Y.Z{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:r,easing:i}}=this,o=i(t/r);this._value=(0,nt.t7)(e,n,o)}}const it=1e-5;function ot(t,e,n,r,i){const o=e-t;return(n-e)*i+-o*r+o+e}function st(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class at extends Y.Z{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:r}=this.settings,{_prevValue:i=t,_currValue:o=t}=this;let s=function(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=ot(t[s],e[s],n[s],r,i);return o}return ot(t,e,n,r,i)}(i,o,e,n,r);const a=st(s,e),u=st(s,o);a<it&&u<it&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}const ut={interpolation:rt,spring:at};class ct{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,r){const{transitions:i}=this;if(i.has(t)){const n=i.get(t),{value:r=n.settings.fromValue}=n;e=r,this.remove(t)}if(!(r=x(r)))return;const o=ut[r.type];if(!o)return void l.Z.error("unsupported transition type '".concat(r.type,"'"))();const s=new o(this.timeline);s.start({...r,fromValue:e,toValue:n}),i.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}var lt=n(5409);const{COMPONENT:ft}=lt.A;function ht(t,e){const n=pt({newProps:t,oldProps:e,propTypes:vt(t),ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=null;const{dataComparator:r,_dataDiff:i}=t;r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied");n&&i&&(n=i(t.data,e.data)||n);return n}(t,e);let i=!1;return r||(i=function(t,e){if(null===e)return"oldProps is null, initial diff";if("all"in t.updateTriggers){if(yt(t,e,"all"))return{all:!0}}const n={};let r=!1;for(const i in t.updateTriggers)if("all"!==i){yt(t,e,i)&&(n[i]=!0,r=n)}return r}(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:mt(t,e),transitionsChanged:dt(t,e)}}function dt(t,e){if(!t.transitions)return null;const n={},r=vt(t);for(const i in t.transitions){const o=r[i],s=o&&o.type;("number"===s||"color"===s||"array"===s)&&gt(t[i],e[i],o)&&(n[i]=!0)}return n}function pt({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}={}){if(e===t)return null;if("object"!==typeof t||null===t)return"".concat(i," changed shallowly");if("object"!==typeof e||null===e)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const n=gt(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=gt(t[o],e[o],r[o]);if(n)return"".concat(i,".").concat(o," ").concat(n)}}return null}function gt(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)?"changed deeply":r||(r=t&&e&&t.equals,!r||r.call(t,e))?r||e===t?null:"changed shallowly":"changed deeply"}function mt(t,e){if(null===e)return"oldProps is null, initial diff";const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function yt(t,e,n){let r=t.updateTriggers[n];r=void 0===r||null===r?{}:r;let i=e.updateTriggers[n];i=void 0===i||null===i?{}:i;return pt({oldProps:i,newProps:r,triggerName:n})}function vt(t){const e=t[ft],n=e&&e.constructor;return n?n._propTypes:{}}function bt(t){if(null===(e=t)||"object"!==typeof e)throw new Error("count(): argument not an object");var e;if("function"===typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"===typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error("count(): argument not a container")}var xt=n(8177);function wt(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const r={...t.inject};for(const t in e.inject)r[t]=(r[t]||"")+e.inject[t];n.inject=r}else n.inject=e.inject;return n}var _t=n(8771),Et=n(6935),At=n(8333),Ot=n(7160),St=n(7013);function Ct(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof Et.Z){const[n,i,o=0]=t,s=e.getDistanceScales([n,i]);r[2]=o*s.unitsPerMeter[2]}return r}function Mt(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:o,offsetMode:s}){let[a,u,c=0]=t;switch(n&&([a,u,c]=At.fF([],[a,u,c,1],n)),i){case r.Df.LNGLAT:return Ct([a,u,c],e,s);case r.Df.LNGLAT_OFFSETS:return Ct([a+o[0],u+o[1],c+(o[2]||0)],e,s);case r.Df.METER_OFFSETS:return Ct((0,St.eG)(o,[a,u,c]),e,s);case r.Df.CARTESIAN:default:return e.isGeospatial?[a+o[0],u+o[1],c+o[2]]:e.projectPosition([a,u,c])}}function Pt(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:o,modelMatrix:s,fromCoordinateSystem:a,fromCoordinateOrigin:u}=function(t){const e={...t};let{coordinateSystem:n}=t;const{viewport:i,coordinateOrigin:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=t;return n===r.Df.DEFAULT&&(n=i.isGeospatial?r.Df.LNGLAT:r.Df.CARTESIAN),void 0===s&&(e.fromCoordinateSystem=n),void 0===a&&(e.fromCoordinateOrigin=o),e.coordinateSystem=n,e}(e),{geospatialOrigin:c,shaderCoordinateOrigin:l,offsetMode:f}=(0,_t.v)(n,i,o),h=Mt(t,{viewport:n,modelMatrix:s,coordinateSystem:a,coordinateOrigin:u,offsetMode:f});if(f){const t=n.projectPosition(c||l);Ot.lu(h,h,t)}return h}const kt={10241:9987,10240:9729,10242:33071,10243:33071},Tt={};const Dt={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Rt(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>Ft(t,e)},accessor:{validate(t,e){const n=It(t);return"function"===n||n===It(e.value)},equal:(t,e,n)=>"function"===typeof e||Ft(t,e)},array:{validate:(t,e)=>e.optional&&!t||Rt(t),equal:(t,e,n)=>n.compare?Ft(t,e):t===e},function:{validate:(t,e)=>e.optional&&!t||"function"===typeof t,equal:(t,e,n)=>!n.compare||t===e},data:{transform:(t,e,n)=>{const{dataTransform:r}=n?n.props:{};return r&&t?r(t):t}},image:{transform:(t,e,n)=>function(t,e){const n=t.context&&t.context.gl;if(!n||!e)return null;if(e instanceof N.Z)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let r=null;e.compressed&&(r={10241:e.data.length>1?9985:9729});const i=new N.Z(n,{...e,parameters:{...kt,...r,...t.props.textureParameters}});return Tt[i.id]=!0,i}(n,t),release:t=>{var e;(e=t)&&e instanceof N.Z&&Tt[e.id]&&(e.delete(),delete Tt[e.id])}}};function Ft(t,e){if(t===e)return!0;if(!Rt(t)||!Rt(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function jt(t,e){switch(It(e)){case"object":return Lt(t,e);case"array":return Lt(t,{type:"array",value:e,compare:!1});case"boolean":return Lt(t,{type:"boolean",value:e});case"number":return Lt(t,{type:"number",value:e});case"function":return Lt(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Lt(t,e){return"type"in e?{name:t,...Dt[e.type],...e}:"value"in e?{name:t,type:It(e.value),...e}:{name:t,type:"object",value:e}}function Rt(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function It(t){return Rt(t)?"array":null===t?"null":typeof t}const{COMPONENT:Nt,ASYNC_ORIGINAL:Bt,ASYNC_RESOLVED:zt,ASYNC_DEFAULTS:$t}=lt.A;function Ut(){const t=this,e=Vt(t.constructor),n=Object.create(e);n[Nt]=t,n[Bt]={},n[zt]={};for(let r=0;r<arguments.length;++r){const t=arguments[r];for(const e in t)n[e]=t[e]}return Object.freeze(n),n}function Vt(t){const e=qt(t,"_mergedDefaultProps");return e||(function(t){if(!t.prototype)return;const e=Object.getPrototypeOf(t),n=Vt(e),r=function(t){const e={},n={},r={};for(const[i,o]of Object.entries(t))if(o&&o.deprecatedFor)r[i]=Array.isArray(o.deprecatedFor)?o.deprecatedFor:[o.deprecatedFor];else{const t=jt(i,o);e[i]=t,n[i]=t.value}return{propTypes:e,defaultProps:n,deprecatedProps:r}}(qt(t,"defaultProps")||{}),i=function(t,e,n){const r=Object.create(null);Object.assign(r,e,t);const i=function(t){const e=qt(t,"layerName")||qt(t,"componentName");e||l.Z.once(0,"".concat(t.name,".componentName not specified"))();return e||t.name}(n);return delete t.id,Object.defineProperties(r,{id:{writable:!0,value:i}}),r}(r.defaultProps,n,t),o={...e._propTypes,...r.propTypes};!function(t,e){const n={},r={};for(const i in e){const t=e[i],{name:o,value:s}=t;t.async&&(n[o]=s,r[o]=Zt(o))}t[$t]=n,t[Bt]={},Object.defineProperties(t,r)}(i,o);const s={...e._deprecatedProps,...r.deprecatedProps};(function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const r="".concat(this.id,": ").concat(n);for(const i of e[n])Wt(this,i)||(this[i]=t);l.Z.deprecated(r,e[n].join("/"))()}})})(i,s),t._mergedDefaultProps=i,t._propTypes=o,t._deprecatedProps=s}(t),t._mergedDefaultProps)}function Zt(t){return{enumerable:!0,set(e){"string"===typeof e||e instanceof Promise||(0,p.D0)(e)?this[Bt][t]=e:this[zt][t]=e},get(){if(this[zt]){if(t in this[zt]){return this[zt][t]||this[$t][t]}if(t in this[Bt]){const e=this[Nt]&&this[Nt].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[$t][t]}}return this[$t][t]}}}function Wt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function qt(t,e){return Wt(t,e)&&t[e]}const{ASYNC_ORIGINAL:Gt,ASYNC_RESOLVED:Ht,ASYNC_DEFAULTS:Xt}=lt.A,Yt=Object.freeze({});class Kt{constructor(t=null){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=Yt,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}}getOldProps(){return this.oldAsyncProps||this.oldProps}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component.props}freezeAsyncOldProps(){if(!this.oldAsyncProps){this.oldProps=this.oldProps||this.component.props,this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const e in this.asyncProps)if(this.isAsyncPropLoading(e))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){const e=t[Ht]||{},n=t[Gt]||t,r=t[Xt]||{};for(const i in e){const t=e[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,t),e[i]=this.getAsyncProp(i)}for(const i in n){const t=n[i];this._createAsyncPropData(i,r[i]),this._updateAsyncProp(i,t)}}_updateAsyncProp(t,e){if(this._didAsyncInputValueChange(t,e)){if("string"===typeof e){var n;const r=null===(n=this.layer)||void 0===n?void 0:n.props.fetch,i=e;r&&(e=r(i,{propName:t,layer:this.layer}))}e instanceof Promise?this._watchPromise(t,e):(0,p.D0)(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e)}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this.freezeAsyncOldProps();const n=this.asyncProps[t];e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount}_setAsyncPropValue(t,e,n){const r=this.asyncProps[t];r&&n>=r.resolvedLoadCount&&void 0!==e&&(this.freezeAsyncOldProps(),r.resolvedValue=e,r.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];n.pendingLoadCount++;const r=n.pendingLoadCount;e.then((e=>{var i;e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,r);const o=null===(i=this.layer)||void 0===i?void 0:i.props.onDataLoad;"data"===t&&o&&o(e,{propName:t,layer:this.layer})})).catch((e=>{var n;null===(n=this.layer)||void 0===n||n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}))}async _resolveAsyncIterable(t,e){var n;"data"!==t&&this._setPropValue(t,e);const r=this.asyncProps[t];r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],s=0;for await(const u of e){const{dataTransform:e}=this.component?this.component.props:{};o=e?e(u,o):o.concat(u),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:s,endRow:o.length}]}),s=o.length,this._setAsyncPropValue(t,o,i)}const a=null===(n=this.layer)||void 0===n?void 0:n.props.onDataLoad;a&&a(o,{propName:t,layer:this.layer})}_postProcessValue(t,e){const n=t.type;return n&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.constructor._propTypes;this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}const{ASYNC_ORIGINAL:Jt,ASYNC_RESOLVED:Qt,ASYNC_DEFAULTS:te}=lt.A;let ee=0;class ne{constructor(){this.props=Ut.apply(this,arguments),this.id=this.props.id,this.count=ee++,this.lifecycle=lt.d.NO_STATE,this.parent=null,this.context=null,this.state=null,this.internalState=null,Object.seal(this)}clone(t){const{props:e}=this,n={};for(const r in e[te])r in e[Qt]?n[r]=e[Qt][r]:r in e[Jt]&&(n[r]=e[Jt][r]);return new this.constructor({...e,...n,...t})}get stats(){return this.internalState.stats}_initState(){this.internalState=new Kt({})}}ne.componentName="Component",ne.defaultProps={};class re extends Kt{constructor({attributeManager:t,layer:e}){super(e),this.attributeManager=t,this.model=null,this.needsRedraw=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}set layer(t){this.component=t}}var ie=n(9787);const oe=2**24-1,se=Object.freeze([]),ae=(0,xt.Z)((({oldViewport:t,viewport:e})=>t.equals(e)));let ue=new Uint8ClampedArray(0);const ce={data:{type:"data",value:se,async:!0},dataComparator:null,_dataDiff:{type:"function",value:t=>t&&t.__diff,compare:!1,optional:!0},dataTransform:{type:"function",value:null,compare:!1,optional:!0},onDataLoad:{type:"function",value:null,compare:!1,optional:!0},onError:{type:"function",value:null,compare:!1,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:s}=n.context;var a;(i=i||n.getLoadOptions(),r=r||n.props.loaders,o)&&(i={...i,fetch:{...null===(a=i)||void 0===a?void 0:a.fetch,signal:o}});let u=s.contains(t);return u||i||(s.add({resourceId:t,data:(0,ie.z)(t,r),persistent:!1}),u=!0),u?s.subscribe({resourceId:t,onChange:t=>n.internalState.reloadAsyncProp(e,t),consumerId:n.id,requestId:e}):(0,ie.z)(t,r,i)},compare:!1},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},onHover:{type:"function",value:null,compare:!1,optional:!0},onClick:{type:"function",value:null,compare:!1,optional:!0},onDragStart:{type:"function",value:null,compare:!1,optional:!0},onDrag:{type:"function",value:null,compare:!1,optional:!0},onDragEnd:{type:"function",value:null,compare:!1,optional:!0},coordinateSystem:r.Df.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,compare:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t],compare:!1},highlightedObjectIndex:-1,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class le extends ne{toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}raiseError(t,e){var n,r,i,o;(e&&(t.message="".concat(e,": ").concat(t.message)),null===(n=(r=this.props).onError)||void 0===n?void 0:n.call(r,t))||(null===(i=this.context)||void 0===i||null===(o=i.onError)||void 0===o||o.call(i,t,this))}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(t=!0){this.internalState&&(this.internalState.needsRedraw=t)}setNeedsUpdate(){this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams())}hasUniformTransition(){return this.internalState.uniformTransitions.active}get isLoaded(){return this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||(this.state.model?[this.state.model]:[]))}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}project(t){const{viewport:e}=this.context,n=Mt(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[r,i,o]=(0,St.aW)(n,e.pixelProjectionMatrix);return 2===t.length?[r,i]:[r,i,o]}unproject(t){const{viewport:e}=this.context;return e.unproject(t)}projectPosition(t){return Pt(t,{viewport:this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem})}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===r.Df.DEFAULT||t===r.Df.LNGLAT||t===r.Df.CARTESIAN}onHover(t,e){return!!this.props.onHover&&this.props.onHover(t,e)}onClick(t,e){return!!this.props.onClick&&this.props.onClick(t,e)}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){(0,d.Z)(t instanceof Uint8Array);const[e,n,r]=t;return e+256*n+65536*r-1}initializeState(){throw new Error("Layer ".concat(this," has not defined initializeState"))}getShaders(t){for(const e of this.props.extensions)t=wt(t,e.getShaders.call(this,e));return t}shouldUpdateState({oldProps:t,props:e,context:n,changeFlags:r}){return r.propsOrDataChanged}updateState({oldProps:t,props:e,context:n,changeFlags:r}){const i=this.getAttributeManager();if(r.dataChanged&&i){const{dataChanged:t}=r;if(Array.isArray(t))for(const e of t)i.invalidateAll(e);else i.invalidateAll()}const o=t.highlightedObjectIndex>=0||t.pickable,s=e.highlightedObjectIndex>=0||e.pickable;if(o!==s&&i){const{pickingColors:t,instancePickingColors:e}=i.attributes,n=t||e;n&&(s&&n.constant&&(n.constant=!1,i.invalidate(n.id)),n.value||s||(n.constant=!0,n.value=[0,0,0]))}}finalizeState(){for(const e of this.getModels())e.delete();const t=this.getAttributeManager();t&&t.finalize(),this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState.uniformTransitions.clear(),this.internalState.finalize()}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e}){const{index:n}=t;return n>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[n]),t}activateViewport(t){const e=this.internalState.viewport;this.internalState.viewport=t,e&&ae({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all",e=""){const n=this.getAttributeManager();n&&("all"===t?n.invalidateAll():n.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(t){const e=this.getAttributeManager();if(!e)return;const n=this.getNumInstances(t),r=this.getStartIndices(t);e.update({data:t.data,numInstances:n,startIndices:r,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this,ignoreUnknownAttributes:!0});const i=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(i)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(ue.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>oe&&l.Z.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),ue=u.Z.allocate(ue,e,{size:3,copy:!0,maxCount:Math.max(e,oe)});const t=Math.floor(ue.length/3),r=[];for(let e=n;e<t;e++)this.encodePickingColor(e,r),ue[3*e+0]=r[0],ue[3*e+1]=r[1],ue[3*e+2]=r[2]}t.value=ue.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),r=t.userData.excludeAttributes||{},i=n.getShaderAttributes(e,r);t.setAttributes(i)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n,i=r.getVertexOffset(t),o=r.getVertexOffset(t+1);r.buffer.subData({data:new Uint8Array(o-i),offset:i})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;this.internalState.usesPickingColorCache&&n.value.buffer!==ue.buffer&&(n.value=ue.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0})}getNumInstances(t){return void 0!==(t=t||this.props).numInstances?t.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:bt(t.data)}getStartIndices(t){return void 0!==(t=t||this.props).startIndices?t.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}_initialize(){(0,C.Z)("layer.initialize",this),this._initState(),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:!0,propsChanged:!0,viewportChanged:!0,extensionsChanged:!0}),this._updateState()}_update(){const t=this.needsUpdate();(0,C.Z)("layer.update",this,t),t&&this._updateState()}_updateState(){const t=this.props,e=this.context.viewport,n=this._updateUniformTransition();this.internalState.propsInTransition=n,this.context.viewport=this.internalState.viewport||e,this.props=n;try{const n=this._getUpdateParams(),i=this.getModels();if(this.context.gl)this.updateState(n);else try{this.updateState(n)}catch(r){}for(const t of this.props.extensions)t.updateState.call(this,n,t);const o=this.getModels()[0]!==i[0];this._updateModules(n,o),this.isComposite?this._renderLayers(n):(this.setNeedsRedraw(),this._updateAttributes(this.props),this.state.model&&this.state.model.setInstanceCount(this.getNumInstances()))}finally{this.context.viewport=e,this.props=t,this.clearChangeFlags(),this.internalState.needsUpdate=!1,this.internalState.resetOldProps()}}_finalize(){(0,C.Z)("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,t)}drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const r=this.props;this.props=this.internalState.propsInTransition||r;const{opacity:i}=this.props;e.opacity=Math.pow(i,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:i}=this.props,o=i&&i(e)||[0,0];(0,F.dR)(this.context.gl,{polygonOffset:o}),(0,F.s8)(this.context.gl,n,(()=>{const r={moduleParameters:t,uniforms:e,parameters:n,context:this.context};for(const t of this.props.extensions)t.draw.call(this,r,t);this.draw(r)}))}finally{this.props=r}}getChangeFlags(){return this.internalState.changeFlags}setChangeFlags(t){const{changeFlags:e}=this.internalState;for(const r in t)if(t[r]){let n=!1;switch(r){case"dataChanged":Array.isArray(e[r])&&(e[r]=Array.isArray(t[r])?e[r].concat(t[r]):t[r],n=!0);default:e[r]||(e[r]=t[r],n=!0)}n&&(0,C.Z)("layer.changeFlag",this,r,t)}const n=e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged;e.propsOrDataChanged=n,e.somethingChanged=n||t.viewportChanged||t.stateChanged}clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}diffProps(t,e){const n=ht(t,e);if(n.updateTriggersChanged)for(const r in n.updateTriggersChanged)n.updateTriggersChanged[r]&&this.invalidateAttribute(r);if(n.transitionsChanged)for(const r in n.transitionsChanged)this.internalState.uniformTransitions.add(r,e[r],t[r],t.transitions[r]);return this.setChangeFlags(n)}validateProps(){!function(t){const e=vt(t);for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}updateAutoHighlight(t){this.props.autoHighlight&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"===typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_updateModules({props:t,oldProps:e},n){const{autoHighlight:r,highlightedObjectIndex:i,highlightColor:o}=t;if(n||e.autoHighlight!==r||e.highlightedObjectIndex!==i||e.highlightColor!==o){const t={};r||(t.pickingSelectedColor=null),Array.isArray(o)&&(t.pickingHighlightColor=o),Number.isInteger(i)&&(t.pickingSelectedColor=i>=0?this.encodePickingColor(i):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id,this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags;const n=this.getAttributeManager(),r=n&&n.getNeedsRedraw(t);return e=e||r,e}_getAttributeManager(){return new et(this.context.gl,{id:this.props.id,stats:this.context.stats,timeline:this.context.timeline})}_initState(){(0,d.Z)(!this.internalState&&!this.state),(0,d.Z)(isFinite(this.props.coordinateSystem));const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new re({attributeManager:t,layer:this}),this.clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(l.Z.deprecated("layer.state.attributeManager","layer.getAttributeManager()"),t)}),this.internalState.layer=this,this.internalState.uniformTransitions=new ct(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props)}_transferState(t){(0,C.Z)("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.internalState.layer=this,this.state=e,this.internalState.setAsyncProps(this.props),this.diffProps(this.props,this.internalState.getOldProps()))}_onAsyncPropUpdated(){this.diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}le.layerName="Layer",le.defaultProps=ce},5409:function(t,e,n){"use strict";n.d(e,{d:function(){return r},A:function(){return i}});const r={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},i={COMPONENT:Symbol.for("component"),ASYNC_DEFAULTS:Symbol.for("asyncPropDefaults"),ASYNC_ORIGINAL:Symbol.for("asyncPropOriginal"),ASYNC_RESOLVED:Symbol.for("asyncPropResolved")}},9894:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});const r={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1};var i={inject:{"vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  // for picking depth values\n  picking_setPickingAttribute(geometry.position.z);\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...{name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(t=r){const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}}}},8020:function(t,e,n){"use strict";n.d(e,{Z:function(){return l}});const r={name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null};var i=n(4088);const o=Object.keys(i.Df).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(i.Df[t],";"))).join(""),s=Object.keys(i.zG).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(i.zG[t],";"))).join("");var a="".concat(o,"\n").concat(s,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z;\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy;\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter;\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  return normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size(position_world.z),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\n"),u=n(8771);const c={};var l={name:"project",dependencies:[r],vs:a,getUniforms:function(t=c){return t.viewport?(0,u.C)(t):{}}}},8771:function(t,e,n){"use strict";n.d(e,{v:function(){return d},C:function(){return p}});var r=n(5975),i=n(8333),o=n(4088),s=n(8177);const a=[0,0,0,0],u=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],l=[0,0,0],f=[0,0,0],h=(0,s.Z)((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:s}){const{projectionCenter:c,viewProjectionMatrix:f,originCommon:h,cameraPosCommon:p,shaderCoordinateOrigin:g,geospatialOrigin:m}=function(t,e,n){const{viewMatrixUncentered:o,projectionMatrix:s}=t;let{viewMatrix:c,viewProjectionMatrix:l}=t,f=a,h=a,p=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:m,offsetMode:y}=d(t,e,n);y&&(h=t.projectPosition(g||m),p=[p[0]-h[0],p[1]-h[1],p[2]-h[2]],h[3]=1,f=i.fF([],h,l),c=o||c,l=r.Jp([],s,c),l=r.Jp([],l,u));return{viewMatrix:c,viewProjectionMatrix:l,projectionCenter:f,originCommon:h,cameraPosCommon:p,shaderCoordinateOrigin:m,geospatialOrigin:g}}(t,n,s),y=t.getDistanceScales(),v=[t.width*e,t.height*e],b=t.projectionMatrix.transform([0,0,-t.focalDistance,1])[3]||1,x={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:g,project_uCommonOrigin:h.slice(0,3),project_uCenter:c,project_uViewportSize:v,project_uDevicePixelRatio:e,project_uFocalDistance:b,project_uCommonUnitsPerMeter:y.unitsPerMeter,project_uCommonUnitsPerWorldUnit:y.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:l,project_uScale:t.scale,project_uViewProjectionMatrix:f,project_uCameraPosition:p};if(m){const e=t.getDistanceScales(m);switch(n){case o.Df.METER_OFFSETS:x.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,x.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case o.Df.LNGLAT:case o.Df.LNGLAT_OFFSETS:x.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,x.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case o.Df.CARTESIAN:x.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],x.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return x}));function d(t,e,n=f){let r,i=n,s=!0;switch(r=e===o.Df.LNGLAT_OFFSETS||e===o.Df.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case o.zG.WEB_MERCATOR:e!==o.Df.LNGLAT&&e!==o.Df.CARTESIAN||(s=!1);break;case o.zG.WEB_MERCATOR_AUTO_OFFSET:e===o.Df.LNGLAT?i=r:e===o.Df.CARTESIAN&&(i=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],r=t.unprojectPosition(i),i[0]-=n[0],i[1]-=n[1],i[2]-=n[2]);break;case o.zG.IDENTITY:i=t.position.map(Math.fround);break;case o.zG.GLOBE:s=!1,r=null;break;default:s=!1}return i[2]=i[2]||0,{geospatialOrigin:r,shaderCoordinateOrigin:i,offsetMode:s}}function p({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=o.Df.DEFAULT,coordinateOrigin:i,autoWrapLongitude:s=!1}={}){r===o.Df.DEFAULT&&(r=t.isGeospatial?o.Df.LNGLAT:o.Df.CARTESIAN);const a=h({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return a.project_uWrapLongitude=s,a.project_uModelMatrix=n||c,a}},3844:function(t,e,n){"use strict";var r=n(8020);e.Z={name:"project32",dependencies:[r.Z],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    mat3 rotation = project_get_orientation_matrix(projectedPosition);\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"}},6507:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(4034),i=n(5304);class o{constructor(t={}){Array.isArray(t)&&(t={compare:t,extract:t,required:t});const{compare:e,extract:n,required:r}=t;this._propsToCompare=e,this._propsToExtract=n,this._requiredProps=r}arePropsEqual(t,e){for(const n of this._propsToCompare||Object.keys(e))if(!(n in t)||!(n in e)||!(0,r.fS)(t[n],e[n]))return!1;return!0}initializeProps(t,e){let n;if(this._propsToExtract){const r={},i={};for(const n of this._propsToExtract)r[n]=t[n],i[n]=e[n];n={start:r,end:i}}else n={start:t,end:e};return this._checkRequiredProps(n.start),this._checkRequiredProps(n.end),n}interpolateProps(t,e,n){return e}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];(0,i.Z)(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}},3630:function(t,e,n){"use strict";function r(){}n.d(e,{Z:function(){return o}});const i={onStart:r,onUpdate:r,onInterrupt:r,onEnd:r};class o{constructor(t){this._inProgress=!1,this._handle=null,this.timeline=t,this.settings={}}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings={...i,...t},this._inProgress=!0,this.settings.onStart(this)}end(){this._inProgress&&(this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd(this))}cancel(){this._inProgress&&(this.settings.onInterrupt(this),this.timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(null===this._handle){const{timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this.timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate(this),this.timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}},1979:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var r=n(6507),i=n(4034),o=n(7013);const s=["bearing","pitch"],a={speed:1.2,curve:1.414};class u extends r.Z{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),this.props={...a,...t}}interpolateProps(t,e,n){const r=(0,o.if)(t,e,n,this.props);for(const o of s)r[o]=(0,i.t7)(t[o]||0,e[o]||0,n);return r}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=(0,o.up)(t,e,this.props)),n}}},5304:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}n.d(e,{Z:function(){return r}})},6871:function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(!t||!e)return!1;for(const n in t){const i=t[n],o=e[n];if(!(i===o||Array.isArray(i)&&Array.isArray(o)&&r(i,o)))return!1}return!0}n.d(e,{v:function(){return r}})},1855:function(t,e,n){"use strict";function r(t,e=(()=>!0)){return Array.isArray(t)?i(t,e,[]):e(t)?[t]:[]}function i(t,e,n){let r=-1;for(;++r<t.length;){const o=t[r];Array.isArray(o)?i(o,e,n):e(o)&&n.push(o)}return n}function o({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let a=n;s<i;s++)t[a++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}n.d(e,{x:function(){return r},k:function(){return o}})},8550:function(t,e,n){"use strict";n.d(e,{jB:function(){return o},D0:function(){return s},jr:function(){return a}});const r=[],i=[];function o(t,e=0,n=1/0){let o=r;const s={index:-1,data:t,target:[]};return t?"function"===typeof t[Symbol.iterator]?o=t:t.length>0&&(i.length=t.length,o=i):o=r,(e>0||Number.isFinite(n))&&(o=(Array.isArray(o)?o:Array.from(o)).slice(e,n),s.index=e-1),{iterable:o,objectInfo:s}}function s(t){return t&&t[Symbol.asyncIterator]}function a(t,{size:e,stride:n,offset:r,startIndices:i,nested:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:e,u=r?r/s:0,c=Math.floor((t.length-u)/a);return(n,{index:r,target:s})=>{if(!i){const n=r*a+u;for(let r=0;r<e;r++)s[r]=t[n+r];return s}const l=i[r],f=i[r+1]||c;let h;if(o){h=new Array(f-l);for(let n=l;n<f;n++){const r=n*a+u;s=new Array(e);for(let n=0;n<e;n++)s[n]=t[r+n];h[n-l]=s}}else if(a===e)h=t.subarray(l*e+u,f*e+u);else{h=new t.constructor((f-l)*e);let n=0;for(let r=l;r<f;r++){const i=r*a+u;for(let r=0;r<e;r++)h[n++]=t[i+r]}}return h}}},744:function(t,e,n){"use strict";var r=n(4708);e.Z=new r.Z({id:"deck"})},5126:function(t,e,n){"use strict";n.d(e,{bS:function(){return o},wQ:function(){return s},Xt:function(){return a},Du:function(){return u},TK:function(){return h}});var r=n(6610),i=n(1681);function o(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function s(t,e){const n=t%e;return n<0?e+n:n}function a(t){return[t[12],t[13],t[14]]}function u(t){const e={};return e.left=l(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),e.right=l(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),e.bottom=l(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),e.top=l(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),e.near=l(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),e.far=l(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14]),e}const c=new i.Z;function l(t,e,n,r){c.set(t,e,n);const o=c.len();return{distance:r/o,normal:new i.Z(-t/o,-e/o,-n/o)}}let f;function h(t,{size:e=1,startIndex:n=0,endIndex:i}){Number.isFinite(i)||(i=t.length);const o=(i-n)/e;f=r.Z.allocate(f,o,{type:Float32Array,size:2*e});let s=n,a=0;for(;s<i;){for(let n=0;n<e;n++){const r=t[s++];f[a+n]=r,f[a+n+e]=(u=r)-Math.fround(u)}a+=2*e}var u;return f.subarray(0,o*e*2)}},8177:function(t,e,n){"use strict";function r(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function i(t){let e,n={};return i=>{for(const o in i)if(!r(i[o],n[o])){e=t(i),n=i;break}return e}}n.d(e,{Z:function(){return i}})},6610:function(t,e,n){"use strict";e.Z=new class{constructor(t){this._pool=[],this.props={overAlloc:2,poolSize:100},this.setProps(t)}setProps(t){Object.assign(this.props,t)}allocate(t,e,{size:n=1,type:r,padding:i=0,copy:o=!1,initialize:s=!1,maxCount:a}){const u=r||t&&t.constructor||Float32Array,c=e*n+i;if(ArrayBuffer.isView(t)){if(c<=t.length)return t;if(c*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new u(t.buffer,0,c)}let l;a&&(l=a*n+i);const f=this._allocate(u,c,s,l);return t&&o?f.set(t):s||f.fill(0,0,4),this._release(t),f}release(t){this._release(t)}_allocate(t,e,n,r){let i=Math.max(Math.ceil(e*this.props.overAlloc),1);i>r&&(i=r);const o=this._pool,s=t.BYTES_PER_ELEMENT*i,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,i);return n&&e.fill(0),e}return new t(i)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:r}=n,i=e.findIndex((t=>t.byteLength>=r));i<0?e.push(n):(i>0||e.length<this.props.poolSize)&&e.splice(i,0,n),e.length>this.props.poolSize&&e.shift()}}},9225:function(t,e,n){"use strict";n.d(e,{Z:function(){return g}});var r=n(744),i=n(5126),o=n(4034),s=n(5451),a=n(1681),u=n(5975),c=n(7013),l=n(4088);const f=Math.PI/180,h=(0,i.bS)(),d=[0,0,0],p={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class g{constructor(t={}){const{id:e=null,x:n=0,y:r=0,width:i=1,height:o=1}=t;this.id=e||this.constructor.displayName||"viewport",this.x=n,this.y=r,this.width=i||1,this.height=o||1,this._frustumPlanes={},this._initViewMatrix(t),this._initProjectionMatrix(t),this._initPixelMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?l.zG.WEB_MERCATOR:l.zG.WEB_MERCATOR_AUTO_OFFSET:l.zG.IDENTITY}equals(t){return t instanceof g&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&(0,o.fS)(t.projectionMatrix,this.projectionMatrix)&&(0,o.fS)(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=this.projectPosition(t),r=(0,c.aW)(n,this.pixelProjectionMatrix),[i,o]=r,s=e?o:this.height-o;return 2===t.length?[i,s]:[i,s,r[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],u=(0,c.CT)([r,s,o],this.pixelUnprojectionMatrix,a),[l,f,h]=this.unprojectPosition(u);return Number.isFinite(o)?[l,f,h]:Number.isFinite(n)?[l,f,n]:[l,f]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return this.isGeospatial?(0,c.w5)(t):t}unprojectFlat(t){return this.isGeospatial?(0,c.es)(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),r=this.unproject([this.width,0],e),i=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}getDistanceScales(t=null){return t?(0,c.ro)({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:r=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+r}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,(0,i.Du)(this.viewProjectionMatrix)),this._frustumPlanes}panByPosition(t,e){return null}getCameraPosition(){return this.cameraPosition}getCameraDirection(){return this.cameraDirection}getCameraUp(){return this.cameraUp}_createProjectionMatrix({orthographic:t,fovyRadians:e,aspect:n,focalDistance:r,near:i,far:o}){return t?(new s.Z).orthographic({fovy:e,aspect:n,focalDistance:r,near:i,far:o}):(new s.Z).perspective({fovy:e,aspect:n,near:i,far:o})}_initViewMatrix(t){const{viewMatrix:e=h,longitude:n=null,latitude:r=null,zoom:i=null,position:o=null,modelMatrix:u=null,focalDistance:l=1,distanceScales:f=null}=t;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this.zoom=i,Number.isFinite(this.zoom)||(this.zoom=this.isGeospatial?(0,c.Bf)({latitude:r})+Math.log2(l):0);const g=Math.pow(2,this.zoom);this.scale=g,this.distanceScales=this.isGeospatial?(0,c.ro)({latitude:r,longitude:n}):f||p,this.focalDistance=l,this.distanceScales.metersPerUnit=new a.Z(this.distanceScales.metersPerUnit),this.distanceScales.unitsPerMeter=new a.Z(this.distanceScales.unitsPerMeter),this.position=d,this.meterOffset=d,o&&(this.position=o,this.modelMatrix=u,this.meterOffset=u?u.transformVector(o):o),this.isGeospatial?(this.longitude=n,this.latitude=r,this.center=this._getCenterInWorld({longitude:n,latitude:r})):this.center=o?this.projectPosition(o):[0,0,0],this.viewMatrixUncentered=e,this.viewMatrix=(new s.Z).multiplyRight(this.viewMatrixUncentered).translate(new a.Z(this.center||d).negate())}_getCenterInWorld({longitude:t,latitude:e}){const{meterOffset:n,distanceScales:r}=this,i=new a.Z(this.projectPosition([t,e,0]));if(n){const t=new a.Z(n).scale(r.unitsPerMeter);i.add(t)}return i}_initProjectionMatrix(t){const{projectionMatrix:e=null,orthographic:n=!1,fovyRadians:r,fovy:i=75,near:o=.1,far:s=1e3,focalDistance:a=1}=t;this.projectionMatrix=e||this._createProjectionMatrix({orthographic:n,fovyRadians:r||i*f,aspect:this.width/this.height,focalDistance:a,near:o,far:s})}_initPixelMatrices(){const t=(0,i.bS)();u.Jp(t,t,this.projectionMatrix),u.Jp(t,t,this.viewMatrix),this.viewProjectionMatrix=t,this.viewMatrixInverse=u.U_([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=(0,i.Xt)(this.viewMatrixInverse);const e=(0,i.bS)(),n=(0,i.bS)();u.bA(e,e,[this.width/2,-this.height/2,1]),u.Iu(e,e,[1,-1,0]),u.Jp(n,e,this.viewProjectionMatrix),this.pixelProjectionMatrix=n,this.viewportMatrix=e,this.pixelUnprojectionMatrix=u.U_((0,i.bS)(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||r.Z.warn("Pixel project matrix not invertible")()}}g.displayName="Viewport"},6935:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(9225),i=n(7013),o=n(1437),s=n(5451);class a extends r.Z{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:r=11,pitch:o=0,bearing:a=0,nearZMultiplier:u=.1,farZMultiplier:c=1.01,orthographic:l=!1,repeat:f=!1,worldOffset:h=0}=t;let{width:d,height:p,altitude:g=1.5}=t;const m=Math.pow(2,r);d=d||1,p=p||1,g=Math.max(.75,g);const{fov:y,aspect:v,focalDistance:b,near:x,far:w}=(0,i.wl)({width:d,height:p,pitch:o,altitude:g,nearZMultiplier:u,farZMultiplier:c});let _=(0,i.lf)({height:p,pitch:o,bearing:a,scale:m,altitude:g});if(h){_=(new s.Z).translate([512*h,0,0]).multiplyLeft(_)}super({...t,width:d,height:p,viewMatrix:_,longitude:n,latitude:e,zoom:r,orthographic:l,fovyRadians:y,aspect:v,focalDistance:b,near:x,far:w}),this.latitude=e,this.longitude=n,this.zoom=r,this.pitch=o,this.bearing=a,this.altitude=g,this.orthographic=l,this._subViewports=f?[]:null,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let r=e;r<=n;r++){const t=r?new a({...this,worldOffset:r}):this;this._subViewports.push(t)}}return this._subViewports}addMetersToLngLat(t,e){return(0,i.eG)(t,e)}panByPosition(t,e){const n=(0,i.CT)(e,this.pixelUnprojectionMatrix),r=this.projectFlat(t),s=o.IH([],r,o.tk([],n)),a=o.IH([],this.center,s),[u,c]=this.unprojectFlat(a);return{longitude:u,latitude:c}}getBounds(t={}){const e=(0,i.zX)(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:o,latitude:s,zoom:u}=(0,i.Xg)({width:n,height:r,bounds:t,...e});return new a({width:n,height:r,longitude:o,latitude:s,zoom:u})}}a.displayName="WebMercatorViewport"},8842:function(t,e,n){"use strict";n.d(e,{Z:function(){return A}});var r=n(4897),i=n(9225),o=n(5451),s=n(7013),a=n(4034),u=n(1836),c=n(6442),l=n(5126);const f=0,h=0,d=0,p=[0,0,0],g=-90,m=90,y=-1/0,v=1/0;class b extends c.Z{constructor({makeViewport:t,width:e,height:n,rotationX:r=f,rotationOrbit:i=h,target:o=p,zoom:s=d,minRotationX:a=g,maxRotationX:u=m,minZoom:c=y,maxZoom:l=v,startPanPosition:b,startRotatePos:x,startRotationX:w,startRotationOrbit:_,startZoomPosition:E,startZoom:A}){super({width:e,height:n,rotationX:r,rotationOrbit:i,target:o,zoom:s,minRotationX:a,maxRotationX:u,minZoom:c,maxZoom:l}),this._state={startPanPosition:b,startRotatePos:x,startRotationX:w,startRotationOrbit:_,startZoomPosition:E,startZoom:A},this.makeViewport=t}panStart({pos:t}){return this._getUpdatedState({startPanPosition:this._unproject(t)})}pan({pos:t,startPosition:e}){const n=this._state.startPanPosition||e;if(!n)return this;const r=this.makeViewport(this._viewportProps).panByPosition(n,t);return this._getUpdatedState(r)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startRotationX:this._viewportProps.rotationX,startRotationOrbit:this._viewportProps.rotationOrbit})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:r,startRotationX:i,startRotationOrbit:o}=this._state,{width:s,height:a}=this._viewportProps;if(!r||!Number.isFinite(i)||!Number.isFinite(o))return this;let u;if(t){let e=(t[0]-r[0])/s;const n=(t[1]-r[1])/a;(i<-90||i>90)&&(e*=-1),u={rotationX:i+180*n,rotationOrbit:o+180*e}}else u={rotationX:i+n,rotationOrbit:o+e};return this._getUpdatedState(u)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this._viewportProps},{rotationOrbit:r}=n;return Math.abs(r-e.rotationOrbit)>180&&(n.rotationOrbit=r<0?r+360:r-360),n}zoomStart({pos:t}){return this._getUpdatedState({startZoomPosition:this._unproject(t),startZoom:this._viewportProps.zoom})}zoom({pos:t,startPos:e,scale:n}){const{zoom:r}=this._viewportProps;let{startZoom:i,startZoomPosition:o}=this._state;Number.isFinite(i)||(i=r,o=this._unproject(e)||this._unproject(t));const s=this._calculateNewZoom({scale:n,startZoom:i}),a=this.makeViewport({...this._viewportProps,zoom:s});return this._getUpdatedState({zoom:s,...a.panByPosition(o,t)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:t})})}zoomOut(t=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/t})})}moveLeft(t=50){return this._panFromCenter([-t,0])}moveRight(t=50){return this._panFromCenter([t,0])}moveUp(t=50){return this._panFromCenter([0,-t])}moveDown(t=50){return this._panFromCenter([0,t])}rotateLeft(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit-t})}rotateRight(t=15){return this._getUpdatedState({rotationOrbit:this._viewportProps.rotationOrbit+t})}rotateUp(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX-t})}rotateDown(t=10){return this._getUpdatedState({rotationX:this._viewportProps.rotationX+t})}_unproject(t){const e=this.makeViewport(this._viewportProps);return t&&e.unproject(t)}_calculateNewZoom({scale:t,startZoom:e}){const{maxZoom:n,minZoom:r}=this._viewportProps;Number.isFinite(e)||(e=this._viewportProps.zoom);const i=e+Math.log2(t);return(0,a.uZ)(i,r,n)}_panFromCenter(t){const{width:e,height:n,target:r}=this._viewportProps;return this.pan({startPosition:r,pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new b({...this._viewportProps,...this._state,...t})}_applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:r,maxRotationX:i,minRotationX:o,rotationOrbit:s}=t;return t.zoom=(0,a.uZ)(r,n,e),t.rotationX=(0,a.uZ)(t.rotationX,o,i),(s<-180||s>180)&&(t.rotationOrbit=(0,l.wQ)(s+180,360)-180),t}}class x extends u.Z{constructor(t){super(b,t)}get linearTransitionProps(){return["target","zoom","rotationX","rotationOrbit"]}}const w=Math.PI/180;function _({height:t,fovy:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:s}){const a=.5/Math.tan(e*w/2),u="Z"===n?[0,0,1]:[0,1,0],c="Z"===n?[0,-a,0]:[0,0,a],l=(new o.Z).lookAt({eye:c,up:u});l.rotateX(r*w),"Z"===n?l.rotateZ(i*w):l.rotateY(i*w);const f=Math.pow(2,s)/(t||1);return l.scale(f),l}class E extends i.Z{constructor(t){const{height:e,fovy:n,orbitAxis:r,target:i=[0,0,0],rotationX:o=0,rotationOrbit:s=0,zoom:a=0}=t;super({...t,longitude:null,viewMatrix:_({height:e,fovy:n,orbitAxis:r,rotationX:o,rotationOrbit:s,zoom:a}),fovy:n,position:i,zoom:a}),this.projectedCenter=this.project(this.center)}unproject(t,{topLeft:e=!0}={}){const[n,r,i=this.projectedCenter[2]]=t,o=e?r:this.height-r,[a,u,c]=(0,s.CT)([n,o,i],this.pixelUnprojectionMatrix);return[a,u,c]}panByPosition(t,e){const n=this.project(t),r=[this.width/2+n[0]-e[0],this.height/2+n[1]-e[1],this.projectedCenter[2]];return{target:this.unproject(r)}}}class A extends r.Z{constructor(t={}){const{orbitAxis:e="Z"}=t;super({...t,orbitAxis:e,type:E})}get controller(){return this._getControllerProps({type:x})}}A.displayName="OrbitView"},4897:function(t,e,n){"use strict";n.d(e,{Z:function(){return c}});var r=n(9225);const i=/([0-9]+\.?[0-9]*)(%|px)/;function o(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=t.match(i);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function s(t,e){return t.relative?Math.round(t.position*e):t.position}var a=n(6871),u=n(5304);class c{constructor(t={}){const{id:e=null,x:n=0,y:i=0,width:o="100%",height:s="100%",projectionMatrix:a=null,fovy:c=50,near:l=.1,far:f=1e3,modelMatrix:h=null,viewportInstance:d=null,type:p=r.Z}=t;(0,u.Z)(!d||d instanceof r.Z),this.viewportInstance=d,this.id=e||this.constructor.displayName||"view",this.type=p,this.props={...t,id:this.id,projectionMatrix:a,fovy:c,near:l,far:f,modelMatrix:h},this._parseDimensions({x:n,y:i,width:o,height:s}),this.equals=this.equals.bind(this),Object.seal(this)}equals(t){if(this===t)return!0;if(this.viewportInstance)return t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance);return(0,a.v)(this.props,t.props)}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const r=this.getDimensions({width:t,height:e});return this._getViewport(n,r)}getViewStateId(){switch(typeof this.props.viewState){case"string":return this.props.viewState;case"object":return this.props.viewState&&this.props.viewState.id;default:return this.id}}filterViewState(t){if(this.props.viewState&&"object"===typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){return{x:s(this._x,t),y:s(this._y,e),width:s(this._width,t),height:s(this._height,e)}}_getControllerProps(t){let e=this.props.controller;return e?!0===e?t:("function"===typeof e&&(e={type:e}),{...t,...e}):null}_getViewport(t,e){const{type:n}=this;return new n({...t,...this.props,...e})}_parseDimensions({x:t,y:e,width:n,height:r}){this._x=o(t),this._y=o(e),this._width=o(n),this._height=o(r)}}},4441:function(t,e,n){"use strict";n.d(e,{Z:function(){return An}});var r=n(744),i=n(5451);class o{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(t,e,n,r,i){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,t.readFields(a,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,r=0,i=0,o=0;const s=[];let a;for(;t.pos<e;){if(r<=0){const e=t.readVarint();n=7&e,r=e>>3}if(r--,1===n||2===n)i+=t.readSVarint(),o+=t.readSVarint(),1===n&&(a&&s.push(a),a=[]),a.push([i,o]);else{if(7!==n)throw new Error(`unknown command ${n}`);a&&a.push(a[0].slice())}}return a&&s.push(a),s}bbox(){const t=this._pbf;t.pos=this._geometry;const e=t.readVarint()+t.pos;let n=1,r=0,i=0,o=0,s=1/0,a=-1/0,u=1/0,c=-1/0;for(;t.pos<e;){if(r<=0){const e=t.readVarint();n=7&e,r=e>>3}if(r--,1===n||2===n)i+=t.readSVarint(),o+=t.readSVarint(),i<s&&(s=i),i>a&&(a=i),o<u&&(u=o),o>c&&(c=o);else if(7!==n)throw new Error(`unknown command ${n}`)}return[s,u,a,c]}_toGeoJSON(t){let e,n,r=this.loadGeometry(),i=o.types[this.type];switch(this.type){case 1:var a=[];for(e=0;e<r.length;e++)a[e]=r[e][0];r=a,t(r,this);break;case 2:for(e=0;e<r.length;e++)t(r[e],this);break;case 3:for(r=function(t){const e=t.length;if(e<=1)return[t];const n=[];let r,i;for(let o=0;o<e;o++){const e=s(t[o]);0!==e&&(void 0===i&&(i=e<0),i===e<0?(r&&n.push(r),r=[t[o]]):r.push(t[o]))}r&&n.push(r);return n}(r),e=0;e<r.length;e++)for(n=0;n<r[e].length;n++)t(r[e][n],this)}1===r.length?r=r[0]:i=`Multi${i}`;const u={type:"Feature",geometry:{type:i,coordinates:r},properties:this.properties};return null!==this.id&&(u.id=this.id),u}toGeoJSON(t){if("function"===typeof t)return this._toGeoJSON(t);const{x:e,y:n,z:r}=t,i=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*n;return this._toGeoJSON((function(t){for(let e=0;e<t.length;e++){const n=t[e];n[0]=360*(n[0]+o)/i-180;const r=180-360*(n[1]+s)/i;n[1]=360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}}))}}function s(t){let e=0;for(let n,r,i=0,o=t.length-1;i<t.length;o=i++)n=t[i],r=t[o],e+=(r[0]-n[0])*(n[1]+r[1]);return e}function a(t,e,n){1===t?e.id=n.readVarint():2===t?function(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos)}class u{constructor(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(c,this,e),this.length=this._features.length}feature(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const e=this._pbf.readVarint()+this._pbf.pos;return new o(this._pbf,e,this.extent,this._keys,this._values)}}function c(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(n))}class l{constructor(t,e){this.layers=t.readFields(f,{},e)}}function f(t,e,n){if(3===t){const t=new u(n,n.readVarint()+n.pos);t.length&&(e[t.name]=t)}}var h=n(5215);let d,p,g,m,y,v,b;class x{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(t,e,n,r,i,o){this.properties={},this.extent=n,this.type=0,this.id=null,this._pbf=t,this._geometry=-1,this._keys=r,this._values=i,this._firstPassData=o,t.readFields(_,this,e)}loadGeometry(){const t=this._pbf;t.pos=this._geometry,d=t.readVarint()+t.pos,p=1,m=0,y=0,v=0,b=0;const e=[],n=[];for(;t.pos<d;)if(m<=0&&(g=t.readVarint(),p=7&g,m=g>>3),m--,1===p||2===p)y+=t.readSVarint(),v+=t.readSVarint(),1===p&&e.push(b),n.push(y,v),b+=2;else{if(7!==p)throw new Error(`unknown command ${p}`);if(b>0){const t=e[e.length-1];n.push(n[t],n[t+1]),b+=2}}return{data:n,lines:e}}_toBinaryCoordinates(t){let e=this.loadGeometry();t(e.data,this);switch(this.type){case 1:this._firstPassData.pointFeaturesCount++,this._firstPassData.pointPositionsCount+=e.lines.length;break;case 2:this._firstPassData.lineFeaturesCount++,this._firstPassData.linePathsCount+=e.lines.length,this._firstPassData.linePositionsCount+=e.data.length/2;break;case 3:const t=w(e);this._firstPassData.polygonFeaturesCount++,this._firstPassData.polygonObjectsCount+=t.lines.length;for(const e of t.lines)this._firstPassData.polygonRingsCount+=e.length;this._firstPassData.polygonPositionsCount+=t.data.length/2,e=t}e.type=x.types[this.type],e.lines.length>1&&(e.type=`Multi${e.type}`);const n={type:"Feature",geometry:e,properties:this.properties};return null!==this.id&&(n.id=this.id),n}toBinaryCoordinates(t){if("function"===typeof t)return this._toBinaryCoordinates(t);const{x:e,y:n,z:r}=t,i=this.extent*Math.pow(2,r),o=this.extent*e,s=this.extent*n;return this._toBinaryCoordinates((function(t){for(let e=0,n=t.length;e<n;e+=2){t[e]=360*(t[e]+o)/i-180;const n=180-360*(t[e+1]+s)/i;t[e+1]=360/Math.PI*Math.atan(Math.exp(n*Math.PI/180))-90}}))}}function w(t){const e=t.lines.length;if(e<=1)return{data:t.data,areas:[[(0,h.ap)(t.data)]],lines:[t.lines]};const n=[],r=[];let i,o,s,a=0;for(let u,c,l=0;l<e;l++){u=t.lines[l]-a,c=t.lines[l+1]-a||t.data.length;const e=t.data.slice(u,c),f=(0,h.ap)(e);if(0!==f)void 0===s&&(s=f<0),s===f<0?(o&&(n.push(i),r.push(o)),o=[u],i=[f]):(i.push(f),o.push(u));else{const e=t.data.slice(0,u),n=t.data.slice(c);t.data=e.concat(n),a+=c-u}}return i&&n.push(i),o&&r.push(o),{areas:n,lines:r,data:t.data}}function _(t,e,n){1===t?e.id=n.readVarint():2===t?function(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=e._keys[t.readVarint()],r=e._values[t.readVarint()];e.properties[n]=r}}(n,e):3===t?e.type=n.readVarint():4===t&&(e._geometry=n.pos)}class E{constructor(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(A,this,e),this.length=this._features.length}feature(t,e){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];const n=this._pbf.readVarint()+this._pbf.pos;return new x(this._pbf,n,this.extent,this._keys,this._values,e)}}function A(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const n=t.readVarint()>>3;e=1===n?t.readString():2===n?t.readFloat():3===n?t.readDouble():4===n?t.readVarint64():5===n?t.readVarint():6===n?t.readSVarint():7===n?t.readBoolean():null}return e}(n))}class O{constructor(t,e){this.layers=t.readFields(S,{},e)}}function S(t,e,n){if(3===t){const t=new E(n,n.readVarint()+n.pos);t.length&&(e[t.name]=t)}}function C(t){const e={};for(const n of t)if(n.properties)for(const t in n.properties){const r=e[t];if(r||void 0===r){const r=n.properties[t];e[t]=L(r)}}return Object.keys(e).filter((t=>e[t]))}function M(t,e={},n={}){const{pointPositionsCount:r,pointFeaturesCount:i,linePositionsCount:o,linePathsCount:s,lineFeaturesCount:a,polygonPositionsCount:u,polygonObjectsCount:c,polygonRingsCount:l,polygonFeaturesCount:f}=e,{numericPropKeys:h,PositionDataType:d=Float32Array}=n,p=t[0]&&"id"in t[0],g=t.length>65535?Uint32Array:Uint16Array,m={positions:new d(2*r),globalFeatureIds:new g(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},y={pathIndices:o>65535?new Uint32Array(s+1):new Uint16Array(s+1),positions:new d(2*o),globalFeatureIds:new g(o),featureIds:a>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[],fields:[]},v={polygonIndices:u>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:u>65535?new Uint32Array(l+1):new Uint16Array(l+1),positions:new d(2*u),triangles:[],globalFeatureIds:new g(u),featureIds:f>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[],fields:[]};for(const x of[m,y,v])for(const t of h)x.numericProps[t]=new Float32Array(x.positions.length/2);y.pathIndices[s]=o,v.polygonIndices[c]=u,v.primitivePolygonIndices[l]=u;const b={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const x of t){const t=x.geometry,e=x.properties||{};switch(t.type){case"Point":case"MultiPoint":P(t,m,b,2,e),m.properties.push(j(e,h)),p&&m.fields.push({id:x.id}),b.pointFeature++;break;case"LineString":case"MultiLineString":k(t,y,b,2,e),y.properties.push(j(e,h)),p&&y.fields.push({id:x.id}),b.lineFeature++;break;case"Polygon":case"MultiPolygon":T(t,v,b,2,e),v.properties.push(j(e,h)),p&&v.fields.push({id:x.id}),b.polygonFeature++;break;default:throw new Error("Invalid geometry type")}b.feature++}return function(t,e,n,r){const i={points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1}},lines:{...e,pathIndices:{value:e.pathIndices,size:1},positions:{value:e.positions,size:r},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1}},polygons:{...n,polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},positions:{value:n.positions,size:r},triangles:{value:new Uint32Array(n.triangles),size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1}}};for(const o in i)for(const t in i[o].numericProps)i[o].numericProps[t]={value:i[o].numericProps[t],size:1};return i}(m,y,v,2)}function P(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);const o=t.data.length/r;F(e,i,n.pointPosition,o),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+o),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+o),n.pointPosition+=o}function k(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);const o=t.data.length/r;F(e,i,n.linePosition,o),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+o),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+o);for(let s=0,a=t.lines.length;s<a;++s){const i=t.lines[s],o=s===a-1?t.data.length:t.lines[s+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(o-i)/r}}function T(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);const o=t.data.length/r;F(e,i,n.polygonPosition,o),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+o),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+o);for(let s=0,a=t.lines.length;s<a;++s){const i=n.polygonPosition;e.polygonIndices[n.polygonObject++]=i;const o=t.areas[s],a=t.lines[s],u=t.lines[s+1];for(let s=0,c=a.length;s<c;++s){const i=a[s],o=s===c-1?void 0===u?t.data.length:u[0]:a[s+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(o-i)/r}D(e,o,a,{startPosition:i,endPosition:n.polygonPosition,coordLength:r})}}function D(t,e,n,{startPosition:r,endPosition:i,coordLength:o}){const s=r*o,a=i*o,u=t.positions.subarray(s,a),c=n[0],l=n.slice(1).map((t=>(t-c)/o)),f=(0,h.OT)(u,l,o,e);for(let h=0,d=f.length;h<d;++h)t.triangles.push(r+f[h])}function F(t,e,n,r){for(const i in t.numericProps)i in e&&t.numericProps[i].fill(e[i],n,n+r)}function j(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}function L(t){return Number.isFinite(t)}var R=n(3614),I=n.n(R);function N(t,e){const n="binary"===(e=function(t){const e="wgs84"===(t={...t,mvt:t.mvt||{},gis:t.gis||{}}).coordinates,{tileIndex:n}=t,r=n&&Number.isFinite(n.x)&&Number.isFinite(n.y)&&Number.isFinite(n.z);if(e&&!r)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property. Check documentation.");return t}(e)).gis.format,r=[],i={pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength>0){const o=n?new O(new(I())(t)):new l(new(I())(t)),s=e.mvt;(Array.isArray(s.layers)?s.layers:Object.keys(o.layers)).forEach((t=>{const e=o.layers[t],a={...s,layerName:t};if(e)for(let o=0;o<e.length;o++){const t=e.feature(o,i),s=n?z(t,a):B(t,a);r.push(s)}}))}if(n){const n=function(t,e,n={}){return M(t,e,{numericPropKeys:n.numericPropKeys||C(t),PositionDataType:n.PositionDataType||Float32Array})}(r,i,e.gis);return n.byteLength=t.byteLength,n}return r}function B(t,e={}){const n=t.toGeoJSON("wgs84"===e.coordinates?e.tileIndex:$);return e.layerProperty&&(n.properties[e.layerProperty]=e.layerName),n}function z(t,e={}){const n=t.toBinaryCoordinates("wgs84"===e.coordinates?e.tileIndex:U);return e.layerProperty&&(n.properties[e.layerProperty]=e.layerName),n}function $(t,e){const{extent:n}=e;for(let r=0;r<t.length;r++){const e=t[r];e[0]/=n,e[1]/=n}}function U(t,e){const{extent:n}=e;for(let r=0,i=t.length;r<i;++r)t[r]/=n}const V={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:"3.0.12",extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:{mvt:{coordinates:"local",layerProperty:"layerName",layers:null,tileIndex:null}}};function Z(t,e){const n=null===e||void 0===e?void 0:e.globalFeatureId;return void 0!==n?function(t,e){const n=G(t);for(const r of n){let t=0,n=r.featureIds.value[0];for(let i=0;i<r.featureIds.value.length;i++){const o=r.featureIds.value[i];if(o!==n){if(e===r.globalFeatureIds.value[t])return H(r,t,i);t=i,n=o}}if(e===r.globalFeatureIds.value[t])return H(r,t,r.featureIds.value.length)}throw new Error(`featureId:${e} not found`)}(t,n):W(t,null===e||void 0===e?void 0:e.type)}function W(t,e){return function(t){const e=[];for(const n of t){if(0===n.featureIds.value.length)continue;let t=0,r=n.featureIds.value[0];for(let i=0;i<n.featureIds.value.length;i++){const o=n.featureIds.value[i];o!==r&&(e.push(H(n,t,i)),t=i,r=o)}e.push(H(n,t,n.featureIds.value.length))}return e}(G(t,e))}function q(t,e,n){switch(t.type){case"Point":return function(t,e,n){const{positions:r}=t,i=Y(r,e,n);if(i.length>1)return{type:"MultiPoint",coordinates:i};return{type:"Point",coordinates:i[0]}}(t,e,n);case"LineString":return function(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.pathIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2)){return{type:"LineString",coordinates:Y(r,i[0],i[1])}}const o=[];for(let s=0;s<i.length-1;s++){const t=Y(r,i[s],i[s+1]);o.push(t)}return{type:"MultiLineString",coordinates:o}}(t,e,n);case"Polygon":return X(t,e,n);default:const r=t;throw new Error(`Unsupported geometry type: ${null===r||void 0===r?void 0:r.type}`)}}function G(t,e){if(!Boolean(t.points||t.lines||t.polygons))return t.type=e||function(t){if(t.pathIndices)return"LineString";if(t.polygonIndices)return"Polygon";return"Point"}(t),[t];const n=[];return t.points&&(t.points.type="Point",n.push(t.points)),t.lines&&(t.lines.type="LineString",n.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",n.push(t.polygons)),n}function H(t,e,n){return{type:"Feature",geometry:q(t,e,n),properties:function(t,e=0,n){const r=Object.assign({},t.properties[t.featureIds.value[e]]);for(const i in t.numericProps)r[i]=t.numericProps[i].value[e];return r}(t,e),...function(t,e=0,n){return t.fields&&t.fields[t.featureIds.value[e]]}(t,e)}}function X(t,e=-1/0,n=1/0){const{positions:r}=t,i=t.polygonIndices.value.filter((t=>t>=e&&t<=n)),o=t.primitivePolygonIndices.value.filter((t=>t>=e&&t<=n));if(!(i.length>2)){const t=[];for(let e=0;e<o.length-1;e++){const n=Y(r,o[e],o[e+1]);t.push(n)}return{type:"Polygon",coordinates:t}}const s=[];for(let a=0;a<i.length-1;a++){const e=X(t,i[a],i[a+1]).coordinates;s.push(e)}return{type:"MultiPolygon",coordinates:s}}function Y(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const e=Array();for(let n=i*t.size;n<(i+1)*t.size;n++)e.push(Number(t.value[n]));r.push(e)}return r}var K=n(4088),J=n(6871);const Q={clipBounds:[0,0,1,1]},tt="\nuniform vec4 clip_bounds;\n\nbool clip_isInBounds(vec2 position) {\n  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];\n}\n",et={name:"clip-vs",vs:tt},nt={"vs:#decl":"\nvarying float clip_isVisible;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));\n","fs:#decl":"\nvarying float clip_isVisible;\n","fs:DECKGL_FILTER_COLOR":"\n  if (clip_isVisible < 0.5) discard;\n"},rt={name:"clip-fs",fs:tt},it={"vs:#decl":"\nvarying vec2 clip_commonPosition;\n","vs:DECKGL_FILTER_GL_POSITION":"\n  clip_commonPosition = geometry.position.xy;\n","fs:#decl":"\nvarying vec2 clip_commonPosition;\n","fs:DECKGL_FILTER_COLOR":"\n  if (!clip_isInBounds(clip_commonPosition)) discard;\n"};class ot extends class{constructor(t={}){this.opts=t}equals(t){return this===t||this.constructor===t.constructor&&(0,J.v)(this.opts,t.opts)}getShaders(t){return null}getSubLayerProps(t){const{defaultProps:e={}}=t.constructor,n={updateTriggers:{}};for(const r in e)if(r in this.props){const t=e[r],i=this.props[r];n[r]=i,t&&"accessor"===t.type&&(n.updateTriggers[r]=this.props.updateTriggers[r],"function"===typeof i&&(n[r]=this.getSubLayerAccessor(i,!0)))}return n}initializeState(t,e){}updateState(t,e){}draw(t,e){}finalizeState(t){}}{getShaders(){let t="instancePositions"in this.getAttributeManager().attributes;return"clipByInstance"in this.props&&(t=this.props.clipByInstance),this.state.clipByInstance=t,t?{modules:[et],inject:nt}:{modules:[rt],inject:it}}draw({uniforms:t}){const{clipBounds:e=Q.clipBounds}=this.props;if(this.state.clipByInstance)t.clip_bounds=e;else{const n=this.projectPosition([e[0],e[1],0]),r=this.projectPosition([e[2],e[3],0]);t.clip_bounds=[Math.min(n[0],r[0]),Math.min(n[1],r[1]),Math.max(n[0],r[0]),Math.max(n[1],r[1])]}}}ot.extensionName="ClipExtension",ot.defaultProps=Q;var st=n(8918),at=n(1855),ut=n(8196);class ct{constructor({x:t,y:e,z:n,onTileLoad:r,onTileError:i}){this.x=t,this.y=e,this.z=n,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._isLoaded=!1,this._isCancelled=!1,this.onTileLoad=r,this.onTileError=i}get data(){return this._isLoaded?this.content:this._loader}get isLoaded(){return this._isLoaded}get isLoading(){return Boolean(this._loader)}get isCancelled(){return this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||r.Z.error("byteLength not defined in tile data")(),t}async _loadData(t,e){const{x:n,y:r,z:i,bbox:o}=this;this._abortController=new AbortController;const{signal:s}=this._abortController,a=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!a)return void(this._isCancelled=!0);if(this._isCancelled)return void a.done();let u,c;try{u=await t({x:n,y:r,z:i,bbox:o,signal:s})}catch(l){c=l||!0}finally{a.done(),this._isCancelled&&!u?this._isLoaded=!1:(this._isLoaded=!0,this._isCancelled=!1)}this._isLoaded&&(c?this.onTileError(c,this):(this.content=u,this.onTileLoad(this)))}loadData(t,e){t&&(this._isCancelled=!1,this._loader=this._loadData(t,e),this._loader.finally((()=>{this._loader=void 0})))}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController.abort())}}const lt=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});var ft=n(1681);const ht=new ft.Z,dt=new ft.Z;class pt{constructor(t=[0,0,0],e=[0,0,0],n=null){n=n||ht.copy(t).add(e).scale(.5),this.center=new ft.Z(n),this.halfDiagonal=new ft.Z(e).subtract(this.center),this.minimum=new ft.Z(t),this.maximum=new ft.Z(e)}clone(){return new pt(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=dt.from(t.normal),r=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),i=this.center.dot(n)+t.distance;return i-r>0?lt.INSIDE:i+r<0?lt.OUTSIDE:lt.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=ht.from(t).subtract(this.center),{halfDiagonal:n}=this;let r,i=0;return r=Math.abs(e.x)-n.x,r>0&&(i+=r*r),r=Math.abs(e.y)-n.y,r>0&&(i+=r*r),r=Math.abs(e.z)-n.z,r>0&&(i+=r*r),i}}var gt=n(5975);const mt=new ft.Z,yt=new ft.Z;class vt{constructor(t=[0,0,0],e=0){this.radius=-0,this.center=new ft.Z,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=mt.from(e),this.center=(new ft.Z).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new vt(this.center,this.radius)}union(t){const e=this.center,n=this.radius,r=t.center,i=t.radius,o=mt.copy(r).subtract(e),s=o.magnitude();if(n>=s+i)return this.clone();if(i>=s+n)return t.clone();const a=.5*(n+s+i);return yt.copy(o).scale((-n+a)/s).add(e),this.center.copy(yt),this.radius=a,this}expand(t){const e=(t=mt.from(t)).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=gt.Q$(mt,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=(t=mt.from(t)).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,r=t.normal.dot(e)+t.distance;return r<-n?lt.OUTSIDE:r<n?lt.INTERSECTING:lt.INSIDE}}var bt=n(1e3),xt=n(6281),wt=n(1031),_t=n(9685);function Et(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1],p=n[2],g=n[3],m=n[4],y=n[5],v=n[6],b=n[7],x=n[8];return t[0]=h*r+d*s+p*c,t[1]=h*i+d*a+p*l,t[2]=h*o+d*u+p*f,t[3]=g*r+m*s+y*c,t[4]=g*i+m*a+y*l,t[5]=g*o+m*u+y*f,t[6]=v*r+b*s+x*c,t[7]=v*i+b*a+x*l,t[8]=v*o+b*u+x*f,t}function At(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}var Ot=n(1437),St=n(7160);const Ct=Object.freeze([1,0,0,0,1,0,0,0,1]),Mt=Object.freeze([0,0,0,0,0,0,0,0,0]),Pt=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),kt={};class Tt extends bt.Z{static get IDENTITY(){return kt.IDENTITY=kt.IDENTITY||Object.freeze(new Tt(Ct)),kt.IDENTITY}static get ZERO(){return kt.ZERO=kt.ZERO||Object.freeze(new Tt(Mt)),kt.ZERO}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Pt}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}set(t,e,n,r,i,o,s,a,u){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this.check()}setRowMajor(t,e,n,r,i,o,s,a,u){return this[0]=t,this[1]=r,this[2]=s,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=o,this[8]=u,this.check()}determinant(){return function(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8];return e*(c*o-s*u)+n*(-c*i+s*a)+r*(u*i-o*a)}(this)}identity(){return this.copy(Ct)}fromQuaternion(t){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,f=r*a,h=i*s,d=i*a,p=i*u,g=o*s,m=o*a,y=o*u;t[0]=1-f-p,t[3]=l-y,t[6]=h+m,t[1]=l+y,t[4]=1-c-p,t[7]=d-g,t[2]=h-m,t[5]=d+g,t[8]=1-c-f}(this,t),this.check()}transpose(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],f=l*s-a*c,h=-l*o+a*u,d=c*o-s*u,p=n*f+r*h+i*d;p&&(p=1/p,t[0]=f*p,t[1]=(-l*r+i*c)*p,t[2]=(a*r-i*s)*p,t[3]=h*p,t[4]=(l*n-i*u)*p,t[5]=(-a*n+i*o)*p,t[6]=d*p,t[7]=(-c*n+r*u)*p,t[8]=(s*n-r*o)*p)}(this,this),this.check()}multiplyLeft(t){return Et(this,t,this),this.check()}multiplyRight(t){return Et(this,this,t),this.check()}rotate(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=Math.sin(n),d=Math.cos(n);t[0]=d*r+h*s,t[1]=d*i+h*a,t[2]=d*o+h*u,t[3]=d*s-h*r,t[4]=d*a-h*i,t[5]=d*u-h*o,t[6]=c,t[7]=l,t[8]=f}(this,this,t),this.check()}scale(t){return Array.isArray(t)?At(this,this,t):At(this,this,[t,t,t]),this.check()}translate(t){return function(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=n[0],d=n[1];t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=h*r+d*s+c,t[7]=h*i+d*a+l,t[8]=h*o+d*u+f}(this,this,t),this.check()}transform(t,e){switch(t.length){case 2:e=Ot.kK(e||[-0,-0],t,this);break;case 3:e=St.kK(e||[-0,-0,-0],t,this);break;case 4:e=(0,wt._x)(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,xt.IL)(e,t.length),e}transformVector(t,e){return(0,xt.x9)("Matrix3.transformVector"),this.transform(t,e)}transformVector2(t,e){return(0,xt.x9)("Matrix3.transformVector"),this.transform(t,e)}transformVector3(t,e){return(0,xt.x9)("Matrix3.transformVector"),this.transform(t,e)}}var Dt=n(6357),Ft=n(394),jt=n(8333);function Lt(){var t=new _t.WT(4);return _t.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Rt(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function It(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=n[0],u=n[1],c=n[2],l=n[3];return t[0]=r*l+s*a+i*c-o*u,t[1]=i*l+s*u+o*a-r*c,t[2]=o*l+s*c+r*u-i*a,t[3]=s*l-r*a-i*u-o*c,t}function Nt(t,e,n,r){var i,o,s,a,u,c=e[0],l=e[1],f=e[2],h=e[3],d=n[0],p=n[1],g=n[2],m=n[3];return(o=c*d+l*p+f*g+h*m)<0&&(o=-o,d=-d,p=-p,g=-g,m=-m),1-o>_t.Ib?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-r)*i)/s,u=Math.sin(r*i)/s):(a=1-r,u=r),t[0]=a*c+u*d,t[1]=a*l+u*p,t[2]=a*f+u*g,t[3]=a*h+u*m,t}function Bt(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+i]+e[3*i+o])*n,t[s]=(e[3*s+i]+e[3*i+s])*n}return t}jt.d9,jt.al,jt.JG,jt.t8;var zt=jt.IH,$t=jt.bA,Ut=jt.AK,Vt=jt.t7,Zt=jt.kE,Wt=jt.we,qt=jt.Fv,Gt=(jt.I6,jt.fS,function(){var t=St.Ue(),e=St.al(1,0,0),n=St.al(0,1,0);return function(r,i,o){var s=St.AK(i,o);return s<-.999999?(St.kC(t,e,i),St.Zh(t)<1e-6&&St.kC(t,n,i),St.Fv(t,t),Rt(r,t,Math.PI),r):s>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(St.kC(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+s,qt(r,r))}}());(function(){var t=Lt(),e=Lt()})(),function(){var t=function(){var t=new _t.WT(9);return _t.WT!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}()}();const Ht=[0,0,0,1];class Xt extends Dt.Z{constructor(t=0,e=0,n=0,r=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,r)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}fromMatrix3(t){return Bt(this,t),this.check()}identity(){var t;return(t=this)[0]=0,t[1]=0,t[2]=0,t[3]=1,this.check()}fromAxisRotation(t,e){return Rt(this,t,e),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=(0,xt.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,xt.u5)(t)}get z(){return this[2]}set z(t){this[2]=(0,xt.u5)(t)}get w(){return this[3]}set w(t){this[3]=(0,xt.u5)(t)}len(){return Zt(this)}lengthSquared(){return Wt(this)}dot(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return Ut(this,t)}rotationTo(t,e){return Gt(this,t,e),this.check()}add(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return zt(this,this,t),this.check()}calculateW(){return function(t,e){var n=e[0],r=e[1],i=e[2];t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}conjugate(){var t,e;return e=this,(t=this)[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],this.check()}invert(){return function(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=o*a}(this,this),this.check()}lerp(t,e,n){return Vt(this,t,e,n),this.check()}multiplyRight(t,e){return(0,Ft.Z)(!e),It(this,this,t),this.check()}multiplyLeft(t,e){return(0,Ft.Z)(!e),It(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+s*a,t[1]=i*u+o*a,t[2]=o*u-i*a,t[3]=s*u-r*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u-o*a,t[1]=i*u+s*a,t[2]=o*u+r*a,t[3]=s*u-i*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+i*a,t[1]=i*u-r*a,t[2]=o*u+s*a,t[3]=s*u-o*a}(this,this,t),this.check()}scale(t){return $t(this,this,t),this.check()}slerp(t,e,n){switch(arguments.length){case 1:({start:t=Ht,target:e,ratio:n}=arguments[0]);break;case 2:[e,n]=arguments,t=this}return Nt(this,t,e,n),this.check()}transformVector4(t,e=t){return jt.VC(e,t,this),(0,xt.IL)(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t,e){return this.multiplyLeft(t,e)}multiply(t,e){return this.multiplyRight(t,e)}}const Yt=new ft.Z,Kt=new ft.Z,Jt=new ft.Z,Qt=new ft.Z,te=new ft.Z,ee=new ft.Z,ne=new ft.Z,re=0,ie=1,oe=2,se=3,ae=4,ue=5,ce=6,le=7,fe=8;class he{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){this.center=(new ft.Z).from(t),this.halfAxes=new Tt(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new ft.Z(t).len(),new ft.Z(e).len(),new ft.Z(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),r=new ft.Z(t).normalize(),i=new ft.Z(e).normalize(),o=new ft.Z(n).normalize();return(new Xt).fromMatrix3(new Tt([...r,...i,...o]))}fromCenterHalfSizeQuaternion(t,e,n){const r=new Xt(n),i=(new Tt).fromQuaternion(r);return i[0]=i[0]*e[0],i[1]=i[1]*e[0],i[2]=i[2]*e[0],i[3]=i[3]*e[1],i[4]=i[4]*e[1],i[5]=i[5]*e[1],i[6]=i[6]*e[2],i[7]=i[7]*e[2],i[8]=i[8]*e[2],this.center=(new ft.Z).from(t),this.halfAxes=i,this}clone(){return new he(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new vt){const e=this.halfAxes,n=e.getColumn(0,Jt),r=e.getColumn(1,Qt),i=e.getColumn(2,te),o=Yt.copy(n).add(r).add(i);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,r=this.halfAxes,i=n.x,o=n.y,s=n.z,a=Math.abs(i*r[re]+o*r[ie]+s*r[oe])+Math.abs(i*r[se]+o*r[ae]+s*r[ue])+Math.abs(i*r[ce]+o*r[le]+s*r[fe]),u=n.dot(e)+t.distance;return u<=-a?lt.OUTSIDE:u>=a?lt.INSIDE:lt.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=Kt.from(t).subtract(this.center),n=this.halfAxes,r=n.getColumn(0,Jt),i=n.getColumn(1,Qt),o=n.getColumn(2,te),s=r.magnitude(),a=i.magnitude(),u=o.magnitude();r.normalize(),i.normalize(),o.normalize();let c,l=0;return c=Math.abs(e.dot(r))-s,c>0&&(l+=c*c),c=Math.abs(e.dot(i))-a,c>0&&(l+=c*c),c=Math.abs(e.dot(o))-u,c>0&&(l+=c*c),l}computePlaneDistances(t,e,n=[-0,-0]){let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,Jt),u=s.getColumn(1,Qt),c=s.getColumn(2,te),l=ee.copy(a).add(u).add(c).add(o),f=ne.copy(l).subtract(t);let h=e.dot(f);return r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(a).add(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(a).subtract(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),l.copy(o).add(a).subtract(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(a).add(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(a).add(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(a).subtract(u).add(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),o.copy(l).subtract(a).subtract(u).subtract(c),f.copy(l).subtract(t),h=e.dot(f),r=Math.min(h,r),i=Math.max(h,i),n[0]=r,n[1]=i,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,Jt);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,Qt);n.transformAsPoint(t);const r=this.halfAxes.getColumn(2,te);return r.transformAsPoint(t),this.halfAxes=new Tt([...e,...n,...r]),this}getTransform(){throw new Error("not implemented")}}var de=n(4034);const pe=new ft.Z,ge=new ft.Z;class me{constructor(t=[0,0,1],e=0){this.normal=new ft.Z,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return(0,Ft.Z)(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=pe.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,r){return this.normal.set(t,e,n),(0,Ft.Z)((0,de.fS)(this.normal.len(),1)),this.distance=r,this}clone(t){return new me(this.normal,this.distance)}equals(t){return(0,de.fS)(this.distance,t.distance)&&(0,de.fS)(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=ge.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=pe.from(t);const n=this.getPointDistance(t),r=ge.copy(this.normal).scale(n);return t.subtract(r).to(e)}}const ye=[new ft.Z([1,0,0]),new ft.Z([0,1,0]),new ft.Z([0,0,1])],ve=new ft.Z,be=new ft.Z;new me(new ft.Z(1,0,0),0);class xe{static get MASK_OUTSIDE(){return 4294967295}static get MASK_INSIDE(){return 0}static get MASK_INDETERMINATE(){return 2147483647}constructor(t=[]){this.planes=t,(0,Ft.Z)(this.planes.every((t=>t instanceof me)))}fromBoundingSphere(t){this.planes.length=2*ye.length;const e=t.center,n=t.radius;let r=0;for(const i of ye){let t=this.planes[r],o=this.planes[r+1];t||(t=this.planes[r]=new me),o||(o=this.planes[r+1]=new me);const s=ve.copy(i).scale(-n).add(e);i.dot(s);t.fromPointNormal(s,i);const a=ve.copy(i).scale(n).add(e),u=be.copy(i).negate();u.dot(a);o.fromPointNormal(a,u),r+=2}return this}computeVisibility(t){(0,Ft.Z)(t);let e=lt.INSIDE;for(const n of this.planes){switch(t.intersectPlane(n)){case lt.OUTSIDE:return lt.OUTSIDE;case lt.INTERSECTING:e=lt.INTERSECTING}}return e}computeVisibilityWithPlaneMask(t,e){if((0,Ft.Z)(t,"boundingVolume is required."),(0,Ft.Z)(Number.isFinite(e),"parentPlaneMask is required."),e===xe.MASK_OUTSIDE||e===xe.MASK_INSIDE)return e;let n=xe.MASK_INSIDE;const r=this.planes;for(let i=0;i<this.planes.length;++i){const o=i<31?1<<i:0;if(i<31&&0===(e&o))continue;const s=r[i],a=t.intersectPlane(s);if(a===lt.OUTSIDE)return xe.MASK_OUTSIDE;a===lt.INTERSECTING&&(n|=o)}return n}}new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z;new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,new ft.Z,Math.PI;var we=1e-15,_e=1e-20;Math.PI,Math.PI,Math.PI,Math.PI;const Ee=new Tt,Ae=new Tt,Oe=new Tt,Se=new Tt,Ce=new Tt;function Me(t,e={}){const n=_e;let r=0,i=0;const o=Ae,s=Oe;o.identity(),s.copy(t);const a=n*function(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}(s);for(;i<10&&Te(s)>a;)De(s,Se),Ce.copy(Se).transpose(),s.multiplyRight(Se),s.multiplyLeft(Ce),o.multiplyRight(Se),++r>2&&(++i,r=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}const Pe=[1,0,0],ke=[2,2,1];function Te(t){let e=0;for(let n=0;n<3;++n){const r=t[Ee.getElementIndex(ke[n],Pe[n])];e+=2*r*r}return Math.sqrt(e)}function De(t,e){const n=we;let r=0,i=1;for(let c=0;c<3;++c){const e=Math.abs(t[Ee.getElementIndex(ke[c],Pe[c])]);e>r&&(i=c,r=e)}const o=Pe[i],s=ke[i];let a=1,u=0;if(Math.abs(t[Ee.getElementIndex(s,o)])>n){const e=(t[Ee.getElementIndex(s,s)]-t[Ee.getElementIndex(o,o)])/2/t[Ee.getElementIndex(s,o)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),a=1/Math.sqrt(1+n*n),u=n*a}return Tt.IDENTITY.to(e),e[Ee.getElementIndex(o,o)]=e[Ee.getElementIndex(s,s)]=a,e[Ee.getElementIndex(s,o)]=u,e[Ee.getElementIndex(o,s)]=-u,e}const Fe=new ft.Z,je=new ft.Z,Le=new ft.Z,Re=new ft.Z,Ie=new ft.Z,Ne=new Tt,Be={diagonal:new Tt,unitary:new Tt};var ze=n(7013);const $e=512,Ue=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Ve=Ue.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Ze=Ve.concat([[.25,.5],[.75,.5]]);class We{constructor(t,e,n){this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new We(t,e,n),new We(t,e+1,n),new We(t+1,e,n),new We(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:r,minZ:i,maxZ:o,bounds:s,offset:a,project:u}=t,c=this.getBoundingVolume(r,a,u);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(c)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=i){const n=c.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const l of this.children)l.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,n,r]){const i=Math.pow(2,this.z),o=$e/i;return this.x*o<n&&this.y*o<r&&(this.x+1)*o>t&&(this.y+1)*o>e}getBoundingVolume(t,e,n){if(n){const e=this.z<1?Ze:this.z<2?Ve:Ue,r=[];for(const i of e){const e=Je(this.x+i[0],this.y+i[1],this.z);e[2]=t[0],r.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],r.push(n(e)))}return function(t,e=new he){if(!t||0===t.length)return e.halfAxes=new Tt([0,0,0,0,0,0,0,0,0]),e.center=new ft.Z,e;const n=t.length,r=new ft.Z(0,0,0);for(const O of t)r.add(O);const i=1/n;r.multiplyByScalar(i);let o=0,s=0,a=0,u=0,c=0,l=0;for(const O of t){const t=Fe.copy(O).subtract(r);o+=t.x*t.x,s+=t.x*t.y,a+=t.x*t.z,u+=t.y*t.y,c+=t.y*t.z,l+=t.z*t.z}o*=i,s*=i,a*=i,u*=i,c*=i,l*=i;const f=Ne;f[0]=o,f[1]=s,f[2]=a,f[3]=s,f[4]=u,f[5]=c,f[6]=a,f[7]=c,f[8]=l;const{unitary:h}=Me(f,Be),d=e.halfAxes.copy(h);let p=d.getColumn(0,Le),g=d.getColumn(1,Re),m=d.getColumn(2,Ie),y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,b=-Number.MAX_VALUE,x=Number.MAX_VALUE,w=Number.MAX_VALUE,_=Number.MAX_VALUE;for(const O of t)Fe.copy(O),y=Math.max(Fe.dot(p),y),v=Math.max(Fe.dot(g),v),b=Math.max(Fe.dot(m),b),x=Math.min(Fe.dot(p),x),w=Math.min(Fe.dot(g),w),_=Math.min(Fe.dot(m),_);p=p.multiplyByScalar(.5*(x+y)),g=g.multiplyByScalar(.5*(w+v)),m=m.multiplyByScalar(.5*(_+b)),e.center.copy(p).add(g).add(m);const E=je.set(y-x,v-w,b-_).multiplyByScalar(.5),A=new Tt([E[0],0,0,0,E[1],0,0,0,E[2]]);return e.halfAxes.multiplyRight(A),e}(r)}const r=Math.pow(2,this.z),i=$e/r,o=this.x*i+e*$e,s=$e-(this.y+1)*i;return new pt([o,s,t[0]],[o+i,s+i,t[1]])}}const qe=512,Ge=[-1/0,-1/0,1/0,1/0],He={type:"url",value:null,validate:(t,e)=>e.optional&&null===t||"string"===typeof t||Array.isArray(t)&&t.every((t=>"string"===typeof t)),equals:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function Xe(t,e){const n=[e.transformPoint([t[0],t[1]]),e.transformPoint([t[2],t[1]]),e.transformPoint([t[0],t[3]]),e.transformPoint([t[2],t[3]])];return[Math.min(...n.map((t=>t[0]))),Math.min(...n.map((t=>t[1]))),Math.max(...n.map((t=>t[0]))),Math.max(...n.map((t=>t[1])))]}function Ye(t,e){if(!t||!t.length)return null;if(Array.isArray(t)){t=t[Math.abs(e.x+e.y)%t.length]}const{x:n,y:r,z:i}=e;return t.replace("{x}",n).replace("{y}",r).replace("{z}",i).replace("{-y}",Math.pow(2,i)-r-1)}function Ke(t,e){return Math.pow(2,t)*qe/e}function Je(t,e,n){const r=Ke(n,qe),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r;return[i,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function Qe(t,e,n,r){const i=Ke(n,r);return[t/i*qe,e/i*qe]}function tn(t,e,n,r,i=512){if(t.isGeospatial){const[t,i]=Je(e,n,r),[o,s]=Je(e+1,n+1,r);return{west:t,north:i,east:o,south:s}}const[o,s]=Qe(e,n,r,i),[a,u]=Qe(e+1,n+1,r,i);return{left:o,top:s,right:a,bottom:u}}function en(t,e,n,r,i){const o=function(t,e,n){let r;if(e&&2===e.length){const[n,i]=e,o=t.getBounds({z:n}),s=t.getBounds({z:i});r=[Math.min(o[0],s[0]),Math.min(o[1],s[1]),Math.max(o[2],s[2]),Math.max(o[3],s[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}(t,null,r),s=Ke(e,n),[a,u,c,l]=function(t,e,n){if(n)return Xe(t,n).map((t=>t*e/qe));return t.map((t=>t*e/qe))}(o,s,i),f=[];for(let h=Math.floor(a);h<c;h++)for(let t=Math.floor(u);t<l;t++)f.push({x:h,y:t,z:e});return f}function nn({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=512,modelMatrix:s,modelMatrixInverse:a,zoomOffset:u=0}){let c=t.isGeospatial?Math.round(t.zoom+Math.log2(qe/o))+u:Math.ceil(t.zoom)+u;if(Number.isFinite(n)&&c<n){if(!i)return[];c=n}Number.isFinite(e)&&c>e&&(c=e);let l=i;return s&&a&&i&&!t.isGeospatial&&(l=Xe(i,s)),t.isGeospatial?function(t,e,n,r){const i=t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new me(t.clone().negate(),e))),s=new xe(o),a=t.distanceScales.unitsPerMeter[2],u=n&&n[0]*a||0,c=n&&n[1]*a||0,l=t.pitch<=60?e:0;if(r){const[t,e,n,i]=r,o=(0,ze.w5)([t,i]),s=(0,ze.w5)([n,e]);r=[o[0],$e-o[1],s[0],$e-s[1]]}const f=new We(0,0,0),h={viewport:t,project:i,cullingVolume:s,elevationBounds:[u,c],minZ:l,maxZ:e,bounds:r,offset:0};if(f.update(h),t.subViewports&&t.subViewports.length>1){for(h.offset=-1;f.update(h)&&!(--h.offset<-3););for(h.offset=1;f.update(h)&&!(++h.offset>3););}return f.getSelected()}(t,c,r,i):en(t,c,o,l||Ge,a)}var rn=n(4942),on=n(6203);const sn={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class an{constructor(t={}){(0,rn.Z)(this,"props",void 0),(0,rn.Z)(this,"stats",void 0),(0,rn.Z)(this,"activeRequestCount",0),(0,rn.Z)(this,"requestQueue",[]),(0,rn.Z)(this,"requestMap",new Map),(0,rn.Z)(this,"deferredUpdate",null),this.props={...sn,...t},this.stats=new on.jk({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t,e=(()=>0)){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},r=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,r),this._issueNewRequests(),r}_issueRequest(t){const{handle:e,resolve:n}=t;let r=!1;const i=()=>{r||(r=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:i}):Promise.resolve({done:i})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0)||(t.resolve(null),!1)}}const un="best-available";class cn{constructor(t){this.opts=t,this._getTileData=t.getTileData,this.onTileError=t.onTileError,this.onTileLoad=e=>{t.onTileLoad(e),this.opts.maxCacheByteSize&&(this._cacheByteSize+=e.byteLength,this._resizeCache())},this.onTileUnload=t.onTileUnload,this._requestScheduler=new an({maxRequests:t.maxRequests,throttleRequests:t.maxRequests>0}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles.every((t=>t.isLoaded))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort()}update(t,{zRange:e,modelMatrix:n}={}){const r=new i.Z(n),o=!r.equals(this._modelMatrix);if(!t.equals(this._viewport)||o){o&&(this._modelMatrixInverse=n&&r.clone().invert(),this._modelMatrix=n&&r),this._viewport=t;const i=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=i.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const s=this.updateTileStates();return this._dirty&&this._resizeCache(),s&&this._frameNumber++,this._frameNumber}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:r,modelMatrix:i,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:u}=this.opts;return nn({viewport:t,maxZoom:e,minZoom:n,zRange:r,tileSize:s,extent:a,modelMatrix:i,modelMatrixInverse:o,zoomOffset:u})}getTileMetadata({x:t,y:e,z:n}){const{tileSize:r}=this.opts;return{bbox:tn(this._viewport,t,e,n,r)}}getParentIndex(t){return t.x=Math.floor(t.x/2),t.y=Math.floor(t.y/2),t.z-=1,t}updateTileStates(){this._updateTileStates(this.selectedTiles);const{maxRequests:t}=this.opts,e=[];let n=0,r=!1;for(const i of this._cache.values()){const t=Boolean(1&i.state);i.isVisible!==t&&(r=!0,i.isVisible=t),i.isSelected=5===i.state,i.isLoading&&(n++,i.isSelected||e.push(i))}if(t>0)for(;n>t&&e.length>0;){e.shift().abort(),n--}return r}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children.length=0;for(const e of t.values()){const t=this._getNearestAncestor(e.x,e.y,e.z);e.parent=t,t&&t.children.push(e)}}_updateTileStates(t){const{_cache:e}=this,n=this.opts.refinementStrategy||un;for(const r of e.values())r.state=0;for(const r of t)r.state=5;if("never"!==n){for(const e of t)fn(e,n);for(const e of t)ln(e)&&hn(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),r=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>r){for(const[i,o]of t)if(o.isVisible||(this._cacheByteSize-=e.maxCacheByteSize?o.byteLength:0,t.delete(i),this.onTileUnload(o)),t.size<=n&&this._cacheByteSize<=r)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.z-e.z)),this._dirty=!1)}_getTile({x:t,y:e,z:n},r){const i="".concat(t,",").concat(e,",").concat(n);let o=this._cache.get(i);return!o&&r?(o=new ct({x:t,y:e,z:n,onTileLoad:this.onTileLoad,onTileError:this.onTileError}),Object.assign(o,this.getTileMetadata(o)),o.loadData(this._getTileData,this._requestScheduler),this._cache.set(i,o),this._dirty=!0):o&&o.isCancelled&&!o.isLoading&&o.loadData(this._getTileData,this._requestScheduler),o}_getNearestAncestor(t,e,n){const{_minZoom:r=0}=this;let i={x:t,y:e,z:n};for(;i.z>r;){i=this.getParentIndex(i);const t=this._getTile(i);if(t)return t}return null}}function ln(t){let e=t;for(;e;){if(!1&e.state)return!0;if(e.isLoaded)return!1;e=e.parent}return!0}function fn(t,e){let n,r=3;for(;n=t.parent;){if(t.isLoaded&&(r=4,e===un))return;n.state=Math.max(n.state,r),t=n}}function hn(t){for(const e of t.children)e.state=Math.max(e.state,3),e.isLoaded||hn(e)}const dn={data:[],dataComparator:He.equals,renderSubLayers:{type:"function",value:t=>new ut.Z(t),compare:!1},getTileData:{type:"function",optional:!0,value:null,compare:!1},onViewportLoad:{type:"function",optional:!0,value:null,compare:!1},onTileLoad:{type:"function",value:t=>{},compare:!1},onTileUnload:{type:"function",value:t=>{},compare:!1},onTileError:{type:"function",value:t=>console.error(t),compare:!1},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:un,zRange:null,maxRequests:6,zoomOffset:0};class pn extends st.Z{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t;null===(t=this.state.tileset)||void 0===t||t.finalize()}get isLoaded(){const{tileset:t}=this.state;return t.selectedTiles.every((t=>t.layers&&t.layers.every((t=>t.isLoaded))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({props:t,changeFlags:e}){let{tileset:n}=this.state;!n||e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData)?(n&&n.finalize(),n=new cn({...this._getTilesetOptions(t),getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}),this.setState({tileset:n})):(e.propsChanged||e.updateTriggersChanged)&&(n.setOptions(this._getTilesetOptions(t)),this.state.tileset.tiles.forEach((t=>{t.layers=null}))),this._updateTileset()}_getTilesetOptions(t){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:s,minZoom:a,maxRequests:u,zoomOffset:c}=t;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:s,minZoom:a,tileSize:e,refinementStrategy:i,extent:o,maxRequests:u,zoomOffset:c}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:n}=this.props,r=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:i}=t,o=this.state.isLoaded!==i,s=this.state.frameNumber!==r;i&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:r}),this.state.isLoaded=i}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.getCurrentLayer().props.onTileLoad(t),t.isVisible&&this.setNeedsUpdate()}_onTileError(t,e){const n=this.getCurrentLayer();n.props.onTileError(t),n._updateTileset(),e.isVisible&&this.setNeedsUpdate()}_onTileUnload(t){this.getCurrentLayer().props.onTileUnload(t)}getTileData(t){const e=this.getCurrentLayer(),{data:n,getTileData:r,fetch:i}=e.props,{signal:o}=t;return t.url=Ye(n,t),r?r(t):t.url?i(t.url,{propName:"data",layer:e,signal:o}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getHighlightedObjectIndex(){return-1}getPickingInfo({info:t,sourceLayer:e}){return t.tile=e.props.tile,t}_updateAutoHighlight(t){t.sourceLayer&&t.sourceLayer.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getHighlightedObjectIndex(t);if(t.isLoaded)if(t.layers)t.layers[0]&&t.layers[0].props.highlightedObjectIndex!==e&&(t.layers=t.layers.map((t=>t.clone({highlightedObjectIndex:e}))));else{const n=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(t.x,"-").concat(t.y,"-").concat(t.z),data:t.data,_offset:0,tile:t});t.layers=(0,at.x)(n,Boolean).map((n=>n.clone({tile:t,highlightedObjectIndex:e})))}else;return t.layers}))}filterSubLayer({layer:t}){return this.props.visible&&t.props.tile.isVisible}}pn.layerName="TileLayer",pn.defaultProps=dn;const gn={Point:mn,MultiPoint:function(t,e,n){return yn(t,e,n)},LineString:vn,MultiLineString:function(t,e,n){return t.map((t=>vn(t,e,n)))},Polygon:bn,MultiPolygon:function(t,e,n){return t.map((t=>bn(t,e,n)))}};function mn([t,e],[n,r],i){const o=(0,de.t7)(n[0],r[0],t),s=(0,de.t7)(n[1],r[1],e);return i.unprojectFlat([o,s])}function yn(t,e,n){return t.map((t=>mn(t,e,n)))}function vn(t,e,n){return yn(t,e,n)}function bn(t,e,n){return t.map((t=>yn(t,e,n)))}const xn=["points","lines","polygons"];function wn(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let o=0,s=i[i.length-1]+1;if(r){const e=function(t,e){if(!t.__layers){const e={},{properties:n}=t;for(let t=0;t<n.length;t++){const{layerName:r}=n[t];r&&(e[r]?e[r][1]=t:e[r]=[t,t])}t.__layers=e}return t.__layers[e]}(t,r);if(!e)return-1;o=e[0],s=e[1]+1}let a=-1;if(e in t.numericProps){const r=t.numericProps[e].value.findIndex(((t,e)=>t===n&&i[e]>=o&&i[e]<s));return r>=0?t.globalFeatureIds.value[r]:-1}return a=e?_n(t.properties,(t=>t[e]===n),o,s):_n(t.fields,(t=>t.id===n),o,s),a>=0?function(t,e){if(!t.__ids){const e=[],n=t.featureIds.value,r=t.globalFeatureIds.value;for(let t=0;t<n.length;t++)e[n[t]]=r[t];t.__ids=e}return t.__ids[e]}(t,a):-1}function _n(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const En={uniqueIdProperty:{type:"string",value:""},highlightedFeatureId:null,loaders:[V],binary:!1};class An extends pn{initializeState(){super.initializeState(),this.setState({data:null,tileJSON:null})}get isLoaded(){return this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:t,oldProps:e,context:n,changeFlags:r}){r.dataChanged&&this._updateTileData(),this.state.data&&(super.updateState({props:t,oldProps:e,context:n,changeFlags:r}),this._setWGS84PropertyForTiles())}async _updateTileData(){let{data:t}=this.props,e=null;if("string"!==typeof t||/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t))t.tilejson&&(e=t);else{const{onDataLoad:r,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{e=await i(t,{propName:"data",layer:this,loaders:[]})}catch(n){this.raiseError(n,"loading TileJSON"),t=null}r&&r(e)}e&&(t=e.tiles),this.setState({data:t,tileJSON:e})}_getTilesetOptions(t){const e=super._getTilesetOptions(t),{tileJSON:n}=this.state;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>t.minZoom&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(t.maxZoom)||n.maxzoom<t.maxZoom)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){return this.state.data?super.renderLayers():null}getTileData(t){var e;const n=Ye(this.state.data,t);if(!n)return Promise.reject("Invalid URL");let r=this.getLoadOptions();const{binary:i,fetch:o}=this.props,{signal:s,x:a,y:u,z:c}=t;return r={...r,mimeType:"application/x-protobuf",mvt:{...null===(e=r)||void 0===e?void 0:e.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:{x:a,y:u,z:c}},gis:i?{format:"binary"}:{}},o(n,{propName:"data",layer:this,loadOptions:r,signal:s})}renderSubLayers(t){const{tile:e}=t,n=Math.pow(2,e.z),o=512/n,s=-o,a=512*e.x/n,u=512*(1-e.y/n),c=(new i.Z).scale([o,s,1]);t.autoHighlight=!1,this.context.viewport.resolution||(t.modelMatrix=c,t.coordinateOrigin=[a,u,0],t.coordinateSystem=K.Df.CARTESIAN,t.extensions=[...t.extensions||[],new ot]);const l=super.renderSubLayers(t);return!this.props.binary||l instanceof ut.Z||r.Z.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),l}_updateAutoHighlight(t){const{uniqueIdProperty:e}=this.props,{hoveredFeatureId:n,hoveredFeatureLayerName:r}=this.state,i=t.object;let o,s;i&&(o=On(i,e),s=Sn(i)),n===o&&r===s||this.setState({hoveredFeatureId:o,hoveredFeatureLayerName:s})}getPickingInfo(t){const e=super.getPickingInfo(t),n=this.context.viewport.resolution;if(this.props.binary&&-1!==e.index){const{data:n}=t.sourceLayer.props;e.object=Z(n,{globalFeatureId:e.index})}return e.object&&!n&&(e.object=Mn(e.object,e.tile.bbox,this.context.viewport)),e}getHighlightedObjectIndex(t){const{hoveredFeatureId:e,hoveredFeatureLayerName:n}=this.state,{uniqueIdProperty:r,highlightedFeatureId:i,binary:o}=this.props,{data:s}=t,a=Cn(i);if(!(Cn(e)||a))return-1;const u=a?i:e;return Array.isArray(s)?s.findIndex((t=>{const e=On(t,r)===u,i=a||Sn(t)===n;return e&&i})):s&&o?function(t,e,n,r){for(const i of xn){const o=t[i]&&wn(t[i],e,n,r);if(o>=0)return o}return-1}(s,r,u,a?"":n):-1}_pickObjects(t){const{deck:e,viewport:n}=this.context,r=n.width,i=n.height,o=n.x,s=n.y,a=[this.id];return e.pickObjects({x:o,y:s,width:r,height:i,layerIds:a,maxObjects:t})}getRenderedFeatures(t=null){const e=this._pickObjects(t),n=new Set,r=[];for(const i of e){const t=On(i.object,this.props.uniqueIdProperty);void 0===t?r.push(i.object):n.has(t)||(n.add(t),r.push(i.object))}return r}_setWGS84PropertyForTiles(){const t="dataInWGS84",{tileset:e}=this.state;e.selectedTiles.forEach((e=>{e.hasOwnProperty(t)||Object.defineProperty(e,t,{get:()=>{if(!e.content)return null;if(this.props.binary&&Array.isArray(e.content)&&!e.content.length)return[];if(void 0===e._contentWGS84){const t=this.props.binary?Z(e.content):e.content;e._contentWGS84=t.map((t=>Mn(t,e.bbox,this.context.viewport)))}return e._contentWGS84}})}))}}function On(t,e){return e?t.properties[e]:"id"in t?t.id:void 0}function Sn(t){var e;return(null===(e=t.properties)||void 0===e?void 0:e.layerName)||null}function Cn(t){return void 0!==t&&null!==t&&""!==t}function Mn(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>function(t,e,n){const r=[n.projectFlat([e.west,e.north]),n.projectFlat([e.east,e.south])];return{...t,coordinates:gn[t.type](t.coordinates,r,n)}}(t.geometry,e,n).coordinates}),r}An.layerName="MVTLayer",An.defaultProps=En},8196:function(t,e,n){"use strict";n.d(e,{Z:function(){return it}});var r=n(8918),i=n(744);function o({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,s=t.length;let a=s,u=s;for(let h=0;h<s;h++){const n=e(t[h]);if(a>h&&n>=i&&(a=h),n>=o){u=h;break}}let c=a;const l=u-a!==r.length,f=l&&t.slice(u);for(let h=0;h<r.length;h++)t[c++]=r[h];if(l){for(let e=0;e<f.length;e++)t[c++]=f[e];t.length=c}return{startRow:a,endRow:a+r.length}}var s=n(6867),a=n(5522),u=n(3844),c=n(9894),l=n(1113),f=n(3982);const h=[0,0,0,255],d={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:h},getLineColor:{type:"accessor",value:h},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class p extends a.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool billboard;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n  }\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[u.Z,c.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:e}=this.context,{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,stroked:s,filled:a,billboard:u,antialiasing:c,lineWidthUnits:l,lineWidthScale:f,lineWidthMinPixels:h,lineWidthMaxPixels:d}=this.props,p="pixels"===n?e.metersPerPixel:1,g="pixels"===l?e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({stroked:s?1:0,filled:a,billboard:u,antialiasing:c,radiusScale:r*p,radiusMinPixels:i,radiusMaxPixels:o,lineWidthScale:f*g,lineWidthMinPixels:h,lineWidthMaxPixels:d}).draw()}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new f.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}p.layerName="ScatterplotLayer",p.defaultProps=d;var g=n(1447),m=n(8550),y=n(6610),v=n(5304),b=n(3478);class x{constructor(t={}){const{attributes:e={}}=t;this.typedArrayManager=y.Z,this.indexStarts=null,this.vertexStarts=null,this.vertexCount=0,this.instanceCount=0,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t),Object.seal(this)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:r,geometryBuffer:i,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=e,this.getGeometry=r,this.positionSize=i&&i.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,i&&((0,v.Z)(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(i),a||(n.positions=i)),this.geometryBuffer=n.positions,Array.isArray(s))for(const u of s)this._rebuildGeometry(u);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}normalizeGeometry(t){return t}updateGeometryAttributes(t,e,n){throw new Error("Not implemented")}getGeometrySize(t){throw new Error("Not implemented")}getGeometryFromBuffer(t){const e=t.value||t;return(0,v.Z)(ArrayBuffer.isView(e)),(0,m.jr)(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices})}_allocate(t,e){const{attributes:n,buffers:r,_attributeDefs:i,typedArrayManager:o}=this;for(const s in i)if(s in r)o.release(n[s]),n[s]=null;else{const r=i[s];r.copy=e,n[s]=o.allocate(n[s],t,r)}}_forEachGeometry(t,e,n){const{data:r,getGeometry:i}=this,{iterable:o,objectInfo:s}=(0,m.jB)(r,e,n);for(const a of o){s.index++;t(i(a,s),s.index)}}_rebuildGeometry(t){if(!this.data||!this.getGeometry)return;let{indexStarts:e,vertexStarts:n,instanceCount:r}=this;const{data:i,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=t||{},u={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{t=this.normalizeGeometry(t),u[e]=t,n[e+1]=n[e]+this.getGeometrySize(t)}),s,a),r=n[n.length-1];else if(o.buffer instanceof b.Z){const t=o.stride||4*this.positionSize;n=i.startIndices,r=n[i.length]||o.buffer.byteLength/t}else{const t=o.value||o,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;n=i.startIndices,r=n[i.length]||t.length/e}this._allocate(r,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=r;const c={};this._forEachGeometry(((t,i)=>{t=u[i]||t,c.vertexStart=n[i],c.indexStart=e[i];const o=i<n.length-1?n[i+1]:r;c.geometrySize=o-n[i],c.geometryIndex=i,this.updateGeometryAttributes(t,c)}),s,a),this.vertexCount=e[e.length-1]}}var w=n(5215);class _ extends x{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):()=>null}normalizeGeometry(t){return this.normalize?function(t,e,n,r){let i=t;if(Array.isArray(t[0])){const n=t.length*e;i=new Array(n);for(let r=0;r<t.length;r++)for(let n=0;n<e;n++)i[r*e+n]=t[r][n]||0}return n?(0,w.dj)(i,{size:e,gridResolution:n}):r?(0,w.ct)(i,{size:e}):i}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}get(t){return this.attributes[t]}getGeometrySize(t){if(Array.isArray(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&Array.isArray(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const{segmentTypes:n}=this.attributes,r=this.isClosed(t),{vertexStart:i,geometrySize:o}=e;n.fill(0,i,i+o),r?(n[i]=4,n[i+o-2]=4):(n[i]+=1,n[i+o-2]+=2),n[i+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n)return;const{vertexStart:r,geometrySize:i}=e,o=new Array(3);for(let s=r,a=0;a<i;s++,a++)this.getPointOnPath(t,a,o),n[3*s]=o[0],n[3*s+1]=o[1],n[3*s+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:r}=this;e*r>=t.length&&(e+=1-t.length/r);const i=e*r;return n[0]=t[i],n[1]=t[i+1],n[2]=3===r&&t[i+2]||0,n}isClosed(t){if(!this.normalize)return this.opts.loop;const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}const E=[0,0,0,255],A={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:E},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},O={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class S extends a.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 lineJoin(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return currPoint + offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.worldPosition = instanceStartPositions;\n  geometry.worldPositionAlt = instanceEndPositions;\n  geometry.pickingColor = instancePickingColors;\n\n  vec2 widthPixels = vec2(clamp(project_size_to_pixel(instanceStrokeWidths * widthScale),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 pos = lineJoin(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    gl_Position = vec4(pos * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec4 pos = vec4(\n      lineJoin(prevPosition, currPosition, nextPosition, width.xy),\n      1.0);\n    geometry.position = pos;\n    gl_Position = project_common_position_to_clipspace(pos);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[u.Z,c.Z]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:O,accessor:"getPath",update:this.calculatePositions,noAlloc:true,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:true},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:O,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:O,defaultValue:E},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new _({fp64:this.use64bitPositions()})}),this.props.getDashArray&&!this.props.extensions.length&&i.Z.removed("getDashArray","PathStyleExtension")()}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,i=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:i.getPath,buffers:i,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||r.invalidateAll()}if(n.extensionsChanged){var i;const{gl:t}=this.context;null===(i=this.state.model)||void 0===i||i.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{viewport:e}=this.context,{jointRounded:n,capRounded:r,billboard:i,miterLimit:o,widthUnits:s,widthScale:a,widthMinPixels:u,widthMaxPixels:c}=this.props,l="pixels"===s?e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthScale:a*l,miterLimit:o,widthMinPixels:u,widthMaxPixels:c}).draw()}_getModel(t){return new l.Z(t,{...this.getShaders(),id:this.props.id,geometry:new f.Z({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}S.layerName="PathLayer",S.defaultProps=A;var C=n(5644),M=n(4088),P=n(4211),k=n(6948),T=n(9187),D=n.n(T);const F=w.wG.CLOCKWISE,j=w.wG.COUNTER_CLOCKWISE,L={isClosed:!0};function R(t,e,n,r,i){let o=e;const s=n.length;for(let a=0;a<s;a++)for(let e=0;e<r;e++)t[o++]=n[a][e]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let a=0;a<r;a++)t[o++]=n[0][a]||0;return L.start=e,L.end=o,L.size=r,(0,w.Ny)(t,i,L),o}function I(t,e,n,r,i=0,o,s){const a=(o=o||n.length)-i;if(a<=0)return e;let u=e;for(let c=0;c<a;c++)t[u++]=n[i+c];if(!function(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}(n,r,i,o))for(let c=0;c<r;c++)t[u++]=n[i+c];return L.start=e,L.end=u,L.size=r,(0,w.Ny)(t,s,L),u}function N(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],r=[];if(t.positions){const{positions:i,holeIndices:o}=t;if(o){let t=0;for(let s=0;s<=o.length;s++)t=I(n,t,i,e,o[s-1],o[s],0===s?F:j),r.push(t);return r.pop(),{positions:n,holeIndices:r}}t=i}if(Number.isFinite(t[0]))return I(n,0,t,e,0,n.length,F),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let i=0;for(const[o,s]of t.entries())i=R(n,i,s,e,0===o?F:j),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return R(n,0,t,e,F),n}class B extends x{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;e&&(this.vertexCount=(e.value||e).length)}normalizeGeometry(t){if(this.normalize){if(t=N(t,this.positionSize),this.opts.resolution)return(0,w.WZ)(t.positions||t,t.holeIndices,{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0});if(this.opts.wrapLongitude)return(0,w.GU)(t.positions||t,t.holeIndices,{size:this.positionSize,maxLatitude:86,edgeTypes:!0})}return t}getGeometrySize(t){if(Array.isArray(t)&&!Number.isFinite(t[0])){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return(t.positions||t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):()=>null}updateGeometryAttributes(t,e){if(Array.isArray(t)&&!Number.isFinite(t[0]))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:r}){const{attributes:i,indexStarts:o,typedArrayManager:s}=this;let a=i.indices;if(!a)return;let u=r;const c=function(t,e,n){let r=null;t.holeIndices&&(r=t.holeIndices.map((t=>t/e)));let i=t.positions||t;if(n){const t=i.length;i=i.slice();const r=[];for(let o=0;o<t;o+=e){r[0]=i[o],r[1]=i[o+1];const t=n(r);i[o]=t[0],i[o+1]=t[1]}}return D()(i,r,e)}(t,this.positionSize,this.opts.preproject);a=s.allocate(a,r+c.length,{copy:!0});for(let l=0;l<c.length;l++)a[u++]=c[l]+n;o[e+1]=r+c.length,i.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:r},positionSize:i}=this;if(!r)return;const o=t.positions||t;for(let s=e,a=0;a<n;s++,a++){const t=o[a*i],e=o[a*i+1],n=i>2?o[a*i+2]:0;r[3*s]=t,r[3*s+1]=e,r[3*s+2]=n}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{attributes:{vertexValid:r},positionSize:i}=this,o=t&&t.holeIndices;if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let s=0;s<o.length;s++)r[e+o[s]/i-1]=0;r[e+n-1]=0}}var z="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n\n#ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n    geometry.normal = normal;\n  }\n\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",$="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(z,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),U="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(z,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n");const V=[0,0,0,255],Z={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:V},getLineColor:{type:"accessor",value:V},material:!0},W={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class q extends a.Z{getShaders(t){return super.getShaders({vs:"top"===t?$:U,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[u.Z,C.N,c.Z]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;e.isGeospatial&&n===M.Df.DEFAULT&&(n=M.Df.LNGLAT),this.setState({numInstances:0,polygonTesselator:new B({preproject:n===M.Df.LNGLAT&&e.projectFlat,fp64:this.use64bitPositions(),IndexType:!t||(0,P.ag)(t,k.h.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const r=this.getAttributeManager(),i=!0;r.remove(["instancePickingColors"]),r.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:i},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:W,accessor:"getPolygon",update:this.calculatePositions,noAlloc:i,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:i},elevations:{size:1,transition:W,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:W,accessor:"getFillColor",defaultValue:V,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{alias:"colors",size:this.props.colorFormat.length,type:5121,normalized:!0,transition:W,accessor:"getLineColor",defaultValue:V,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:r}=this.props;return r[0]&&r[0].__source&&(e.object=r.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:r,elevationScale:i}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,u={...t,extruded:Boolean(e),elevationScale:i};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(u),r&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(u).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:r}=t,i=this.getAttributeManager();var o;(r.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),i.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,r=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:r.getPolygon,buffers:r,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:r}=this.props;let i,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,i=new l.Z(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return r&&(o=new l.Z(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new f.Z({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,i].filter(Boolean),topModel:i,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}q.layerName="SolidPolygonLayer",q.defaultProps=Z;const G={circle:{type:p,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:s.Z,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:g.Z,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},H={type:S,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",getLineColor:"getColor",getLineWidth:"getWidth"}},X={type:q,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Y({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function K(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),i.updateTriggers[s]=r[o],n&&(i.transitions[s]=n[o])),i[s]=a}return i}function J(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:o=0,endRow:s=t.length}=n;for(let a=o;a<s;a++){const n=t[a];i.Z.assert(n&&n.geometry,"GeoJSON does not have geometry");const{geometry:o}=n;if("GeometryCollection"===o.type){i.Z.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:t}=o;for(let i=0;i<t.length;i++){Q(t[i],r,e,n,a)}}else Q(o,r,e,n,a)}return r}function Q(t,e,n,r,o){const{type:s,coordinates:a}=t,{pointFeatures:u,lineFeatures:c,polygonFeatures:l,polygonOutlineFeatures:f}=e;if(function(t,e){let n=tt[t];i.Z.assert(n,"Unknown GeoJSON type ".concat(t));for(;e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(s,a))switch(s){case"Point":u.push(n({geometry:t},r,o));break;case"MultiPoint":a.forEach((t=>{u.push(n({geometry:{type:"Point",coordinates:t}},r,o))}));break;case"LineString":c.push(n({geometry:t},r,o));break;case"MultiLineString":a.forEach((t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}));break;case"Polygon":l.push(n({geometry:t},r,o)),a.forEach((t=>{f.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}));break;case"MultiPolygon":a.forEach((t=>{l.push(n({geometry:{type:"Polygon",coordinates:t}},r,o)),t.forEach((t=>{f.push(n({geometry:{type:"LineString",coordinates:t}},r,o))}))}))}else i.Z.warn("".concat(s," coordinates are malformed"))()}const tt={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function et(t){return t.geometry.coordinates}function nt(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:r,lines:i,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(3*i.length);const o=[];for(let t=0;t<i.length;t++)e(i[t],o),n[r][3*t+0]=o[0],n[r][3*t+1]=o[1],n[r][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{getPosition:r.positions,instancePickingColors:{size:3,value:s.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{getPath:i.positions,instancePickingColors:{size:3,value:s.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const rt={...Y(G.circle),...Y(G.icon),...Y(G.text),...Y(H),...Y(X),stroked:!0,filled:!0,extruded:!1,wireframe:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class it extends r.Z{initializeState(){this.state={layerProps:{},features:{}},this.props.getLineDashArray&&i.Z.removed("getLineDashArray","PathStyleExtension")()}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,r=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:r}),r?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=nt(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch(i.Z.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return i.Z.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),r=this.getSubLayerRow.bind(this);let s={};const a={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)s[e]=t[e].slice(),a[e]=[];for(const i of e.dataChanged){const e=J(n,r,i);for(const n in t)a[n].push(o({data:s[n],getIndex:t=>t.__source.index,dataRange:i,replace:e[n]}))}}else s=J(n,r);const u=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=et,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=et,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=et,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=et,n}(s,a);this.setState({features:s,featuresDiff:a,layerProps:u})}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n=t.sourceLayer.id.startsWith(e);for(const r of this.getSubLayers())r.id.startsWith(e)===n&&r.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,r="polygons-fill",i=this.shouldRenderSubLayer(r,n.polygons.data)&&this.getSubLayerClass(r,X.type);if(i){const o=K(this,X.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new i(o,this.getSubLayerProps({id:r,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,r="polygons-stroke",i="linestrings",o=!t&&e&&this.shouldRenderSubLayer(r,n.polygonsOutline.data)&&this.getSubLayerClass(r,H.type),s=this.shouldRenderSubLayer(i,n.lines.data)&&this.getSubLayerClass(i,H.type);if(o||s){const t=K(this,H.props);return[o&&new o(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:r}=this.props;!n&&Number.isFinite(r)&&(r=e.points.data.findIndex((t=>t.__source.index===r)));const i=new Set(t.split("+")),o=[];for(const s of i){const t="points-".concat(s),n=G[s],i=n&&this.shouldRenderSubLayer(t,e.points.data)&&this.getSubLayerClass(t,n.type);if(i){const s=K(this,n.props);o.push(new i(s,this.getSubLayerProps({id:t,updateTriggers:s.updateTriggers,highlightedObjectIndex:r}),e.points))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"===typeof t?(e,n)=>{const{data:r,index:i}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return-1!==n?function(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}(t,r,n):null}(r,i);return t(o,n)}:super.getSubLayerAccessor(t)}}it.layerName="GeoJsonLayer",it.defaultProps=rt},6867:function(t,e,n){"use strict";n.d(e,{Z:function(){return E}});var r=n(5522),i=n(3844),o=n(9894),s=n(744),a=n(1113),u=n(3982),c=n(5432),l=n(1953),f=n(4912),h=n(8949),d=n(9787),p=n(8550);const g=()=>{},m={10241:9987,10240:9729,10242:33071,10243:33071};function y(t,e,n,r){return n===e.width&&r===e.height?e:(t.canvas.height=r,t.canvas.width=n,t.clearRect(0,0,t.canvas.width,t.canvas.height),t.drawImage(e,0,0,e.width,e.height,0,0,n,r),t.canvas)}function v(t){return t&&(t.id||t.url)}function b(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r];t[v(i)]={...i,x:o,y:n}}}class x{constructor(t,{onUpdate:e=g,onError:n=g}){this.gl=t,this.onUpdate=e,this.onError=n,this._loadOptions=null,this._getIcon=null,this._texture=null,this._externalTexture=null,this._mapping={},this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=4,this._canvasWidth=1024,this._canvasHeight=0,this._canvas=null}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?v(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:r,data:i,getIcon:o}){t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),o&&(this._getIcon=o),r&&(this._mapping=r),n&&this._updateIconAtlas(n),this._autoPacking&&(i||o)&&"undefined"!==typeof document&&(this._canvas=this._canvas||document.createElement("canvas"),this._updateAutoPacking(i))}get isLoaded(){return 0===this._pendingCount}_updateIconAtlas(t){var e;null===(e=this._texture)||void 0===e||e.delete(),this._texture=null,this._externalTexture=t,this.onUpdate()}_updateAutoPacking(t){const e=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=(0,p.jB)(t);for(const s of i){o.index++;const t=e(s,o),i=v(t);if(!t)throw new Error("Icon is missing.");if(!t.url)throw new Error("Icon url is missing.");r[i]||n[i]&&t.url===n[i].url||(r[i]={...t,source:s,sourceIndex:o.index})}return r}(t,this._getIcon,this._mapping)||{});if(e.length>0){const{mapping:t,xOffset:n,yOffset:r,rowHeight:i,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let c=0;c<t.length;c++){const u=t[c];if(!n[v(u)]){const{height:t,width:c}=u;r+c+e>s&&(b(n,a,i),r=0,i=o+i+e,o=0,a=[]),a.push({icon:u,xOffset:r}),r=r+c+e,o=Math.max(o,t)}}return a.length>0&&b(n,a,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:s,canvasHeight:(u=o+i+e,Math.pow(2,Math.ceil(Math.log2(u))))};var u}({icons:e,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=i,this._mapping=t,this._xOffset=n,this._yOffset=r,this._canvasHeight=o,this._texture||(this._texture=new f.Z(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:m})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,r){const i=e.width,o=e.height,s=(0,c.h)(e,{width:n,height:r});return(0,l.Lv)(e,s,{targetY:0,width:i,height:o}),e.delete(),s}(this.gl,this._texture,this._canvasWidth,this._canvasHeight)),this.onUpdate(),this._loadIcons(e)}}_loadIcons(t){const e=this._canvas.getContext("2d");for(const n of t)this._pendingCount++,(0,d.z)(n.url,h.S,this._loadOptions).then((t=>{const r=v(n),{x:i,y:o,width:s,height:a}=this._mapping[r],u=y(e,t,s,a);this._texture.setSubImageData({data:u,x:i,y:o,width:s,height:a}),this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const w=[0,0,0,255],_={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:w},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,compare:!1,optional:!0}};class E extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.Z]})}initializeState(){this.state={iconManager:new x(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})};this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:w},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState({oldProps:t,props:e,changeFlags:n}){super.updateState({props:e,oldProps:t,changeFlags:n});const r=this.getAttributeManager(),{iconAtlas:i,iconMapping:o,data:s,getIcon:a}=e,{iconManager:u}=this.state;u.setProps({loadOptions:e.loadOptions});let c=!1;if(i||this.internalState.isAsyncPropLoading("iconAtlas")?(t.iconAtlas!==e.iconAtlas&&u.setProps({iconAtlas:i,autoPacking:!1}),t.iconMapping!==e.iconMapping&&(u.setProps({iconMapping:o}),c=!0)):u.setProps({autoPacking:!0}),(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getIcon))&&u.setProps({data:s,getIcon:a}),c&&(r.invalidate("instanceOffsets"),r.invalidate("instanceIconFrames"),r.invalidate("instanceColorModes")),n.extensionsChanged){var l;const{gl:t}=this.context;null===(l=this.state.model)||void 0===l||l.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(){super.finalizeState(),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:r,sizeUnits:i,billboard:o,alphaCutoff:s}=this.props,{iconManager:a}=this.state,{viewport:u}=this.context,c=a.getTexture();c&&this.state.model.setUniforms(t).setUniforms({iconsTexture:c,iconsTextureDim:[c.width,c.height],sizeScale:e*("pixels"===i?u.metersPerPixel:1),sizeMinPixels:n,sizeMaxPixels:r,billboard:o,alphaCutoff:s}).draw()}_getModel(t){return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){const{onIconError:e}=this.getCurrentLayer().props;e?e(t):s.Z.error(t.error)()}getInstanceOffset(t){const e=this.state.iconManager.getIconMapping(t);return[e.width/2-e.anchorX||0,e.height/2-e.anchorY||0]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const e=this.state.iconManager.getIconMapping(t);return[e.x||0,e.y||0,e.width||0,e.height||0]}}E.layerName="IconLayer",E.defaultProps=_},7693:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var r=n(5522),i=n(3844),o=n(5644),s=n(9894),a=n(1113),u=n(3982);const c=[0,0,0,255],l=[0,0,1],f={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:l},getColor:{type:"accessor",value:c},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};class h extends r.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME point-cloud-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 instanceNormals;\nattribute vec4 instanceColors;\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusPixels;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.normal = project_normal(instanceNormals);\n  unitPosition = positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n  vec3 offset = vec3(positions.xy * radiusPixels, 0.0);\n  DECKGL_FILTER_SIZE(offset, geometry);\n\n  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);\n  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\n  vColor = vec4(lightColor, instanceColors.a * opacity);\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME point-cloud-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\nvarying vec2 unitPosition;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition);\n\n  if (distToCenter > 1.0) {\n    discard;\n  }\n\n  gl_FragColor = vColor;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[i.Z,o.N,s.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:l},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:c}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}n.dataChanged&&function(t){const{header:e,attributes:n}=t;e&&n&&(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}(t.data)}draw({uniforms:t}){const{viewport:e}=this.context,{pointSize:n,sizeUnits:r}=this.props,i="meters"===r?1/e.metersPerPixel:1;this.state.model.setUniforms(t).setUniforms({radiusPixels:n*i}).draw()}_getModel(t){const e=[];for(let n=0;n<3;n++){const t=n/3*Math.PI*2;e.push(2*Math.cos(t),2*Math.sin(t),0)}return new a.Z(t,{...this.getShaders(),id:this.props.id,geometry:new u.Z({drawMode:4,attributes:{positions:new Float32Array(e)}}),isInstanced:!0})}}h.layerName="PointCloudLayer",h.defaultProps=f},1447:function(t,e,n){"use strict";n.d(e,{Z:function(){return N}});var r=n(8918),i=n(8550),o=n(744),s=n(6867);const a=[];class u extends s.Z{getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float buffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(buffer - gamma, buffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState();this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:r}=e;r!==n.outlineColor&&(r=r.map((t=>t/255)),r[3]=Number.isFinite(r[3])?r[3]:1,this.setState({outlineColor:r})),!e.sdf&&e.outlineWidth&&o.Z.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:r}=this.props,{outlineColor:i}=this.state;t.uniforms={...t.uniforms,buffer:.75,outlineBuffer:r?Math.max(n,.75*(1-r)):-1,gamma:n,sdf:Boolean(e),outlineColor:i},super.draw(t)}getInstanceOffset(t){return t?Array.from(t).map((t=>super.getInstanceOffset(t))):a}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).map((t=>super.getInstanceIconFrame(t))):a}}u.layerName="MultiIconLayer",u.defaultProps={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};var c=n(9296),l=n.n(c);const f=[];function h(t,e,n,r){let i=0;for(let o=e;o<n;o++){const e=t[o];let n=null;const s=r&&r[e];s&&(n=s.width),i+=n}return i}function d(t,e,n,r,i,o){let s=e,a=0;for(let u=e;u<n;u++){const e=h(t,u,u+1,i);a+e>r&&(s<u&&o.push(u),s=u,a=0),a+=e}return a}function p(t,e,n,r,i=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?d(t,i,o,n,r,s):function(t,e,n,r,i,o){let s=e,a=e,u=e,c=0;for(let l=e;l<n;l++)if(" "===t[l]?u=l+1:" "!==t[l+1]&&l+1!==n||(u=l+1),u>a){let e=h(t,a,u,i);c+e>r&&(s<a&&(o.push(a),s=a,c=0),e>r&&(e=d(t,a,u,r,i,o),s=o[o.length-1])),a=u,c+=e}}(t,i,o,n,r,s),s}function g(t,e,n,r,i,s){let a=0,u=0;for(let c=e;c<n;c++){const e=t[c],n=r[e];n?(u||(u=n.height),i[c]=a+n.width/2,a+=n.width):(o.Z.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),i[c]=a,a+=32)}s[0]=a,s[1]=u}function m(t,e,n,r,i){const o=(t=Array.from(t)).length,s=new Array(o),a=new Array(o),u=new Array(o),c=("break-word"===n||"break-all"===n)&&isFinite(r)&&r>0,l=[0,0],h=[];let d=0,m=0,y=0;for(let v=0;v<=o;v++){const b=t[v];if("\n"!==b&&v!==o||(y=v),y>m){const o=c?p(t,n,r,i,m,y):f;for(let n=0;n<=o.length;n++){const r=0===n?m:o[n-1],c=n<o.length?o[n]:y;g(t,r,c,i,s,h);for(let t=r;t<c;t++)a[t]=d+h[1]/2,u[t]=h[0];d+=h[1]*e,l[0]=Math.max(l[0],h[0])}m=y}"\n"===b&&(s[m]=0,a[m]=0,u[m]=0,m++)}return l[1]=d,{x:s,y:a,rowWidth:u,size:l}}const y=function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),v="Monaco, monospace",b="normal",x=new class{constructor(t=5){this.limit=t,this.clear()}clear(){this._cache={},this._order=[]}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(this._deleteCache(t),this._deleteOrder(t))}_deleteCache(t){delete this._cache[t]}_deleteOrder(t){const e=this._order.findIndex((e=>e===t));e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}(3),w=["fontFamily","fontWeight","characterSet","fontSize","sdf","buffer","cutoff","radius"];function _(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function E(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="baseline",t.textAlign="left"}class A{constructor(){this.props={fontFamily:v,fontWeight:b,characterSet:y,fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12},this._key=null,this._atlas=null}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){return 1.2}setProps(t={}){w.forEach((e=>{e in t&&(this.props[e]=t[e])}));const e=this._key;this._key=this._getKey();const n=function(t,e){const n=x.get(t);if(!n)return e;const r=[],i=n.mapping;let o=Object.keys(i);o=new Set(o);let s=e;return s instanceof Array&&(s=new Set(s)),s.forEach((t=>{o.has(t)||r.push(t)})),r}(this._key,this.props.characterSet),r=x.get(this._key);if(r&&0===n.length)return void(this._key!==e&&(this._atlas=r));const i=this._generateFontAtlas(this._key,n,r);this._atlas=i,x.set(this._key,i)}_generateFontAtlas(t,e,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:s,sdf:a,radius:u,cutoff:c}=this.props;let f=n&&n.data;f||(f=document.createElement("canvas"),f.width=1024);const h=f.getContext("2d");E(h,r,o,i);const{mapping:d,canvasHeight:p,xOffset:g,yOffset:m}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:s=0,yOffset:a=0}){let u=0,c=s,l=0;for(const d of t)if(!o[d]){const t=e(d,l++);c+t+2*r>i&&(c=0,u++),o[d]={x:c+r,y:a+u*(n+2*r)+r,width:t,height:n},c+=t+2*r}const f=n+2*r;return{mapping:o,xOffset:c,yOffset:a+u*f,canvasHeight:(h=a+(u+1)*f,Math.pow(2,Math.ceil(Math.log2(h))))};var h}({getFontWidth:t=>h.measureText(t).width,fontHeight:1.2*o,buffer:s,characterSet:e,maxCanvasWidth:1024,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(f.height!==p){const t=h.getImageData(0,0,f.width,f.height);f.height=p,h.putImageData(t,0,0)}if(E(h,r,o,i),a){const t=new(l())(o,s,u,c,r,i),n=h.getImageData(0,0,t.size,t.size);for(const r of e)_(t.draw(r),n),h.putImageData(n,d[r].x-s,d[r].y+s)}else for(const l of e)h.fillText(l,d[l].x,d[l].y+.9*o);return{xOffset:g,yOffset:m,mapping:d,data:f,width:f.width,height:f.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:r,sdf:i,radius:o,cutoff:s}=this.props;return i?"".concat(t," ").concat(e," ").concat(n," ").concat(r," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(r)}}var O=n(5522),S=n(3844),C=n(9894),M=n(1113),P=n(3982);const k={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class T extends O.Z{getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n  }\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[S.Z,C.Z]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{viewport:e}=this.context,{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:o,sizeMaxPixels:s,getLineWidth:a}=this.props;let{padding:u}=this.props;const c="pixels"===i?e.metersPerPixel:1;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(t).setUniforms({billboard:n,stroked:Boolean(a),padding:u,sizeScale:r*c,sizeMinPixels:o,sizeMaxPixels:s}).draw()}_getModel(t){return new M.Z(t,{...this.getShaders(),id:this.props.id,geometry:new P.Z({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}T.layerName="TextBackgroundLayer",T.defaultProps=k;const D={fontSize:64,buffer:4,sdf:!1,radius:12,cutoff:.25,smoothing:.1},F={start:1,middle:0,end:-1},j={top:1,center:0,bottom:-1},L=[0,0,0,255],R=["fontSize","buffer","sdf","radius","cutoff"],I={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:L},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:y},fontFamily:v,fontWeight:b,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:L},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:L},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class N extends r.Z{initializeState(){this.state={styleVersion:0,fontAtlasManager:new A}}updateState({props:t,oldProps:e,changeFlags:n}){const r=n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getText),i=this.state.characterSet;r&&this._updateText();const o=i!==this.state.characterSet||this._fontChanged(e,t);o&&this._updateFontAtlas(e,t);(o||t.lineHeight!==e.lineHeight||t.wordBreak!==e.wordBreak||t.maxWidth!==e.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(t,e){const{fontSettings:n,fontFamily:r,fontWeight:i}=e,{fontAtlasManager:o,characterSet:s}=this.state;o.setProps({...D,...n,characterSet:s,fontFamily:r,fontWeight:i})}_fontChanged(t,e){if(t.fontFamily!==e.fontFamily||t.fontWeight!==e.fontWeight)return!0;if(t.fontSettings===e.fontSettings)return!1;const n=t.fontSettings||{},r=e.fontSettings||{};return R.some((t=>n[t]!==r[t]))}_updateText(){const{data:t,characterSet:e}=this.props,n=t.attributes&&t.attributes.getText;let r,{getText:o}=this.props,{startIndices:s}=t;const a="auto"===e&&new Set;if(n&&s){const{texts:e,characterCount:i}=function({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,u=r?r/s:0,c=i[e]||Math.ceil((t.length-u)/a),l=o&&new Set,f=new Array(e);let h=t;if(a>1||u>0){h=new t.constructor(c);for(let e=0;e<c;e++)h[e]=t[e*a+u]}for(let d=0;d<e;d++){const t=i[d],e=i[d+1]||c,n=h.subarray(t,e);f[d]=String.fromCodePoint.apply(null,n),l&&n.forEach(l.add,l)}if(l)for(const d of l)o.add(String.fromCodePoint(d));return{texts:f,characterCount:c}}({...ArrayBuffer.isView(n)?{value:n}:n,length:t.length,startIndices:s,characterSet:a});r=i,o=(t,{index:n})=>e[n]}else{const{iterable:e,objectInfo:n}=(0,i.jB)(t);s=[0],r=0;for(const t of e){n.index++;const e=Array.from(o(t,n)||"");a&&e.forEach(a.add,a),r+=e.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||e})}getBoundingRect(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:u}=this.props,c=r(t,e)||"",{size:[l,f]}=m(c,s,i,o,n);return[(F["function"===typeof a?a(t,e):a]-1)*l/2,(j["function"===typeof u?u(t,e):u]-1)*f/2,l,f]}getIconOffsets(t,e){const n=this.state.fontAtlasManager.mapping,{getText:r}=this.state,{wordBreak:i,maxWidth:o,lineHeight:s,getTextAnchor:a,getAlignmentBaseline:u}=this.props,c=r(t,e)||"",{x:l,y:f,rowWidth:h,size:[d,p]}=m(c,s,i,o,n),g=F["function"===typeof a?a(t,e):a],y=j["function"===typeof u?u(t,e):u],v=l.length,b=new Array(2*v);let x=0;for(let m=0;m<v;m++){const t=(1-g)*(d-h[m])/2;b[x++]=(g-1)*d/2+t+l[m],b[x++]=(y-1)*p/2+f[m]}return b}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:r,texture:i,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:c,getPosition:l,getColor:f,getSize:h,getAngle:d,getPixelOffset:p,getBackgroundColor:g,getBorderColor:m,getBorderWidth:y,backgroundPadding:v,background:b,billboard:x,fontSettings:w,outlineWidth:_,outlineColor:E,sizeScale:A,sizeUnits:O,sizeMinPixels:S,sizeMaxPixels:C,transitions:M,updateTriggers:P}=this.props,k=this.getSubLayerClass("characters",u),F=this.getSubLayerClass("background",T);return[b&&new F({getFillColor:g,getLineColor:m,getLineWidth:y,padding:v,getPosition:l,getSize:h,getAngle:d,getPixelOffset:p,billboard:x,sizeScale:A/this.state.fontAtlasManager.props.fontSize,sizeUnits:O,sizeMinPixels:S,sizeMaxPixels:C,transitions:M&&{getPosition:M.getPosition,getAngle:M.getAngle,getSize:M.getSize,getFillColor:M.getBackgroundColor,getLineColor:M.getBorderColor,getLineWidth:M.getBorderWidth,getPixelOffset:M.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:P.getPosition,getAngle:P.getAngle,getSize:P.getSize,getFillColor:P.getBackgroundColor,getLineColor:P.getBorderColor,getLineWidth:P.getBorderWidth,getPixelOffset:P.getPixelOffset,getBoundingRect:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes?{length:a.length,attributes:a.attributes.background||{}}:a,_dataDiff:c,autoHighlight:!1,getBoundingRect:this.getBoundingRect.bind(this)}),new k({sdf:w.sdf,smoothing:Number.isFinite(w.smoothing)?w.smoothing:D.smoothing,outlineWidth:_,outlineColor:E,iconAtlas:i,iconMapping:o,getPosition:l,getColor:f,getSize:h,getAngle:d,getPixelOffset:p,billboard:x,sizeScale:A*r,sizeUnits:O,sizeMinPixels:S*r,sizeMaxPixels:C*r,transitions:M&&{getPosition:M.getPosition,getAngle:M.getAngle,getColor:M.getColor,getSize:M.getSize,getPixelOffset:M.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:P.getText,getPosition:P.getPosition,getAngle:P.getAngle,getColor:P.getColor,getSize:P.getSize,getPixelOffset:P.getPixelOffset,getIconOffsets:{getText:P.getText,getTextAnchor:P.getTextAnchor,getAlignmentBaseline:P.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:c,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets.bind(this),getIcon:n})]}}N.layerName="TextLayer",N.defaultProps=I},9756:function(t,e,n){"use strict";n.d(e,{Z:function(){return f}});var r=n(8646),i=n(6935);function o({map:t,gl:e,deck:n}){if(t.__deck)return t.__deck;const i=n&&n.props._customRender,o={useDevicePixels:!0,_customRender:()=>{t.triggerRepaint(),i&&i()},parameters:{depthMask:!0,depthTest:!0,blendFunc:[770,771,1,771],blendEquation:32774},userData:{isExternal:!1,mapboxLayers:new Set}};return n?(n.setProps(o),n.props.userData.isExternal=!0):(Object.assign(o,{gl:e,width:!1,height:!1,touchAction:"unset",viewState:s(t)}),n=new r.Z(o),t.on("move",(()=>function(t,e){t.setProps({viewState:s(e)}),t.needsRedraw({clearRedrawFlags:!0})}(n,t))),t.on("remove",(()=>{n.finalize(),t.__deck=null}))),n.props.userData.mapboxVersion=function(t){let e=0,n=0;t.version&&([e,n]=t.version.split(".").slice(0,2).map(Number));return{major:e,minor:n}}(t),t.__deck=n,t.on("render",(()=>{n.layerManager&&function(t,e){const{mapboxLayers:n,isExternal:r}=t.props.userData;if(r){const r=Array.from(n,(t=>t.id)),i=u(t,(t=>{for(const e of r)if(c(e,t))return!1;return!0}));i.length>0&&t._drawLayers("mapbox-repaint",{viewports:[a(t,e,!1)],layers:i,clearCanvas:!1})}t.props.userData.currentViewport=null}(n,t)})),n}function s(t){const{lng:e,lat:n}=t.getCenter();return{longitude:e,latitude:n,zoom:t.getZoom(),bearing:t.getBearing(),pitch:t.getPitch()}}function a(t,e,n=!0){const{mapboxVersion:r}=t.props.userData;return new i.Z(Object.assign({x:0,y:0,width:t.width,height:t.height,repeat:!0},s(e),n?{nearZMultiplier:1===r.major&&r.minor>=3||r.major>=2?.02:1/(t.height||1)}:{nearZMultiplier:.1}))}function u(t,e){return t.layerManager.getLayers().filter(e)}function c(t,e){let n=e;for(;n;){if(n.id===t)return!0;n=n.parent}return!1}function l(t){if(t.props.userData.isExternal)return;const e=[];t.props.userData.mapboxLayers.forEach((t=>{const n=new(0,t.props.type)(t.props);e.push(n)})),t.setProps({layers:e})}class f{constructor(t){if(!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,e){var n,r;this.map=t,this.deck=o({map:t,gl:e,deck:this.props.deck}),n=this.deck,r=this,n.props.userData.mapboxLayers.add(r),l(n)}onRemove(){var t,e;t=this.deck,e=this,t.props.userData.mapboxLayers.delete(e),l(t)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&l(this.deck)}render(t,e){!function(t,e,n){let{currentViewport:r}=t.props.userData;r||(r=a(t,e,!0),t.props.userData.currentViewport=r),t.layerManager&&t._drawLayers("mapbox-repaint",{viewports:[r],layers:u(t,(t=>c(n.id,t))),clearCanvas:!1})}(this.deck,this.map,this)}}},4310:function(t,e,n){"use strict";n.d(e,{Z:function(){return S}});var r=n(744),i=n(5522),o=n(3844),s=n(5644),a=n(9894),u=n(3982),c=n(9450),l=n(4912),f=n(1113),h=n(4211),d=n(6948),p=n(8550),g=n(4088);const m=Math.PI/180,y=new Float32Array(16),v=new Float32Array(12);function b(t,e,n){const r=e[0]*m,i=e[1]*m,o=e[2]*m,s=Math.sin(o),a=Math.sin(r),u=Math.sin(i),c=Math.cos(o),l=Math.cos(r),f=Math.cos(i),h=n[0],d=n[1],p=n[2];t[0]=h*f*l,t[1]=h*u*l,t[2]=h*-a,t[3]=d*(-u*c+f*a*s),t[4]=d*(f*c+u*a*s),t[5]=d*l*s,t[6]=p*(u*s+f*a*c),t[7]=p*(-f*s+u*a*c),t[8]=p*l*c}function x(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const w={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:o,getTranslation:s,getTransformMatrix:a}=this.props,u=Array.isArray(a),c=u&&16===a.length,l=Array.isArray(o),f=Array.isArray(i),h=Array.isArray(s),d=c||!u&&Boolean(a(r[0]));t.constant=d?c:f&&l&&h;const g=t.value;if(t.constant){let e;if(d)y.set(a),e=x(y);else{e=v;b(e,i,o),e.set(s,9)}t.value=new Float32Array(e)}else{let u=e*t.size;const{iterable:m,objectInfo:w}=(0,p.jB)(r,e,n);for(const t of m){let e;if(w.index++,d)y.set(c?a:a(t,w)),e=x(y);else{e=v;b(e,f?i:i(t,w),l?o:o(t,w)),e.set(h?s:s(t,w),9)}g[u++]=e[0],g[u++]=e[1],g[u++]=e[2],g[u++]=e[3],g[u++]=e[4],g[u++]=e[5],g[u++]=e[6],g[u++]=e[7],g[u++]=e[8],g[u++]=e[9],g[u++]=e[10],g[u++]=e[11]}}}};function _(t,e){return e===g.Df.CARTESIAN||e===g.Df.METER_OFFSETS||e===g.Df.DEFAULT&&!t.isGeospatial}function E(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),r.Z.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function A(t,e){if(t.attributes)return E(t.attributes,e),t instanceof u.Z?t:new u.Z(t);if(t.positions||t.POSITION)return E(t,e),new u.Z({attributes:t});throw Error("Invalid mesh")}const O={mesh:{value:null,type:"object",async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:[0,0,0,255]},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]}};class S extends i.Z{getShaders(){const t=!(0,c.D0)(this.context.gl),e={};return(0,h.U6)(this.context.gl,d.h.GLSL_DERIVATIVES)&&(e.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-vs\nuniform float sizeScale;\nuniform bool composeModelMatrix;\nin vec3 positions;\nin vec3 normals;\nin vec3 colors;\nin vec2 texCoords;\nin vec3 instancePositions;\nin vec3 instancePositions64Low;\nin vec4 instanceColors;\nin vec3 instancePickingColors;\nin mat3 instanceModelMatrix;\nin vec3 instanceTranslation;\nout vec2 vTexCoord;\nout vec3 cameraPosition;\nout vec3 normals_commonspace;\nout vec4 position_commonspace;\nout vec4 vColor;\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = instancePickingColors;\n\n  vTexCoord = texCoords;\n  cameraPosition = project_uCameraPosition;\n  normals_commonspace = project_normal(instanceModelMatrix * normals);\n  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);\n  geometry.normal = normals_commonspace;\n\n  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;\n\n  if (composeModelMatrix) {\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);\n  }\n  else {\n    pos = project_size(pos);\n    DECKGL_FILTER_SIZE(pos, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);\n  }\n\n  geometry.position = position_commonspace;\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#version 300 es\n#define SHADER_NAME simple-mesh-layer-fs\n\nprecision highp float;\n\nuniform bool hasTexture;\nuniform sampler2D sampler;\nuniform bool flatShading;\nuniform float opacity;\n\nin vec2 vTexCoord;\nin vec3 cameraPosition;\nin vec3 normals_commonspace;\nin vec4 position_commonspace;\nin vec4 vColor;\n\nout vec4 fragColor;\n\nvoid main(void) {\n  geometry.uv = vTexCoord;\n\n  vec3 normal;\n  if (flatShading) {\n#ifdef DERIVATIVES_AVAILABLE\n    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\n#else\n    normal = vec3(0.0, 0.0, 1.0);\n#endif\n  } else {\n    normal = normals_commonspace;\n  }\n\n  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;\n  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);\n  fragColor = vec4(lightColor, color.a * opacity);\n\n  DECKGL_FILTER_COLOR(fragColor, geometry);\n}\n",modules:[o.Z,s.s,a.Z],transpileToGLSL100:t,defines:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:w}),this.setState({emptyTexture:new l.Z(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState({props:t,oldProps:e,changeFlags:n}){if(super.updateState({props:t,oldProps:e,changeFlags:n}),t.mesh!==e.mesh||n.extensionsChanged){var r;if(null===(r=this.state.model)||void 0===r||r.delete(),t.mesh){this.state.model=this.getModel(t.mesh);const e=t.mesh.attributes||t.mesh;this.setState({hasNormals:Boolean(e.NORMAL||e.normals)})}this.getAttributeManager().invalidateAll()}t.texture!==e.texture&&this.setTexture(t.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(){super.finalizeState(),this.state.emptyTexture.delete()}draw({uniforms:t}){if(!this.state.model)return;const{viewport:e}=this.context,{sizeScale:n,coordinateSystem:r,_instanced:i}=this.props;this.state.model.setUniforms(t).setUniforms({sizeScale:n,composeModelMatrix:!i||_(e,r),flatShading:!this.state.hasNormals}).draw()}getModel(t){const e=new f.Z(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:A(t,this.props._useMeshColors),isInstanced:!0}),{texture:n}=this.props,{emptyTexture:r}=this.state;return e.setUniforms({sampler:n||r,hasTexture:Boolean(n)}),e}setTexture(t){const{emptyTexture:e,model:n}=this.state;null===n||void 0===n||n.setUniforms({sampler:t||e,hasTexture:Boolean(t)})}}S.layerName="SimpleMeshLayer",S.defaultProps=O},6024:function(t,e,n){"use strict";n.d(e,{Z:function(){return y}});var r=n(7294),i=n(5697),o=n.n(i),s=n(8646);var a="undefined"!==typeof window?r.useLayoutEffect:r.useEffect;function u(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}var c=n(4897),l=n(5522);function f(t){return t?"function"===typeof t?(0,r.createElement)(c.Z,{},t):Array.isArray(t)?t.map(f):t.type===r.Fragment?f(t.props.children):(u(t.type,c.Z),t):t}const h={position:"absolute",zIndex:-1};function d(t,e){return t?"function"===typeof t?t(e):Array.isArray(t)?t.map((t=>d(t,e))):function(t){const e=t&&t.type,n=e&&e.defaultProps;return n&&n.mapStyle}(t)?(e.style=h,(0,r.cloneElement)(t,e)):function(t){const e=t&&t.type;return e&&e.deckGLViewProps}(t)?(0,r.cloneElement)(t,e):t:t}const p={mixBlendMode:null};function g(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const m=(0,r.forwardRef)(((t,e)=>{const n=(0,r.useRef)({}).current,[i,o]=(0,r.useState)(0);n.forceUpdate=o;const h=(0,r.useRef)(null),m=(0,r.useRef)(null),y=(0,r.useMemo)((()=>function({children:t,layers:e,views:n}){const i=[],o=[],s={};return r.Children.forEach(f(t),(t=>{if(t){const e=t.type;if(u(e,l.Z)){const n=function(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}(e,t.props);o.push(n)}else i.push(t);if(e!==c.Z&&u(e,c.Z)&&t.props.id){const n=new e(t.props);s[n.id]=n}}})),Object.keys(s).length>0&&(Array.isArray(n)?n.forEach((t=>{s[t.id]=t})):n&&(s[n.id]=n),n=Object.values(s)),{layers:e=o.length>0?[...o,...e]:e,children:i,views:n}}(t)),[t.layers,t.views,t.children]);let v=!0;const b=e=>v&&t.viewState?(n.viewStateUpdateRequested=e,null):(n.viewStateUpdateRequested=null,t.onViewStateChange(e)),x=e=>{v?n.interactionStateUpdateRequested=e:(n.interactionStateUpdateRequested=null,t.onInteractionStateChange(e))},w=(0,r.useMemo)((()=>{const e={...t,style:null,width:"100%",height:"100%",layers:y.layers,views:y.views,onViewStateChange:b,onInteractionStateChange:x};return n.deck&&n.deck.setProps(e),e}),[t]);(0,r.useEffect)((()=>(n.deck=function(t,e){const n=new(e.Deck||s.Z)({...e,style:null,width:"100%",height:"100%",_customRender:e=>{t.redrawReason=e;const r=n.viewManager.getViewports();t.lastRenderedViewports!==r?t.forceUpdate((t=>t+1)):g(t)}});return n}(n,{...w,parent:h.current,canvas:m.current}),()=>n.deck.finalize())),[]),a((()=>{g(n);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=n;t&&b(t),e&&x(e)})),(0,r.useImperativeHandle)(e,(()=>function(t){const e={pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)};return Object.defineProperty(e,"deck",{get:()=>t.deck}),e}(n)),[]);const{viewManager:_}=n.deck||{},E=_&&_.getViewports(),{ContextProvider:A,width:O,height:S,id:C,style:M}=t,{containerStyle:P,canvasStyle:k}=(0,r.useMemo)((()=>function({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const o in n)o in p?i[o]=n[o]:r[o]=n[o];return{containerStyle:r,canvasStyle:i}}({width:O,height:S,style:M})),[O,S,M]);if(!n.viewStateUpdateRequested&&n.lastRenderedViewports===E||n.version!==i){n.lastRenderedViewports=E,n.version=i;const t=function({children:t,deck:e,ContextProvider:n}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const o={},s=i.views[0].id;for(const r of t){let t=s,e=r;u(r.type,c.Z)&&(t=r.props.id||s,e=r.props.children);const n=i.getViewport(t),a=i.getViewState(t);if(n){const{x:r,y:i,width:s,height:u}=n;e=d(e,{x:r,y:i,width:s,height:u,viewport:n,viewState:a}),o[t]||(o[t]={viewport:n,children:[]}),o[t].children.push(e)}}return Object.keys(o).map((t=>{const{viewport:i,children:s}=o[t],{x:a,y:u,width:c,height:l}=i,f={position:"absolute",left:a,top:u,width:c,height:l},h="view-".concat(t),d=(0,r.createElement)("div",{key:h,id:h,style:f},...s);if(n){const o={viewport:i,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:n=>{n.viewId=t,e._onViewStateChange(n)}};return(0,r.createElement)(n,{key:h,value:o},d)}return d}))}({children:y.children,deck:n.deck,ContextProvider:A}),e=(0,r.createElement)("canvas",{key:"canvas",id:C||"deckgl-overlay",ref:m,style:k});n.control=(0,r.createElement)("div",{id:"".concat(C||"deckgl","-wrapper"),ref:h,style:P},[e,t])}return v=!1,n.control}));m.propTypes=s.Z.getPropTypes(o()),m.defaultProps=s.Z.defaultProps;var y=m},7625:function(t,e,n){"use strict";function r(t){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),r.forEach((function(e){o(t,e,n[e])}))}return t}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,{G:function(){return Zt}});var u=function(){},c={},l={},f={mark:u,measure:u};try{"undefined"!==typeof window&&(c=window),"undefined"!==typeof document&&(l=document),"undefined"!==typeof MutationObserver&&MutationObserver,"undefined"!==typeof performance&&(f=performance)}catch(qt){}var h=(c.navigator||{}).userAgent,d=void 0===h?"":h,p=c,g=l,m=f,y=(p.document,!!g.documentElement&&!!g.head&&"function"===typeof g.addEventListener&&"function"===typeof g.createElement),v=(~d.indexOf("MSIE")||d.indexOf("Trident/"),"svg-inline--fa"),b="data-fa-i2svg",x=(function(){try{}catch(qt){return!1}}(),[1,2,3,4,5,6,7,8,9,10]),w=x.concat([11,12,13,14,15,16,17,18,19,20]),_={GROUP:"group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},E=(["xs","sm","lg","fw","ul","li","border","pull-left","pull-right","spin","pulse","rotate-90","rotate-180","rotate-270","flip-horizontal","flip-vertical","flip-both","stack","stack-1x","stack-2x","inverse","layers","layers-text","layers-counter",_.GROUP,_.SWAP_OPACITY,_.PRIMARY,_.SECONDARY].concat(x.map((function(t){return"".concat(t,"x")}))).concat(w.map((function(t){return"w-".concat(t)}))),p.FontAwesomeConfig||{});if(g&&"function"===typeof g.querySelector){[["data-family-prefix","familyPrefix"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach((function(t){var e=a(t,2),n=e[0],r=e[1],i=function(t){return""===t||"false"!==t&&("true"===t||t)}(function(t){var e=g.querySelector("script["+t+"]");if(e)return e.getAttribute(t)}(n));void 0!==i&&null!==i&&(E[r]=i)}))}var A=s({},{familyPrefix:"fa",replacementClass:v,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0},E);A.autoReplaceSvg||(A.observeMutations=!1);var O=s({},A);p.FontAwesomeConfig=O;var S=p||{};S.___FONT_AWESOME___||(S.___FONT_AWESOME___={}),S.___FONT_AWESOME___.styles||(S.___FONT_AWESOME___.styles={}),S.___FONT_AWESOME___.hooks||(S.___FONT_AWESOME___.hooks={}),S.___FONT_AWESOME___.shims||(S.___FONT_AWESOME___.shims=[]);var C=S.___FONT_AWESOME___,M=[];y&&((g.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(g.readyState)||g.addEventListener("DOMContentLoaded",(function t(){g.removeEventListener("DOMContentLoaded",t),1,M.map((function(t){return t()}))})));var P,k="pending",T="settled",D="fulfilled",F="rejected",j=function(){},L="undefined"!==typeof n.g&&"undefined"!==typeof n.g.process&&"function"===typeof n.g.process.emit,R="undefined"===typeof setImmediate?setTimeout:setImmediate,I=[];function N(){for(var t=0;t<I.length;t++)I[t][0](I[t][1]);I=[],P=!1}function B(t,e){I.push([t,e]),P||(P=!0,R(N,0))}function z(t){var e=t.owner,n=e._state,r=e._data,i=t[n],o=t.then;if("function"===typeof i){n=D;try{r=i(r)}catch(qt){Z(o,qt)}}$(o,r)||(n===D&&U(o,r),n===F&&Z(o,r))}function $(t,e){var n;try{if(t===e)throw new TypeError("A promises callback cannot return that same promise.");if(e&&("function"===typeof e||"object"===r(e))){var i=e.then;if("function"===typeof i)return i.call(e,(function(r){n||(n=!0,e===r?V(t,r):U(t,r))}),(function(e){n||(n=!0,Z(t,e))})),!0}}catch(qt){return n||Z(t,qt),!0}return!1}function U(t,e){t!==e&&$(t,e)||V(t,e)}function V(t,e){t._state===k&&(t._state=T,t._data=e,B(q,t))}function Z(t,e){t._state===k&&(t._state=T,t._data=e,B(G,t))}function W(t){t._then=t._then.forEach(z)}function q(t){t._state=D,W(t)}function G(t){t._state=F,W(t),!t._handled&&L&&n.g.process.emit("unhandledRejection",t._data,t)}function H(t){n.g.process.emit("rejectionHandled",t)}function X(t){if("function"!==typeof t)throw new TypeError("Promise resolver "+t+" is not a function");if(this instanceof X===!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._then=[],function(t,e){function n(t){Z(e,t)}try{t((function(t){U(e,t)}),n)}catch(qt){n(qt)}}(t,this)}X.prototype={constructor:X,_state:k,_then:null,_data:void 0,_handled:!1,then:function(t,e){var n={owner:this,then:new this.constructor(j),fulfilled:t,rejected:e};return!e&&!t||this._handled||(this._handled=!0,this._state===F&&L&&B(H,this)),this._state===D||this._state===F?B(z,n):this._then.push(n),n.then},catch:function(t){return this.then(null,t)}},X.all=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.all().");return new X((function(e,n){var r=[],i=0;function o(t){return i++,function(n){r[t]=n,--i||e(r)}}for(var s,a=0;a<t.length;a++)(s=t[a])&&"function"===typeof s.then?s.then(o(a),n):r[a]=s;i||e(r)}))},X.race=function(t){if(!Array.isArray(t))throw new TypeError("You must pass an array to Promise.race().");return new X((function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&"function"===typeof r.then?r.then(e,n):e(r)}))},X.resolve=function(t){return t&&"object"===r(t)&&t.constructor===X?t:new X((function(e){e(t)}))},X.reject=function(t){return new X((function(e,n){n(t)}))};var Y={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};function K(t){if(t&&y){var e=g.createElement("style");e.setAttribute("type","text/css"),e.innerHTML=t;for(var n=g.head.childNodes,r=null,i=n.length-1;i>-1;i--){var o=n[i],s=(o.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(s)>-1&&(r=o)}return g.head.insertBefore(e,r),t}}function J(){for(var t=12,e="";t-- >0;)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[62*Math.random()|0];return e}function Q(t){return"".concat(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function tt(t){return Object.keys(t||{}).reduce((function(e,n){return e+"".concat(n,": ").concat(t[n],";")}),"")}function et(t){return t.size!==Y.size||t.x!==Y.x||t.y!==Y.y||t.rotate!==Y.rotate||t.flipX||t.flipY}function nt(t){var e=t.transform,n=t.containerWidth,r=t.iconWidth,i={transform:"translate(".concat(n/2," 256)")},o="translate(".concat(32*e.x,", ").concat(32*e.y,") "),s="scale(".concat(e.size/16*(e.flipX?-1:1),", ").concat(e.size/16*(e.flipY?-1:1),") "),a="rotate(".concat(e.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(s," ").concat(a)},path:{transform:"translate(".concat(r/2*-1," -256)")}}}var rt={x:0,y:0,width:"100%",height:"100%"};function it(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t.attributes&&(t.attributes.fill||e)&&(t.attributes.fill="black"),t}function ot(t){var e=t.icons,n=e.main,r=e.mask,i=t.prefix,o=t.iconName,a=t.transform,u=t.symbol,c=t.title,l=t.maskId,f=t.titleId,h=t.extra,d=t.watchable,p=void 0!==d&&d,g=r.found?r:n,m=g.width,y=g.height,v="fak"===i,x=v?"":"fa-w-".concat(Math.ceil(m/y*16)),w=[O.replacementClass,o?"".concat(O.familyPrefix,"-").concat(o):"",x].filter((function(t){return-1===h.classes.indexOf(t)})).filter((function(t){return""!==t||!!t})).concat(h.classes).join(" "),_={children:[],attributes:s({},h.attributes,{"data-prefix":i,"data-icon":o,class:w,role:h.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(m," ").concat(y)})},E=v&&!~h.classes.indexOf("fa-fw")?{width:"".concat(m/y*16*.0625,"em")}:{};p&&(_.attributes[b]=""),c&&_.children.push({tag:"title",attributes:{id:_.attributes["aria-labelledby"]||"title-".concat(f||J())},children:[c]});var A=s({},_,{prefix:i,iconName:o,main:n,mask:r,maskId:l,transform:a,symbol:u,styles:s({},E,h.styles)}),S=r.found&&n.found?function(t){var e,n=t.children,r=t.attributes,i=t.main,o=t.mask,a=t.maskId,u=t.transform,c=i.width,l=i.icon,f=o.width,h=o.icon,d=nt({transform:u,containerWidth:f,iconWidth:c}),p={tag:"rect",attributes:s({},rt,{fill:"white"})},g=l.children?{children:l.children.map(it)}:{},m={tag:"g",attributes:s({},d.inner),children:[it(s({tag:l.tag,attributes:s({},l.attributes,d.path)},g))]},y={tag:"g",attributes:s({},d.outer),children:[m]},v="mask-".concat(a||J()),b="clip-".concat(a||J()),x={tag:"mask",attributes:s({},rt,{id:v,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"}),children:[p,y]},w={tag:"defs",children:[{tag:"clipPath",attributes:{id:b},children:(e=h,"g"===e.tag?e.children:[e])},x]};return n.push(w,{tag:"rect",attributes:s({fill:"currentColor","clip-path":"url(#".concat(b,")"),mask:"url(#".concat(v,")")},rt)}),{children:n,attributes:r}}(A):function(t){var e=t.children,n=t.attributes,r=t.main,i=t.transform,o=tt(t.styles);if(o.length>0&&(n.style=o),et(i)){var a=nt({transform:i,containerWidth:r.width,iconWidth:r.width});e.push({tag:"g",attributes:s({},a.outer),children:[{tag:"g",attributes:s({},a.inner),children:[{tag:r.icon.tag,children:r.icon.children,attributes:s({},r.icon.attributes,a.path)}]}]})}else e.push(r.icon);return{children:e,attributes:n}}(A),C=S.children,M=S.attributes;return A.children=C,A.attributes=M,u?function(t){var e=t.prefix,n=t.iconName,r=t.children,i=t.attributes,o=t.symbol;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:s({},i,{id:!0===o?"".concat(e,"-").concat(O.familyPrefix,"-").concat(n):o}),children:r}]}]}(A):function(t){var e=t.children,n=t.main,r=t.mask,i=t.attributes,o=t.styles,a=t.transform;if(et(a)&&n.found&&!r.found){var u={x:n.width/n.height/2,y:.5};i.style=tt(s({},o,{"transform-origin":"".concat(u.x+a.x/16,"em ").concat(u.y+a.y/16,"em")}))}return[{tag:"svg",attributes:i,children:e}]}(A)}var st=function(){},at=(O.measurePerformance&&m&&m.mark&&m.measure,function(t,e,n,r){var i,o,s,a=Object.keys(t),u=a.length,c=void 0!==r?function(t,e){return function(n,r,i,o){return t.call(e,n,r,i,o)}}(e,r):e;for(void 0===n?(i=1,s=t[a[0]]):(i=0,s=n);i<u;i++)s=c(s,t[o=a[i]],o,t);return s});function ut(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.skipHooks,i=void 0!==r&&r,o=Object.keys(e).reduce((function(t,n){var r=e[n];return!!r.icon?t[r.iconName]=r.icon:t[n]=r,t}),{});"function"!==typeof C.hooks.addPack||i?C.styles[t]=s({},C.styles[t]||{},o):C.hooks.addPack(t,o),"fas"===t&&ut("fa",e)}var ct=C.styles,lt=C.shims,ft=function(){var t=function(t){return at(ct,(function(e,n,r){return e[r]=at(n,t,{}),e}),{})};t((function(t,e,n){return e[3]&&(t[e[3]]=n),t})),t((function(t,e,n){var r=e[2];return t[n]=n,r.forEach((function(e){t[e]=n})),t}));var e="far"in ct;at(lt,(function(t,n){var r=n[0],i=n[1],o=n[2];return"far"!==i||e||(i="fas"),t[r]={prefix:i,iconName:o},t}),{})};ft();C.styles;function ht(t,e,n){if(t&&t[e]&&t[e][n])return{prefix:e,iconName:n,icon:t[e][n]}}function dt(t){var e=t.tag,n=t.attributes,r=void 0===n?{}:n,i=t.children,o=void 0===i?[]:i;return"string"===typeof t?Q(t):"<".concat(e," ").concat(function(t){return Object.keys(t||{}).reduce((function(e,n){return e+"".concat(n,'="').concat(Q(t[n]),'" ')}),"").trim()}(r),">").concat(o.map(dt).join(""),"</").concat(e,">")}var pt=function(t){var e={size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0};return t?t.toLowerCase().split(" ").reduce((function(t,e){var n=e.toLowerCase().split("-"),r=n[0],i=n.slice(1).join("-");if(r&&"h"===i)return t.flipX=!0,t;if(r&&"v"===i)return t.flipY=!0,t;if(i=parseFloat(i),isNaN(i))return t;switch(r){case"grow":t.size=t.size+i;break;case"shrink":t.size=t.size-i;break;case"left":t.x=t.x-i;break;case"right":t.x=t.x+i;break;case"up":t.y=t.y-i;break;case"down":t.y=t.y+i;break;case"rotate":t.rotate=t.rotate+i}return t}),e):e};function gt(t){this.name="MissingIcon",this.message=t||"Icon unavailable",this.stack=(new Error).stack}gt.prototype=Object.create(Error.prototype),gt.prototype.constructor=gt;var mt={fill:"currentColor"},yt={attributeType:"XML",repeatCount:"indefinite",dur:"2s"},vt={tag:"path",attributes:s({},mt,{d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"})},bt=s({},yt,{attributeName:"opacity"});s({},mt,{cx:"256",cy:"364",r:"28"}),s({},yt,{attributeName:"r",values:"28;14;28;28;14;28;"}),s({},bt,{values:"1;0;1;1;0;1;"}),s({},mt,{opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"}),s({},bt,{values:"1;0;0;0;0;1;"}),s({},mt,{opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"}),s({},bt,{values:"0;0;1;1;0;0;"}),C.styles;function xt(t){var e=t[0],n=t[1],r=a(t.slice(4),1)[0];return{found:!0,width:e,height:n,icon:Array.isArray(r)?{tag:"g",attributes:{class:"".concat(O.familyPrefix,"-").concat(_.GROUP)},children:[{tag:"path",attributes:{class:"".concat(O.familyPrefix,"-").concat(_.SECONDARY),fill:"currentColor",d:r[0]}},{tag:"path",attributes:{class:"".concat(O.familyPrefix,"-").concat(_.PRIMARY),fill:"currentColor",d:r[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:r}}}}C.styles;function wt(){var t="fa",e=v,n=O.familyPrefix,r=O.replacementClass,i='svg:not(:root).svg-inline--fa {\n  overflow: visible;\n}\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.225em;\n}\n.svg-inline--fa.fa-w-1 {\n  width: 0.0625em;\n}\n.svg-inline--fa.fa-w-2 {\n  width: 0.125em;\n}\n.svg-inline--fa.fa-w-3 {\n  width: 0.1875em;\n}\n.svg-inline--fa.fa-w-4 {\n  width: 0.25em;\n}\n.svg-inline--fa.fa-w-5 {\n  width: 0.3125em;\n}\n.svg-inline--fa.fa-w-6 {\n  width: 0.375em;\n}\n.svg-inline--fa.fa-w-7 {\n  width: 0.4375em;\n}\n.svg-inline--fa.fa-w-8 {\n  width: 0.5em;\n}\n.svg-inline--fa.fa-w-9 {\n  width: 0.5625em;\n}\n.svg-inline--fa.fa-w-10 {\n  width: 0.625em;\n}\n.svg-inline--fa.fa-w-11 {\n  width: 0.6875em;\n}\n.svg-inline--fa.fa-w-12 {\n  width: 0.75em;\n}\n.svg-inline--fa.fa-w-13 {\n  width: 0.8125em;\n}\n.svg-inline--fa.fa-w-14 {\n  width: 0.875em;\n}\n.svg-inline--fa.fa-w-15 {\n  width: 0.9375em;\n}\n.svg-inline--fa.fa-w-16 {\n  width: 1em;\n}\n.svg-inline--fa.fa-w-17 {\n  width: 1.0625em;\n}\n.svg-inline--fa.fa-w-18 {\n  width: 1.125em;\n}\n.svg-inline--fa.fa-w-19 {\n  width: 1.1875em;\n}\n.svg-inline--fa.fa-w-20 {\n  width: 1.25em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: 0.3em;\n  width: auto;\n}\n.svg-inline--fa.fa-border {\n  height: 1.5em;\n}\n.svg-inline--fa.fa-li {\n  width: 2em;\n}\n.svg-inline--fa.fa-fw {\n  width: 1.25em;\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: 0.25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left;\n}\n\n.fa-lg {\n  font-size: 1.3333333333em;\n  line-height: 0.75em;\n  vertical-align: -0.0667em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit;\n}\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: 0.1em;\n  padding: 0.2em 0.25em 0.15em;\n}\n\n.fa-pull-left {\n  float: left;\n}\n\n.fa-pull-right {\n  float: right;\n}\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: 0.3em;\n}\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: 0.3em;\n}\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear;\n}\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8);\n}\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=1)";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2)";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=3)";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1);\n}\n\n.fa-flip-both, .fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1);\n}\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical,\n:root .fa-flip-both {\n  -webkit-filter: none;\n          filter: none;\n}\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: #fff;\n}\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px;\n}\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: 0.4;\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: 1;\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse {\n  color: #fff;\n}';if(n!==t||r!==e){var o=new RegExp("\\.".concat(t,"\\-"),"g"),s=new RegExp("\\--".concat(t,"\\-"),"g"),a=new RegExp("\\.".concat(e),"g");i=i.replace(o,".".concat(n,"-")).replace(s,"--".concat(n,"-")).replace(a,".".concat(r))}return i}function _t(){O.autoAddCss&&!Ct&&(K(wt()),Ct=!0)}function Et(t,e){return Object.defineProperty(t,"abstract",{get:e}),Object.defineProperty(t,"html",{get:function(){return t.abstract.map((function(t){return dt(t)}))}}),Object.defineProperty(t,"node",{get:function(){if(y){var e=g.createElement("div");return e.innerHTML=t.html,e.children}}}),t}function At(t){var e=t.prefix,n=void 0===e?"fa":e,r=t.iconName;if(r)return ht(St.definitions,n,r)||ht(C.styles,n,r)}var Ot,St=new(function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.definitions={}}var e,n,r;return e=t,(n=[{key:"add",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n.reduce(this._pullDefinitions,{});Object.keys(i).forEach((function(e){t.definitions[e]=s({},t.definitions[e]||{},i[e]),ut(e,i[e]),ft()}))}},{key:"reset",value:function(){this.definitions={}}},{key:"_pullDefinitions",value:function(t,e){var n=e.prefix&&e.iconName&&e.icon?{0:e}:e;return Object.keys(n).map((function(e){var r=n[e],i=r.prefix,o=r.iconName,s=r.icon;t[i]||(t[i]={}),t[i][o]=s})),t}}])&&i(e.prototype,n),r&&i(e,r),t}()),Ct=!1,Mt={transform:function(t){return pt(t)}},Pt=(Ot=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.transform,r=void 0===n?Y:n,i=e.symbol,o=void 0!==i&&i,a=e.mask,u=void 0===a?null:a,c=e.maskId,l=void 0===c?null:c,f=e.title,h=void 0===f?null:f,d=e.titleId,p=void 0===d?null:d,g=e.classes,m=void 0===g?[]:g,y=e.attributes,v=void 0===y?{}:y,b=e.styles,x=void 0===b?{}:b;if(t){var w=t.prefix,_=t.iconName,E=t.icon;return Et(s({type:"icon"},t),(function(){return _t(),O.autoA11y&&(h?v["aria-labelledby"]="".concat(O.replacementClass,"-title-").concat(p||J()):(v["aria-hidden"]="true",v.focusable="false")),ot({icons:{main:xt(E),mask:u?xt(u.icon):{found:!1,width:null,height:null,icon:{}}},prefix:w,iconName:_,transform:s({},Y,r),symbol:o,title:h,maskId:l,titleId:p,extra:{attributes:v,styles:x,classes:m}})}))}},function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(t||{}).icon?t:At(t||{}),r=e.mask;return r&&(r=(r||{}).icon?r:At(r||{})),Ot(n,s({},e,{mask:r}))}),kt=n(5697),Tt=n.n(kt),Dt=n(7294);function Ft(t){return(Ft="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lt(Object(n),!0).forEach((function(e){jt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function It(t,e){if(null==t)return{};var n,r,i=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}function Nt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Bt(t){return e=t,(e-=0)===e?t:(t=t.replace(/[\-_\s]+(.)?/g,(function(t,e){return e?e.toUpperCase():""}))).substr(0,1).toLowerCase()+t.substr(1);var e}function zt(t){return t.split(";").map((function(t){return t.trim()})).filter((function(t){return t})).reduce((function(t,e){var n,r=e.indexOf(":"),i=Bt(e.slice(0,r)),o=e.slice(r+1).trim();return i.startsWith("webkit")?t[(n=i,n.charAt(0).toUpperCase()+n.slice(1))]=o:t[i]=o,t}),{})}var $t=!1;try{$t=!0}catch(qt){}function Ut(t){return t&&"object"===Ft(t)&&t.prefix&&t.iconName&&t.icon?t:Mt.icon?Mt.icon(t):null===t?null:t&&"object"===Ft(t)&&t.prefix&&t.iconName?t:Array.isArray(t)&&2===t.length?{prefix:t[0],iconName:t[1]}:"string"===typeof t?{prefix:"fas",iconName:t}:void 0}function Vt(t,e){return Array.isArray(e)&&e.length>0||!Array.isArray(e)&&e?jt({},t,e):{}}function Zt(t){var e=t.forwardedRef,n=It(t,["forwardedRef"]),r=n.icon,i=n.mask,o=n.symbol,s=n.className,a=n.title,u=n.titleId,c=Ut(r),l=Vt("classes",[].concat(Nt(function(t){var e,n=t.spin,r=t.pulse,i=t.fixedWidth,o=t.inverse,s=t.border,a=t.listItem,u=t.flip,c=t.size,l=t.rotation,f=t.pull,h=(jt(e={"fa-spin":n,"fa-pulse":r,"fa-fw":i,"fa-inverse":o,"fa-border":s,"fa-li":a,"fa-flip-horizontal":"horizontal"===u||"both"===u,"fa-flip-vertical":"vertical"===u||"both"===u},"fa-".concat(c),"undefined"!==typeof c&&null!==c),jt(e,"fa-rotate-".concat(l),"undefined"!==typeof l&&null!==l&&0!==l),jt(e,"fa-pull-".concat(f),"undefined"!==typeof f&&null!==f),jt(e,"fa-swap-opacity",t.swapOpacity),e);return Object.keys(h).map((function(t){return h[t]?t:null})).filter((function(t){return t}))}(n)),Nt(s.split(" ")))),f=Vt("transform","string"===typeof n.transform?Mt.transform(n.transform):n.transform),h=Vt("mask",Ut(i)),d=Pt(c,Rt({},l,{},f,{},h,{symbol:o,title:a,titleId:u}));if(!d)return function(){var t;!$t&&console&&"function"===typeof console.error&&(t=console).error.apply(t,arguments)}("Could not find icon",c),null;var p=d.abstract,g={ref:e};return Object.keys(n).forEach((function(t){Zt.defaultProps.hasOwnProperty(t)||(g[t]=n[t])})),Wt(p[0],g)}Zt.displayName="FontAwesomeIcon",Zt.propTypes={border:Tt().bool,className:Tt().string,mask:Tt().oneOfType([Tt().object,Tt().array,Tt().string]),fixedWidth:Tt().bool,inverse:Tt().bool,flip:Tt().oneOf(["horizontal","vertical","both"]),icon:Tt().oneOfType([Tt().object,Tt().array,Tt().string]),listItem:Tt().bool,pull:Tt().oneOf(["right","left"]),pulse:Tt().bool,rotation:Tt().oneOf([0,90,180,270]),size:Tt().oneOf(["lg","xs","sm","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:Tt().bool,symbol:Tt().oneOfType([Tt().bool,Tt().string]),title:Tt().string,transform:Tt().oneOfType([Tt().string,Tt().object]),swapOpacity:Tt().bool},Zt.defaultProps={border:!1,className:"",mask:null,fixedWidth:!1,inverse:!1,flip:null,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,symbol:!1,title:"",transform:null,swapOpacity:!1};var Wt=function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof n)return n;var i=(n.children||[]).map((function(n){return t(e,n)})),o=Object.keys(n.attributes||{}).reduce((function(t,e){var r=n.attributes[e];switch(e){case"class":t.attrs.className=r,delete n.attributes.class;break;case"style":t.attrs.style=zt(r);break;default:0===e.indexOf("aria-")||0===e.indexOf("data-")?t.attrs[e.toLowerCase()]=r:t.attrs[Bt(e)]=r}return t}),{attrs:{}}),s=r.style,a=void 0===s?{}:s,u=It(r,["style"]);return o.attrs.style=Rt({},o.attrs.style,{},a),e.apply(void 0,[n.tag,Rt({},o.attrs,{},u)].concat(Nt(i)))}.bind(null,Dt.createElement)},6255:function(t,e,n){"use strict";n.d(e,{Kn:function(){return o},Ss:function(){return s},TW:function(){return a},D0:function(){return u},Ew:function(){return c},Lj:function(){return l},zH:function(){return f},Os:function(){return h}});const r=t=>"boolean"===typeof t,i=t=>"function"===typeof t,o=t=>null!==t&&"object"===typeof t,s=t=>o(t)&&t.constructor==={}.constructor,a=t=>t&&"function"===typeof t[Symbol.iterator],u=t=>t&&"function"===typeof t[Symbol.asyncIterator],c=t=>"undefined"!==typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,l=t=>"undefined"!==typeof Blob&&t instanceof Blob,f=t=>t&&"object"===typeof t&&t.isBuffer,h=t=>(t=>"undefined"!==typeof ReadableStream&&t instanceof ReadableStream||o(t)&&i(t.tee)&&i(t.cancel)&&i(t.getReader))(t)||(t=>o(t)&&i(t.read)&&i(t.pipe)&&r(t.readable))(t)},9787:function(t,e,n){"use strict";n.d(e,{z:function(){return W}});var r=n(6255),i=n(5596),o=n(7504);function s(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}var a=n(4942),u=n(4155);"undefined"!==typeof self&&self,"undefined"!==typeof window&&window,"undefined"!==typeof n.g&&n.g,"undefined"!==typeof document&&document,"object"!==typeof u||String(u);const c="undefined"!==typeof window&&"undefined"!==typeof window.orientation,l="undefined"!==typeof u&&u.version&&/v([0-9]*)/.exec(u.version),f=(l&&parseFloat(l[1]),new Map);function h(t){s(t.source&&!t.url||!t.source&&t.url);let e=f.get(t.source||t.url);return e||(t.url&&(e=function(t){if(!t.startsWith("http"))return t;return d((e=t,`try {\n  importScripts('${e}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`));var e}(t.url),f.set(t.url,e)),t.source&&(e=d(t.source),f.set(t.source,e))),s(e),e}function d(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function p(t,e=!0,n){const r=n||new Set;if(t){if(g(t))r.add(t);else if(g(t.buffer))r.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"===typeof t)for(const i in t)p(t[i],e,r)}else;return void 0===n?Array.from(r):[]}function g(t){return!!t&&(t instanceof ArrayBuffer||("undefined"!==typeof MessagePort&&t instanceof MessagePort||("undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!==typeof OffscreenCanvas&&t instanceof OffscreenCanvas)))}const m=()=>{};class y{static isSupported(){return"undefined"!==typeof Worker}constructor(t){(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"source",void 0),(0,a.Z)(this,"url",void 0),(0,a.Z)(this,"terminated",!1),(0,a.Z)(this,"worker",void 0),(0,a.Z)(this,"onMessage",void 0),(0,a.Z)(this,"onError",void 0),(0,a.Z)(this,"_loadableURL","");const{name:e,source:n,url:r}=t;s(n||r),this.name=e,this.source=n,this.url=r,this.onMessage=m,this.onError=t=>console.log(t),this.worker=this._createBrowserWorker()}destroy(){this.onMessage=m,this.onError=m,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||p(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+=`worker ${this.name}. `,t.message&&(e+=`${t.message} in `),t.lineno&&(e+=`:${t.lineno}:${t.colno}`),new Error(e)}_createBrowserWorker(){this._loadableURL=h({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}}class v{constructor(t,e){(0,a.Z)(this,"name",void 0),(0,a.Z)(this,"workerThread",void 0),(0,a.Z)(this,"isRunning",void 0),(0,a.Z)(this,"result",void 0),(0,a.Z)(this,"_resolve",void 0),(0,a.Z)(this,"_reject",void 0),this.name=t,this.workerThread=e,this.isRunning=!0,this._resolve=()=>{},this._reject=()=>{},this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){s(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){s(this.isRunning),this.isRunning=!1,this._reject(t)}}class b{constructor(t){(0,a.Z)(this,"name","unnamed"),(0,a.Z)(this,"source",void 0),(0,a.Z)(this,"url",void 0),(0,a.Z)(this,"maxConcurrency",1),(0,a.Z)(this,"maxMobileConcurrency",1),(0,a.Z)(this,"onDebug",(()=>{})),(0,a.Z)(this,"reuseWorkers",!0),(0,a.Z)(this,"props",{}),(0,a.Z)(this,"jobQueue",[]),(0,a.Z)(this,"idleQueue",[]),(0,a.Z)(this,"count",0),(0,a.Z)(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t,e=((t,e,n)=>t.done(n)),n=((t,e)=>t.error(e))){const r=new Promise((r=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:r}),this)));return this._startQueuedJob(),await r}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new v(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new y({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return c?this.maxMobileConcurrency:this.maxConcurrency}}const x={maxConcurrency:3,maxMobileConcurrency:1,onDebug:()=>{},reuseWorkers:!0};class w{static isSupported(){return y.isSupported()}static getWorkerFarm(t={}){return w._workerFarm=w._workerFarm||new w({}),w._workerFarm.setProps(t),w._workerFarm}constructor(t){(0,a.Z)(this,"props",void 0),(0,a.Z)(this,"workerPools",new Map),this.props={...x},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy()}setProps(t){this.props={...this.props,...t};for(const e of this.workerPools.values())e.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:r}=t;let i=this.workerPools.get(e);return i||(i=new b({name:e,source:n,url:r}),i.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,i)),i}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}(0,a.Z)(w,"_workerFarm",void 0);async function _(t,e,n,r,i){const o=t.id,a=function(t,e={}){const n=e[t.id]||{},r=`${t.id}-worker.js`;let i=n.workerUrl;if("test"===e._workerType&&(i=`modules/${t.module}/dist/${r}`),!i){let e=t.version;"latest"===e&&(e="latest");const n=e?`@${e}`:"";i=`https://unpkg.com/@loaders.gl/${t.module}${n}/dist/${r}`}return s(i),i}(t,n),u=w.getWorkerFarm(n).getWorkerPool({name:o,url:a});n=JSON.parse(JSON.stringify(n));const c=await u.startJob("process-on-worker",E.bind(null,i));c.postMessage("process",{input:e,options:n});const l=await c.result;return await l.result}async function E(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(r.error);break;case"process":const{id:o,input:s,options:a}=r;try{const n=await t(s,a);e.postMessage("done",{id:o,result:n})}catch(i){const t=i instanceof Error?i.message:"unknown error";e.postMessage("error",{id:o,error:t})}break;default:console.warn(`parse-with-worker unknown message ${n}`)}}var A=n(9521);function O(t){var e;if((e=t)&&"object"===typeof e&&e.isBuffer&&(t=function(t){return A.toArrayBuffer?A.toArrayBuffer(t):t}(t)),t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"===typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"===typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}async function S(t){const e=[];for await(const n of t)e.push(n);return function(...t){const e=t.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),n=e.reduce(((t,e)=>t+e.byteLength),0),r=new Uint8Array(n);let i=0;for(const o of e)r.set(o,i),i+=o.byteLength;return r.buffer}(...e)}const C=262144;var M=n(4959);function P(t,e){return M.jU?async function*(t,e){const n=t.getReader();let r;try{for(;;){const t=r||n.read();null!==e&&void 0!==e&&e._streamReadAhead&&(r=n.read());const{done:i,value:o}=await t;if(i)return;yield O(o)}}catch(i){n.releaseLock()}}(t,e):async function*(t,e){for await(const n of t)yield O(n)}(t)}function k(t,e){if("string"===typeof t)return function*(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||262144;let r=0;const i=new TextEncoder;for(;r<t.length;){const e=Math.min(t.length-r,n),o=t.slice(r,r+e);r+=e,yield i.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t,e={}){const{chunkSize:n=C}=e;let r=0;for(;r<t.byteLength;){const e=Math.min(t.byteLength-r,n),i=new ArrayBuffer(e),o=new Uint8Array(t,r,e);new Uint8Array(i).set(o),r+=e,yield i}}(t,e);if((0,r.Lj)(t))return async function*(t,e){const n=(null===e||void 0===e?void 0:e.chunkSize)||1048576;let r=0;for(;r<t.size;){const e=r+n,i=await t.slice(r,e).arrayBuffer();r=e,yield i}}(t,e);if((0,r.Os)(t))return P(t,e);if((0,r.Ew)(t)){return P(t.body,e)}throw new Error("makeIterator")}var T=n(7927);const D="Cannot convert supplied data type";async function F(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"===typeof t||i)return function(t,e,n){if(e.text&&"string"===typeof t)return t;if((0,r.zH)(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const r=t.byteLength||t.length;return 0===t.byteOffset&&r===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+r)),n}throw new Error(D)}(t,e);if((0,r.Lj)(t)&&(t=await(0,T.L1)(t)),(0,r.Ew)(t)){const n=t;return await(0,T.mm)(n),e.binary?await n.arrayBuffer():await n.text()}if((0,r.Os)(t)&&(t=k(t,n)),(0,r.TW)(t)||(0,r.D0)(t))return S(t);throw new Error(D)}var j=n(9752),L=n(6228);const R=/\.([^.]+)$/;function I(t,e=[],n,r){if(!N(t))return null;if(e&&!Array.isArray(e))return(0,i.T)(e);let o=[];e&&(o=o.concat(e)),null!==n&&void 0!==n&&n.ignoreRegisteredLoaders||o.push(...(0,L.kO)()),function(t){for(const e of t)(0,i.T)(e)}(o);const s=function(t,e,n,r){const{url:i,type:o}=(0,j.l)(t),s=i||(null===r||void 0===r?void 0:r.url);let a=null;null!==n&&void 0!==n&&n.mimeType&&(a=z(e,null===n||void 0===n?void 0:n.mimeType));return a=a||function(t,e){const n=e&&R.exec(e),r=n&&n[1];return r?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,r):null}(e,s),a=a||z(e,o),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"===typeof e){if($(e,n))return n}else if(ArrayBuffer.isView(e)){if(U(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer){if(U(e,0,n))return n}return null}(e,t),a=a||z(e,null===n||void 0===n?void 0:n.fallbackMimeType),a}(t,o,n,r);if(!s&&(null===n||void 0===n||!n.nothrow))throw new Error(B(t));return s}function N(t){return!(t instanceof Response&&204===t.status)}function B(t){const{url:e,type:n}=(0,j.l)(t);let r="No valid loader found";return t&&(r+=` data: "${function(t,e=5){if("string"===typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return V(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return V(t,0,e)}return""}(t)}", contentType: "${n}"`),e&&(r+=` url: ${e}`),r}function z(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e===`application/x.${n.id}`)return n}return null}function $(t,e){if(e.testText)return e.testText(t);return(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function U(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((r=>function(t,e,n,r){if(r instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":return r===V(t,e,r.length);default:return!1}}(t,e,n,r)))}function V(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}async function Z(t,e,n,a){s(!a||"object"===typeof a),!e||Array.isArray(e)||(0,i.C)(e)||(a=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:u}=(0,j.l)(t),c=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,a),l=await async function(t,e=[],n,i){if(!N(t))return null;let o=I(t,e,{...n,nothrow:!0},i);if(o)return o;if((0,r.Lj)(t)&&(o=I(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!o&&(null===n||void 0===n||!n.nothrow))throw new Error(B(t));return o}(t,c,n);return l?(a=function(t,e,n=null){if(n)return n;const r={fetch:(0,o.bV)(e,t),...t};return Array.isArray(r.loaders)||(r.loaders=null),r}({url:u,parse:Z,loaders:c},n=(0,o.GR)(n,l,c,u),a),await async function(t,e,n,r){if(function(t,e="3.0.12"){s(t,"no worker provided");const n=t.version}(t),e=await F(e,t,n),t.parseTextSync&&"string"===typeof e)return n.dataType="text",t.parseTextSync(e,n,r,t);if(function(t,e){return!!w.isSupported()&&t.worker&&(null===e||void 0===e?void 0:e.worker)}(t,n))return await _(t,e,n,0,Z);if(t.parseText&&"string"===typeof e)return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw s(!t.parseSync),new Error(`${t.id} loader - no parser found and worker is disabled`)}(l,t,n,a)):null}async function W(t,e,n,s){Array.isArray(e)||(0,i.C)(e)||(void 0,n=e,e=void 0);const a=(0,o.bV)(n);let u=t;return"string"===typeof t&&(u=await a(t)),(0,r.Lj)(t)&&(u=await a(t)),await Z(u,e,n)}},6228:function(t,e,n){"use strict";n.d(e,{fh:function(){return s},kO:function(){return a}});var r=n(5596),i=n(7504);const o=()=>{const t=(0,i.rx)();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function s(t){const e=o();t=Array.isArray(t)?t:[t];for(const n of t){const t=(0,r.T)(n);e.find((e=>t===e))||e.unshift(t)}}function a(){return o()}},5596:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function i(t){var e;if(!t)return!1;Array.isArray(t)&&(t=t[0]);return Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions)}function o(t){var e,n;let o;return r(t,"null loader"),r(i(t),"invalid loader"),Array.isArray(t)&&(o=t[1],t=t[0],t={...t,options:{...t.options,...o}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}n.d(e,{C:function(){return i},T:function(){return o}})},7504:function(t,e,n){"use strict";n.d(e,{bV:function(){return y},rx:function(){return p},GR:function(){return m}});var r=n(4959),i=n(6255);let o="";const s={};var a=n(7927);async function u(t,e){if("string"===typeof t){t=function(t){for(const e in s)if(t.startsWith(e)){const n=s[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t=`${o}${t}`),t}(t);let n=e;return null!==e&&void 0!==e&&e.fetch&&"function"!==typeof(null===e||void 0===e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await(0,a.L1)(t)}var c=n(4942);const l=new(n(4708).Z)({id:"loaders.gl"});class f{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}const h={fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){(0,c.Z)(this,"console",void 0),this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},d={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function p(){r.CO.loaders=r.CO.loaders||{};const{loaders:t}=r.CO;return t._state=t._state||{},t._state}const g=()=>{const t=p();return t.globalOptions=t.globalOptions||{...h},t.globalOptions};function m(t,e,n,r){return n=n||[],function(t,e){v(t,null,h,d,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};v(r,n.id,i,o,e)}}(t,n=Array.isArray(n)?n:[n]),x(e,t,r)}function y(t,e){const n=g(),r=t||n;return"function"===typeof r.fetch?r.fetch:(0,i.Kn)(r.fetch)?t=>u(t,r):null!==e&&void 0!==e&&e.fetch?null===e||void 0===e?void 0:e.fetch:u}function v(t,e,n,r,o){const s=e||"Top level",a=e?`${e}.`:"";for(const u in t){const c=!e&&(0,i.Kn)(t[u]),f="baseUri"===u&&!e,h="workerUrl"===u&&e;if(!(u in n)&&!f&&!h)if(u in r)l.warn(`${s} loader option '${a}${u}' no longer supported, use '${r[u]}'`)();else if(!c){const t=b(u,o);l.warn(`${s} loader option '${a}${u}' not recognized. ${t}`)()}}}function b(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const e in i.options){if(t===e)return`Did you mean '${i.id}.${e}'?`;const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(r=r||`Did you mean '${i.id}.${e}'?`)}return r}function x(t,e,n){const r={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(r,n),null===r.log&&(r.log=new f),w(r,g()),w(r,e),r}function w(t,e){for(const n in e)if(n in e){const r=e[n];(0,i.Ss)(r)&&(0,i.Ss)(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}},9752:function(t,e,n){"use strict";n.d(e,{C:function(){return l},l:function(){return c}});var r=n(6255);const i=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,o=/^([-\w.]+\/[-\w.+]+)/;function s(t){const e=o.exec(t);return e?e[1]:t}function a(t){const e=i.exec(t);return e?e[1]:""}const u=/\?.*/;function c(t){if((0,r.Ew)(t)){const e=f(t.url||"");return{url:e,type:s(t.headers.get("content-type")||"")||a(e)}}return(0,r.Lj)(t)?{url:f(t.name||""),type:t.type||""}:"string"===typeof t?{url:f(t),type:a(t)}:{url:"",type:""}}function l(t){return(0,r.Ew)(t)?t.headers["content-length"]||-1:(0,r.Lj)(t)?t.size:"string"===typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}function f(t){return t.replace(u,"")}},7927:function(t,e,n){"use strict";n.d(e,{L1:function(){return o},mm:function(){return s}});var r=n(6255),i=n(9752);async function o(t){if((0,r.Ew)(t))return t;const e={},n=(0,i.C)(t);n>=0&&(e["content-length"]=String(n));const{url:o,type:s}=(0,i.l)(t);s&&(e["content-type"]=s);const a=await async function(t){const e=5;if("string"===typeof t)return`data:,${t.slice(0,e)}`;if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){return`data:base64,${function(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}(t.slice(0,e))}`}return null}(t);a&&(e["x-first-bytes"]=a),"string"===typeof t&&(t=(new TextEncoder).encode(t));const u=new Response(t,{headers:e});return Object.defineProperty(u,"url",{value:o}),u}async function s(t){if(!t.ok){const e=await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=` ${await t.text()}`),e+=r,e=e.length>60?`${e.slice(60)}...`:e}catch(n){}return e}(t);throw new Error(e)}}},8712:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("null row");if(!e)throw new Error("no headers");const n={};for(let r=0;r<e.length;r++)n[e[r]]=t[r];return n}function i(t,e){if(!t)throw new Error("null row");if(!e)throw new Error("no headers");const n=new Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n}n.d(e,{w:function(){return x}});var o=n(4942);let s;class a extends Array{enqueue(t){return this.push(t)}dequeue(){return this.shift()}}s=Symbol.asyncIterator;class u{constructor(){(0,o.Z)(this,"_values",void 0),(0,o.Z)(this,"_settlers",void 0),(0,o.Z)(this,"_closed",void 0),this._values=new a,this._settlers=new a,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[s](){return this}enqueue(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const e=this._settlers.dequeue();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.enqueue(t)}next(){if(this._values.length>0){const t=this._values.dequeue();return t instanceof Error?Promise.reject(t):Promise.resolve({value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise(((t,e)=>{this._settlers.enqueue({resolve:t,reject:e})}))}}class c{constructor(t,e){if((0,o.Z)(this,"schema",void 0),(0,o.Z)(this,"options",void 0),(0,o.Z)(this,"length",0),(0,o.Z)(this,"rows",null),(0,o.Z)(this,"cursor",0),(0,o.Z)(this,"_headers",[]),this.options=e,this.schema=t,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}addObjectRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}getBatch(){let t=this.rows;if(!t)return null;t=t.slice(0,this.length),this.rows=null;return{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}}}class l{constructor(t,e){if((0,o.Z)(this,"schema",void 0),(0,o.Z)(this,"options",void 0),(0,o.Z)(this,"length",0),(0,o.Z)(this,"objectRows",null),(0,o.Z)(this,"arrayRows",null),(0,o.Z)(this,"cursor",0),(0,o.Z)(this,"_headers",[]),this.options=e,this.schema=t,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this.options.shape){case"object-row-table":const n=r(t,this._headers);this.addObjectRow(n,e);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(100),this.arrayRows[this.length]=t,this.length++}}addObjectRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this.options.shape){case"array-row-table":const n=i(t,this._headers);this.addArrayRow(n,e);break;case"object-row-table":this.objectRows=this.objectRows||new Array(100),this.objectRows[this.length]=t,this.length++}}getBatch(){let t=this.arrayRows||this.objectRows;return t?(t=t.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}}class f{constructor(t,e){(0,o.Z)(this,"schema",void 0),(0,o.Z)(this,"length",0),(0,o.Z)(this,"allocated",0),(0,o.Z)(this,"columns",{}),this.schema=t,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(t){this._reallocateColumns();let e=0;for(const n in this.columns)this.columns[n][this.length]=t[e++];this.length++}addObjectRow(t){this._reallocateColumns();for(const e in t)this.columns[e][this.length]=t[e];this.length++}getBatch(){this._pruneColumns();const t=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const e in this.schema){const n=this.schema[e];t[n.name]=this.columns[n.index]}this.columns={};return{shape:"columnar-table",batchType:"data",data:t,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:100,this.columns={};for(const t in this.schema){const e=this.schema[t],n=e.type||Float32Array,r=this.columns[e.index];if(r&&ArrayBuffer.isView(r)){const t=new n(this.allocated);t.set(r),this.columns[e.index]=t}else r?(r.length=this.allocated,this.columns[e.index]=r):this.columns[e.index]=new n(this.allocated)}}}_pruneColumns(){for(const[t,e]of Object.entries(this.columns))this.columns[t]=e.slice(0,this.length)}}const h={shape:"array-row-table",batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},d="TableBatchBuilder";class p{constructor(t,e){(0,o.Z)(this,"schema",void 0),(0,o.Z)(this,"options",void 0),(0,o.Z)(this,"aggregator",null),(0,o.Z)(this,"batchCount",0),(0,o.Z)(this,"bytesUsed",0),(0,o.Z)(this,"isChunkComplete",!1),(0,o.Z)(this,"lastBatchEmittedMs",Date.now()),(0,o.Z)(this,"totalLength",0),(0,o.Z)(this,"totalBytes",0),(0,o.Z)(this,"rowBytes",0),this.schema=t,this.options={...h,...e}}limitReached(){var t,e;return!!(Boolean(null===(t=this.options)||void 0===t?void 0:t.limit)&&this.totalLength>=this.options.limit)||!!(Boolean(null===(e=this.options)||void 0===e?void 0:e._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(t){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(t),this.totalBytes+=this.rowBytes,Array.isArray(t)?this.addArrayRow(t):this.addObjectRow(t))}addArrayRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addArrayRow(t)}addObjectRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addObjectRow(t)}chunkComplete(t){t instanceof ArrayBuffer&&(this.bytesUsed+=t.byteLength),"string"===typeof t&&(this.bytesUsed+=t.length),this.isChunkComplete=!0}getFullBatch(t){return this._isFull()?this._getBatch(t):null}getFinalBatch(t){return this._getBatch(t)}_estimateRowMB(t){return Array.isArray(t)?8*t.length:8*Object.keys(t).length}_isFull(){if(!this.aggregator||0===this.aggregator.rowCount())return!1;if("auto"===this.options.batchSize){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return!(this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs)&&(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(t){if(!this.aggregator)return null;null!==t&&void 0!==t&&t.bytesUsed&&(this.bytesUsed=t.bytesUsed);const e=this.aggregator.getBatch();return e.count=this.batchCount,e.bytesUsed=this.bytesUsed,Object.assign(e,t),this.batchCount++,this.aggregator=null,e}_getTableBatchType(){switch(this.options.shape){case"row-table":return c;case"array-row-table":case"object-row-table":return l;case"columnar-table":return f;case"arrow-table":if(!p.ArrowBatch)throw new Error(d);return p.ArrowBatch;default:throw new Error(d)}}}(0,o.Z)(p,"ArrowBatch",void 0);var g=n(377),m=n.n(g);const{ChunkStreamer:y}=m();function v(t){t=t||{},y.call(this,t),this.textDecoder=new TextDecoder(this._config.encoding),this.stream=async function(t){this._input=t;try{for await(const e of t)this.parseChunk(this.getStringChunk(e));this._finished=!0,this.parseChunk("")}catch(e){this._sendError(e)}},this._nextChunk=function(){},this.getStringChunk=function(t){return"string"===typeof t?t:this.textDecoder.decode(t,{stream:!0})}}v.prototype=Object.create(y.prototype),v.prototype.constructor=v;const b={csv:{shape:"object-row-table",optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","\t","|",";"]}},x={id:"csv",module:"csv",name:"CSV",version:"3.0.12",extensions:["csv"],mimeTypes:["text/csv"],category:"table",parse:async(t,e)=>w((new TextDecoder).decode(t),e),parseText:(t,e)=>w(t,e),parseInBatches:function(t,e){var n;"auto"===(e={...e}).batchSize&&(e.batchSize=4e3);const r={...b.csv,...null===(n=e)||void 0===n?void 0:n.csv},i=new u;let o=!0,s=null,a=null,c=null;const l={...r,header:!1,download:!1,chunkSize:5242880,skipEmptyLines:!1,step(t){let n=t.data;if(r.skipEmptyLines){if(""===n.flat().join("").trim())return}const u=t.meta.cursor;if(o&&!s){if("auto"===r.header?_(n):Boolean(r.header))return void(s=n.map(E()))}o&&(o=!1,s||(s=A(r.columnPrefix,n.length)),c=function(t,e){const n=e?{}:[];for(let r=0;r<t.length;r++){const i=e&&e[r]||r;switch(typeof t[r]){case"number":case"boolean":n[i]={name:String(i),index:r,type:Float32Array};break;case"string":default:n[i]={name:String(i),index:r,type:Array}}}return n}(n,s)),r.optimizeMemoryUsage&&(n=JSON.parse(JSON.stringify(n))),a=a||new p(c,{shape:r.shape||"array-row-table",...e});try{a.addRow(n);const t=a&&a.getFullBatch({bytesUsed:u});t&&i.enqueue(t)}catch(l){i.enqueue(l)}},complete(t){try{const e=t.meta.cursor,n=a&&a.getFinalBatch({bytesUsed:e});n&&i.enqueue(n)}catch(e){i.enqueue(e)}i.close()}};return m().parse(t,l,v),i},options:b};async function w(t,e){const n={...b.csv,...null===e||void 0===e?void 0:e.csv},o=function(t){return m().parse(t,{download:!1,dynamicTyping:!0,preview:1}).data[0]}(t),s="auto"===n.header?_(o):Boolean(n.header),a={...n,header:s,download:!1,transformHeader:s?E():void 0,error:t=>{throw new Error(t)}},u=m().parse(t,a);let{data:c}=u;const l=u.meta.fields||A(n.columnPrefix,o.length);switch(n.shape){case"object-row-table":c=c.map((t=>Array.isArray(t)?r(t,l):t));break;case"array-row-table":c=c.map((t=>Array.isArray(t)?t:i(t,l)))}return c}function _(t){return t&&t.every((t=>"string"===typeof t))}function E(){const t=new Set;return e=>{let n=e,r=1;for(;t.has(n);)n=`${e}.${r}`,r++;return t.add(n),n}}function A(t,e=0){const n=[];for(let r=0;r<e;r++)n.push(`${t}${r+1}`);return n}},377:function(t){var e="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:{},n={};function r(t){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(t){var e=u(t);e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null);this._handle=new o(e),this._handle.streamer=this,this._config=e}.call(this,t),this.parseChunk=function(t,e){if(this.isFirstChunk&&c(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(t);void 0!==n&&(t=n)}this.isFirstChunk=!1;var r=this._partialLine+t;this._partialLine="";var i=this._handle.parse(r,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var o=i.meta.cursor;this._finished||(this._partialLine=r.substring(o-this._baseIndex),this._baseIndex=o),i&&i.data&&(this._rowCount+=i.data.length);var s=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(c(this._config.chunk)&&!e){if(this._config.chunk(i,this._handle),this._handle.paused()||this._handle.aborted())return;i=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(i.data),this._completeResults.errors=this._completeResults.errors.concat(i.errors),this._completeResults.meta=i.meta),this._completed||!s||!c(this._config.complete)||i&&i.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),s||i&&i.meta.paused||this._nextChunk(),i}},this._sendError=function(t){c(this._config.error)&&this._config.error(t)}}function i(t){var e;t=t||{},r.call(this,t),this.stream=function(t){return e=t,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var t=this._config.chunkSize,n=t?e.substr(0,t):e;return e=t?e.substr(t):"",this._finished=!e,this.parseChunk(n)}}}function o(t){var e,r,i,o=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,l=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,f=this,h=0,d=0,p=!1,g=!1,m=[],y={data:[],errors:[],meta:{}};if(c(t.step)){var v=t.step;t.step=function(e){if(y=e,w())x();else{if(x(),!y.data||0===y.data.length)return;h+=e.data.length,t.preview&&h>t.preview?r.abort():v(y,f)}}}function b(e){return"greedy"===t.skipEmptyLines?""===e.join("").trim():1===e.length&&0===e[0].length}function x(){if(y&&i&&(E("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+n.DefaultDelimiter+"'"),i=!1),t.skipEmptyLines)for(var e=0;e<y.data.length;e++)b(y.data[e])&&y.data.splice(e--,1);return w()&&function(){if(!y)return;function e(e){c(t.transformHeader)&&(e=t.transformHeader(e)),m.push(e)}if(Array.isArray(y.data[0])){for(var n=0;w()&&n<y.data.length;n++)y.data[n].forEach(e);y.data.splice(0,1)}else y.data.forEach(e)}(),function(){if(!y||!y.data||!t.header&&!t.dynamicTyping&&!t.transform)return y;function e(e,n){var r,i=t.header?{}:[];for(r=0;r<e.length;r++){var o=r,s=e[r];t.header&&(o=r>=m.length?"__parsed_extra":m[r]),t.transform&&(s=t.transform(s,o)),s=_(o,s),"__parsed_extra"===o?(i[o]=i[o]||[],i[o].push(s)):i[o]=s}return t.header&&(r>m.length?E("FieldMismatch","TooManyFields","Too many fields: expected "+m.length+" fields but parsed "+r,d+n):r<m.length&&E("FieldMismatch","TooFewFields","Too few fields: expected "+m.length+" fields but parsed "+r,d+n)),i}var n=1;!y.data[0]||Array.isArray(y.data[0])?(y.data=y.data.map(e),n=y.data.length):y.data=e(y.data,0);t.header&&y.meta&&(y.meta.fields=m);return d+=n,y}()}function w(){return t.header&&0===m.length}function _(e,n){return function(e){return t.dynamicTypingFunction&&void 0===t.dynamicTyping[e]&&(t.dynamicTyping[e]=t.dynamicTypingFunction(e)),!0===(t.dynamicTyping[e]||t.dynamicTyping)}(e)?"true"===n||"TRUE"===n||"false"!==n&&"FALSE"!==n&&(o.test(n)?parseFloat(n):l.test(n)?new Date(n):""===n?null:n):n}function E(t,e,n,r){y.errors.push({type:t,code:e,message:n,row:r})}this.parse=function(o,l,f){var h=t.quoteChar||'"';if(t.newline||(t.newline=function(t,e){t=t.substr(0,1048576);var n=new RegExp(s(e)+"([^]*?)"+s(e),"gm"),r=(t=t.replace(n,"")).split("\r"),i=t.split("\n"),o=i.length>1&&i[0].length<r[0].length;if(1===r.length||o)return"\n";for(var a=0,u=0;u<r.length;u++)"\n"===r[u][0]&&a++;return a>=r.length/2?"\r\n":"\r"}(o,h)),i=!1,t.delimiter)c(t.delimiter)&&(t.delimiter=t.delimiter(o),y.meta.delimiter=t.delimiter);else{var d=function(e,r,i,o,s){var u,c,l;s=s||[",","\t","|",";",n.RECORD_SEP,n.UNIT_SEP];for(var f=0;f<s.length;f++){var h=s[f],d=0,p=0,g=0;l=void 0;for(var m=new a({comments:o,delimiter:h,newline:r,preview:10}).parse(e),y=0;y<m.data.length;y++)if(i&&b(m.data[y]))g++;else{var v=m.data[y].length;p+=v,"undefined"!==typeof l?v>1&&(d+=Math.abs(v-l),l=v):l=0}m.data.length>0&&(p/=m.data.length-g),("undefined"===typeof c||d>c)&&p>1.99&&(c=d,u=h)}return t.delimiter=u,{successful:!!u,bestDelimiter:u}}(o,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess);d.successful?t.delimiter=d.bestDelimiter:(i=!0,t.delimiter=n.DefaultDelimiter),y.meta.delimiter=t.delimiter}var g=u(t);return t.preview&&t.header&&g.preview++,e=o,r=new a(g),y=r.parse(e,l,f),x(),p?{meta:{paused:!0}}:y||{meta:{paused:!1}}},this.paused=function(){return p},this.pause=function(){p=!0,r.abort(),e=e.substr(r.getCharIndex())},this.resume=function(){p=!1,f.streamer.parseChunk(e,!0)},this.aborted=function(){return g},this.abort=function(){g=!0,r.abort(),y.meta.aborted=!0,c(t.complete)&&t.complete(y),e=""}}function s(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function a(t){var e,r=(t=t||{}).delimiter,i=t.newline,o=t.comments,a=t.step,u=t.preview,l=t.fastMode,f=e=void 0===t.quoteChar?'"':t.quoteChar;if(void 0!==t.escapeChar&&(f=t.escapeChar),("string"!==typeof r||n.BAD_DELIMITERS.indexOf(r)>-1)&&(r=","),o===r)throw new Error("Comment character same as delimiter");!0===o?o="#":("string"!==typeof o||n.BAD_DELIMITERS.indexOf(o)>-1)&&(o=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");var h=0,d=!1;this.parse=function(t,n,p){if("string"!==typeof t)throw new Error("Input must be a string");var g=t.length,m=r.length,y=i.length,v=o.length,b=c(a);h=0;var x=[],w=[],_=[],E=0;if(!t)return R();if(l||!1!==l&&-1===t.indexOf(e)){for(var A=t.split(i),O=0;O<A.length;O++){if(_=A[O],h+=_.length,O!==A.length-1)h+=i.length;else if(p)return R();if(!o||_.substr(0,v)!==o){if(b){if(x=[],D(_.split(r)),I(),d)return R()}else D(_.split(r));if(u&&O>=u)return x=x.slice(0,u),R(!0)}}return R()}for(var S,C=t.indexOf(r,h),M=t.indexOf(i,h),P=new RegExp(s(f)+s(e),"g");;)if(t[h]!==e)if(o&&0===_.length&&t.substr(h,v)===o){if(-1===M)return R();h=M+y,M=t.indexOf(i,h),C=t.indexOf(r,h)}else if(-1!==C&&(C<M||-1===M))_.push(t.substring(h,C)),h=C+m,C=t.indexOf(r,h);else{if(-1===M)break;if(_.push(t.substring(h,M)),L(M+y),b&&(I(),d))return R();if(u&&x.length>=u)return R(!0)}else{for(S=h,h++;;){if(-1===(S=t.indexOf(e,S+1)))return p||w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:h}),j();if(S===g-1)return j(t.substring(h,S).replace(P,e));if(e!==f||t[S+1]!==f){if(e===f||0===S||t[S-1]!==f){var k=F(-1===M?C:Math.min(C,M));if(t[S+1+k]===r){if(_.push(t.substring(h,S).replace(P,e)),h=S+1+k+m,C=t.indexOf(r,h),M=t.indexOf(i,h),b&&(I(),d))return R();if(u&&x.length>=u)return R(!0);break}var T=F(M);if(t.substr(S+1+T,y)===i){if(_.push(t.substring(h,S).replace(P,e)),L(S+1+T+y),C=t.indexOf(r,h),b&&(I(),d))return R();if(u&&x.length>=u)return R(!0);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:h}),S++}}else S++}if(b&&(I(),d))return R();if(u&&x.length>=u)return R(!0)}return j();function D(t){x.push(t),E=h}function F(e){var n=0;if(-1!==e){var r=t.substring(S+1,e);r&&""===r.trim()&&(n=r.length)}return n}function j(e){return p||("undefined"===typeof e&&(e=t.substr(h)),_.push(e),h=g,D(_),b&&I()),R()}function L(e){h=e,D(_),_=[],M=t.indexOf(i,h)}function R(t,e){return{data:e||!1?x[0]:x,errors:w,meta:{delimiter:r,linebreak:i,aborted:d,truncated:!!t,cursor:E+(n||0)}}}function I(){a(R(void 0,!0)),x=[],w=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return h}}function u(t){if("object"!==typeof t||null===t)return t;var e=Array.isArray(t)?[]:{};for(var n in t)e[n]=u(t[n]);return e}function c(t){return"function"===typeof t}t.exports=n,n.parse=function(t,e,r){var o=(e=e||{}).dynamicTyping||!1;c(o)&&(e.dynamicTypingFunction=o,o={});if(e.dynamicTyping=o,e.transform=!!c(e.transform)&&e.transform,e.worker&&n.WORKERS_SUPPORTED){var s=newWorker();return s.userStep=e.step,s.userChunk=e.chunk,s.userComplete=e.complete,s.userError=e.error,e.step=c(e.step),e.chunk=c(e.chunk),e.complete=c(e.complete),e.error=c(e.error),delete e.worker,void s.postMessage({input:t,config:e,workerId:s.id})}var a=null;"string"===typeof t&&(a=new i(e));a||(a=new r(e));return a.stream(t)},n.unparse=function(t,e){var r=!1,i=!0,o=",",a="\r\n",u='"',c=u+u,l=!1,f=null;!function(){if("object"!==typeof e)return;"string"!==typeof e.delimiter||n.BAD_DELIMITERS.filter((function(t){return-1!==e.delimiter.indexOf(t)})).length||(o=e.delimiter);("boolean"===typeof e.quotes||Array.isArray(e.quotes))&&(r=e.quotes);"boolean"!==typeof e.skipEmptyLines&&"string"!==typeof e.skipEmptyLines||(l=e.skipEmptyLines);"string"===typeof e.newline&&(a=e.newline);"string"===typeof e.quoteChar&&(u=e.quoteChar);"boolean"===typeof e.header&&(i=e.header);if(Array.isArray(e.columns)){if(0===e.columns.length)throw new Error("Option columns is empty");f=e.columns}void 0!==e.escapeChar&&(c=e.escapeChar+u)}();var h=new RegExp(s(u),"g");"string"===typeof t&&(t=JSON.parse(t));if(Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return p(null,t,l);if("object"===typeof t[0])return p(f||d(t[0]),t,l)}else if("object"===typeof t)return"string"===typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:d(t.data[0])),Array.isArray(t.data[0])||"object"===typeof t.data[0]||(t.data=[t.data])),p(t.fields||[],t.data||[],l);throw new Error("Unable to serialize unrecognized input");function d(t){if("object"!==typeof t)return[];var e=[];for(var n in t)e.push(n);return e}function p(t,e,n){var r="";"string"===typeof t&&(t=JSON.parse(t)),"string"===typeof e&&(e=JSON.parse(e));var s=Array.isArray(t)&&t.length>0,u=!Array.isArray(e[0]);if(s&&i){for(var c=0;c<t.length;c++)c>0&&(r+=o),r+=g(t[c],c);e.length>0&&(r+=a)}for(var l=0;l<e.length;l++){var f=s?t.length:e[l].length,h=!1,d=s?0===Object.keys(e[l]).length:0===e[l].length;if(n&&!s&&(h="greedy"===n?""===e[l].join("").trim():1===e[l].length&&0===e[l][0].length),"greedy"===n&&s){for(var p=[],m=0;m<f;m++){var y=u?t[m]:m;p.push(e[l][y])}h=""===p.join("").trim()}if(!h){for(var v=0;v<f;v++){v>0&&!d&&(r+=o);var b=s&&u?t[v]:v;r+=g(e[l][b],v)}l<e.length-1&&(!n||f>0&&!d)&&(r+=a)}}return r}function g(t,e){return"undefined"===typeof t||null===t?"":t.constructor===Date?JSON.stringify(t).slice(1,25):(t=t.toString().replace(h,c),"boolean"===typeof r&&r||Array.isArray(r)&&r[e]||function(t,e){for(var n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return!0;return!1}(t,n.BAD_DELIMITERS)||t.indexOf(o)>-1||" "===t.charAt(0)||" "===t.charAt(t.length-1)?u+t+u:t)}},n.RECORD_SEP=String.fromCharCode(30),n.UNIT_SEP=String.fromCharCode(31),n.BYTE_ORDER_MARK="\ufeff",n.BAD_DELIMITERS=["\r","\n",'"',n.BYTE_ORDER_MARK],n.WORKERS_SUPPORTED=!1,n.NODE_STREAM_INPUT=1,n.LocalChunkSize=10485760,n.RemoteChunkSize=5242880,n.DefaultDelimiter=",",n.Parser=a,n.ParserHandle=o,n.ChunkStreamer=r,n.StringStreamer=i,i.prototype=Object.create(i.prototype),i.prototype.constructor=i},8949:function(t,e,n){"use strict";n.d(e,{S:function(){return P}});function r(t,e){if(!t)throw new Error(e)}var i=n(4155);const o={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document},s=o.global||o.self||o.window,a="object"!==typeof i||"[object process]"!==String(i)||!0,u="undefined"!==typeof i&&i.version&&/v([0-9]*)/.exec(i.version),{_parseImageNode:c}=(u&&parseFloat(u[1]),s),l="undefined"!==typeof Image,f="undefined"!==typeof ImageBitmap,h=Boolean(c),d=!!a||h;function p(t){const e=m(t);if(!e)throw new Error("Not an image");return e}function g(t){switch(p(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function m(t){return"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!==typeof Image&&t instanceof Image?"image":t&&"object"===typeof t&&t.data&&t.width&&t.height?"data":null}const y=/^data:image\/svg\+xml/,v=/\.svg((\?|#).*)?$/;function b(t){return t&&(y.test(t)||v.test(t))}function x(t,e){if(b(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function w(t,e,n){const r=function(t,e){if(b(e)){let e=(new TextDecoder).decode(t);try{"function"===typeof unescape&&"function"===typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(e)}`}return x(t,e)}(t,n),i=self.URL||self.webkitURL,o="string"!==typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;if(n.src=t,e.image&&e.image.decode&&n.decode)return await n.decode(),n;return await new Promise(((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error(`Could not load image ${t}: ${e}`))}catch(i){r(i)}}))}(o||r,e)}finally{o&&i.revokeObjectURL(o)}}const _={};let E=!0;async function A(t,e,n){let r;if(b(n)){r=await w(t,e,n)}else r=x(t,n);const i=e&&e.imagebitmap;return await async function(t,e=null){!function(t){for(const e in t||_)return!1;return!0}(e)&&E||(e=null);if(e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),E=!1}return await createImageBitmap(t)}(r,i)}const O=!1,S=!0;function C(t){const e=M(t);return function(t){const e=M(t);if(!(e.byteLength>=24&&2303741511===e.getUint32(0,O)))return null;return{mimeType:"image/png",width:e.getUint32(16,O),height:e.getUint32(20,O)}}(e)||function(t){const e=M(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,O)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:r}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let i=2;for(;i+9<e.byteLength;){const t=e.getUint16(i,O);if(r.has(t))return{mimeType:"image/jpeg",height:e.getUint16(i+5,O),width:e.getUint16(i+7,O)};if(!n.has(t))return null;i+=2,i+=e.getUint16(i,O)}return null}(e)||function(t){const e=M(t);if(!(e.byteLength>=10&&1195984440===e.getUint32(0,O)))return null;return{mimeType:"image/gif",width:e.getUint16(6,S),height:e.getUint16(8,S)}}(e)||function(t){const e=M(t);if(!(e.byteLength>=14&&16973===e.getUint16(0,O)&&e.getUint32(2,S)===e.byteLength))return null;return{mimeType:"image/bmp",width:e.getUint32(18,S),height:e.getUint32(22,S)}}(e)}function M(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const P={id:"image",module:"images",name:"Images",version:"3.0.12",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:o}=n||{};let a;switch(function(t){switch(t){case"auto":case"data":return function(){if(f)return"imagebitmap";if(l)return"image";if(d)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return f||l||d;case"imagebitmap":return f;case"image":return l;case"data":return d;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}(t),t}}(i)){case"imagebitmap":a=await A(t,e,o);break;case"image":a=await w(t,e,o);break;case"data":a=await function(t,e){const{mimeType:n}=C(t)||{},{_parseImageNode:i}=s;return r(i),i(t,n,e)}(t,e);break;default:r(!1)}return"data"===i&&(a=g(a)),a},tests:[t=>Boolean(C(new DataView(t)))],options:{image:{type:"auto",decode:!0}}}},4959:function(t,e,n){"use strict";n.d(e,{CO:function(){return o},jU:function(){return s}});var r=n(4155);const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document},o=i.global||i.self||i.window||{},s="object"!==typeof r||"[object process]"!==String(r)||!0,a="undefined"!==typeof r&&r.version&&/v([0-9]*)/.exec(r.version);a&&parseFloat(a[1])},3982:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(4538),i=n(2525);const o={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class s{static get DRAW_MODE(){return o}constructor(t={}){const{id:e=(0,r.hQ)("geometry"),drawMode:n=o.TRIANGLES,attributes:i={},indices:s=null,vertexCount:a=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,s),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const n in t){let e=t[n];e=ArrayBuffer.isView(e)?{value:e}:e,(0,i.h)(ArrayBuffer.isView(e.value),`${this._print(n)}: must be typed array or object with value as typed array`),"POSITION"!==n&&"positions"!==n||e.size||(e.size=3),"indices"===n?((0,i.h)(!this.indices),this.indices=e):this.attributes[n]=e}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const r in t){const e=t[r],{value:i,size:o,constant:s}=e;!s&&i&&o>=1&&(n=Math.min(n,i.length/o))}return(0,i.h)(Number.isFinite(n)),n}}},1113:function(t,e,n){"use strict";n.d(e,{Z:function(){return R}});var r=n(9450),i=n(358),o=n(4072),s=n(3478),a=n(7577);let u=null;function c(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!u||u.byteLength<n)&&(u=new ArrayBuffer(n)),u),0,e)}var l=n(2525),f=n(6073),h=n(5989),d=n(1202);class p extends a.Z{static isSupported(t,e={}){return!e.constantAttributeZero||((0,r.D0)(t)||"Chrome"===function(t){if(!t&&!(0,h.Z)())return"Node";if((0,d.Z)(t))return"Electron";const e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i?"IE":f.u9.chrome?"Chrome":f.u9.safari?"Safari":f.u9.mozInnerScreenX?"Firefox":"Unknown"}())}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new p(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return p.MAX_ATTRIBUTES=p.MAX_ATTRIBUTES||t.getParameter(34921),p.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:p._setConstantFloatArray(t,e,n);break;case Int32Array:p._setConstantIntArray(t,e,n);break;case Uint32Array:p._setConstantUintArray(t,e,n);break;default:(0,l.h)(!1)}}constructor(t,e={}){const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return p.getMaxAttributes(this.gl)}initialize(t={}){return this.setProps(t)}setProps(t){return this}setElementBuffer(t=null,e={}){return(0,l.h)(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:o,stride:s,offset:a,normalized:u,integer:c,divisor:f}=n,{gl:h,gl2:d}=this;return t=Number(t),this.bind((()=>{h.bindBuffer(34962,e.handle),c?((0,l.h)((0,r.D0)(h)),d.vertexAttribIPointer(t,i,o,s,a)):h.vertexAttribPointer(t,i,o,u,s,a),h.enableVertexAttribArray(t),d.vertexAttribDivisor(t,f||0)})),this}enable(t,e=!0){return!e&&0===t&&!p.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),r=n.byteLength*t,i=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new s.Z(this.gl,r),o=o||this.buffer.reallocate(r),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=c(e.constructor,i);!function({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let s=0;for(let a=n;s<i;s++)t[a++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o)}({target:t,source:n,start:0,count:i}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:(0,l.h)(!1)}}static _setConstantIntArray(t,e,n){switch((0,l.h)((0,r.D0)(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:(0,l.h)(!1)}}static _setConstantUintArray(t,e,n){switch((0,l.h)((0,r.D0)(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:(0,l.h)(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,{location:e}){return(0,l.h)(Number.isFinite(e)),this.bind((()=>{switch(t){case 34373:return this.gl.getVertexAttribOffset(e,t);default:return this.gl.getVertexAttrib(e,t)}}))}}var g=n(7469);const m=/^(.+)__LOCATION_([0-9]+)$/,y=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class v{constructor(t,e={}){const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new p(t),(0,g.F)(this,"VertexArray","v6.0",y),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(t={}){return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(t=null,e={}){return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e,n={}){if(34963===e.target)return this.setElementBuffer(e,n);const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return r>=0&&(this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.setBuffer(r,e,i)),this}setConstant(t,e,n={}){const{location:r,accessor:i}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return r>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[r]=e,this.accessors[r]=i,this.clearDrawParams(),this.vertexArrayObject.enable(r,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new s.Z(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof s.Z&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof s.Z&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let r;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),r=n()})),r}_resolveLocationAndAccessor(t,e,n,i){const s={location:-1,accessor:null},{location:a,name:u}=this._getAttributeIndex(t);if(!Number.isFinite(a)||a<0)return this.unused[t]=e,r.cM.once(3,(()=>`unused value ${t} in ${this.id}`))(),s;const c=this._getAttributeInfo(u||a);if(!c)return s;const f=this.accessors[a]||{},h=o.Z.resolve(c.accessor,f,n,i),{size:d,type:p}=h;return(0,l.h)(Number.isFinite(d)&&Number.isFinite(p)),{location:a,accessor:h}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=m.exec(t),r=n?n[1]:t,i=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(r)+i,name:r}:{location:-1}}_setAttribute(t,e){if(e instanceof s.Z)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof s.Z){const n=e[0],r=e[1];this.setBuffer(t,n,r)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof s.Z))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let r=this.values[0];ArrayBuffer.isView(r)&&this._setConstantAttributeZero(r,n);for(let i=1;i<this.vertexArrayObject.MAX_ATTRIBUTES;i++)r=this.values[i],ArrayBuffer.isView(r)&&this._setConstantAttribute(i,r)}_setConstantAttributeZero(t,e){if(p.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){p.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],r=this.accessors[e];if(!n)return;const{divisor:i}=r,o=i>0;if(t.isInstanced=t.isInstanced||o,n instanceof s.Z){const e=n;if(o){const n=e.getVertexCount(r);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(r);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(t=null,e={}){return r.cM.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}var b=n(4538),x=n(6047),w=n(7944),_=n(1053),E=n(9579),A=n(8522);function O(t,e={}){const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(i+=","+(o%r===0?" ":"")),i+=O(t[o],e);return`${i}${t.length>n?"...":"]"}`}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const r=t.toPrecision(2);return r.indexOf(".0")===r.length-2?r.slice(0,-1):r}function S(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let o,a,u,c="NOT PROVIDED",l=1,f=0,h=0;if(n&&(c=n.type,l=n.size,c=String(c).replace("Array",""),o=-1!==c.indexOf("nt")),e instanceof s.Z){const t=e,{data:s,changed:d}=t.getDebugData();let p;if(a=d?"*":"",u=s,h=t.byteLength,f=h/s.BYTES_PER_ELEMENT/l,n){p=`${n.divisor>0?"I ":"P "} ${f} (x${l}=${h} bytes ${(0,E.km)(i,c)})`}else o=!0,p=`${h} bytes`;return{[r]:`${a}${O(u,{size:l,isInteger:o})}`,"Format ":p}}return u=e,l=e.length,c=String(e.constructor.name).replace("Array",""),o=-1!==c.indexOf("nt"),{[r]:`${O(u,{size:l,isInteger:o})} (constant)`,"Format ":`${l}x${c} (constant)`}}function C(t,e){const{type:n,size:r}=e,i=(0,A.jG)(n,r);return i?`${t} (${i.name})`:t}function M({header:t="Uniforms",program:e,uniforms:n,undefinedOnly:r=!1}){(0,l.h)(e);const i=".*Matrix",o=e._uniformSetters,s={},a=Object.keys(o).sort();let u=0;for(const l of a)l.match(".*_.*")||l.match(i)||P({table:s,header:t,uniforms:n,uniformName:l,undefinedOnly:r})&&u++;for(const l of a)l.match(i)&&P({table:s,header:t,uniforms:n,uniformName:l,undefinedOnly:r})&&u++;for(const l of a)s[l]||P({table:s,header:t,uniforms:n,uniformName:l,undefinedOnly:r})&&u++;let c=0;const f={};if(!r)for(const l in n){const e=n[l];s[l]||(c++,f[l]={Type:`NOT USED: ${e}`,[t]:O(e)})}return{table:s,count:u,unusedTable:f,unusedCount:c}}function P({table:t,header:e,uniforms:n,uniformName:r,undefinedOnly:i}){const o=n[r],s=function(t){return void 0!==t&&null!==t}(o);return(!i||!s)&&(t[r]={[e]:s?O(o):"N/A","Uniform Type":s?o:"NOT PROVIDED"},!0)}function k(t){const{type:e,size:n}=t.accessor,r=(0,A.jG)(e,n);return r?`${r.name} ${t.name}`:t.name}const T={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function D(t,e){const{attributeMap:n=T}=e||{};return n&&n[t]||t}function F(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}(0,l.h)(Number.isFinite(e.size),`attribute ${t} needs size`)}const j=()=>{},L={};class R{constructor(t,e={}){const{id:n=(0,b.hQ)("model")}=e;(0,l.h)((0,r.UF)(t)),this.id=n,this.gl=t,this.id=e.id||(0,b.hQ)("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||i.Z.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:r,modules:o,defines:s,inject:a,varyings:u,bufferMode:c,transpileToGLSL100:f}=t;this.programProps={program:e,vs:n,fs:r,modules:o,defines:s,inject:a,varyings:u,bufferMode:c,transpileToGLSL100:f},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},(0,l.h)(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c}=t;this.programProps={program:e,vs:n,fs:r,modules:i,defines:o,inject:s,varyings:a,bufferMode:u,transpileToGLSL100:c},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return(0,l.h)(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return(0,l.h)(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const r={};let i=e.indices;for(const o in e.attributes){const a=e.attributes[o],u=D(o,n);if("indices"===o)i=a;else if(a.constant)r[u]=a.value;else{const e=a.value,n={...a};delete n.value,r[u]=[new s.Z(t,e),n],F(o,n)}}if(i){const e=i.value||i;(0,l.h)(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===i.isIndexed||i.isIndexed};r.indices=[new s.Z(t,{data:e,target:34963}),n]}return r}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(t={}){if((0,b.nK)(t))return this;const e={};for(const n in t){const r=t[n];e[n]=r.getValue?r.getValue():r}return this.vertexArray.setAttributes(e),this}setUniforms(t={}){return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return(0,x.Z)(this.program.gl,t),this}draw(t={}){this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:o={},transformFeedback:s=this.transformFeedback,parameters:a={},vertexArray:u=this.vertexArray}=t;let c;this.setAttributes(o),this.updateModuleSettings(e),this.setUniforms(i),r.cM.priority>=2&&(c=this._logDrawCallStart(2));const l=this.vertexArray.getDrawParams(),{isIndexed:f=l.isIndexed,indexType:h=l.indexType,indexOffset:d=l.indexOffset,vertexArrayInstanced:p=l.isInstanced}=this.props;p&&!this.isInstanced&&r.cM.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:g,instanceCount:m}=this,{onBeforeRender:y=j,onAfterRender:v=j}=this.props;y(),this.program.setUniforms(this.uniforms);const b=this.program.draw(Object.assign(L,t,{logPriority:c,uniforms:null,framebuffer:n,parameters:a,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:u,transformFeedback:s,isIndexed:f,indexType:h,isInstanced:g,instanceCount:m,offset:f?d:0}));return v(),r.cM.priority>=2&&this._logDrawCallEnd(c,u,n),b}transform(t={}){const{discard:e=!0,feedbackBuffers:n,unbindModels:r=[]}=t;let{parameters:i}=t;n&&this._setFeedbackBuffers(n),e&&(i=Object.assign({},i,{35977:e})),r.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:i}))}finally{r.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(t={}){return r.cM.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:r,inject:i,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:u}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}(0,l.h)(t instanceof w.Z,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new v(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof s.Z&&e.delete()}}_setAnimationProps(t){this.animated&&(0,l.h)(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(t={}){if((0,b.nK)(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new _.Z(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),r.cM.group(2,`>>> DRAWING MODEL ${this.id}`,{collapsed:r.cM.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const o=function({vertexArray:t,header:e="Attributes"}){if(!t.configuration)return{};const n={};t.elements&&(n.ELEMENT_ARRAY_BUFFER=S(t,t.elements,null,e));const r=t.values;for(const i in r){const o=t._getAttributeInfo(i);if(o){let s=`${i}: ${o.name}`;const a=t.accessors[o.location];a&&(s=`${i}: ${C(o.name,a)}`),n[s]=S(t,r[i],a,e)}}return n}({vertexArray:e,header:`${this.id} attributes`,attributes:this._attributes}),{table:s,unusedTable:a,unusedCount:u}=M({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:c,count:l}=M({header:`${this.id} uniforms`,program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});l>0&&r.cM.log("MISSING UNIFORMS",Object.keys(c))(),u>0&&r.cM.log("UNUSED UNIFORMS",Object.keys(a))();const f=function(t){const e={},n=`Accessors for ${t.id}`;for(const r of t.attributeInfos)r&&(e[`in ${k(r)}`]={[n]:JSON.stringify(r.accessor)});for(const r of t.varyingInfos)r&&(e[`out ${k(r)}`]={[n]:JSON.stringify(r.accessor)});return e}(this.vertexArray.configuration);r.cM.table(t,o)(),r.cM.table(t,s)(),r.cM.table(t+1,f)(),i&&i.log({logLevel:2,message:`Rendered to ${i.id}`}),r.cM.groupEnd(2,`>>> DRAWING MODEL ${this.id}`)()}}},358:function(t,e,n){"use strict";n.d(e,{Z:function(){return I}});var r=n(5682),i=n(9047);const o={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function s(t){let e=a(t);return"object"===e?t?"type"in t?Object.assign({},t,o[t.type]):"value"in t?(e=a(t.value),Object.assign({type:e},t,o[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},o[e])}function a(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class u{constructor({name:t,vs:e,fs:n,dependencies:r=[],uniforms:o,getUniforms:a,deprecations:u=[],defines:c={},inject:l={},vertexShader:f,fragmentShader:h}){(0,i.Z)("string"===typeof t),this.name=t,this.vs=e||f,this.fs=n||h,this.getModuleUniforms=a,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(u),this.defines=c,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);"string"===typeof r&&(r={order:0,injection:r}),e[i][n]=r}return e}(l),o&&(this.uniforms=function(t){const e={};for(const n in t){const r=s(t[n]);e[n]=r}return e}(o))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:(0,i.Z)(!1)}return`#define MODULE_${this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_")}\n${e}// END MODULE_${this.name}\n\n`}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{switch(t.type){case"function":t.regex=new RegExp(`\\b${t.old}\\(`);break;default:t.regex=new RegExp(`${t.type} ${t.old};`)}})),t}_defaultGetUniforms(t={}){const e={},n=this.uniforms;for(const r in n){const o=n[r];r in t&&!o.private?(o.validate&&(0,i.Z)(o.validate(t[r],o),`${this.name}: invalid ${r}`),e[r]=t[r]):e[r]=o.value}return e}}function c(t){return l(h(t))}function l(t){const e={},n={};return f({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}function f({modules:t,level:e,moduleMap:n,moduleDepth:r}){if(e>=5)throw new Error("Possible loop in shader dependency graph");for(const i of t)n[i.name]=i,(void 0===r[i.name]||r[i.name]<e)&&(r[i.name]=e);for(const i of t)i.dependencies&&f({modules:i.dependencies,level:e+1,moduleMap:n,moduleDepth:r})}function h(t,e){return t.map((t=>(t instanceof u||((0,i.Z)("string"!==typeof t,`Shader module use by name is deprecated. Import shader module '${t}' and use it directly.`),(0,i.Z)(t.name,"shader module has no name"),(t=new u(t)).dependencies=h(t.dependencies)),t)))}const d={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},p={};Object.keys(d).forEach((t=>{p[t]=t}));const g={};function m(t,e,n={}){const r=d[e];if((0,i.Z)(r,e),!function(t={}){const e="undefined"!==typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",r=-1!==n.indexOf("MSIE "),i=-1!==n.indexOf("Trident/");return r||i}(n))return!0;if(e in g)return g[e];const o=`#extension GL_${r[0]} : ${n.behavior||"enable"}\nvoid main(void) {}`,s=t.createShader(35633);t.shaderSource(s,o),t.compileShader(s);const a=t.getShaderParameter(s,35713);return t.deleteShader(s),g[e]=a,a}function y(t,e){const n=d[e];(0,i.Z)(n,e);const r=function(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],o="string"===typeof r?Boolean(t.getExtension(r)):r;return(0,i.Z)(!1===o||!0===o),o}function v(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>y(t,e)))}var b=n(6713);function x(t){return new RegExp(`\\b${t}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}const w=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],_=[...w,[x("attribute"),"in $1"],[x("varying"),"out $1"]],E=[...w,[x("varying"),"in $1"]],A=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],O=[...A,[x("in"),"attribute $1"],[x("out"),"varying $1"]],S=[...A,[x("in"),"varying $1"]],C="gl_FragColor",M=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,P=/void\s+main\s*\([^)]*\)\s*\{\n?/;function k(t,e,n){switch(e){case 300:return n?T(t,_):function(t){const e=(t=T(t,E)).match(M);if(e){const n=e[1];t=t.replace(new RegExp("\\bgl_FragColor\\b","g"),n)}else{const e="fragmentColor";t=t.replace(P,(t=>`out vec4 ${e};\n${t}`)).replace(new RegExp("\\bgl_FragColor\\b","g"),e)}return t}(t);case 100:return n?T(t,O):function(t){const e=(t=T(t,S)).match(M);if(e){const n=e[1];t=t.replace(M,"").replace(new RegExp(`\\b${n}\\b`,"g"),C)}return t}(t);default:throw new Error(`unknown GLSL version ${e}`)}}function T(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}const D=`\n\n${b.O_}\n\n`,F={[r.H]:"vertex",[r.Y]:"fragment"};function j(t,{id:e,source:n,type:o,modules:s,defines:a={},hookFunctions:u=[],inject:c={},transpileToGLSL100:l=!1,prologue:f=!0,log:h}){(0,i.Z)("string"===typeof n,"shader source must be a string");const d=o===r.H,g=n.split("\n");let y=100,x="",w=n;0===g[0].indexOf("#version ")?(y=300,x=g[0],w=g.slice(1).join("\n")):x=`#version ${y}`;const _={};s.forEach((t=>{Object.assign(_,t.getDefines())})),Object.assign(_,a);let E=f?`${x}\n${function({id:t,source:e,type:n}){return t&&"string"===typeof t&&-1===e.indexOf("SHADER_NAME")?`\n#define SHADER_NAME ${t}_${F[n]}\n\n`:""}({id:e,source:n,type:o})}\n${function({type:t}){return`\n#define SHADER_TYPE_${F[t].toUpperCase()}\n`}({type:o})}\n${function(t){switch(function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||7936),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||7937);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/Apple/i)||e.match(/Apple/i)?"APPLE":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN"}(n,r),vendor:n,renderer:r,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t).gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n"}}(t)}\n${function(t,e,n){let r="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return v(t,p.GLSL_FRAG_DEPTH)&&(r+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),v(t,p.GLSL_DERIVATIVES)&&m(t,p.GLSL_DERIVATIVES)&&(r+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),v(t,p.GLSL_FRAG_DATA)&&m(t,p.GLSL_FRAG_DATA,{behavior:"require"})&&(r+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),v(t,p.GLSL_TEXTURE_LOD)&&(r+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),r}(t)}\n${function(t={}){let e=0,n="";for(const r in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const i=t[r];(i||Number.isFinite(i))&&(n+=`#define ${r.toUpperCase()} ${t[r]}\n`)}0===e&&(n+="\n");return n}(_)}\n${d?"":"precision highp float;\n\n"}\n`:`${x}\n`;const A=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!==typeof t?(n=t,t=n.hook):n={},t=t.trim();const[r,i]=t.split(":"),o=t.replace(/\(.+/,"");e[r][o]=Object.assign(n,{signature:i})})),e}(u),O={},S={},C={};for(const r in c){const t="string"===typeof c[r]?{injection:c[r],order:0}:c[r],e=r.match(/^(v|f)s:(#)?([\w-]+)$/);if(e){const n=e[2],i=e[3];n?"decl"===i?S[r]=[t]:C[r]=[t]:O[r]=[t]}else C[r]=[t]}for(const r of s){h&&r.checkDeprecations(w,h);E+=r.getModuleSource(o,y);const t=r.injections[o];for(const e in t){const n=e.match(/^(v|f)s:#([\w-]+)$/);if(n){const r="decl"===n[2]?S:C;r[e]=r[e]||[],r[e].push(t[e])}else O[e]=O[e]||[],O[e].push(t[e])}}return E+=D,E=(0,b.ZP)(E,o,S),E+=function(t,e){let n="";for(const r in t){const i=t[r];if(n+=`void ${i.signature} {\n`,i.header&&(n+=`  ${i.header}`),e[r]){const t=e[r];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+=`  ${e.injection}\n`}i.footer&&(n+=`  ${i.footer}`),n+="}\n"}return n}(A[o],O),E+=w,E=(0,b.ZP)(E,o,C),E=k(E,l?100:y,d),E}function L(t){return function(e){const n={};for(const r of t){const t=r.getUniforms(e,n);Object.assign(n,t)}return n}}var R=n(7944);class I{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new I(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"===typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(t={}){const{vs:e="",fs:n="",defines:i={},inject:o={},varyings:s=[],bufferMode:a=35981,transpileToGLSL100:u=!1}=t,l=this._getModuleList(t.modules),f=this._getHash(e),h=this._getHash(n),d=l.map((t=>this._getHash(t.name))).sort(),p=s.map((t=>this._getHash(t))),g=Object.keys(i).sort(),m=Object.keys(o).sort(),y=[],v=[];for(const r of g)y.push(this._getHash(r)),y.push(this._getHash(i[r]));for(const r of m)v.push(this._getHash(r)),v.push(this._getHash(o[r]));const b=`${f}/${h}D${y.join("/")}M${d.join("/")}I${v.join("/")}V${p.join("/")}H${this.stateHash}B${a}${u?"T":""}`;if(!this._programCache[b]){const t=function(t,e){const{vs:n,fs:i}=e,o=c(e.modules||[]);return{gl:t,vs:j(t,Object.assign({},e,{source:n,type:r.H,modules:o})),fs:j(t,Object.assign({},e,{source:i,type:r.Y,modules:o})),getUniforms:L(o)}}(this.gl,{vs:e,fs:n,modules:l,inject:o,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:u});this._programCache[b]=new R.Z(this.gl,{hash:b,vs:t.vs,fs:t.fs,varyings:s,bufferMode:a}),this._getUniforms[b]=t.getUniforms||(t=>{}),this._useCounts[b]=0}return this._useCounts[b]++,this._programCache[b]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(t=[]){const e=new Array(this._defaultModules.length+t.length),n={};let r=0;for(let i=0,o=this._defaultModules.length;i<o;++i){const t=this._defaultModules[i],o=t.name;e[r++]=t,n[o]=!0}for(let i=0,o=t.length;i<o;++i){const o=t[i],s=o.name;n[s]||(e[r++]=o,n[s]=!0)}return e.length=r,e}}},9450:function(t,e,n){"use strict";n.d(e,{KQ:function(){return l},JD:function(){return c},s9:function(){return Q},JY:function(){return G},w:function(){return q},vd:function(){return u},yW:function(){return tt},UF:function(){return s},D0:function(){return a},cM:function(){return r},kL:function(){return Z},aQ:function(){return et},dR:function(){return V},s8:function(){return W}});const r=new(n(4708).Z)({id:"luma.gl"});function i(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const o="Invalid WebGLRenderingContext";function s(t){return"undefined"!==typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version)))}function a(t){return"undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function u(t){return a(t)?t:null}function c(t){return i(s(t),o),t}function l(t){return i(a(t),"Requires WebGL2"),t}var f=n(9718);const h={};function d(t,e){var n;h[t]=!0,void 0!==e&&(n=e,f.CO.console&&f.CO.console.error&&f.CO.console.error(n))}const p=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const e=new t.VertexAttrib(n);this.attribs[r]=e}this.maxAttrib=0};(p.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const g=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(h[n]=!0)}while(0!==n);for(n in h)if(h[n])return delete h[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const r=e.currentVertexArrayObject;r.maxAttrib=Math.max(r.maxAttrib,t);const i=r.attribs[t];return i.enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,r){switch(t){case 34962:e.currentArrayBuffer=r;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=r}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,r){const i=e.currentVertexArrayObject,o=i.attribs[t];switch(r){case 34975:return o.buffer;case 34338:return o.enabled;case 34339:return o.size;case 34340:return o.stride;case 34341:return o.type;case 34922:return o.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,r,i,o,s,a){const u=e.currentVertexArrayObject;u.maxAttrib=Math.max(u.maxAttrib,t);const c=u.attribs[t];return c.buffer=e.currentArrayBuffer,c.size=r,c.type=i,c.normalized=o,c.stride=s,c.offset=a,c.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{var t;t="OESVertexArrayObject emulation library context restored",f.CO.console&&f.CO.console.log&&f.CO.console.log(t),e.reset_()}),!0),this.reset_()};g.prototype.VERTEX_ARRAY_BINDING_OES=34229,g.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let e=0;e<this.vertexArrayObjects.length;++e)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new p(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},g.prototype.createVertexArrayOES=function(){const t=new p(this);return this.vertexArrayObjects.push(t),t},g.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},g.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof p&&t.hasBeenBound&&t.ext===this)},g.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return void d(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");const n=this.original,r=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const i=this.currentVertexArrayObject;if(r===i)return;r&&i.elementArrayBuffer===r.elementArrayBuffer||n.bindBuffer.call(e,34963,i.elementArrayBuffer);let o=this.currentArrayBuffer;const s=Math.max(r?r.maxAttrib:0,i.maxAttrib);for(let a=0;a<=s;a++){const t=i.attribs[a],s=r?r.attribs[a]:null;if(r&&t.enabled===s.enabled||(t.enabled?n.enableVertexAttribArray.call(e,a):n.disableVertexAttribArray.call(e,a)),t.enabled){let i=!1;r&&t.buffer===s.buffer||(o!==t.buffer&&(n.bindBuffer.call(e,34962,t.buffer),o=t.buffer),i=!0),(i||t.cached!==s.cached)&&n.vertexAttribPointer.call(e,a,t.size,t.type,t.normalized,t.stride,t.offset)}}this.currentArrayBuffer!==o&&n.bindBuffer.call(e,34962,this.currentArrayBuffer)};const m="OES_element_index",y="WEBGL_draw_buffers",v="WEBGL_debug_renderer_info",b=t=>a(t)?void 0:0,x={3074:t=>a(t)?void 0:36064,35723:t=>a(t)?void 0:4352,35977:b,32937:b,36795:(t,e)=>{const n=a(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(v);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(v);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:b,35071:b,37447:b,36063:(t,e)=>{if(!a(t)){const n=t.getExtension(y);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:b,35374:b,35377:b,34852:t=>{if(!a(t)){const e=t.getExtension(y);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(m)?2147483647:65535,33001:t=>t.getExtension(m)?16777216:65535,33e3:t=>16777216,37157:b,35373:b,35657:b,36183:b,37137:b,34045:b,35978:b,35979:b,35968:b,35376:b,35375:b,35659:b,37154:b,35371:b,35658:b,35076:b,35077:b,35380:b};const w="ANGLE_instanced_arrays";const _={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{i(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[w]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){i(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{i(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{i(!1)},deleteQuery:()=>{i(!1)},beginQuery:()=>{i(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},E={readBuffer:(t,e,n)=>{a(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:o}=function(t,e){return{webgl2:a(t),ext:t.getExtension(e)}}(t,w);let s;switch(r){case 35069:s=!!i&&void 0;break;case 35070:s=i||o?void 0:0}return void 0!==s?s:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!a(t))switch(r){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!a(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;r=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,r)},getParameter:function(t,e,n){const r=x[n],i="function"===typeof r?r(t,e,n):r;return void 0!==i?i:e(n)},hint:(t,e,n,r)=>e(n,r)};function A(t,{extension:e,target:n,target2:r}){const o=_[e];i(o);const{meta:s={}}=o,{suffix:a=""}=s,u=t.getExtension(e);for(const i of Object.keys(o)){const e=`${i}${a}`;let s=null;"meta"===i||"function"===typeof t[i]||(u&&"function"===typeof u[e]?s=(...t)=>u[e](...t):"function"===typeof o[i]&&(s=o[i].bind(n))),s&&(n[i]=s,r[i]=s)}}("undefined"!==typeof n.g?n.g:window).polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(!function(t){if("function"===typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new g(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&A(t,{extension:n,target:t.luma,target2:t})}(t,_),function(t,{target:e,target2:n}){Object.keys(E).forEach((r=>{if("function"===typeof E[r]){const i=t[r]?t[r].bind(t):()=>{},o=E[r].bind(null,t,i);e[r]=o,n[r]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const O={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},S=(t,e,n)=>e?t.enable(n):t.disable(n),C=(t,e,n)=>t.hint(n,e),M=(t,e,n)=>t.pixelStorei(n,e);function P(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const k={3042:S,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:S,2885:(t,e)=>t.cullFace(e),2929:S,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:S,35723:C,36006:(t,e)=>{const n=a(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:C,2849:(t,e)=>t.lineWidth(e),32823:S,32824:"polygonOffset",10752:"polygonOffset",35977:S,32938:"sampleCoverage",32939:"sampleCoverage",3089:S,3088:(t,e)=>t.scissor(...e),2960:S,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:M,3317:M,37440:M,37441:M,37443:M,3330:M,3332:M,3331:M,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:M,32878:M,3316:M,3315:M,32877:M,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=P(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=P(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=P(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=P(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=P(e)&&3===e.length?[...e,...e]:e;const[n,r,i,o,s,a]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function T(t,e,n){return void 0!==e[t]?e[t]:n[t]}const D={blendEquation:(t,e,n)=>t.blendEquationSeparate(T(32777,e,n),T(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(T(32969,e,n),T(32968,e,n),T(32971,e,n),T(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(T(32824,e,n),T(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(T(32938,e,n),T(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,T(2962,e,n),T(2967,e,n),T(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,T(34816,e,n),T(36003,e,n),T(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,T(2964,e,n),T(2965,e,n),T(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,T(34817,e,n),T(34818,e,n),T(34819,e,n))},F={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:r,[1028===e?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:r,[1028===e?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},j=(t,e)=>t.isEnabled(e),L={3042:j,2884:j,2929:j,3024:j,32823:j,32926:j,32928:j,3089:j,2960:j,35977:j};function R(t){for(const e in t)return!1;return!0}function I(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function N(t,e){const n=t[e].bind(t);t[e]=function(...e){const r=e[0];return r in t.state.cache||(t.state.cache[r]=n(...e)),t.state.enable?t.state.cache[r]:n(...e)},Object.defineProperty(t[e],"name",{value:`${e}-from-cache`,configurable:!1})}function B(t,e,n){const r=t[e].bind(t);t[e]=function(...e){const{valueChanged:i,oldValue:o}=n(t.state._updateCache,...e);return i&&r(...e),o},Object.defineProperty(t[e],"name",{value:`${e}-to-cache`,configurable:!1})}class z{constructor(t,{copyState:e=!1,log:n=(()=>{})}={}){this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"===typeof(e=e||O)){const n=e,r=L[n];return r?r(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const e=L[i];r[i]=e?e(t,Number(i)):t.getParameter(Number(i))}return r}(t):Object.assign({},O),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){i(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];V(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const r=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in t){i(void 0!==o);const s=t[o],a=this.cache[o];I(s,a)||(n=!0,e=a,r&&!(o in r)&&(r[o]=a),this.cache[o]=s)}return{valueChanged:n,oldValue:e}}}function $(t,e={}){const{enable:r=!0,copyState:o}=e;if(i(void 0!==o),!t.state){const e="undefined"!==typeof n.g?n.g:window,{polyfillContext:r}=e;r&&r(t),t.state=new z(t,{copyState:o}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const n in F){B(t,n,F[n])}N(t,"getParameter"),N(t,"isEnabled")}return t.state.enable=r,t}function U(t){i(t.state),t.state.pop()}function V(t,e){if(i(s(t),"setParameters requires a WebGL context"),R(e))return;const n={};for(const i in e){const r=Number(i),o=k[i];o&&("string"===typeof o?n[o]=!0:o(t,e[i],r))}const r=t.state&&t.state.cache;if(r)for(const i in n){(0,D[i])(t,e,r)}}function Z(t){V(t,O)}function W(t,e,n){if(R(e))return n(t);const{nocatch:r=!0}=e;let i;if(function(t){t.state||$(t,{copyState:!1}),t.state.push()}(t),V(t,e),r)i=n(t),U(t);else try{i=n(t)}finally{U(t)}return i}function q(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function G(t,e,n=!0){return function(t,e,n,r,i){const o=H(t[0],e,n);let s=X(t[1],e,r,i),a=H(t[0]+1,e,n);const u=a===n-1?a:a-1;let c;a=X(t[1]+1,e,r,i),i?(a=0===a?a:a+1,c=s,s=a):c=a===r-1?a:a-1;return{x:o,y:s,width:Math.max(u-o+1,1),height:Math.max(c-s+1,1)}}(e,q(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function H(t,e,n){return Math.min(Math.round(t*e),n-1)}function X(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Y=(0,f.jU)(),K=Y&&"undefined"!==typeof document,J={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Q(t={}){i(Y,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},J,t);const{width:e,height:n}=t;function o(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let s;t.onError=o;const{canvas:u}=t;return s=function(t,e){const{onError:n}=e;let r=null;const i=t=>r=t.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e));o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e));if(t.removeEventListener("webglcontextcreationerror",i,!1),!a)return n(`Failed to create ${s&&!o?"WebGL2":"WebGL"} context: ${r||"Unknown error"}`);e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1);e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1);return a}(function({canvas:t,width:e=800,height:n=600,onError:r}){let i;if("string"===typeof t){K&&"complete"===document.readyState||r(`createGLContext called on canvas '${t}' before page was loaded`),i=document.getElementById(t)}else t?i=t:(i=document.createElement("canvas"),i.id="lumagl-canvas",i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(n)?`${n}px`:"100%",document.body.insertBefore(i,document.body.firstChild));return i}({canvas:u,width:e,height:n,onError:o}),t),s?(s=tt(s,t),function(t){const e=a(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),o=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?`(${n.vendor},${n.renderer})`:"",o=t.debug?" debug":"";r.info(1,`${e}${o} context ${i}`)()}(s),s):null}function tt(t,e={}){if(!t||t._instrumented)return t;t._version=t._version||function(t){if("undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)return 2;return 1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},J,e);const{manageState:n,debug:i}=e;return n&&$(t,{copyState:!1,log:(...t)=>r.log(1,...t)()}),Y&&i&&(f.CO.makeDebugContext?(t=f.CO.makeDebugContext(t,e),r.level=Math.max(r.level,1)):r.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function et(t,e={}){if(t.canvas){return void function(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,o="height"in n?n.height:t.canvas.clientHeight;i&&o||(r.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,o=t.canvas.height||1);t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const s=t.luma.canvasSizeInfo;if(s.clientWidth!==i||s.clientHeight!==o||s.devicePixelRatio!==e){let n=e;const s=Math.floor(i*n),a=Math.floor(o*n);t.canvas.width=s,t.canvas.height=a,t.drawingBufferWidth===s&&t.drawingBufferHeight===a||(r.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/o),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(o*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:o,devicePixelRatio:e})}}(t,function(t){const e="undefined"===typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e)}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}},5682:function(t,e,n){"use strict";n.d(e,{H:function(){return r},Y:function(){return i}});const r="vs",i="fs"},6713:function(t,e,n){"use strict";n.d(e,{O_:function(){return s},Lm:function(){return f},ZP:function(){return l}});var r=n(5682),i=n(9047);const o={[r.H]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[r.Y]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},s="__LUMA_INJECT_DECLARATIONS__",a=/void\s+main\s*\([^)]*\)\s*\{\n?/,u=/}\n?[^{}]*$/,c=[];function l(t,e,n,i=!1){const l=e===r.H;for(const r in n){const e=n[r];e.sort(((t,e)=>t.order-e.order)),c.length=e.length;for(let t=0,n=e.length;t<n;++t)c[t]=e[t].injection;const i=`${c.join("\n")}\n`;switch(r){case"vs:#decl":l&&(t=t.replace(s,i));break;case"vs:#main-start":l&&(t=t.replace(a,(t=>t+i)));break;case"vs:#main-end":l&&(t=t.replace(u,(t=>i+t)));break;case"fs:#decl":l||(t=t.replace(s,i));break;case"fs:#main-start":l||(t=t.replace(a,(t=>t+i)));break;case"fs:#main-end":l||(t=t.replace(u,(t=>i+t)));break;default:t=t.replace(r,(t=>t+i))}}return t=t.replace(s,""),i&&(t=t.replace(/\}\s*$/,(t=>t+o[e]))),t}function f(t){const e={};return(0,i.Z)(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?`${e[n]}\n${t[n]}`:t[n]})),e}},5644:function(t,e,n){"use strict";n.d(e,{N:function(){return l},s:function(){return f}});var r="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n";const i={lightSources:{}};function o({color:t=[0,0,0],intensity:e=1}={}){return t.map((t=>t*e/255))}const s={name:"lights",vs:r,fs:r,getUniforms:function t(e=i){if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:r}=e.lightSources||{};return t||n&&n.length>0||r&&r.length>0?Object.assign({},function({ambientLight:t,pointLights:e=[],directionalLights:n=[]}){const r={};return r["lighting_uAmbientLight.color"]=t?o(t):[0,0,0],e.forEach(((t,e)=>{r[`lighting_uPointLight[${e}].color`]=o(t),r[`lighting_uPointLight[${e}].position`]=t.position,r[`lighting_uPointLight[${e}].attenuation`]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=e.length,n.forEach(((t,e)=>{r[`lighting_uDirectionalLight[${e}].color`]=o(t),r[`lighting_uDirectionalLight[${e}].direction`]=t.direction})),r.lighting_uDirectionalLightCount=n.length,r}({ambientLight:t,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}};var a="\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n";const u={};function c(t=u){if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}const l={name:"gouraud-lighting",dependencies:[s],vs:a,defines:{LIGHTING_VERTEX:1},getUniforms:c},f={name:"phong-lighting",dependencies:[s],fs:a,defines:{LIGHTING_FRAGMENT:1},getUniforms:c}},9047:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}n.d(e,{Z:function(){return r}})},4072:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var r=n(9335),i=n(2525),o=n(2610);const s={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},a={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class u{static getBytesPerElement(t){return(0,r.vN)(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){(0,i.h)(t.size);return(0,r.vN)(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new u(...[s,...t])}constructor(...t){t.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return u.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return u.getBytesPerVertex(this)}_assign(t={}){return void 0!==(t=(0,o.k)("Accessor",t,a)).type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"===typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}},3478:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var r=n(7577),i=n(4072),o=n(9335),s=n(9450),a=n(2525),u=n(2610);const c={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},l={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:c},f={removedProps:c};class h extends r.Z{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(t=this.accessor){return Math.round(this.byteLength/i.Z.getBytesPerElement(t))}getVertexCount(t=this.accessor){return Math.round(this.byteLength/i.Z.getBytesPerVertex(t))}initialize(t={}){return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=(0,u.k)("Buffer",t,l),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=(0,u.k)("Buffer",t,f))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new i.Z(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:r=0}=t,i=t.byteLength||t.length;(0,a.h)(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==r||void 0!==i?((0,s.KQ)(this.gl),this.gl.bufferSubData(this.target,n,e,r,i)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData({sourceBuffer:t,readOffset:e=0,writeOffset:n=0,size:r}){const{gl:i}=this;return(0,s.KQ)(i),i.bindBuffer(36662,t.handle),i.bindBuffer(36663,this.handle),i.copyBufferSubData(36662,36663,e,n,r),i.bindBuffer(36662,null),i.bindBuffer(36663,null),this.debugData=null,this}getData({dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:r=0}={}){(0,s.KQ)(this.gl);const i=(0,o.vN)(this.accessor.type||5126,{clamped:!1}),u=this._getAvailableElementCount(e),c=n;let l,f;t?(f=t.length,l=f-c):(l=Math.min(u,r||u),f=c+l);const h=Math.min(u,l);return r=r||h,(0,a.h)(r<=h),t=t||new i(f),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,r),this.gl.bindBuffer(36662,null),t}bind({target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:r}={}){return 35345===t||35982===t?void 0!==r?this.gl.bindBufferRange(t,e,this.handle,n,r):((0,a.h)(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind({target:t=this.target,index:e=this.accessor&&this.accessor.index}={}){return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t,e=0,n=t.byteLength+e){(0,a.h)(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const r=this._getTarget();this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,this.usage),this.gl.bufferSubData(r,e,t),this.gl.bindBuffer(r,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const s=(0,o.O)(t);return(0,a.h)(s),this.setAccessor(new i.Z(this.accessor,{type:s})),this}_setByteLength(t,e=this.usage){(0,a.h)(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const r=this._getTarget();return this.gl.bindBuffer(r,this.handle),this.gl.bufferData(r,n,e),this.gl.bindBuffer(r,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/(0,o.vN)(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new i.Z(this.accessor,{type:(0,o.O)(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return s.cM.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return s.cM.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return s.cM.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return s.cM.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new i.Z(this.accessor,t),this}}},6047:function(t,e,n){"use strict";n.d(e,{Z:function(){return s},$:function(){return a}});var r=n(9450),i=n(2525);const o="clear: bad arguments";function s(t,{framebuffer:e=null,color:n=null,depth:s=null,stencil:a=null}={}){const u={};e&&(u.framebuffer=e);let c=0;n&&(c|=16384,!0!==n&&(u.clearColor=n)),s&&(c|=256,!0!==s&&(u.clearDepth=s)),a&&(c|=1024,!0!==s&&(u.clearStencil=s)),(0,i.h)(0!==c,o),(0,r.s8)(t,u,(()=>{t.clear(c)}))}function a(t,{framebuffer:e=null,buffer:n=6144,drawBuffer:s=0,value:a=[0,0,0,0]}={}){(0,r.KQ)(t),(0,r.s8)(t,{framebuffer:e},(()=>{switch(n){case 6144:switch(a.constructor){case Int32Array:t.clearBufferiv(n,s,a);break;case Uint32Array:t.clearBufferuiv(n,s,a);break;case Float32Array:default:t.clearBufferfv(n,s,a)}break;case 6145:t.clearBufferfv(6145,0,[a]);break;case 6146:t.clearBufferiv(6146,0,[a]);break;case 34041:const[e,r]=a;t.clearBufferfi(34041,0,e,r);break;default:(0,i.h)(!1,o)}}))}},1953:function(t,e,n){"use strict";n.d(e,{Km:function(){return l},Lv:function(){return f},z6:function(){return c}});var r=n(3849),i=n(5008),o=n(9450),s=n(9335),a=n(2525);var u=n(5432);function c(t,e={}){const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:u=null,sourceWidth:c,sourceHeight:l,sourceType:f}=e;const{framebuffer:d,deleteFramebuffer:p}=h(t);(0,a.h)(d);const{gl:g,handle:m,attachments:y}=d;c=c||d.width,l=l||d.height,36064===o&&null===m&&(o=1028),(0,a.h)(y[o]),f=f||y[o].type,u=function(t,e,n,r,i){if(t)return t;e=e||5121;const o=(0,s.vN)(e,{clamped:!1}),u=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return(0,a.h)(!1),0}}(n);return new o(r*i*u)}(u,f,i,c,l),f=f||(0,s.O)(u);const v=g.bindFramebuffer(36160,m);return g.readPixels(n,r,c,l,i,f,u),g.bindFramebuffer(36160,v||null),p&&d.delete(),u}function l(t,{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}={}){let r=c(t,{sourceAttachment:e}),{width:i,height:o}=t;for(;o>n;)({data:r,width:i,height:o}=(0,s.KS)({data:r,width:i,height:o}));(0,s.c$)({data:r,width:i,height:o});const a=document.createElement("canvas");a.width=i,a.height=o;const u=a.getContext("2d"),l=u.createImageData(i,o);return l.data.set(r),u.putImageData(l,0,0),a.toDataURL()}function f(t,e,n={}){const{sourceX:r=0,sourceY:s=0,targetMipmaplevel:u=0,targetInternalFormat:c=6408}=n;let{targetX:l,targetY:f,targetZ:d,width:p,height:g}=n;const{framebuffer:m,deleteFramebuffer:y}=h(t);(0,a.h)(m);const{gl:v,handle:b}=m,x="undefined"!==typeof l||"undefined"!==typeof f||"undefined"!==typeof d;l=l||0,f=f||0,d=d||0;const w=v.bindFramebuffer(36160,b);(0,a.h)(e);let _=null;if(e instanceof i.Z&&(_=e,p=Number.isFinite(p)?p:_.width,g=Number.isFinite(g)?g:_.height,_.bind(0),e=_.target),x)switch(e){case 3553:case 34067:v.copyTexSubImage2D(e,u,l,f,r,s,p,g);break;case 35866:case 32879:(0,o.KQ)(v).copyTexSubImage3D(e,u,l,f,d,r,s,p,g)}else v.copyTexImage2D(e,u,c,r,s,p,g,0);return _&&_.unbind(),v.bindFramebuffer(36160,w||null),y&&m.delete(),_}function h(t){return t instanceof r.Z?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:(0,u.Y)(t),deleteFramebuffer:!0}}},3849:function(t,e,n){"use strict";n.d(e,{Z:function(){return d}});var r=n(9450),i=n(7577),o=n(4912),s=n(9830),a=n(6047),u=n(1953),c=n(4211),l=n(9579),f=n(2525);const h="Multiple render targets not supported";class d extends i.Z{static isSupported(t,e={}){const{colorBufferFloat:n,colorBufferHalfFloat:r}=e;let i=!0;return n&&(i=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),r&&(i=i&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),i}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new d(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=(0,r.KQ)(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=(0,r.KQ)(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t,e={}){super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize({width:t=1,height:e=1,attachments:n=null,color:r=!0,depth:i=!0,stencil:o=!1,check:s=!0,readBuffer:a,drawBuffers:u}){if((0,f.h)(t>=0&&e>=0,"Width and height need to be integers"),this.width=t,this.height=e,n)for(const c in n){const r=n[c];(Array.isArray(r)?r[0]:r).resize({width:t,height:e})}else n=this._createDefaultAttachments(r,i,o,t,e);this.update({clearAttachments:!0,attachments:n,readBuffer:a,drawBuffers:u}),n&&s&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update({attachments:t={},readBuffer:e,drawBuffers:n,clearAttachments:r=!1,resizeAttachments:i=!0}){this.attach(t,{clearAttachments:r,resizeAttachments:i});const{gl:o}=this,s=o.bindFramebuffer(36160,this.handle);return e&&this._setReadBuffer(e),n&&this._setDrawBuffers(n),o.bindFramebuffer(36160,s||null),this}resize(t={}){let{width:e,height:n}=t;if(null===this.handle)return(0,f.h)(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&r.cM.log(2,`Resizing framebuffer ${this.id} to ${e}x${n}`)();for(const r in this.attachments)this.attachments[r].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t,{clearAttachments:e=!1,resizeAttachments:n=!0}={}){const r={};e&&Object.keys(this.attachments).forEach((t=>{r[t]=null})),Object.assign(r,t);const i=this.gl.bindFramebuffer(36160,this.handle);for(const o in r){(0,f.h)(void 0!==o,"Misspelled framebuffer binding point?");const t=Number(o),e=r[t];let i=e;if(i)if(i instanceof s.Z)this._attachRenderbuffer({attachment:t,renderbuffer:i});else if(Array.isArray(e)){const[n,r=0,o=0]=e;i=n,this._attachTexture({attachment:t,texture:n,layer:r,level:o})}else this._attachTexture({attachment:t,texture:i,layer:0,level:0});else this._unattach(t);n&&i&&i.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,i||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(d.STATUS||{})[t]||`Framebuffer error ${t}`}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(t={}){const{color:e,depth:n,stencil:r,drawBuffers:i=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||r)&&(0,a.Z)(this.gl,{color:e,depth:n,stencil:r}),i.forEach(((t,e)=>{(0,a.$)(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(t={}){return r.cM.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(t={}){return r.cM.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(t={}){return r.cM.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(t={}){return r.cM.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(t={}){return r.cM.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(t={}){return r.cM.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate({attachments:t=[],x:e=0,y:n=0,width:i,height:o}){const s=(0,r.KQ)(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===e&&0===n&&void 0===i&&void 0===o?s.invalidateFramebuffer(36008,t):s.invalidateFramebuffer(36008,t,e,n,i,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(t,e,n){let r=this._getAttachmentParameterFallback(e);return null===r&&(this.gl.bindFramebuffer(36160,this.handle),r=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&r>1e3&&(r=(0,l.km)(this.gl,r)),r}getAttachmentParameters(t=36064,e,n=this.constructor.ATTACHMENT_PARAMETERS||[]){const r={};for(const i of n){r[e?(0,l.km)(this.gl,i):i]=this.getAttachmentParameter(t,i,e)}return r}getParameters(t=!0){const e=Object.keys(this.attachments),n={};for(const r of e){const e=Number(r);n[t?(0,l.km)(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!==typeof window&&window.open((0,u.Km)(this),"luma-debug-texture"),this}log(t=0,e=""){if(t>r.cM.level||"undefined"===typeof window)return this;e=e||`Framebuffer ${this.id}`;const n=(0,u.Km)(this,{targetMaxHeight:100});return r.cM.image({logLevel:t,message:e,image:n},e)(),this}bind({target:t=36160}={}){return this.gl.bindFramebuffer(t,this.handle),this}unbind({target:t=36160}={}){return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,r,i){let a=null;return t&&(a=a||{},a[36064]=new o.Z(this.gl,{id:`${this.id}-color0`,pixels:null,format:6408,type:5121,width:r,height:i,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),e&&n?(a=a||{},a[33306]=new s.Z(this.gl,{id:`${this.id}-depth-stencil`,format:35056,width:r,height:111}),this.ownResources.push(a[33306])):e?(a=a||{},a[36096]=new s.Z(this.gl,{id:`${this.id}-depth`,format:33189,width:r,height:i}),this.ownResources.push(a[36096])):n&&(0,f.h)(!1),a}_unattach(t){const e=this.attachments[t];e&&(e instanceof s.Z?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer({attachment:t=36064,renderbuffer:e}){const{gl:n}=this;n.framebufferRenderbuffer(36160,t,36161,e.handle),this.attachments[t]=e}_attachTexture({attachment:t=36064,texture:e,layer:n,level:i}){const{gl:o}=this;switch(o.bindTexture(e.target,e.handle),e.target){case 35866:case 32879:(0,r.KQ)(o).framebufferTextureLayer(36160,t,e.target,i,n);break;case 34067:const s=function(t){return t<34069?t+34069:t}(n);o.framebufferTexture2D(36160,t,s,e.handle,i);break;case 3553:o.framebufferTexture2D(36160,t,3553,e.handle,i);break;default:(0,f.h)(!1,"Illegal texture type")}o.bindTexture(e.target,null),this.attachments[t]=e}_setReadBuffer(t){const e=(0,r.vd)(this.gl);e?e.readBuffer(t):(0,f.h)(36064===t||1029===t,h),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=(0,r.KQ)(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):(0,f.h)(1===t.length&&(36064===t[0]||1029===t[0]),h)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=(0,c.N$)(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}d.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303]},7944:function(t,e,n){"use strict";n.d(e,{Z:function(){return z}});var r=n(7577),i=n(5008),o=n(3849),s=n(9450),a=n(9830),u=n(2525);const c={5126:E.bind(null,"uniform1fv",g,1,A),35664:E.bind(null,"uniform2fv",g,2,A),35665:E.bind(null,"uniform3fv",g,3,A),35666:E.bind(null,"uniform4fv",g,4,A),5124:E.bind(null,"uniform1iv",m,1,A),35667:E.bind(null,"uniform2iv",m,2,A),35668:E.bind(null,"uniform3iv",m,3,A),35669:E.bind(null,"uniform4iv",m,4,A),35670:E.bind(null,"uniform1iv",m,1,A),35671:E.bind(null,"uniform2iv",m,2,A),35672:E.bind(null,"uniform3iv",m,3,A),35673:E.bind(null,"uniform4iv",m,4,A),35674:E.bind(null,"uniformMatrix2fv",g,4,O),35675:E.bind(null,"uniformMatrix3fv",g,9,O),35676:E.bind(null,"uniformMatrix4fv",g,16,O),35678:_,35680:_,5125:E.bind(null,"uniform1uiv",y,1,A),36294:E.bind(null,"uniform2uiv",y,2,A),36295:E.bind(null,"uniform3uiv",y,3,A),36296:E.bind(null,"uniform4uiv",y,4,A),35685:E.bind(null,"uniformMatrix2x3fv",g,6,O),35686:E.bind(null,"uniformMatrix2x4fv",g,8,O),35687:E.bind(null,"uniformMatrix3x2fv",g,6,O),35688:E.bind(null,"uniformMatrix3x4fv",g,12,O),35689:E.bind(null,"uniformMatrix4x2fv",g,8,O),35690:E.bind(null,"uniformMatrix4x3fv",g,12,O),35678:_,35680:_,35679:_,35682:_,36289:_,36292:_,36293:_,36298:_,36299:_,36300:_,36303:_,36306:_,36307:_,36308:_,36311:_},l={},f={},h={},d=[0];function p(t,e,n,r){1===e&&"boolean"===typeof t&&(t=t?1:0),Number.isFinite(t)&&(d[0]=t,t=d);const i=t.length;if(i%e&&s.cM.warn(`Uniform size should be multiples of ${e}`,t)(),t instanceof n)return t;let o=r[i];o||(o=new n(i),r[i]=o);for(let s=0;s<i;s++)o[s]=t[s];return o}function g(t,e){return p(t,e,Float32Array,l)}function m(t,e){return p(t,e,Int32Array,f)}function y(t,e){return p(t,e,Uint32Array,h)}function v(t,e,n){const r=c[n.type];if(!r)throw new Error(`Unknown GLSL uniform type ${n.type}`);return r().bind(null,t,e)}function b(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error(`Failed to parse GLSL uniform name ${t}`);return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function x(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||(!0===t||!1===t||(t instanceof i.Z||(t instanceof a.Z||t instanceof o.Z&&Boolean(t.texture))))}function w(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let t=0,e=n.length;t<e;++t)r[t]=n[t]}else t[e]=n.slice();else t[e]=n}function _(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function E(t,e,n,r){let i=null,o=null;return(s,a,c)=>{const l=e(c,n),f=l.length;let h=!1;if(null===i)i=new Float32Array(f),o=f,h=!0;else{(0,u.h)(o===f,"Uniform length cannot change.");for(let t=0;t<f;++t)if(l[t]!==i[t]){h=!0;break}}return h&&(r(s,t,a,l),i.set(l)),h}}function A(t,e,n,r){t[e](n,r)}function O(t,e,n,r){t[e](n,!1,r)}function S(t,e="unnamed"){const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}function C(t,e,n,r){const i=t.split(/\r?\n/),o={},s={},a=r||S(e)||"(unnamed)",u=`${function(t){switch(t){case 35632:return"fragment";case 35633:return"vertex";default:return"unknown type"}}(n)} shader ${a}`;for(let l=0;l<i.length;l++){const e=i[l];if(e.length<=1)continue;const n=e.split(":"),r=n[0],a=parseInt(n[2],10);if(isNaN(a))throw new Error(`GLSL compilation error in ${u}: ${t}`);"WARNING"!==r?o[a]=e:s[a]=e}const c=function(t,e=1,n=": "){const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map(((t,r)=>{const o=String(r+e),s=o.length;return P(o,i-s)+n+t}))}(e);return{shaderName:u,errors:M(o,c),warnings:M(s,c)}}function M(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if((t[r+3]||t[r+2]||t[r+1])&&(n+=`${i}\n`,t[r+1])){const e=t[r+1],i=e.split(":",3),o=i[0],s=parseInt(i[1],10)||0;n+=P(`^^^ ${o}: ${e.substring(i.join(":").length+1).trim()}\n\n`,s)}}return n}function P(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return`${n}${t}`}var k=n(4538);class T extends r.Z{static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return(0,u.h)(!1),"unknown"}}constructor(t,e){(0,s.JD)(t),(0,u.h)("string"===typeof e.source,"Shader: GLSL source code must be a JavaScript string");super(t,{id:S(e.source,null)||e.id||(0,k.hQ)(`unnamed ${T.getTypeName(e.shaderType)}`)}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize({source:t}){const e=S(t,null);e&&(this.id=(0,k.hQ)(e)),this._compile(t)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return`${T.getTypeName(this.shaderType)}:${this.id}`}getName(){return S(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(t=this.source){t.startsWith("#version ")||(t=`#version 100\n${t}`),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle);if(!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:r}=C(t,this.source,this.shaderType,this.id);throw s.cM.error(`GLSL compilation errors in ${e}\n${n}`)(),s.cM.warn(`GLSL compilation warnings in ${e}\n${r}`)(),new Error(`GLSL compilation errors in ${e}`)}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class D extends T{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class F extends T{constructor(t,e){"string"===typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}var j=n(4072),L=n(8522);class R{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getActiveAttrib(t.handle,r),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,i,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!(0,s.D0)(e))return;const n=e.getProgramParameter(t.handle,35971);for(let r=0;r<n;r++){const{name:n,type:i,size:o}=e.getTransformFeedbackVarying(t.handle,r);this._addVarying(r,n,i,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,r){const{type:i,components:o}=(0,L.hJ)(n),s={type:i,size:r*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new j.Z(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,r){const{type:i,components:o}=(0,L.hJ)(n),s={location:t,name:e,accessor:new j.Z({type:i,size:r*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}var I=n(9579);const N=35981,B=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class z extends r.Z{constructor(t,e={}){super(t,e),this.stubRemovedMethods("Program","v6.0",B),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(t={}){const{hash:e,vs:n,fs:r,varyings:i,bufferMode:o=N}=t;return this.hash=e||"",this.vs="string"===typeof n?new D(this.gl,{id:`${t.id}-vs`,source:n}):n,this.fs="string"===typeof r?new F(this.gl,{id:`${t.id}-fs`,source:r}):r,(0,u.h)(this.vs instanceof D),(0,u.h)(this.fs instanceof F),this.uniforms={},this._textureUniforms={},i&&i.length>0&&((0,s.KQ)(this.gl),this.varyings=i,this.gl2.transformFeedbackVaryings(this.handle,i,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new R(this),this.setProps(t)}delete(t={}){return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw({logPriority:t,drawMode:e=4,vertexCount:n,offset:r=0,start:i,end:o,isIndexed:a=!1,indexType:c=5123,instanceCount:l=0,isInstanced:f=l>0,vertexArray:h=null,transformFeedback:d,framebuffer:p,parameters:g={},uniforms:m,samplers:y}){if((m||y)&&(s.cM.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(m||{})),s.cM.priority>=t){const r=p?p.id:"default",i=`mode=${(0,I.km)(this.gl,e)} verts=${n} instances=${l} indexType=${(0,I.km)(this.gl,c)} isInstanced=${f} isIndexed=${a} Framebuffer=${r}`;s.cM.log(t,i)()}return(0,u.h)(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===n||f&&0===l)&&(h.bindForDraw(n,l,(()=>{if(void 0!==p&&(g=Object.assign({},g,{framebuffer:p})),d){const t=(0,L.$Z)(e);d.begin(t)}this._bindTextures(),(0,s.s8)(this.gl,g,(()=>{a&&f?this.gl2.drawElementsInstanced(e,n,c,r,l):a&&(0,s.D0)(this.gl)&&!isNaN(i)&&!isNaN(o)?this.gl2.drawRangeElements(e,i,o,n,c,r):a?this.gl.drawElements(e,n,c,r):f?this.gl2.drawArraysInstanced(e,r,n,l):this.gl.drawArrays(e,r,n)})),d&&d.end()})),!0)}setUniforms(t={}){s.cM.priority>=2&&function(t,e,n){for(const r in t){const i=t[r];if((!n||Boolean(n[r]))&&!x(i))throw e=e?`${e} `:"",console.error(`${e} Bad uniform ${r}`,i),new Error(`${e} Bad uniform ${r}`)}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],r=this._uniformSetters[e];if(r){let t=n,s=!1;if(t instanceof o.Z&&(t=t.texture),t instanceof i.Z)if(s=this.uniforms[e]!==n,s){void 0===r.textureIndex&&(r.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:i}=r;n.bind(i),t=i,this._textureUniforms[e]=n}else t=r.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(r(t)||s)&&w(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const r of e){switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new D({handle:r});break;case 35632:n.fs=new F({handle:r})}}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=(0,k.hQ)(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?`${t}-program`:"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),s.cM.time(4,`linkProgram for ${this._getName()}`)(),t.linkProgram(this.handle),s.cM.timeEnd(4,`linkProgram for ${this._getName()}`)(),t.debug||s.cM.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error(`Error linking: ${t.getProgramInfoLog(this.handle)}`);t.validateProgram(this.handle);if(!t.getProgramParameter(this.handle,35715))throw new Error(`Error validating: ${t.getProgramInfoLog(this.handle)}`)}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:r}=b(n.name);let i=t.getUniformLocation(this.handle,r);if(this._uniformSetters[r]=v(t,i,n),n.size>1)for(let e=0;e<n.size;e++)i=t.getUniformLocation(this.handle,`${r}[${e}]`),this._uniformSetters[`${r}[${e}]`]=v(t,i,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}},9830:function(t,e,n){"use strict";n.d(e,{Z:function(){return u}});var r=n(7577);const i="EXT_color_buffer_float";var o={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:i,bpp:2},33327:{gl2:i,bpp:4},34842:{gl2:i,bpp:8},33326:{gl2:i,bpp:4},33328:{gl2:i,bpp:8},34836:{gl2:i,bpp:16},35898:{gl2:i,bpp:4}},s=n(9450),a=n(2525);class u extends r.Z{static isSupported(t,{format:e}={format:null}){return!e||function(t,e,n){const r=n[e];if(!r)return!1;const i=(0,s.D0)(t)&&r.gl2||r.gl1;return"string"===typeof i?t.getExtension(i):i}(t,e,o)}static getSamplesForFormat(t,{format:e}){return t.getInternalformatParameter(36161,e,32937)}constructor(t,e={}){super(t,e),this.initialize(e),Object.seal(this)}initialize({format:t,width:e=1,height:n=1,samples:r=0}){return(0,a.h)(t,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&(0,s.D0)(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,t,e,n):this.gl.renderbufferStorage(36161,t,e,n),this.format=t,this.width=e,this.height=n,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*o[this.format].bpp),this}resize({width:t,height:e}){return t!==this.width||e!==this.height?this.initialize({width:t,height:e,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){this.gl.bindRenderbuffer(36161,this.handle);return this.gl.getRenderbufferParameter(36161,t)}}},7577:function(t,e,n){"use strict";n.d(e,{Z:function(){return l}});var r=n(9450),i=n(9835),o=n(9579),s=n(2525),a=n(4538),u=n(7469);const c="Resource subclass must define virtual methods";class l{constructor(t,e={}){(0,r.JD)(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||(0,a.hQ)(this.constructor.name),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return`${this.constructor.name}(${this.id})`}get handle(){return this._handle}delete({deleteChildren:t=!1}={}){const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(t=this.handle){if("function"!==typeof t)return this._bindHandle(t),this;let e;return this._bound?e=t():(this._bindHandle(this.handle),this._bound=!0,e=t(),this._bound=!1,this._bindHandle(null)),e}unbind(){this.bind(null)}getParameter(t,e={}){t=(0,o.sF)(this.gl,t),(0,s.h)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,r.D0)(this.gl);if(!((!("webgl2"in n)||t)&&(!("extension"in n)||this.gl.getExtension(n.extension)))){const e=n.webgl1,r="webgl2"in n?n.webgl2:n.webgl1;return t?r:e}}return this._getParameter(t,e)}getParameters(t={}){const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},s=(0,r.D0)(this.gl),a={},u=e||Object.keys(i);for(const r of u){const e=i[r];if(e&&(!("webgl2"in e)||s)&&(!("extension"in e)||this.gl.getExtension(e.extension))){const i=n?(0,o.km)(this.gl,r):r;a[i]=this.getParameter(r,t),n&&"GLenum"===e.type&&(a[i]=(0,o.km)(this.gl,a[i]))}}return a}setParameter(t,e){t=(0,o.sF)(this.gl,t),(0,s.h)(t);const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=(0,r.D0)(this.gl);if(!((!("webgl2"in n)||t)&&(!("extension"in n)||this.gl.getExtension(n.extension))))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=(0,o.sF)(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return(0,u.F)(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(c)}_deleteHandle(){throw new Error(c)}_bindHandle(t){throw new Error(c)}_getOptsFromHandle(){throw new Error(c)}_getParameter(t,e){throw new Error(c)}_setParameter(t,e){throw new Error(c)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this.constructor.name,e=i.l.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}_removeStats(){const t=this.constructor.name;i.l.get("Resource Counts").get(`${t}s Active`).decrementCount()}_trackAllocatedMemory(t,e=this.constructor.name){const n=i.l.get("Memory Usage");n.get("GPU Memory").addCount(t),n.get(`${e} Memory`).addCount(t),this.byteLength=t}_trackDeallocatedMemory(t=this.constructor.name){const e=i.l.get("Memory Usage");e.get("GPU Memory").subtractCount(this.byteLength),e.get(`${t} Memory`).subtractCount(this.byteLength),this.byteLength=0}}},4912:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(9450),i=n(5008),o=n(2525);let s="";class a extends i.Z{static isSupported(t,e){return i.Z.isSupported(t,e)}constructor(t,e={}){var n,i;(0,r.JD)(t),(e instanceof Promise||"string"===typeof e)&&(e={data:e}),"string"===typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,(0,o.h)("string"===typeof n),n=s+n,new Promise(((t,e)=>{try{const r=new Image;r.onload=()=>t(r),r.onerror=()=>e(new Error(`Could not load image ${n}.`)),r.crossOrigin=i&&i.crossOrigin||"anonymous",r.src=n}catch(r){e(r)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}},3889:function(t,e,n){"use strict";n.d(e,{ae:function(){return i},C:function(){return o},pH:function(){return s},br:function(){return a},KR:function(){return u}});var r=n(9450);const i={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},o={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},s={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function a(t,e){const n=i[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const o=(0,r.D0)(t)&&n.gl2||n.gl1;return"string"===typeof o?t.getExtension(o):o}function u(t,e){const n=i[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}},5008:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var r=n(9450),i=n(9718),o=n(7577),s=n(3478),a=n(3889),u=n(2525),c=n(4538);const l=[9729,9728],f=i.CO.WebGLBuffer||function(){};class h extends o.Z{static isSupported(t,e={}){const{format:n,linearFiltering:r}=e;let i=!0;return n&&(i=i&&(0,a.br)(t,n),i=i&&(!r||(0,a.KR)(t,n))),i}constructor(t,e){const{id:n=(0,c.hQ)("texture"),handle:r,target:i}=e;super(t,{id:n,handle:r}),this.target=i,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return`Texture(${this.id},${this.width}x${this.height})`}initialize(t={}){let e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:o=6408,border:s=0,recreate:a=!1,parameters:u={},pixelStore:c={},textureUnit:l}=t;e||(e=i);let{width:f,height:h,dataFormat:d,type:p,compressed:g=!1,mipmaps:m=!0}=t;const{depth:y=0}=t;return({width:f,height:h,compressed:g,dataFormat:d,type:p}=this._deduceParameters({format:o,type:p,dataFormat:d,compressed:g,data:e,width:f,height:h})),this.width=f,this.height=h,this.depth=y,this.format=o,this.type=p,this.dataFormat=d,this.border=s,this.textureUnit=l,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),m&&this._isNPOT()&&(r.cM.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),m=!1,this._updateForNPOT(u)),this.mipmaps=m,this.setImageData({data:e,width:f,height:h,depth:y,format:o,type:p,dataFormat:d,border:s,mipmaps:m,parameters:c,compressed:g}),m&&this.generateMipmap(),this.setParameters(u),a&&(this.data=e),n&&(this._video={video:e,parameters:u,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize({height:t,width:e,mipmaps:n=!1}){return e!==this.width||t!==this.height?this.initialize({width:e,height:t,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:n}):this}generateMipmap(t={}){return this._isNPOT()?(r.cM.warn(`texture: ${this} is Non-Power-Of-Two, disabling mipmaping`)(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:o=this.format,border:s=this.border,offset:c=0,parameters:l={}}=t;let{data:f=null,type:h=this.type,width:d=this.width,height:p=this.height,dataFormat:g=this.dataFormat,compressed:m=!1}=t;f||(f=n),({type:h,dataFormat:g,compressed:m,width:d,height:p}=this._deduceParameters({format:o,type:h,dataFormat:g,compressed:m,data:f,width:d,height:p}));const{gl:y}=this;y.bindTexture(this.target,this.handle);let v,b=null;if(({data:f,dataType:b}=this._getDataType({data:f,compressed:m})),(0,r.s8)(this.gl,l,(()=>{switch(b){case"null":y.texImage2D(e,i,o,d,p,s,g,h,f);break;case"typed-array":y.texImage2D(e,i,o,d,p,s,g,h,f,c);break;case"buffer":v=(0,r.KQ)(y),v.bindBuffer(35052,f.handle||f),v.texImage2D(e,i,o,d,p,s,g,h,c),v.bindBuffer(35052,null);break;case"browser-object":(0,r.D0)(y)?y.texImage2D(e,i,o,d,p,s,g,h,f):y.texImage2D(e,i,o,g,h,f);break;case"compressed":for(const[t,n]of f.entries())y.compressedTexImage2D(e,t,n.format,n.width,n.height,s,n.data);break;default:(0,u.h)(!1,"Unknown image data type")}})),f&&f.byteLength)this._trackAllocatedMemory(f.byteLength,"Texture");else{const t=a.C[this.dataFormat]||4,e=a.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:e=null,data:n=null,x:i=0,y:o=0,width:a=this.width,height:c=this.height,level:l=0,format:h=this.format,type:d=this.type,dataFormat:p=this.dataFormat,compressed:g=!1,offset:m=0,border:y=this.border,parameters:v={}}){if(({type:d,dataFormat:p,compressed:g,width:a,height:c}=this._deduceParameters({format:h,type:d,dataFormat:p,compressed:g,data:n,width:a,height:c})),(0,u.h)(0===this.depth,"texSubImage not supported for 3D textures"),n||(n=e),n&&n.data){const t=n;n=t.data,a=t.shape[0],c=t.shape[1]}n instanceof s.Z&&(n=n.handle),this.gl.bindTexture(this.target,this.handle),(0,r.s8)(this.gl,v,(()=>{if(g)this.gl.compressedTexSubImage2D(t,l,i,o,a,c,h,n);else if(null===n)this.gl.texSubImage2D(t,l,i,o,a,c,p,d,null);else if(ArrayBuffer.isView(n))this.gl.texSubImage2D(t,l,i,o,a,c,p,d,n,m);else if(n instanceof f){const e=(0,r.KQ)(this.gl);e.bindBuffer(35052,n),e.texSubImage2D(t,l,i,o,a,c,p,d,m),e.bindBuffer(35052,null)}else if((0,r.D0)(this.gl)){(0,r.KQ)(this.gl).texSubImage2D(t,l,i,o,a,c,p,d,n)}else this.gl.texSubImage2D(t,l,i,o,p,d,n)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return r.cM.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType({data:t,compressed:e=!1}){return e?{data:t,dataType:"compressed"}:null===t?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof s.Z?{data:t.handle,dataType:"buffer"}:t instanceof f?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:r,height:i,dataFormat:o,type:s,compressed:u}=t;const c=a.ae[e];return o=o||c&&c.dataFormat,s=s||c&&c.types[0],u=u||c&&c.compressed,({width:r,height:i}=this._deduceImageSize(n,r,i)),{dataFormat:o,type:s,compressed:u,width:r,height:i,format:e,data:n}}_deduceImageSize(t,e,n){let r;return r="undefined"!==typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!==typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},(0,u.h)(r,"Could not deduced texture size"),(0,u.h)(void 0===e||r.width===e,"Deduced texture width does not match supplied width"),(0,u.h)(void 0===n||r.height===n,"Deduced texture height does not match supplied height"),r}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:(0,u.h)(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(0,r.D0)(this.gl)&&(!(!this.width||!this.height)&&(!(0,c.wt)(this.width)||!(0,c.wt)(this.height)))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===l.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}},1053:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(9450),i=n(7577),o=n(3478),s=n(4538);class a extends i.Z{static isSupported(t){return(0,r.D0)(t)}constructor(t,e={}){(0,r.KQ)(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(t={}){return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,(0,s.nK)(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(t={}){return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:o,byteOffset:s}=this._getBufferParams(e);return n<0?(this.unused[t]=i,r.cM.warn((()=>`${this.id} unused varying buffer ${t}`))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,s,o),this)}begin(t=0){return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,r;return t instanceof o.Z===!1?(r=t.buffer,n=t.byteSize,e=t.byteOffset):r=t,void 0===e&&void 0===n||(e=e||0,n=n||r.byteLength-e),{buffer:r,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:r}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,r,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e,n=0,r){const i=e&&e.handle;return i&&void 0!==r?this.gl.bindBufferRange(35982,t,i,n,r):this.gl.bindBufferBase(35982,t,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}},4211:function(t,e,n){"use strict";n.d(e,{U6:function(){return s},ag:function(){return a},N$:function(){return u}});var r=n(6948),i=n(9450),o=n(2525);function s(t,e){return a(t,e)}function a(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>c(t,e)))}function u(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in r.Z)void 0===t.luma.caps[e]&&(t.luma.caps[e]=c(t,e));return t.luma.caps}function c(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=r.Z[e];let s;(0,o.h)(n,e);const a=(0,i.D0)(t)&&n[1]||n[0];if("function"===typeof a)s=a(t);else if(Array.isArray(a)){s=!0;for(const e of a)s=s&&Boolean(t.getExtension(e))}else"string"===typeof a?s=Boolean(t.getExtension(a)):"boolean"===typeof a?s=a:(0,o.h)(!1);return s}(t,e)),t.luma.caps[e]||i.cM.log(2,`Feature: ${e} not supported`)(),t.luma.caps[e]}},6948:function(t,e,n){"use strict";n.d(e,{h:function(){return o}});var r=n(3849),i=n(4912);const o={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};e.Z={[o.WEBGL2]:[!1,!0],[o.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[o.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[o.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[o.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[o.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[o.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[o.FLOAT_BLEND]:["EXT_float_blend"],[o.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[o.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[o.TEXTURE_FLOAT]:["OES_texture_float",!0],[o.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[o.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[o.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[o.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[o.COLOR_ATTACHMENT_RGBA32F]:[function(t){const e=new i.Z(t,{format:6408,type:5126,dataFormat:6408}),n=new r.Z(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),o=n.getStatus();return e.delete(),n.delete(),36053===o},"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[o.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[o.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[o.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[o.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[o.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]}},9835:function(t,e,n){"use strict";n.d(e,{l:function(){return a}});var r=n(9450),i=n(6203),o=n(9718);const s="8.5.7";const a=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new i.jk({id:t})),this.stats.get(t)}};if(o.CO.luma&&o.CO.luma.VERSION!==s)throw new Error(`luma.gl - multiple VERSIONs detected: ${o.CO.luma.VERSION} vs 8.5.7`);o.CO.luma||((0,o.jU)()&&r.cM.log(1,"luma.gl 8.5.7 - set luma.log.level=1 (or higher) to trace rendering")(),o.CO.luma=o.CO.luma||{VERSION:s,version:s,log:r.cM,stats:a,globals:{modules:{},nodeIO:{}}});o.CO.luma},2525:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}n.d(e,{h:function(){return r}})},2610:function(t,e,n){"use strict";n.d(e,{k:function(){return i}});var r=n(9450);function i(t,e,n){const{removedProps:i={},deprecatedProps:o={},replacedProps:s={}}=n;for(const u in i)if(u in e){const e=i[u]?`${t}.${i[u]}`:"N/A";r.cM.removed(`${t}.${u}`,e)()}for(const u in o)if(u in e){const e=o[u];r.cM.deprecated(`${t}.${u}`,`${t}.${e}`)()}let a=null;for(const u in s)if(u in e){const n=s[u];r.cM.deprecated(`${t}.${u}`,`${t}.${n}`)(),a=a||Object.assign({},e),a[n]=e[u],delete a[u]}return a||e}},7469:function(t,e,n){"use strict";n.d(e,{F:function(){return i}});var r=n(9450);function i(t,e,n,i){const o=`See luma.gl ${n} Upgrade Guide at https://luma.gl/docs/upgrade-guide`,s=Object.getPrototypeOf(t);i.forEach((t=>{s.methodName||(s[t]=()=>{throw r.cM.removed(`Calling removed method ${e}.${t}: `,o)(),new Error(t)})}))}},4538:function(t,e,n){"use strict";n.d(e,{hQ:function(){return o},wt:function(){return s},nK:function(){return a}});var r=n(2525);const i={};function o(t="id"){i[t]=i[t]||1;return`${t}-${i[t]++}`}function s(t){return(0,r.h)("number"===typeof t,"Input must be a number"),t&&0===(t&t-1)}function a(t){let e=!0;for(const n in t){e=!1;break}return e}},8522:function(t,e,n){"use strict";n.d(e,{$Z:function(){return u},hJ:function(){return c},jG:function(){return l}});var r=n(2525);const i=5126,o=5124,s=5125,a={[i]:[i,1,"float"],35664:[i,2,"vec2"],35665:[i,3,"vec3"],35666:[i,4,"vec4"],[o]:[o,1,"int"],35667:[o,2,"ivec2"],35668:[o,3,"ivec3"],35669:[o,4,"ivec4"],[s]:[s,1,"uint"],36294:[s,2,"uvec2"],36295:[s,3,"uvec3"],36296:[s,4,"uvec4"],35670:[i,1,"bool"],35671:[i,2,"bvec2"],35672:[i,3,"bvec3"],35673:[i,4,"bvec4"],35674:[i,8,"mat2"],35685:[i,8,"mat2x3"],35686:[i,8,"mat2x4"],35675:[i,12,"mat3"],35687:[i,12,"mat3x2"],35688:[i,12,"mat3x4"],35676:[i,16,"mat4"],35689:[i,16,"mat4x2"],35690:[i,16,"mat4x3"]};function u(t){switch(t){case 0:return 0;case 1:case 3:case 2:return 1;case 4:case 5:case 6:return 4;default:return(0,r.h)(!1),0}}function c(t){const e=a[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function l(t,e){switch(t){case 5120:case 5121:case 5122:case 5123:t=i}for(const n in a){const[r,i,o]=a[n];if(r===t&&i===e)return{glType:n,name:o}}return null}},9579:function(t,e,n){"use strict";n.d(e,{sF:function(){return i},km:function(){return o}});var r=n(2525);function i(t,e){if("string"!==typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return(0,r.h)(void 0!==i,`Accessing undefined constant GL.${e}`),i}function o(t,e){e=Number(e);for(const n in t)if(t[n]===e)return`GL.${n}`;return String(e)}},5432:function(t,e,n){"use strict";n.d(e,{h:function(){return d},Y:function(){return p}});var r=n(4912),i=n(9450),o=n(5008);const s=[34069,34070,34071,34072,34073,34074];class a extends o.Z{constructor(t,e={}){(0,i.JD)(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(t={}){const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage({face:t,data:e,x:n=0,y:r=0,mipmapLevel:i=0}){return this._subImage({target:t,data:e,x:n,y:r,mipmapLevel:i})}async setCubeMapImageData({width:t,height:e,pixels:n,data:r,border:o=0,format:a=6408,type:u=5121}){const{gl:c}=this,l=n||r,f=await Promise.all(s.map((t=>{const e=l[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),s.forEach(((n,r)=>{f[r].length>1&&!1!==this.opts.mipmaps&&i.cM.warn(`${this.id} has mipmap and multiple LODs.`)(),f[r].forEach(((r,i)=>{t&&e?c.texImage2D(n,i,a,t,e,o,a,u,r):c.texImage2D(n,i,a,a,u,r)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:r,pixels:i,data:o,border:s=0,format:a=6408,type:u=5121}=t,{gl:c}=this,l=i||o;return this.bind(),l instanceof Promise?l.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?c.texImage2D(e,0,a,n,r,s,a,u,l):c.texImage2D(e,0,a,a,u,l),this}}a.FACES=s;var u=n(3889),c=n(3478);class l extends o.Z{static isSupported(t){return(0,i.D0)(t)}constructor(t,e={}){(0,i.KQ)(t),super(t,e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1})),this.initialize(e),Object.seal(this)}setImageData({level:t=0,dataFormat:e=6408,width:n,height:r,depth:o=1,border:s=0,format:a,type:l=5121,offset:f=0,data:h,parameters:d={}}){if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),(0,i.s8)(this.gl,d,(()=>{ArrayBuffer.isView(h)&&this.gl.texImage3D(this.target,t,e,n,r,o,s,a,l,h),h instanceof c.Z&&(this.gl.bindBuffer(35052,h.handle),this.gl.texImage3D(this.target,t,e,n,r,o,s,a,l,f))})),h&&h.byteLength)this._trackAllocatedMemory(h.byteLength,"Texture");else{const t=u.C[this.dataFormat]||4,e=u.pH[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}var f=n(3849),h=n(2525);function d(t,e){(0,h.h)(t instanceof r.Z||t instanceof a||t instanceof l);const n=t.constructor,{gl:i,width:o,height:s,format:u,type:c,dataFormat:f,border:d,mipmaps:p}=t;return new n(i,Object.assign({width:o,height:s,format:u,type:c,dataFormat:f,border:d,mipmaps:p},e))}function p(t,e){const{gl:n,width:r,height:i,id:o}=t;return new f.Z(n,Object.assign({},e,{id:`framebuffer-for-${o}`,width:r,height:i,attachments:{36064:t}}))}},9335:function(t,e,n){"use strict";n.d(e,{O:function(){return r},vN:function(){return i},c$:function(){return o},KS:function(){return s}});function r(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error("Failed to deduce GL constant from typed array")}}function i(t,{clamped:e=!0}={}){switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function o({data:t,width:e,height:n,bytesPerPixel:r=4,temp:i}){const o=e*r;i=i||new Uint8Array(o);for(let s=0;s<n/2;++s){const e=s*o,r=(n-s-1)*o;i.set(t.subarray(e,e+o)),t.copyWithin(e,r,r+o),t.set(i,r)}}function s({data:t,width:e,height:n}){const r=Math.round(e/2),i=Math.round(n/2),o=new Uint8Array(r*i*4);for(let s=0;s<i;s++)for(let n=0;n<r;n++)for(let i=0;i<4;i++)o[4*(s*r+n)+i]=t[4*(2*s*e+2*n)+i];return{data:o,width:r,height:i}}},9296:function(t){"use strict";t.exports=n,t.exports.default=n;var e=1e20;function n(t,e,n,r,i,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=i||"sans-serif",this.fontWeight=o||"normal",this.radius=n||8;var s=this.size=this.fontSize+2*this.buffer,a=s+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=s,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a),this.useMetrics=void 0!==this.ctx.measureText("A").actualBoundingBoxLeft,this.middle=Math.round(s/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(t,e,n,r,o,s){for(var a=0;a<e;a++)i(t,a,e,n,r,o,s);for(var u=0;u<n;u++)i(t,u*e,1,e,r,o,s)}function i(t,n,r,i,o,s,a){var u,c,l,f;for(s[0]=0,a[0]=-e,a[1]=e,u=0;u<i;u++)o[u]=t[n+u*r];for(u=1,c=0,l=0;u<i;u++){do{f=s[c],l=(o[u]-o[f]+u*u-f*f)/(u-f)/2}while(l<=a[c]&&--c>-1);s[++c]=u,a[c]=l,a[c+1]=e}for(u=0,c=0;u<i;u++){for(;a[c+1]<u;)c++;f=s[c],t[n+u*r]=o[f]+(u-f)*(u-f)}}n.prototype._draw=function(t,n){var i,o,s,a,u,c,l,f,h,d=this.ctx.measureText(t),p=d.width,g=2*this.buffer;n&&this.useMetrics?(u=Math.floor(d.actualBoundingBoxAscent),f=this.buffer+Math.ceil(d.actualBoundingBoxAscent),c=this.buffer,l=this.buffer,i=(o=Math.min(this.size,Math.ceil(d.actualBoundingBoxRight-d.actualBoundingBoxLeft)))+g,s=(a=Math.min(this.size-c,Math.ceil(d.actualBoundingBoxAscent+d.actualBoundingBoxDescent)))+g,this.ctx.textBaseline="alphabetic"):(i=o=this.size,s=a=this.size,u=19*this.fontSize/24,c=l=0,f=this.middle,this.ctx.textBaseline="middle"),o&&a&&(this.ctx.clearRect(l,c,o,a),this.ctx.fillText(t,this.buffer,f),h=this.ctx.getImageData(l,c,o,a));var m=new Uint8ClampedArray(i*s);return function(t,n,r,i,o,s,a){s.fill(e,0,n*r),a.fill(0,0,n*r);for(var u=(n-i)/2,c=0;c<o;c++)for(var l=0;l<i;l++){var f=(c+u)*n+l+u,h=t.data[4*(c*i+l)+3]/255;if(1===h)s[f]=0,a[f]=e;else if(0===h)s[f]=e,a[f]=0;else{var d=Math.max(0,.5-h),p=Math.max(0,h-.5);s[f]=d*d,a[f]=p*p}}}(h,i,s,o,a,this.gridOuter,this.gridInner),r(this.gridOuter,i,s,this.f,this.v,this.z),r(this.gridInner,i,s,this.f,this.v,this.z),function(t,e,n,r,i,o,s){for(var a=0;a<e*n;a++){var u=Math.sqrt(r[a])-Math.sqrt(i[a]);t[a]=Math.round(255-255*(u/o+s))}}(m,i,s,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:m,metrics:{width:o,height:a,sdfWidth:i,sdfHeight:s,top:u,left:0,advance:p}}},n.prototype.draw=function(t){return this._draw(t,!1).data},n.prototype.drawWithMetrics=function(t){return this._draw(t,!0)}},6357:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(4034),i=n(394);class o extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){get ELEMENTS(){return(0,i.Z)(!1),0}clone(){return(new this.constructor).copy(this)}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}to(t){return t===this?this:(0,r.kJ)(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(r.vc)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+(0,r.Bw)(this[n],t);return`${t.printTypes?this.constructor.name:""}[${e}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!(0,r.fS)(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){void 0===n&&(n=e,e=t,t=this);for(let r=0;r<this.ELEMENTS;++r){const i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if(Array.isArray(t))return this.multiply(t);for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.scale(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}multiplyByScalar(t){return this.scale(t)}get elements(){return this}check(){if(r.vc.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}}},1e3:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(6357),i=n(6281),o=n(4034),s=n(394);class a extends r.Z{get ELEMENTS(){return(0,s.Z)(!1),0}get RANK(){return(0,s.Z)(!1),0}toString(){let t="[";if(o.vc.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+e]}`}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=` ${this[e]}`}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=(0,i.u5)(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)e[r]=this[n+r];return e}setColumn(t,e){const n=t*this.RANK;for(let r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}},5451:function(t,e,n){"use strict";n.d(e,{Z:function(){return p}});var r=n(6281),i=n(1e3),o=n(1031),s=n(5975),a=n(1437),u=n(7160),c=n(8333);const l=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),f=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),h=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),d={};class p extends i.Z{static get IDENTITY(){return d.IDENTITY=d.IDENTITY||Object.freeze(new p(l)),d.IDENTITY}static get ZERO(){return d.ZERO=d.ZERO||Object.freeze(new p(f)),d.ZERO}get INDICES(){return h}get ELEMENTS(){return 16}get RANK(){return 4}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,r,i,o,s,a,u,c,l,f,h,d,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=o,this[6]=s,this[7]=a,this[8]=u,this[9]=c,this[10]=l,this[11]=f,this[12]=h,this[13]=d,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,r,i,o,s,a,u,c,l,f,h,d,p,g){return this[0]=t,this[1]=i,this[2]=u,this[3]=h,this[4]=e,this[5]=o,this[6]=c,this[7]=d,this[8]=n,this[9]=s,this[10]=l,this[11]=p,this[12]=r,this[13]=a,this[14]=f,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(l)}fromQuaternion(t){return s.en(this,t),this.check()}frustum({left:t,right:e,bottom:n,top:r,near:i,far:o}){return o===1/0?p._computeInfinitePerspectiveOffCenter(this,t,e,n,r,i):s.oy(this,t,e,n,r,i,o),this.check()}static _computeInfinitePerspectiveOffCenter(t,e,n,r,i,o){const s=2*o/(n-e),a=2*o/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),l=-2*o;return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=l,t[15]=0,t}lookAt(t,e,n){return 1===arguments.length&&({eye:t,center:e,up:n}=t),e=e||[0,0,0],n=n||[0,1,0],s.zB(this,t,e,n),this.check()}ortho({left:t,right:e,bottom:n,top:r,near:i=.1,far:o=500}){return s.M5(this,t,e,n,r,i,o),this.check()}orthographic({fovy:t=45*Math.PI/180,aspect:e=1,focalDistance:n=1,near:r=.1,far:i=500}){if(t>2*Math.PI)throw Error("radians");const o=t/2,s=n*Math.tan(o),a=s*e;return(new p).ortho({left:-a,right:a,bottom:-s,top:s,near:r,far:i})}perspective({fovy:t,fov:e=45*Math.PI/180,aspect:n=1,near:r=.1,far:i=500}={}){if((t=t||e)>2*Math.PI)throw Error("radians");return s.G3(this,t,n,r,i),this.check()}determinant(){return s.GH(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t=[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=null){const n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],o=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*o,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*o,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*o,t}transpose(){return s.p4(this,this),this.check()}invert(){return s.U_(this,this),this.check()}multiplyLeft(t){return s.Jp(this,t,this),this.check()}multiplyRight(t){return s.Jp(this,this,t),this.check()}rotateX(t){return s.lM(this,this,t),this.check()}rotateY(t){return s.uD(this,this,t),this.check()}rotateZ(t){return s.jI(this,this,t),this.check()}rotateXYZ([t,e,n]){return this.rotateX(t).rotateY(e).rotateZ(n)}rotateAxis(t,e){return s.U1(this,this,t,e),this.check()}scale(t){return Array.isArray(t)?s.bA(this,this,t):s.bA(this,this,[t,t,t]),this.check()}translate(t){return s.Iu(this,this,t),this.check()}transform(t,e){return 4===t.length?(e=c.fF(e||[-0,-0,-0,-0],t,this),(0,r.IL)(e,4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;switch(n){case 2:e=a.fF(e||[-0,-0],t,this);break;case 3:e=u.fF(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.IL)(e,t.length),e}transformAsVector(t,e){switch(t.length){case 2:e=(0,o.pb)(e||[-0,-0],t,this);break;case 3:e=(0,o.pL)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return(0,r.IL)(e,t.length),e}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}transformPoint(t,e){return(0,r.x9)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}transformVector(t,e){return(0,r.x9)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}transformDirection(t,e){return(0,r.x9)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}},1681:function(t,e,n){"use strict";n.d(e,{Z:function(){return h}});var r=n(6357),i=n(6281),o=n(394);class s extends r.Z{get ELEMENTS(){return(0,o.Z)(!1),0}copy(t){return(0,o.Z)(!1),this}get x(){return this[0]}set x(t){this[0]=(0,i.u5)(t)}get y(){return this[1]}set y(t){this[1]=(0,i.u5)(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const r=this[n]-t[n];e+=r*r}return(0,i.u5)(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return(0,i.u5)(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),(0,i.u5)(this[t])}setComponent(t,e){return(0,o.Z)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}var a=n(4034),u=n(7160),c=n(1031);const l=[0,0,0],f={};class h extends s{static get ZERO(){return f.ZERO=f.ZERO||Object.freeze(new h(0,0,0,0))}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&(0,a.kJ)(t)?this.copy(t):(a.vc.debug&&((0,i.u5)(t),(0,i.u5)(e),(0,i.u5)(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return a.vc.debug&&((0,i.u5)(t.x),(0,i.u5)(t.y),(0,i.u5)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=(0,i.u5)(t)}angle(t){return u.EU(this,t)}cross(t){return u.kC(this,this,t),this.check()}rotateX({radians:t,origin:e=l}){return u.lM(this,this,e,t),this.check()}rotateY({radians:t,origin:e=l}){return u.uD(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=l}){return u.jI(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return u.fF(this,this,t),this.check()}transformAsVector(t){return(0,c.pL)(this,this,t),this.check()}transformByMatrix3(t){return u.kK(this,this,t),this.check()}transformByMatrix2(t){return(0,c.eQ)(this,this,t),this.check()}transformByQuaternion(t){return u.VC(this,this,t),this.check()}}},394:function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error(`math.gl assertion ${e}`)}n.d(e,{Z:function(){return r}})},4034:function(t,e,n){"use strict";n.d(e,{vc:function(){return r},Bw:function(){return i},kJ:function(){return o},uZ:function(){return a},t7:function(){return u},fS:function(){return c}});Math.PI,Math.PI;const r={};function i(t,{precision:e=r.precision||4}={}){return t=function(t){return Math.round(t/r.EPSILON)*r.EPSILON}(t),`${parseFloat(t.toPrecision(e))}`}function o(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function s(t,e,n){if(o(t)){n=n||((r=t).clone?r.clone():new Array(r.length));for(let r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var r;return e(t)}function a(t,e,n){return s(t,(t=>Math.max(e,Math.min(n,t))))}function u(t,e,n){return o(t)?t.map(((t,r)=>u(t,e[r],n))):n*e+(1-n)*t}function c(t,e,n){const i=r.EPSILON;n&&(r.EPSILON=n);try{if(t===e)return!0;if(o(t)&&o(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!c(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=r.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{r.EPSILON=i}}r.EPSILON=1e-12,r.debug=!1,r.precision=4,r.printTypes=!1,r.printDegrees=!1,r.printRowMajor=!0},1031:function(t,e,n){"use strict";function r(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function i(t,e,n){const r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/s,t[1]=(n[1]*r+n[5]*i+n[9]*o)/s,t[2]=(n[2]*r+n[6]*i+n[10]*o)/s,t}function o(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function s(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}n.d(e,{pb:function(){return r},pL:function(){return i},eQ:function(){return o},_x:function(){return s}})},6281:function(t,e,n){"use strict";n.d(e,{u5:function(){return i},IL:function(){return o},x9:function(){return a}});var r=n(4034);function i(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${t}`);return t}function o(t,e,n=""){if(r.vc.debug&&!function(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error(`math.gl: ${n} some fields set to invalid numbers'`);return t}const s={};function a(t,e){s[t]||(s[t]=!0,console.warn(`${t} has been removed in version ${e}, see upgrade guide for more information`))}},5215:function(t,e,n){"use strict";n.d(e,{wG:function(){return r},WZ:function(){return N},GU:function(){return Z},dj:function(){return R},ct:function(){return V},OT:function(){return s},ap:function(){return o},Ny:function(){return i}});const r={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function i(t,e,n={}){return function(t,e={}){return Math.sign(o(t,e))}(t,n)!==e&&(function(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,s=Math.floor(o/2);for(let a=0;a<s;++a){const e=n+a*i,r=n+(o-1-a)*i;for(let n=0;n<i;++n){const i=t[e+n];t[e+n]=t[r+n],t[r+n]=i}}}(t,n),!0)}function o(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let s=n,a=r-i;s<r;s+=i)o+=(t[s]-t[a])*(t[s+1]+t[a+1]),a=s;return o/2}function s(t,e,n,r){n=n||2;const i=e&&e.length,o=i?e[0]*n:t.length;let s=a(t,0,o,n,!0,r&&r[0]);const l=[];if(!s||s.next===s.prev)return l;let f,h,d,m,y,b,x;if(i&&(s=function(t,e,n,r,i){const o=[];let s,c,l,f,h;for(s=0,c=e.length;s<c;s++)l=e[s]*r,f=s<c-1?e[s+1]*r:t.length,h=a(t,l,f,r,!1,i&&i[s+1]),h===h.next&&(h.steiner=!0),o.push(v(h));for(o.sort(p),s=0;s<o.length;s++)g(o[s],n),n=u(n,n.next);return n}(t,e,s,n,r)),t.length>80*n){m=h=t[0],y=d=t[1];for(let e=n;e<o;e+=n)b=t[e],x=t[e+1],b<m&&(m=b),x<y&&(y=x),b>h&&(h=b),x>d&&(d=x);f=Math.max(h-m,d-y),f=0!==f?1/f:0}return c(s,l,n,m,y,f),l}function a(t,e,n,r,i,s){let a,u;if(void 0===s&&(s=o(t,{start:e,end:n,size:r})),i===s<0)for(a=e;a<n;a+=r)u=M(a,t[a],t[a+1],u);else for(a=n-r;a>=e;a-=r)u=M(a,t[a],t[a+1],u);return u&&_(u,u.next)&&(P(u),u=u.next),u}function u(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!_(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(P(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function c(t,e,n,r,i,o,s){if(!t)return;!s&&o&&function(t,e,n,r){let i=t;do{null===i.z&&(i.z=y(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){let e,n,r,i,o,s,a,u,c=1;do{for(i=t,t=null,u=null,r=0;i;){for(r++,s=i,o=0,n=0;n<c&&(o++,s=s.nextZ,s);n++);for(a=c;o>0||a>0&&s;)0!==o&&(0===a||!s||i.z<=s.z)?(e=i,i=i.nextZ,o--):(e=s,s=s.nextZ,a--),u?u.nextZ=e:t=e,e.prevZ=u,u=e;i=s}u.nextZ=null,c*=2}while(r>1)}(i)}(t,r,i,o);let a,p,g=t;for(;t.prev!==t.next;)if(a=t.prev,p=t.next,o?f(t,r,i,o):l(t))e.push(a.i/n),e.push(t.i/n),e.push(p.i/n),P(t),t=p.next,g=p.next;else if((t=p)===g){s?1===s?c(t=h(u(t),e,n),e,n,r,i,o,2):2===s&&d(t,e,n,r,i,o):c(u(t),e,n,r,i,o,1);break}}function l(t){const e=t.prev,n=t,r=t.next;if(w(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(b(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&w(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function f(t,e,n,r){const i=t.prev,o=t,s=t.next;if(w(i,o,s)>=0)return!1;const a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,f=y(a,u,e,n,r),h=y(c,l,e,n,r);let d=t.prevZ,p=t.nextZ;for(;d&&d.z>=f&&p&&p.z<=h;){if(d!==t.prev&&d!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==t.prev&&p!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=f;){if(d!==t.prev&&d!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,d.x,d.y)&&w(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=h;){if(p!==t.prev&&p!==t.next&&b(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function h(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!_(i,o)&&E(i,r,r.next,o)&&S(i,o)&&S(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),P(r),P(r.next),r=t=o),r=r.next}while(r!==t);return u(r)}function d(t,e,n,r,i,o){let s=t;do{let t=s.next.next;for(;t!==s.prev;){if(s.i!==t.i&&x(s,t)){let a=C(s,t);return s=u(s,s.next),a=u(a,a.next),c(s,e,n,r,i,o),void c(a,e,n,r,i,o)}t=t.next}s=s.next}while(s!==t)}function p(t,e){return t.x-e.x}function g(t,e){if(e=function(t,e){let n=e;const r=t.x,i=t.y;let o,s=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const t=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(t<=r&&t>s){if(s=t,t===r){if(i===n.y)return n;if(i===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!o)return null;if(r===s)return o;const a=o,u=o.x,c=o.y;let l,f=1/0;n=o;do{r>=n.x&&n.x>=u&&r!==n.x&&b(i<c?r:s,i,u,c,i<c?s:r,i,n.x,n.y)&&(l=Math.abs(i-n.y)/(r-n.x),S(n,t)&&(l<f||l===f&&(n.x>o.x||n.x===o.x&&m(o,n)))&&(o=n,f=l)),n=n.next}while(n!==a);return o}(t,e)){const n=C(e,t);u(e,e.next),u(n,n.next)}}function m(t,e){return w(t.prev,t,e.prev)<0&&w(e.next,t,t.next)<0}function y(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function v(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function b(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&E(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(S(t,e)&&S(e,t)&&function(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(w(t.prev,t,e.prev)||w(t,e.prev,e))||_(t,e)&&w(t.prev,t,t.next)>0&&w(e.prev,e,e.next)>0)}function w(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function _(t,e){return t.x===e.x&&t.y===e.y}function E(t,e,n,r){const i=O(w(t,e,n)),o=O(w(t,e,r)),s=O(w(n,r,t)),a=O(w(n,r,e));return i!==o&&s!==a||(!(0!==i||!A(t,n,e))||(!(0!==o||!A(t,r,e))||(!(0!==s||!A(n,t,r))||!(0!==a||!A(n,e,r)))))}function A(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function O(t){return t>0?1:t<0?-1:0}function S(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function C(t,e){const n=new k(t.i,t.x,t.y),r=new k(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function M(t,e,n,r){const i=new k(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function P(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function k(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function T(t,e,n,r,i=[]){let o,s;if(8&n)o=(r[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(r[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(r[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(r[0]-t[0])/(e[0]-t[0]),s=0}for(let a=0;a<t.length;a++)i[a]=(1&s)===a?r[s]:o*(e[a]-t[a])+t[a];return i}function D(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function F(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function j(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function L(t,e,n,r,i=[]){const o=r+e*n;for(let s=0;s<n;s++)i[s]=t[o+s];return i}function R(t,e={}){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e,u=(a-s)/n;let c=[];const l=[c],f=L(t,0,n,s);let h,d;const p=z(f,i,o,[]),g=[];F(c,f);for(let m=1;m<u;m++){for(h=L(t,m,n,s,h),d=D(h,p);d;){T(f,h,d,p,g);const t=D(g,p);t&&(T(f,g,t,p,g),d=t),F(c,g),j(f,g),$(p,i,d),r&&c.length>n&&(c=[],l.push(c),F(c,f)),d=D(h,p)}F(c,h),j(f,h)}return r?l:l[0]}function I(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function N(t,e,n={}){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n,a=[],u=[{pos:t,types:s&&new Array(t.length/r).fill(1),holes:e||[]}],c=[[],[]];let l=[];for(;u.length;){const{pos:t,types:e,holes:n}=u.shift();U(t,r,n[0]||t.length,c),l=z(c[0],i,o,l);const f=D(c[1],l);if(f){let i=B(t,e,r,0,n[0]||t.length,l,f);const o={pos:i[0].pos,types:i[0].types,holes:[]},a={pos:i[1].pos,types:i[1].types,holes:[]};u.push(o,a);for(let u=0;u<n.length;u++)i=B(t,e,r,n[u],n[u+1]||t.length,l,f),i[0]&&(o.holes.push(o.pos.length),o.pos=I(o.pos,i[0].pos),s&&(o.types=I(o.types,i[0].types))),i[1]&&(a.holes.push(a.pos.length),a.pos=I(a.pos,i[1].pos),s&&(a.types=I(a.types,i[1].types)))}else{const r={positions:t};s&&(r.edgeTypes=e),n.length&&(r.holeIndices=n),a.push(r)}}return a}function B(t,e,n,r,i,o,s){const a=(i-r)/n,u=[],c=[],l=[],f=[],h=[];let d,p,g;const m=L(t,a-1,n,r);let y=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),v=e&&e[a-1],b=0,x=0;for(let w=0;w<a;w++)d=L(t,w,n,r,d),p=Math.sign(8&s?d[1]-o[3]:d[0]-o[2]),g=e&&e[r/n+w],p&&y&&y!==p&&(T(m,d,s,o,h),F(u,h)&&l.push(v),F(c,h)&&f.push(v)),p<=0?(F(u,d)&&l.push(g),b-=p):l.length&&(l[l.length-1]=0),p>=0?(F(c,d)&&f.push(g),x+=p):f.length&&(f[f.length-1]=0),j(m,d),y=p,v=g;return[b?{pos:u,types:e&&l}:null,x?{pos:c,types:e&&f}:null]}function z(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function $(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function U(t,e,n,r){let i=1/0,o=-1/0,s=1/0,a=-1/0;for(let u=0;u<n;u+=e){const e=t[u],n=t[u+1];i=e<i?e:i,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return r[0][0]=i,r[0][1]=s,r[1][0]=o,r[1][1]=a,r}function V(t,e={}){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e,s=t.slice(r,i);G(s,n,0,i-r);const a=R(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const u of a)H(u,n);return a}function Z(t,e,n={}){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n;e=e||[];const s=[],a=[];let u=0,c=0;for(let f=0;f<=e.length;f++){const i=e[f]||t.length,o=c,l=W(t,r,u,i);for(let e=l;e<i;e++)s[c++]=t[e];for(let e=u;e<l;e++)s[c++]=t[e];G(s,r,o,c),q(s,r,o,c,n.maxLatitude),u=i,a[f]=c}a.pop();const l=N(s,a,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const f of l)H(f.positions,r);return l}function W(t,e,n,r){let i=-1,o=-1;for(let s=n+1;s<r;s+=e){const e=Math.abs(t[s]);e>i&&(i=e,o=s-1)}return o}function q(t,e,n,r,i=85.051129){const o=t[n],s=t[r-e];if(Math.abs(o-s)>180){const r=L(t,0,e,n);r[0]+=360*Math.round((s-o)/360),F(t,r),r[1]=Math.sign(r[1])*i,F(t,r),r[0]=o,F(t,r)}}function G(t,e,n,r){let i,o=t[0];for(let s=n;s<r;s+=e){i=t[s];const e=i-o;(e>180||e<-180)&&(i-=360*Math.round(e/360)),t[s]=o=i}}function H(t,e){let n;const r=t.length/e;for(let o=0;o<r&&(n=t[o*e],(n+180)%360===0);o++);const i=360*-Math.round(n/360);if(0!==i)for(let o=0;o<r;o++)t[o*e]+=i}},7013:function(t,e,n){"use strict";n.d(e,{DW:function(){return j},eG:function(){return E},Xg:function(){return k},if:function(){return N},zX:function(){return D},ro:function(){return _},up:function(){return B},Bf:function(){return w},wl:function(){return O},lf:function(){return A},w5:function(){return b},QA:function(){return L},CT:function(){return P},es:function(){return x},aW:function(){return M}});var r=n(8333);function i(t,e){const n=r.fF([],e,t);return r.bA(n,n,1/n[3]),n}function o(t,e){const n=t%e;return n<0?e+n:n}const s=Math.log2||function(t){return Math.log(t)*Math.LOG2E};var a=n(5975),u=n(1437),c=n(7160);function l(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const f=Math.PI,h=f/4,d=f/180,p=180/f,g=512,m=4003e4;function y(t){return Math.pow(2,t)}function v(t){return s(t)}function b([t,e]){l(Number.isFinite(t)),l(Number.isFinite(e)&&e>=-90&&e<=90,"invalid latitude");const n=e*d;return[g*(t*d+f)/(2*f),g*(f+Math.log(Math.tan(h+.5*n)))/(2*f)]}function x([t,e]){const n=t/g*(2*f)-f,r=2*(Math.atan(Math.exp(e/g*(2*f)-f))-h);return[n*p,r*p]}function w({latitude:t}){l(Number.isFinite(t));const e=Math.cos(t*d);return v(m*e)-9}function _({latitude:t,longitude:e,highPrecision:n=!1}){l(Number.isFinite(t)&&Number.isFinite(e));const r={},i=Math.cos(t*d),o=512/360,s=o/i,a=12790407194604047e-21/i;if(r.unitsPerMeter=[a,a,a],r.metersPerUnit=[1/a,1/a,1/a],r.unitsPerDegree=[o,s,a],r.degreesPerUnit=[.703125,1/s,1/a],n){const e=d*Math.tan(t*d)/i,n=o*e/2,u=12790407194604047e-21*e,c=u/s*a;r.unitsPerDegree2=[0,n,u],r.unitsPerMeter2=[c,0,c]}return r}function E(t,e){const[n,r,i]=t,[o,s,a]=e,{unitsPerMeter:u,unitsPerMeter2:c}=_({longitude:n,latitude:r,highPrecision:!0}),l=b(t);l[0]+=o*(u[0]+c[0]*s),l[1]+=s*(u[1]+c[1]*s);const f=x(l),h=(i||0)+(a||0);return Number.isFinite(i)||Number.isFinite(a)?[f[0],f[1],h]:f}function A({height:t,pitch:e,bearing:n,altitude:r,scale:i,center:o=null}){const s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return a.Iu(s,s,[0,0,-r]),a.lM(s,s,-e*d),a.jI(s,s,n*d),i/=t,a.bA(s,s,[i,i,i]),o&&a.Iu(s,s,c.tk([],o)),s}function O({width:t,height:e,fovy:n=S(1.5),altitude:r,pitch:i=0,nearZMultiplier:o=1,farZMultiplier:s=1}){void 0!==r&&(n=S(r));const a=.5*n*d,u=C(n),c=i*d,l=Math.sin(a)*u/Math.sin(Math.min(Math.max(Math.PI/2-c-a,.01),Math.PI-.01));return{fov:2*a,aspect:t/e,focalDistance:u,near:o,far:(Math.sin(c)*l+u)*s}}function S(t){return 2*Math.atan(.5/t)*p}function C(t){return.5/Math.tan(.5*t*d)}function M(t,e){const[n,r,o=0]=t;return l(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(o)),i(e,[n,r,o,1])}function P(t,e,n=0){const[r,o,s]=t;if(l(Number.isFinite(r)&&Number.isFinite(o),"invalid pixel coordinate"),Number.isFinite(s)){return i(e,[r,o,s,1])}const a=i(e,[r,o,0,1]),c=i(e,[r,o,1,1]),f=a[2],h=c[2],d=f===h?0:((n||0)-f)/(h-f);return u.t7([],a,c,d)}function k({width:t,height:e,bounds:n,minExtent:r=0,maxZoom:i=24,padding:o=0,offset:a=[0,0]}){const[[u,c],[f,h]]=n;if(Number.isFinite(o)){o={top:o,bottom:o,left:o,right:o}}else l(Number.isFinite(o.top)&&Number.isFinite(o.bottom)&&Number.isFinite(o.left)&&Number.isFinite(o.right));const d=new j({width:t,height:e,longitude:0,latitude:0,zoom:0}),p=d.project([u,h]),g=d.project([f,c]),m=[Math.max(Math.abs(g[0]-p[0]),r),Math.max(Math.abs(g[1]-p[1]),r)],y=[t-o.left-o.right-2*Math.abs(a[0]),e-o.top-o.bottom-2*Math.abs(a[1])];l(y[0]>0&&y[1]>0);const v=y[0]/m[0],b=y[1]/m[1],x=(o.right-o.left)/2/v,w=(o.bottom-o.top)/2/b,_=[(g[0]+p[0])/2+x,(g[1]+p[1])/2+w],E=d.unproject(_),A=Math.min(i,d.zoom+s(Math.abs(Math.min(v,b))));return l(Number.isFinite(A)),{longitude:E[0],latitude:E[1],zoom:A}}const T=Math.PI/180;function D(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},s=i([0,r],o),a=i([n,r],o);let u,c;return(t.fovy?.5*t.fovy*T:Math.atan(.5/t.altitude))>(90-t.pitch)*T-.01?(u=F(t,0,e),c=F(t,n,e)):(u=i([0,0],o),c=i([n,0],o)),[s,a,c,u]}function F(t,e,n){const{pixelUnprojectionMatrix:r}=t,o=i(r,[e,0,1,1]),s=i(r,[e,t.height,1,1]),a=(n*t.distanceScales.unitsPerMeter[2]-o[2])/(s[2]-o[2]),c=x(u.t7([],o,s,a));return c[2]=n,c}class j{constructor({width:t,height:e,latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:s=0,altitude:u=null,fovy:l=null,position:f=null,nearZMultiplier:h=.02,farZMultiplier:d=1.01}={width:1,height:1}){t=t||1,e=e||1,null===l&&null===u?l=S(u=1.5):null===l?l=S(u):null===u&&(u=C(l));const p=y(i);u=Math.max(.75,u);const g=_({longitude:r,latitude:n}),m=b([r,n]);m[2]=0,f&&c.IH(m,m,c.dC([],f,g.unitsPerMeter)),this.projectionMatrix=function({width:t,height:e,pitch:n,altitude:r,fovy:i,nearZMultiplier:o,farZMultiplier:s}){const{fov:u,aspect:c,near:l,far:f}=O({width:t,height:e,altitude:r,fovy:i,pitch:n,nearZMultiplier:o,farZMultiplier:s});return a.G3([],u,c,l,f)}({width:t,height:e,pitch:o,fovy:l,nearZMultiplier:h,farZMultiplier:d}),this.viewMatrix=A({height:e,scale:p,center:m,pitch:o,bearing:s,altitude:u}),this.width=t,this.height=e,this.scale=p,this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=s,this.altitude=u,this.fovy=l,this.center=m,this.meterOffset=f||[0,0,0],this.distanceScales=g,this._initMatrices(),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),Object.freeze(this)}_initMatrices(){const{width:t,height:e,projectionMatrix:n,viewMatrix:r}=this,i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.Jp(i,i,n),a.Jp(i,i,r),this.viewProjectionMatrix=i;const o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];a.bA(o,o,[t/2,-e/2,1]),a.Iu(o,o,[1,-1,0]),a.Jp(o,o,i);const s=a.U_([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=o,this.pixelUnprojectionMatrix=s}equals(t){return t instanceof j&&(t.width===this.width&&t.height===this.height&&a.fS(t.projectionMatrix,this.projectionMatrix)&&a.fS(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=M(this.projectPosition(t),this.pixelProjectionMatrix),[r,i]=n,o=e?i:this.height-i;return 2===t.length?[r,o]:[r,o,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[r,i,o]=t,s=e?i:this.height-i,a=n&&n*this.distanceScales.unitsPerMeter[2],u=P([r,s,o],this.pixelUnprojectionMatrix,a),[c,l,f]=this.unprojectPosition(u);return Number.isFinite(o)?[c,l,f]:Number.isFinite(n)?[c,l,n]:[c,l]}projectPosition(t){const[e,n]=b(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=x(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){return b(t)}unprojectFlat(t){return x(t)}getMapCenterByLngLatPosition({lngLat:t,pos:e}){const n=P(e,this.pixelUnprojectionMatrix),r=b(t),i=u.IH([],r,u.tk([],n));return x(u.IH([],this.center,i))}getLocationAtPoint({lngLat:t,pos:e}){return this.getMapCenterByLngLatPosition({lngLat:t,pos:e})}fitBounds(t,e={}){const{width:n,height:r}=this,{longitude:i,latitude:o,zoom:s}=k(Object.assign({width:n,height:r,bounds:t},e));return new j({width:n,height:r,longitude:i,latitude:o,zoom:s})}getBounds(t){const e=this.getBoundingRegion(t),n=Math.min(...e.map((t=>t[0]))),r=Math.max(...e.map((t=>t[0])));return[[n,Math.min(...e.map((t=>t[1])))],[r,Math.max(...e.map((t=>t[1])))]]}getBoundingRegion(t={}){return D(this,t.z||0)}}function L({width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:a=0,bearing:u=0}){(n<-180||n>180)&&(n=o(n+180,360)-180),(u<-180||u>180)&&(u=o(u+180,360)-180);const c=s(e/512);if(i<=c)i=c,r=0;else{const t=e/2/Math.pow(2,i),n=x([0,t])[1];if(r<n)r=n;else{const e=x([0,512-t])[1];r>e&&(r=e)}}return{width:t,height:e,longitude:n,latitude:r,zoom:i,pitch:a,bearing:u}}const R=["longitude","latitude","zoom"],I={curve:1.414,speed:1.2};function N(t,e,n,r={}){const i={},{startZoom:o,startCenterXY:s,uDelta:a,w0:c,u1:l,S:f,rho:h,rho2:d,r0:p}=z(t,e,r);if(l<.01){for(const r of R){const o=t[r],s=e[r];i[r]=(g=n)*s+(1-g)*o}return i}var g;const m=n*f,y=Math.cosh(p)/Math.cosh(p+h*m),b=c*((Math.cosh(p)*Math.tanh(p+h*m)-Math.sinh(p))/d)/l,w=o+v(1/y),_=u.bA([],a,b);u.IH(_,_,s);const E=x(_);return i.longitude=E[0],i.latitude=E[1],i.zoom=w,i}function B(t,e,n={}){n=Object.assign({},I,n);const{screenSpeed:r,speed:i,maxDuration:o}=n,{S:s,rho:a}=z(t,e,n),u=1e3*s;let c;return c=Number.isFinite(r)?u/(r/a):u/i,Number.isFinite(o)&&c>o?0:c}function z(t,e,n){const r=(n=Object.assign({},I,n)).curve,i=t.zoom,o=[t.longitude,t.latitude],s=y(i),a=e.zoom,c=[e.longitude,e.latitude],l=y(a-i),f=b(o),h=b(c),d=u.lu([],h,f),p=Math.max(t.width,t.height),g=p/l,m=u.kE(d)*s,v=Math.max(m,.01),x=r*r,w=(g*g-p*p+x*x*v*v)/(2*p*x*v),_=(g*g-p*p-x*x*v*v)/(2*g*x*v),E=Math.log(Math.sqrt(w*w+1)-w),A=Math.log(Math.sqrt(_*_+1)-_);return{startZoom:i,startCenterXY:f,uDelta:d,w0:p,u1:m,S:(A-E)/r,rho:r,rho2:x,r0:E,r1:A}}},6203:function(t,e,n){"use strict";n.d(e,{jk:function(){return s}});var r=n(4155);function i(){let t;if("undefined"!==typeof window&&window.performance)t=window.performance.now();else if("undefined"!==typeof r&&r.hrtime){const e=r.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class o{constructor(t,e){this.name=t,this.type=e,this.sampleSize=1,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=i(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(i()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class s{constructor({id:t,stats:e}){this.id=t,this.stats={},this._initializeStats(e),Object.seal(this)}get(t,e="count"){return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(t=[]){t.forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof o?t:new o(e,n)),this.stats[e]}}},6917:function(t,e,n){"use strict";n.d(e,{Ri:function(){return ht},wt:function(){return xt}});var r,i=n(7294),o=(n(5697),n(765)),s=n(4270),a=n(8274),u=n(5296),c=n(6637),l=n(2945),f=n(5558),h=n(5777),d=n(4411),p=n(884),g=n(1331),m=n(4683);!function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"}(r||(r={}));var y={type:"xstate.init"};function v(t){return void 0===t?[]:[].concat(t)}function b(t){return{type:"xstate.assign",assignment:t}}function x(t,e){return"string"==typeof(t="string"==typeof t&&e&&e[t]?e[t]:t)?{type:t}:"function"==typeof t?{type:t.name,exec:t}:t}function w(t){return function(e){return t===e}}function _(t){return"string"==typeof t?{type:t}:t}function E(t,e){return{value:t,context:e,actions:[],changed:!1,matches:w(t)}}var A=function(t,e){return t.actions.forEach((function(n){var r=n.exec;return r&&r(t.context,e)}))};function O(t){var e=(0,i.useRef)();return e.current||(e.current={v:t()}),e.current.v}function S(){return(S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function C(t,e,n){var o=(0,i.useRef)(t),s=O((function(){return function(t){var e=t.initialState,n=r.NotStarted,i=new Set,o={_machine:t,send:function(o){n===r.Running&&(e=t.transition(e,o),A(e,_(o)),i.forEach((function(t){return t(e)})))},subscribe:function(t){return i.add(t),t(e),{unsubscribe:function(){return i.delete(t)}}},start:function(){return n=r.Running,A(e,y),o},stop:function(){return n=r.Stopped,i.clear(),o},get state(){return e},get status(){return n}};return o}(o.current).start()})),a=(0,i.useRef)(null),u=(0,i.useState)((function(){return function(t){var e;return t.subscribe((function(t){e=t})).unsubscribe(),e}(s)})),c=u[0],l=u[1],f=(0,i.useCallback)((function(t){var n=(0,h.HD)(t)?{type:t}:t,r=function(t){return Object.entries(t).reduce((function(t,e){var n=e[0],r=e[1];return t[n]=r.current,t}),{})}(e);s.send(S({},n,{lastEventType:a.current,refs:r})),a.current=n.type}),[n]);return(0,i.useEffect)((function(){return s.subscribe((function(t){t.changed&&l(t)})),function(){s.stop()}}),[s]),(0,i.useEffect)((function(){0}),[n,c]),[(0,i.useMemo)((function(){return S({},c,{matches:function(t){return t===c.value}})}),[c.changed,c.context,c.value]),f,s]}function M(t,e){return O((function(){return function(t,e){void 0===e&&(e={});var n={config:t,_options:e,initialState:{value:t.initial,actions:v(t.states[t.initial].entry).map((function(t){return x(t,e.actions)})),context:t.context,matches:w(t.initial)},transition:function(e,r){var i,o,s="string"==typeof e?{value:e,context:t.context}:e,a=s.value,u=s.context,c=_(r),l=t.states[a];if(l.on){var f=v(l.on[c.type]),h=function(e){if(void 0===e)return{value:E(a,u)};var r="string"==typeof e?{target:e}:e,i=r.target,o=void 0===i?a:i,s=r.actions,f=void 0===s?[]:s,h=r.cond,d=u;if((void 0===h?function(){return!0}:h)(u,c)){var p=t.states[o],g=!1,m=[].concat(l.exit,f,p.entry).filter((function(t){return t})).map((function(t){return x(t,n._options.actions)})).filter((function(t){if("xstate.assign"===t.type){g=!0;var e=Object.assign({},d);return"function"==typeof t.assignment?e=t.assignment(d,c):Object.keys(t.assignment).forEach((function(n){e[n]="function"==typeof t.assignment[n]?t.assignment[n](d,c):t.assignment[n]})),d=e,!1}return!0}));return{value:{value:o,context:d,actions:m,changed:o!==a||m.length>0||g,matches:w(o)}}}};try{for(var d=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}(f),p=d.next();!p.done;p=d.next()){var g=h(p.value);if("object"==typeof g)return g.value}}catch(t){i={error:t}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}}return E(a,u)}};return n}(t,e)}))}var P,k,T,D=n(5152);function F(){return(F=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function j(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}!function(t){t.Idle="IDLE",t.Open="OPEN",t.Navigating="NAVIGATING",t.Dragging="DRAGGING",t.Interacting="INTERACTING"}(k||(k={})),function(t){t.ButtonMouseDown="BUTTON_MOUSE_DOWN",t.ButtonMouseUp="BUTTON_MOUSE_UP",t.Blur="BLUR",t.ClearNavSelection="CLEAR_NAV_SELECTION",t.ClearTypeahead="CLEAR_TYPEAHEAD",t.GetDerivedData="GET_DERIVED_DATA",t.KeyDownEscape="KEY_DOWN_ESCAPE",t.KeyDownEnter="KEY_DOWN_ENTER",t.KeyDownSpace="KEY_DOWN_SPACE",t.KeyDownNavigate="KEY_DOWN_NAVIGATE",t.KeyDownSearch="KEY_DOWN_SEARCH",t.KeyDownTab="KEY_DOWN_TAB",t.KeyDownShiftTab="KEY_DOWN_SHIFT_TAB",t.OptionTouchStart="OPTION_TOUCH_START",t.OptionMouseMove="OPTION_MOUSE_MOVE",t.OptionMouseEnter="OPTION_MOUSE_ENTER",t.OptionMouseDown="OPTION_MOUSE_DOWN",t.OptionMouseUp="OPTION_MOUSE_UP",t.OptionClick="OPTION_CLICK",t.ListMouseUp="LIST_MOUSE_UP",t.OptionPress="OPTION_PRESS",t.OutsideMouseDown="OUTSIDE_MOUSE_DOWN",t.OutsideMouseUp="OUTSIDE_MOUSE_UP",t.ValueChange="VALUE_CHANGE",t.PopoverPointerDown="POPOVER_POINTER_DOWN",t.PopoverPointerUp="POPOVER_POINTER_UP",t.UpdateAfterTypeahead="UPDATE_AFTER_TYPEAHEAD"}(T||(T={}));var L=b({navigationValue:null}),R=b({typeaheadQuery:null}),I=b({value:function(t,e){return e.value}}),N=b({navigationValue:function(t,e){return e.value}}),B=b({navigationValue:function(t){var e,n,r,i=(e=t.value,n=t.options,e?n.find((function(t){return t.value===e})):void 0);return i&&!i.disabled?t.value:(null==(r=t.options.find((function(t){return!t.disabled})))?void 0:r.value)||null}});function z(t,e){if(e.type===T.Blur){var n=e.refs,r=n.list,i=n.popover,o=e.relatedTarget,s=(0,D.r)(i);return!((null==s?void 0:s.activeElement)===r||!i||i.contains(o||(null==s?void 0:s.activeElement)))}return!1}function $(t,e){if(e.type===T.OutsideMouseDown||e.type===T.OutsideMouseUp){var n=e.refs,r=n.button,i=n.popover,o=e.relatedTarget;return!(o===r||!r||r.contains(o)||!i||i.contains(o))}return!1}function U(t,e){return!!t.options.find((function(e){return e.value===t.navigationValue}))}function V(t,e){var n=e.refs,r=n.popover,i=n.list,o=e.relatedTarget;return!(r&&o&&r.contains(o)&&o!==i)&&U(t)}function Z(t,e){requestAnimationFrame((function(){e.refs.list&&e.refs.list.focus()}))}function W(t,e){e.refs.button&&e.refs.button.focus()}function q(t,e){return!e.disabled}function G(t,e){return e.type!==T.OptionTouchStart||!e||!e.disabled}function H(t,e){return(!("disabled"in e)||!e.disabled)&&("value"in e?null!=e.value:null!=t.navigationValue)}function X(t,e){e.callback&&e.callback(e.value)}function Y(t,e){if(e.type===T.KeyDownEnter){var n=e.refs.hiddenInput;if(n&&n.form){var r=n.form.querySelector("button,[type='submit']");r&&r.click()}}}var K=b({typeaheadQuery:function(t,e){return(t.typeaheadQuery||"")+e.query}}),J=b({value:function(t,e){if(e.type===T.UpdateAfterTypeahead&&e.query){var n=et(t.options,e.query);if(n&&!n.disabled)return e.callback&&e.callback(n.value),n.value}return t.value}}),Q=b({navigationValue:function(t,e){if(e.type===T.UpdateAfterTypeahead&&e.query){var n=et(t.options,e.query);if(n&&!n.disabled)return n.value}return t.navigationValue}}),tt=((P={})[T.GetDerivedData]={actions:b((function(t,e){return F({},t,e.data)}))},P[T.ValueChange]={actions:[I,X]},P);function et(t,e){return void 0===e&&(e=""),e&&t.find((function(t){return!t.disabled&&t.label&&t.label.toLowerCase().startsWith(e.toLowerCase())}))||null}var nt=["as","aria-labelledby","aria-label","children","defaultValue","disabled","form","name","onChange","required","value","__componentName"],rt=["arrow","button","children","portal"],it=["aria-label","arrow","as","children","onKeyDown","onMouseDown","onMouseUp"],ot=["as","children"],st=["as","position","onBlur","onKeyDown","onMouseUp","portal","unstable_observableRefs"],at=["as"],ut=["as","children","disabled","onClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseUp","onTouchStart","value","label"],ct=(0,a.nm)("ListboxDescendantContext"),lt=(0,f.o)("ListboxContext",{}),ft=(0,i.forwardRef)((function(t,e){var n=t.as,r=void 0===n?"div":n,s=t["aria-labelledby"],u=t["aria-label"],l=t.children,f=t.defaultValue,m=t.disabled,y=void 0!==m&&m,v=t.form,b=t.name,x=t.onChange,w=t.required,_=t.value,E=t.__componentName,A=void 0===E?"ListboxInput":E,O=j(t,nt),S=(0,i.useRef)(null!=_),P=(0,a.f5)(),D=P[0],et=P[1],rt=(0,i.useRef)(null),it=(0,i.useRef)(null),ot=(0,i.useRef)(null),st=(0,i.useRef)(null),at=(0,i.useRef)(null),ut=(0,i.useRef)(null),ft=(0,i.useRef)(null),ht=C(M(function(t){var e,n,r,i,o,s,a=t.value;return{id:"listbox",initial:k.Idle,context:{value:a,options:[],navigationValue:null,typeaheadQuery:null},states:(s={},s[k.Idle]={on:F({},tt,(e={},e[T.ButtonMouseDown]={target:k.Open,actions:[B],cond:q},e[T.KeyDownSpace]={target:k.Navigating,actions:[B,Z],cond:q},e[T.KeyDownSearch]={target:k.Idle,actions:K,cond:q},e[T.UpdateAfterTypeahead]={target:k.Idle,actions:[J],cond:q},e[T.ClearTypeahead]={target:k.Idle,actions:R},e[T.KeyDownNavigate]={target:k.Navigating,actions:[B,R,Z],cond:q},e[T.KeyDownEnter]={actions:[Y],cond:q},e))},s[k.Interacting]={entry:[L],on:F({},tt,(n={},n[T.ClearNavSelection]={actions:[L,Z]},n[T.KeyDownEnter]={target:k.Idle,actions:[I,R,W,X],cond:H},n[T.KeyDownSpace]={target:k.Idle,actions:[I,R,W,X],cond:H},n[T.ButtonMouseDown]={target:k.Idle,actions:[W]},n[T.KeyDownEscape]={target:k.Idle,actions:[W]},n[T.OptionMouseDown]={target:k.Dragging},n[T.OutsideMouseDown]=[{target:k.Idle,cond:$,actions:R},{target:k.Dragging,actions:R,cond:U}],n[T.OutsideMouseUp]=[{target:k.Idle,cond:$,actions:R},{target:k.Navigating,cond:U},{target:k.Interacting,actions:R}],n[T.KeyDownEnter]=k.Interacting,n[T.Blur]=[{target:k.Idle,cond:z,actions:R},{target:k.Navigating,cond:V},{target:k.Interacting,actions:R}],n[T.OptionTouchStart]={target:k.Navigating,actions:[N,R],cond:G},n[T.OptionClick]={target:k.Idle,actions:[I,R,W,X],cond:H},n[T.OptionPress]={target:k.Idle,actions:[I,R,W,X],cond:H},n[T.OptionMouseEnter]={target:k.Navigating,actions:[N,R],cond:G},n[T.KeyDownNavigate]={target:k.Navigating,actions:[N,R,Z]},n))},s[k.Open]={on:F({},tt,(r={},r[T.ClearNavSelection]={actions:[L]},r[T.KeyDownEnter]={target:k.Idle,actions:[I,R,W,X],cond:H},r[T.KeyDownSpace]={target:k.Idle,actions:[I,R,W,X],cond:H},r[T.ButtonMouseDown]={target:k.Idle,actions:[W]},r[T.KeyDownEscape]={target:k.Idle,actions:[W]},r[T.OptionMouseDown]={target:k.Dragging},r[T.OutsideMouseDown]=[{target:k.Idle,cond:$,actions:R},{target:k.Dragging,cond:U},{target:k.Interacting,actions:R}],r[T.OutsideMouseUp]=[{target:k.Idle,cond:$,actions:R},{target:k.Navigating,cond:U},{target:k.Interacting,actions:R}],r[T.Blur]=[{target:k.Idle,cond:z,actions:R},{target:k.Navigating,cond:V},{target:k.Interacting,actions:R}],r[T.ButtonMouseUp]={target:k.Navigating,actions:[B,Z]},r[T.ListMouseUp]={target:k.Navigating,actions:[B,Z]},r[T.OptionTouchStart]={target:k.Navigating,actions:[N,R],cond:G},r[T.OptionClick]={target:k.Idle,actions:[I,R,W,X],cond:H},r[T.OptionPress]={target:k.Idle,actions:[I,R,W,X],cond:H},r[T.KeyDownNavigate]={target:k.Navigating,actions:[N,R,Z]},r[T.KeyDownSearch]={target:k.Navigating,actions:K},r[T.UpdateAfterTypeahead]={actions:[Q]},r[T.ClearTypeahead]={actions:R},r[T.OptionMouseMove]=[{target:k.Dragging,actions:[N],cond:G},{target:k.Dragging}],r))},s[k.Dragging]={on:F({},tt,(i={},i[T.ClearNavSelection]={actions:[L]},i[T.KeyDownEnter]={target:k.Idle,actions:[I,R,W,X],cond:H},i[T.KeyDownSpace]={target:k.Idle,actions:[I,R,W,X],cond:H},i[T.ButtonMouseDown]={target:k.Idle,actions:[W]},i[T.KeyDownEscape]={target:k.Idle,actions:[W]},i[T.OptionMouseDown]={target:k.Dragging},i[T.OutsideMouseDown]=[{target:k.Idle,cond:$,actions:R},{target:k.Navigating,cond:U},{target:k.Interacting,actions:R}],i[T.OutsideMouseUp]=[{target:k.Idle,cond:$,actions:R},{target:k.Navigating,cond:U,actions:Z},{target:k.Interacting,actions:[R,Z]}],i[T.Blur]=[{target:k.Idle,cond:z,actions:R},{target:k.Navigating,cond:V},{target:k.Interacting,actions:R}],i[T.ButtonMouseUp]={target:k.Navigating,actions:[B,Z]},i[T.OptionTouchStart]={target:k.Navigating,actions:[N,R],cond:G},i[T.OptionClick]={target:k.Idle,actions:[I,R,W,X],cond:H},i[T.OptionPress]={target:k.Idle,actions:[I,R,W,X],cond:H},i[T.OptionMouseEnter]={target:k.Dragging,actions:[N,R],cond:G},i[T.KeyDownNavigate]={target:k.Navigating,actions:[N,R,Z]},i[T.KeyDownSearch]={target:k.Navigating,actions:K},i[T.UpdateAfterTypeahead]={actions:[Q]},i[T.ClearTypeahead]={actions:R},i[T.OptionMouseMove]=[{target:k.Navigating,actions:[N],cond:G},{target:k.Navigating}],i[T.OptionMouseUp]={target:k.Idle,actions:[I,R,W,X],cond:H},i))},s[k.Navigating]={on:F({},tt,(o={},o[T.ClearNavSelection]={actions:[L,Z]},o[T.KeyDownEnter]={target:k.Idle,actions:[I,R,W,X],cond:H},o[T.KeyDownSpace]={target:k.Idle,actions:[I,R,W,X],cond:H},o[T.ButtonMouseDown]={target:k.Idle,actions:[W]},o[T.KeyDownEscape]={target:k.Idle,actions:[W]},o[T.OptionMouseDown]={target:k.Dragging},o[T.OutsideMouseDown]=[{target:k.Idle,cond:$,actions:R},{target:k.Navigating,cond:U},{target:k.Interacting,actions:R}],o[T.OutsideMouseUp]=[{target:k.Idle,cond:$,actions:R},{target:k.Navigating,cond:U},{target:k.Interacting,actions:R}],o[T.Blur]=[{target:k.Idle,cond:z,actions:R},{target:k.Navigating,cond:V},{target:k.Interacting,actions:R}],o[T.ButtonMouseUp]={target:k.Navigating,actions:[B,Z]},o[T.OptionTouchStart]={target:k.Navigating,actions:[N,R],cond:G},o[T.OptionClick]={target:k.Idle,actions:[I,R,W,X],cond:H},o[T.OptionPress]={target:k.Idle,actions:[I,R,W,X],cond:H},o[T.OptionMouseEnter]={target:k.Navigating,actions:[N,R],cond:G},o[T.KeyDownNavigate]={target:k.Navigating,actions:[N,R,Z]},o[T.KeyDownSearch]={target:k.Navigating,actions:K},o[T.UpdateAfterTypeahead]={actions:[Q]},o[T.ClearTypeahead]={actions:R},o[T.OptionMouseMove]=[{target:k.Navigating,actions:[N],cond:G},{target:k.Navigating}],o))},s)}}({value:(S.current?_:f)||null})),{button:rt,hiddenInput:it,highlightedOption:ot,input:st,list:at,popover:ut,selectedOption:ft},false),dt=ht[0],pt=ht[1];var gt=(0,o.M)(O.id),mt=O.id||(0,d.q)("listbox-input",gt),yt=(0,g.e)(st,e),vt=(0,i.useMemo)((function(){var t=D.find((function(t){return t.value===dt.context.value}));return t?t.label:null}),[D,dt.context.value]),bt=function(t){return[k.Navigating,k.Open,k.Dragging,k.Interacting].includes(t)}(dt.value),xt={ariaLabel:u,ariaLabelledBy:s,buttonRef:rt,disabled:y,highlightedOptionRef:ot,isExpanded:bt,listboxId:mt,listboxValueLabel:vt,listRef:at,onValueChange:function(t){t!==dt.context.value&&(null==x||x(t))},popoverRef:ut,selectedOptionRef:ft,send:pt,state:dt.value,stateData:dt.context},wt=(0,i.useRef)(!1);if(!S.current&&null==f&&!wt.current&&D.length){wt.current=!0;var _t=D.find((function(t){return!t.disabled}));_t&&_t.value&&pt({type:T.ValueChange,value:_t.value})}return(0,p.cO)(_,"value",A),function(t,e,n){(0,i.useRef)(null!=t).current&&t!==e&&n()}(_,dt.context.value,(function(){pt({type:T.ValueChange,value:_})})),(0,c.L)((function(){pt({type:T.GetDerivedData,data:{options:D}})}),[D,pt]),(0,i.useEffect)((function(){function t(t){var e=t.target,n=t.relatedTarget;Et(ut.current,e)||pt({type:T.OutsideMouseDown,relatedTarget:n||e})}return bt&&window.addEventListener("mousedown",t),function(){window.removeEventListener("mousedown",t)}}),[pt,bt]),(0,i.useEffect)((function(){function t(t){var e=t.target,n=t.relatedTarget;Et(ut.current,e)||pt({type:T.OutsideMouseUp,relatedTarget:n||e})}return bt&&window.addEventListener("mouseup",t),function(){window.removeEventListener("mouseup",t)}}),[pt,bt]),(0,p.kG)("listbox"),(0,i.createElement)(r,F({},O,{ref:yt,"data-reach-listbox-input":"","data-state":bt?"expanded":"closed","data-value":dt.context.value,id:mt}),(0,i.createElement)(lt.Provider,{value:xt},(0,i.createElement)(a.w_,{context:ct,items:D,set:et},(0,h.mf)(l)?l({id:mt,isExpanded:bt,value:dt.context.value,selectedOptionRef:ft,highlightedOptionRef:ot,valueLabel:vt,expanded:bt}):l,(v||b||w)&&(0,i.createElement)("input",{ref:it,"data-reach-listbox-hidden-input":"",disabled:y,form:v,name:b,readOnly:!0,required:w,tabIndex:-1,type:"hidden",value:dt.context.value||""}))))}));var ht=(0,i.forwardRef)((function(t,e){var n=t.arrow,r=void 0===n?"\u25bc":n,o=t.button,s=t.children,a=t.portal,u=void 0===a||a,c=j(t,rt);return(0,i.createElement)(ft,F({},c,{__componentName:"Listbox",ref:e}),(function(t){var e=t.value,n=t.valueLabel;return(0,i.createElement)(i.Fragment,null,(0,i.createElement)(pt,{arrow:r,children:o?(0,h.mf)(o)?o({value:e,label:n}):o:void 0}),(0,i.createElement)(vt,{portal:u},(0,i.createElement)(bt,null,s)))}))}));var dt=(0,i.forwardRef)((function(t,e){var n=t["aria-label"],r=t.arrow,o=void 0!==r&&r,s=t.as,a=void 0===s?"span":s,c=t.children,l=t.onKeyDown,f=t.onMouseDown,p=t.onMouseUp,y=j(t,it),v=(0,i.useContext)(lt),b=v.buttonRef,x=v.send,w=v.ariaLabelledBy,_=v.disabled,E=v.isExpanded,A=v.listboxId,O=v.stateData,S=v.listboxValueLabel,C=O.value,M=(0,g.e)(b,e),P=wt();var k=(0,d.q)("button",A),D=(0,i.useMemo)((function(){return c?(0,h.mf)(c)?c({isExpanded:E,label:S,value:C,expanded:E}):c:S}),[c,S,E,C]);return(0,i.createElement)(a,F({"aria-disabled":_||void 0,"aria-expanded":E||void 0,"aria-haspopup":"listbox","aria-labelledby":n?void 0:[w,k].filter(Boolean).join(" "),"aria-label":n,role:"button",tabIndex:_?-1:0},y,{ref:M,"data-reach-listbox-button":"",id:k,onKeyDown:(0,m.M)(l,P),onMouseDown:(0,m.M)(f,(function(t){(0,u.d)(t.nativeEvent)||(t.preventDefault(),t.stopPropagation(),x({type:T.ButtonMouseDown,disabled:_}))})),onMouseUp:(0,m.M)(p,(function(t){(0,u.d)(t.nativeEvent)||(t.preventDefault(),t.stopPropagation(),x({type:T.ButtonMouseUp}))}))}),D,o&&(0,i.createElement)(mt,null,(0,h.jn)(o)?null:o))}));var pt=(0,i.memo)(dt),gt=(0,i.forwardRef)((function(t,e){var n=t.as,r=void 0===n?"span":n,o=t.children,s=j(t,ot),a=(0,i.useContext)(lt).isExpanded;return(0,i.createElement)(r,F({"aria-hidden":!0},s,{ref:e,"data-reach-listbox-arrow":"","data-expanded":a?"":void 0}),(0,h.mf)(o)?o({isExpanded:a,expanded:a}):o||"\u25bc")}));var mt=(0,i.memo)(gt),yt=(0,i.forwardRef)((function(t,e){var n=t.as,r=void 0===n?"div":n,o=t.position,a=void 0===o?s.g0:o,u=t.onBlur,c=t.onKeyDown,l=t.onMouseUp,f=t.portal,h=void 0===f||f,d=t.unstable_observableRefs,p=j(t,st),y=(0,i.useContext)(lt),v=y.isExpanded,b=y.buttonRef,x=y.popoverRef,w=y.send,_=(0,g.e)(x,e),E=wt();var A=F({hidden:!v,tabIndex:-1},p,{ref:_,"data-reach-listbox-popover":"",onMouseUp:(0,m.M)(l,(function(){w({type:T.ListMouseUp})})),onBlur:(0,m.M)(u,(function(t){var e=t.nativeEvent;requestAnimationFrame((function(){w({type:T.Blur,relatedTarget:e.relatedTarget||e.target})}))})),onKeyDown:(0,m.M)(c,E)});return h?(0,i.createElement)(s.J2,F({},A,{as:r,targetRef:b,position:a,unstable_observableRefs:d})):(0,i.createElement)(r,A)}));var vt=(0,i.memo)(yt),bt=(0,i.forwardRef)((function(t,e){var n=t.as,r=void 0===n?"ul":n,o=j(t,at),s=(0,i.useContext)(lt),a=s.listRef,u=s.ariaLabel,c=s.ariaLabelledBy,l=s.isExpanded,f=s.listboxId,h=s.stateData,p=h.value,m=h.navigationValue,y=(0,g.e)(e,a);return(0,i.createElement)(r,F({"aria-activedescendant":_t(l?m:p),"aria-labelledby":u?void 0:c,"aria-label":u,role:"listbox",tabIndex:-1},o,{ref:y,"data-reach-listbox-list":"",id:(0,d.q)("listbox",f)}))}));var xt=(0,i.forwardRef)((function(t,e){var n=t.as,r=void 0===n?"li":n,o=t.children,s=t.disabled,c=t.onClick,l=t.onMouseDown,f=t.onMouseEnter,h=t.onMouseLeave,d=t.onMouseMove,p=t.onMouseUp,y=t.onTouchStart,v=t.value,b=t.label,x=j(t,ut);var w=(0,i.useContext)(lt),_=w.highlightedOptionRef,E=w.selectedOptionRef,A=w.send,O=w.isExpanded,S=w.onValueChange,C=w.state,M=w.stateData,P=M.value,D=M.navigationValue,L=(0,i.useState)(b),R=L[0],I=L[1],N=b||R||"",B=(0,i.useRef)(null);(0,a.Yf)({element:B.current,value:v,label:N,disabled:!!s},ct);var z=(0,i.useCallback)((function(t){!b&&t&&I((function(e){return t.textContent&&e!==t.textContent?t.textContent:e||""}))}),[b]),$=!!D&&D===v,U=P===v,V=(0,g.e)(z,e,B,U?E:null,$?_:null);return(0,i.createElement)(r,F({"aria-selected":(O?$:U)||void 0,"aria-disabled":s||void 0,role:"option"},x,{ref:V,id:_t(v),"data-reach-listbox-option":"","data-current-nav":$?"":void 0,"data-current-selected":U?"":void 0,"data-label":N,"data-value":v,onClick:(0,m.M)(c,(function(t){(0,u.d)(t.nativeEvent)||A({type:T.OptionClick,value:v,callback:S,disabled:!!s})})),onMouseDown:(0,m.M)(l,(function(t){(0,u.d)(t.nativeEvent)||(t.preventDefault(),A({type:T.OptionMouseDown}))})),onMouseEnter:(0,m.M)(f,(function(){A({type:T.OptionMouseEnter,value:v,disabled:!!s})})),onMouseLeave:(0,m.M)(h,(function(){A({type:T.ClearNavSelection})})),onMouseMove:(0,m.M)(d,(function(){C!==k.Open&&D===v||A({type:T.OptionMouseMove,value:v,disabled:!!s})})),onMouseUp:(0,m.M)(p,(function(t){(0,u.d)(t.nativeEvent)||A({type:T.OptionMouseUp,value:v,callback:S,disabled:!!s})})),onTouchStart:(0,m.M)(y,(function(){A({type:T.OptionTouchStart,value:v,disabled:!!s})}))}),o)}));function wt(){var t=(0,i.useContext)(lt),e=t.send,n=t.disabled,r=t.onValueChange,o=t.stateData,s=o.navigationValue,u=o.typeaheadQuery,c=(0,a.Ak)(ct),f=(0,l.R)(r);(0,i.useEffect)((function(){u&&e({type:T.UpdateAfterTypeahead,query:u,callback:f});var t=window.setTimeout((function(){null!=u&&e({type:T.ClearTypeahead})}),1e3);return function(){window.clearTimeout(t)}}),[f,e,u]);var d=c.findIndex((function(t){return t.value===s}));return(0,m.M)((function(t){var i=t.key,o=(0,h.HD)(i)&&1===i.length,a=c.find((function(t){return t.value===s}));switch(i){case"Enter":return void e({type:T.KeyDownEnter,value:s,callback:r,disabled:!!(null!=a&&a.disabled||n)});case" ":return t.preventDefault(),void e({type:T.KeyDownSpace,value:s,callback:r,disabled:!!(null!=a&&a.disabled||n)});case"Escape":return void e({type:T.KeyDownEscape});case"Tab":var u=t.shiftKey?T.KeyDownShiftTab:T.KeyDownTab;return void e({type:u});default:return void(o&&e({type:T.KeyDownSearch,query:i,disabled:n}))}}),(0,a.Dv)(ct,{currentIndex:d,orientation:"vertical",key:"index",rotate:!0,filter:function(t){return!t.disabled},callback:function(t){e({type:T.KeyDownNavigate,value:c[t].value,disabled:n})}}))}function _t(t){var e=(0,i.useContext)(lt).listboxId;return t?(0,d.q)("option-"+t,e):void 0}function Et(t,e){return!(!t||!t.contains(e))}},7467:function(t,e,n){"use strict";n.d(e,{iR:function(){return k},h4:function(){return I},i5:function(){return L},Uj:function(){return F}});var r=n(7294),i=n(5697),o=n.n(i),s=n(765);var a=n(5296),u=n(2945),c=n(6637),l=n(5152),f=n(5558),h=n(5777),d=n(4411),p=n(9695),g=n(884),m=n(1331),y=n(4683);function v(){return(v=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function b(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}var x,w,_=["children"],E=["aria-label","aria-labelledby","aria-valuetext","as","defaultValue","disabled","value","getAriaLabel","getAriaValueText","getValueText","handleAlignment","max","min","name","onChange","onKeyDown","onMouseDown","onMouseMove","onMouseUp","onPointerDown","onPointerUp","onTouchEnd","onTouchMove","onTouchStart","orientation","step","children","__componentName"],A=["ref"],O=["as","children","style"],S=["as","children","style"],C=["as","onBlur","onFocus","style","onKeyDown"];!function(t){t.Horizontal="horizontal",t.Vertical="vertical"}(x||(x={})),function(t){t.Center="center",t.Contain="contain"}(w||(w={}));x.Horizontal,x.Vertical,w.Center,w.Contain;var M=(0,f.o)("SliderContext",{}),P=function(){return(0,r.useContext)(M)},k=(o().number,o().bool,o().func,o().func,o().func,w.Center,w.Contain,o().number,o().number,o().string,x.Horizontal,x.Vertical,o().func,o().number,o().number,(0,r.forwardRef)((function(t,e){var n=t.children,i=b(t,_);return(0,r.createElement)(T,v({},i,{ref:e,"data-reach-slider":"",__componentName:"Slider"}),(0,r.createElement)(F,null,(0,r.createElement)(L,null),(0,r.createElement)(I,null),n))})));var T=(0,r.forwardRef)((function(t,e){var n,i=t["aria-label"],o=t["aria-labelledby"],f=t["aria-valuetext"],_=t.as,O=void 0===_?"div":_,S=t.defaultValue,C=t.disabled,P=void 0!==C&&C,k=t.value,T=t.getAriaLabel,D=t.getAriaValueText,F=t.getValueText,j=t.handleAlignment,L=void 0===j?w.Center:j,R=t.max,I=void 0===R?100:R,$=t.min,U=void 0===$?0:$,V=t.name,Z=t.onChange,W=t.onKeyDown,q=t.onMouseDown,G=t.onMouseMove,H=t.onMouseUp,X=t.onPointerDown,Y=t.onPointerUp,K=t.onTouchEnd,J=t.onTouchMove,Q=t.onTouchStart,tt=t.orientation,et=void 0===tt?x.Horizontal:tt,nt=t.step,rt=void 0===nt?1:nt,it=t.children,ot=t.__componentName,st=void 0===ot?"SliderInput":ot,at=b(t,E);(0,g.cO)(k,"value",st);var ut=(0,r.useRef)(),ct=(0,s.M)(at.id),lt=(0,r.useRef)(!1),ft=(0,r.useRef)(null),ht=(0,r.useRef)(null),dt=(0,r.useRef)(null),pt=(0,m.e)(dt,e),gt=(0,r.useState)(!1),mt=gt[0],yt=gt[1],vt=b(function(t){var e=(0,r.useState)({width:0,height:0}),n=e[0],i=n.width,o=n.height,s=e[1];return(0,c.L)((function(){var e=(0,l.r)(t.current).defaultView||window;if(t.current){var n=e.getComputedStyle(t.current),r=n.height,a=n.width,u=parseFloat(r),c=parseFloat(a);u===o&&c===i||s({height:u,width:c})}}),[t,i,o]),{ref:t,width:i,height:o}}(ht),A),bt=function(t,e){var n=(0,r.useRef)(null!=t),i=(0,r.useState)(e),o=i[0],s=i[1],a=(0,r.useCallback)((function(t){n.current||s(t)}),[]);return[n.current?t:o,a]}(k,S||U),xt=bt[0],wt=bt[1],_t=N(xt,U,I),Et=z(_t,U,I),At=et===x.Vertical,Ot=At?vt.height:vt.width,St="calc("+Et+"% - "+(L===w.Center?Ot+"px / 2":Ot+"px * "+.01*Et)+")",Ct=(0,r.useRef)(St);(0,c.L)((function(){Ct.current=St}),[St]);var Mt=(0,r.useRef)(Z);(0,c.L)((function(){Mt.current=Z}),[Z]);var Pt=(0,r.useCallback)((function(t){wt(t),Mt.current&&Mt.current(t,{min:U,max:I,handlePosition:Ct.current})}),[I,U,wt]),kt=(0,r.useCallback)((function(t){return function(t,e,n){var r=n.orientation,i=n.min,o=n.max,s=n.step;if(!e||!t)return null;var a=e.getBoundingClientRect(),u=a.left,c=a.width,l=a.bottom,f=a.height,h=r===x.Vertical,d=function(t,e,n){return(n-e)*t+e}((h?l-t.y:t.x-u)/(h?f:c),i,o);return N(s?B(d,s,i):d,i,o)}(function(t,e){if(void 0!==e.current&&t.changedTouches){for(var n=0;n<t.changedTouches.length;n+=1){var r=t.changedTouches[n];if(r.identifier===e.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:t.clientX,y:t.clientY}}(t,ut),ft.current,{step:rt,orientation:et,min:U,max:I})}),[I,U,et,rt]),Tt=(0,u.g)((function(t){if(!P){var e,n=(I-U)/10,r=rt||(I-U)/100;switch(t.key){case"ArrowLeft":case"ArrowDown":e=_t-r;break;case"ArrowRight":case"ArrowUp":e=_t+r;break;case"PageDown":e=_t-n;break;case"PageUp":e=_t+n;break;case"Home":e=U;break;case"End":e=I;break;default:return}t.preventDefault(),e=N(rt?B(e,rt,U):e,U,I),Pt(e)}})),Dt=F?F(_t):D?D(_t):f,Ft=((n={})[At?"height":"width"]=Et+"%",n),jt={ariaLabel:T?T(_t):i,ariaLabelledBy:o,ariaValueText:Dt,handleDimensions:vt,handleKeyDown:Tt,handlePosition:St,handleRef:ht,hasFocus:mt,onKeyDown:W,setHasFocus:yt,sliderId:ct,sliderMax:I,sliderMin:U,value:_t,disabled:!!P,isVertical:At,orientation:et,trackPercent:Et,trackRef:ft,rangeStyle:Ft,updateValue:Pt},Lt=(0,r.useRef)(p.Z),Rt=(0,r.useRef)(p.Z),It=(0,r.useRef)(p.Z),Nt=(0,r.useRef)({onMouseMove:G,onMouseDown:q,onMouseUp:H,onTouchStart:Q,onTouchEnd:K,onTouchMove:J,onPointerDown:X,onPointerUp:Y});(0,c.L)((function(){Nt.current.onMouseMove=G,Nt.current.onMouseDown=q,Nt.current.onMouseUp=H,Nt.current.onTouchStart=Q,Nt.current.onTouchEnd=K,Nt.current.onTouchMove=J,Nt.current.onPointerDown=X,Nt.current.onPointerUp=Y}),[G,q,H,Q,K,J,X,Y]);var Bt=(0,u.g)((function(t){if(!(0,a.d)(t))if(P)lt.current=!1;else{var e=(0,l.r)(dt.current).defaultView||window;if(lt.current=!0,t.changedTouches){var n;t.preventDefault();var r=null==(n=t.changedTouches)?void 0:n[0];null!=r&&(ut.current=r.identifier)}var i=kt(t);null!=i&&(e.requestAnimationFrame((function(){var t;return null==(t=ht.current)?void 0:t.focus()})),Pt(i),Lt.current=Zt(),It.current=Wt())}})),zt=(0,u.g)((function(t){var e;(0,a.d)(t)||(P?lt.current=!1:(lt.current=!0,null==(e=dt.current)||e.setPointerCapture(t.pointerId)))})),$t=(0,u.g)((function(t){var e;(0,a.d)(t)||(null==(e=dt.current)||e.releasePointerCapture(t.pointerId),lt.current=!1)})),Ut=(0,u.g)((function(t){if(!P&&lt.current){var e=kt(t);null!=e&&Pt(e)}else lt.current=!1})),Vt=(0,u.g)((function(t){(0,a.d)(t)||(lt.current=!1,null!=kt(t)&&(ut.current=void 0,Lt.current(),It.current()))})),Zt=(0,r.useCallback)((function(){var t=(0,l.r)(dt.current),e=(0,y.M)(Nt.current.onTouchMove,Ut),n=(0,y.M)(Nt.current.onMouseMove,Ut);return t.addEventListener("touchmove",e),t.addEventListener("mousemove",n),function(){t.removeEventListener("touchmove",e),t.removeEventListener("mousemove",n)}}),[Ut]),Wt=(0,r.useCallback)((function(){var t=(0,l.r)(dt.current),e=t.defaultView||window,n=(0,y.M)(Nt.current.onPointerUp,$t),r=(0,y.M)(Nt.current.onTouchEnd,Vt),i=(0,y.M)(Nt.current.onMouseUp,Vt);return"PointerEvent"in e&&t.addEventListener("pointerup",n),t.addEventListener("touchend",r),t.addEventListener("mouseup",i),function(){"PointerEvent"in e&&t.removeEventListener("pointerup",n),t.removeEventListener("touchend",r),t.removeEventListener("mouseup",i)}}),[Vt,$t]),qt=(0,r.useCallback)((function(){var t=dt.current;if(!t)return p.Z;var e=(0,l.r)(t).defaultView||window,n=(0,y.M)(Nt.current.onTouchStart,Bt),r=(0,y.M)(Nt.current.onMouseDown,Bt),i=(0,y.M)(Nt.current.onPointerDown,zt);return t.addEventListener("touchstart",n),t.addEventListener("mousedown",r),"PointerEvent"in e&&t.addEventListener("pointerdown",i),function(){t.removeEventListener("touchstart",n),t.removeEventListener("mousedown",r),"PointerEvent"in e&&t.removeEventListener("pointerdown",i)}}),[zt,Bt]);return(0,r.useEffect)((function(){return Rt.current=qt(),function(){Rt.current(),It.current(),Lt.current()}}),[qt]),(0,g.kG)("slider"),(0,r.createElement)(M.Provider,{value:jt},(0,r.createElement)(O,v({},at,{ref:pt,"data-reach-slider-input":"","data-disabled":P?"":void 0,"data-orientation":et,tabIndex:-1}),(0,h.mf)(it)?it({hasFocus:mt,id:ct,max:I,min:U,value:_t,ariaValueText:Dt,valueText:Dt}):it,V&&(0,r.createElement)("input",{type:"hidden",value:_t,name:V,id:ct&&(0,d.q)("input",ct)})))}));var D=(0,r.forwardRef)((function(t,e){var n=t.as,i=void 0===n?"div":n,o=t.children,s=t.style,a=void 0===s?{}:s,u=b(t,O),c=P(),l=c.disabled,f=c.orientation,h=c.trackRef,d=(0,m.e)(h,e);return(0,r.createElement)(i,v({ref:d,style:v({},a,{position:"relative"})},u,{"data-reach-slider-track":"","data-disabled":l?"":void 0,"data-orientation":f}),o)}));var F=(0,r.memo)(D);var j=(0,r.forwardRef)((function(t,e){var n=t.as,i=void 0===n?"div":n;t.children;var o=t.style,s=void 0===o?{}:o,a=b(t,S),u=P(),c=u.disabled,l=u.orientation,f=u.rangeStyle;return(0,r.createElement)(i,v({ref:e,style:v({position:"absolute"},f,s)},a,{"data-reach-slider-range":"","data-disabled":c?"":void 0,"data-orientation":l}))}));var L=(0,r.memo)(j);var R=(0,r.forwardRef)((function(t,e){var n=t.as,i=void 0===n?"div":n,o=t.onBlur,s=t.onFocus,a=t.style,u=void 0===a?{}:a,c=t.onKeyDown,l=b(t,C),f=P(),h=f.ariaLabel,d=f.ariaLabelledBy,p=f.ariaValueText,g=f.disabled,x=f.handlePosition,w=f.handleRef,_=f.isVertical,E=f.handleKeyDown,A=f.orientation,O=f.setHasFocus,S=f.sliderMin,M=f.sliderMax,k=f.value,T=(0,m.e)(w,e);return(0,r.createElement)(i,v({"aria-disabled":g||void 0,"aria-label":h,"aria-labelledby":h?void 0:d,"aria-orientation":A,"aria-valuemax":M,"aria-valuemin":S,"aria-valuenow":k,"aria-valuetext":p,role:"slider",tabIndex:g?-1:0},l,{"data-reach-slider-handle":"",ref:T,onBlur:(0,y.M)(o,(function(){O(!1)})),onFocus:(0,y.M)(s,(function(){O(!0)})),onKeyDown:(0,y.M)(c,E),style:v({position:"absolute"},_?{bottom:x}:{left:x},u)}))}));var I=(0,r.memo)(R);function N(t,e,n){return t>n?n:t<e?e:t}function B(t,e,n){var r=Math.round((t-n)/e)*e+n;return Number(r.toFixed(function(t){if(Math.abs(t)<1){var e=t.toExponential().split("e-"),n=e[0].split(".")[1];return(n?n.length:0)+parseInt(e[1],10)}var r=t.toString().split(".")[1];return r?r.length:0}(e)))}function z(t,e,n){return 100*(t-e)/(n-e)}},3880:function(t,e,n){"use strict";n.d(e,{ZP:function(){return V}});var r=n(7294),i=n(765),o=n(5152);var s=n(4411),a=n(884),u=n(1331),c=n(4683),l=n(4921);n(5697);function f(){return(f=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var h=["as","style"],d=(0,r.forwardRef)((function(t,e){var n=t.as,i=void 0===n?"span":n,o=t.style,s=void 0===o?{}:o,a=function(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,h);return(0,r.createElement)(i,f({ref:e,style:f({border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"},s)},a))}));var p=n(958);function g(){return(g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function m(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}var y,v,b,x,w,_,E,A,O=["children","label","ariaLabel","id","DEBUG_STYLE"],S=["label","ariaLabel","isVisible","id"],C=["ariaLabel","aria-label","as","id","isVisible","label","position","style","triggerRect"],M=["type"];!function(t){t.Idle="IDLE",t.Focused="FOCUSED",t.Visible="VISIBLE",t.LeavingVisible="LEAVING_VISIBLE",t.Dismissed="DISMISSED"}(E||(E={})),function(t){t.Blur="BLUR",t.Focus="FOCUS",t.GlobalMouseMove="GLOBAL_MOUSE_MOVE",t.MouseDown="MOUSE_DOWN",t.MouseEnter="MOUSE_ENTER",t.MouseLeave="MOUSE_LEAVE",t.MouseMove="MOUSE_MOVE",t.Rest="REST",t.SelectWithKeyboard="SELECT_WITH_KEYBOARD",t.TimeComplete="TIME_COMPLETE"}(A||(A={}));var P,k,T={initial:E.Idle,states:(_={},_[E.Idle]={enter:j,on:(y={},y[A.MouseEnter]=E.Focused,y[A.Focus]=E.Visible,y)},_[E.Focused]={enter:function(){window.clearTimeout(P),P=window.setTimeout((function(){$({type:A.Rest})}),100)},leave:function(){window.clearTimeout(P)},on:(v={},v[A.MouseMove]=E.Focused,v[A.MouseLeave]=E.Idle,v[A.MouseDown]=E.Dismissed,v[A.Blur]=E.Idle,v[A.Rest]=E.Visible,v)},_[E.Visible]={on:(b={},b[A.Focus]=E.Focused,b[A.MouseEnter]=E.Focused,b[A.MouseLeave]=E.LeavingVisible,b[A.Blur]=E.LeavingVisible,b[A.MouseDown]=E.Dismissed,b[A.SelectWithKeyboard]=E.Dismissed,b[A.GlobalMouseMove]=E.LeavingVisible,b)},_[E.LeavingVisible]={enter:function(){window.clearTimeout(k),k=window.setTimeout((function(){return $({type:A.TimeComplete})}),500)},leave:function(){window.clearTimeout(k),j()},on:(x={},x[A.MouseEnter]=E.Visible,x[A.Focus]=E.Visible,x[A.TimeComplete]=E.Idle,x)},_[E.Dismissed]={leave:function(){j()},on:(w={},w[A.MouseLeave]=E.Idle,w[A.Blur]=E.Idle,w)},_)},D={value:T.initial,context:{id:null}},F=[];function j(){D.context.id=null}function L(t){var e=void 0===t?{}:t,n=e.id,l=e.onPointerEnter,f=e.onPointerMove,h=e.onPointerLeave,d=e.onPointerDown,g=e.onMouseEnter,m=e.onMouseMove,y=e.onMouseLeave,v=e.onMouseDown,b=e.onFocus,x=e.onBlur,w=e.onKeyDown,_=e.disabled,O=e.ref,S=e.DEBUG_STYLE,C=String((0,i.M)(n)),M=(0,r.useState)(!!S||U(C,!0)),P=M[0],k=M[1],T=(0,r.useRef)(null),j=(0,u.e)(O,T),L=(0,p.EL)(T,{observe:P});function R(t,e){return"undefined"!==typeof window&&"PointerEvent"in window?t:(0,c.M)(t,e)}function I(t){return function(e){"mouse"===e.pointerType&&t(e)}}function N(){$({type:A.MouseEnter,id:C})}function B(){$({type:A.MouseMove,id:C})}function z(){$({type:A.MouseLeave})}function V(){D.context.id===C&&$({type:A.MouseDown})}return(0,r.useEffect)((function(){return t=function(){k(U(C))},F.push(t),function(){F.splice(F.indexOf(t),1)};var t}),[C]),(0,a.kG)("tooltip"),(0,r.useEffect)((function(){var t=(0,o.r)(T.current);function e(t){"Escape"!==t.key&&"Esc"!==t.key||D.value!==E.Visible||$({type:A.SelectWithKeyboard})}return t.addEventListener("keydown",e),function(){return t.removeEventListener("keydown",e)}}),[]),function(t){var e=t.disabled,n=t.isVisible,i=t.ref;(0,r.useEffect)((function(){if("undefined"!==typeof window&&"PointerEvent"in window&&e&&n){var t=(0,o.r)(i.current);return t.addEventListener("mousemove",r),function(){t.removeEventListener("mousemove",r)}}function r(t){n&&(t.target instanceof Element&&t.target.closest("[data-reach-tooltip-trigger][data-state='tooltip-visible']")||$({type:A.GlobalMouseMove}))}}),[e,n,i])}({disabled:_,isVisible:P,ref:T}),[{"aria-describedby":P?(0,s.q)("tooltip",C):void 0,"data-state":P?"tooltip-visible":"tooltip-hidden","data-reach-tooltip-trigger":"",ref:j,onPointerEnter:(0,c.M)(l,I(N)),onPointerMove:(0,c.M)(f,I(B)),onPointerLeave:(0,c.M)(h,I(z)),onPointerDown:(0,c.M)(d,I(V)),onMouseEnter:R(g,N),onMouseMove:R(m,B),onMouseLeave:R(y,z),onMouseDown:R(v,V),onFocus:(0,c.M)(b,(function(){window.__REACH_DISABLE_TOOLTIPS||$({type:A.Focus,id:C})})),onBlur:(0,c.M)(x,(function(){D.context.id===C&&$({type:A.Blur})})),onKeyDown:(0,c.M)(w,(function(t){"Enter"!==t.key&&" "!==t.key||$({type:A.SelectWithKeyboard})}))},{id:C,triggerRect:L,isVisible:P},P]}var R=(0,r.forwardRef)((function(t,e){var n=t.children,i=t.label,o=t.ariaLabel,s=t.id,a=t.DEBUG_STYLE,u=m(t,O),c=r.Children.only(n),l=L({id:s,onPointerEnter:c.props.onPointerEnter,onPointerMove:c.props.onPointerMove,onPointerLeave:c.props.onPointerLeave,onPointerDown:c.props.onPointerDown,onMouseEnter:c.props.onMouseEnter,onMouseMove:c.props.onMouseMove,onMouseLeave:c.props.onMouseLeave,onMouseDown:c.props.onMouseDown,onFocus:c.props.onFocus,onBlur:c.props.onBlur,onKeyDown:c.props.onKeyDown,disabled:c.props.disabled,ref:c.ref,DEBUG_STYLE:a}),f=l[0],h=l[1];return(0,r.createElement)(r.Fragment,null,(0,r.cloneElement)(c,f),(0,r.createElement)(I,g({ref:e,label:i,"aria-label":o},h,u)))}));var I=(0,r.forwardRef)((function(t,e){var n=t.label,i=t.ariaLabel,o=t.isVisible,a=t.id,u=m(t,S);return o?(0,r.createElement)(l.h,null,(0,r.createElement)(N,g({ref:e,label:n,"aria-label":i,isVisible:o},u,{id:(0,s.q)("tooltip",String(a))}))):null}));var N=(0,r.forwardRef)((function(t,e){var n=t.ariaLabel,i=t["aria-label"],o=t.as,s=void 0===o?"div":o,a=t.id,c=t.isVisible,l=t.label,f=t.position,h=void 0===f?z:f,y=t.style,v=t.triggerRect,b=m(t,C),x=null!=(i||n),w=(0,r.useRef)(null),_=(0,u.e)(e,w),E=(0,p.EL)(w,{observe:c});return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(s,g({role:x?void 0:"tooltip"},b,{ref:_,"data-reach-tooltip":"",id:x?void 0:a,style:g({},y,B(h,v,E))}),l),x&&(0,r.createElement)(d,{role:"tooltip",id:a},i||n))}));function B(t,e,n){return!n?{visibility:"hidden"}:t(e,n)}var z=function(t,e,n){void 0===n&&(n=8);var r=function(t){var e,n,r=(0,o.r)(t),i=r.defaultView||window;return r?{width:null!=(e=r.documentElement.clientWidth)?e:i.innerWidth,height:null!=(n=r.documentElement.clientHeight)?n:i.innerHeight}:{width:0,height:0}}(),i=r.width,s=r.height;if(!t||!e)return{};var a={top:t.top-e.height<0,right:i<t.left+e.width,bottom:s<t.bottom+e.height+n,left:t.left-e.width<0},u=a.bottom&&!a.top;return{left:a.right&&!a.left?t.right-e.width+window.pageXOffset+"px":t.left+window.pageXOffset+"px",top:u?t.top-n-e.height+window.pageYOffset+"px":t.top+n+t.height+window.pageYOffset+"px"}};function $(t){var e=function(t,e){var n=T.states[t.value],r=n&&n.on&&n.on[e.type];if(!r)return g({},t,{changed:!1});n&&n.leave&&n.leave(t.context,e);e.type;var i=m(e,M),o=g({},D.context,i),s="string"===typeof r?r:r.target,a=T.states[s];a&&a.enter&&a.enter(t.context,e);return{value:s,context:o,changed:!0}}(D,t),n=e.value,r=e.context;e.changed&&(D={value:n,context:r},F.forEach((function(t){return t(D)})))}function U(t,e){return D.context.id===t&&(e?D.value===E.Visible:D.value===E.Visible||D.value===E.LeavingVisible)}var V=R},2945:function(t,e,n){"use strict";n.d(e,{R:function(){return s},g:function(){return a}});var r=n(7294),i=n(6637);function o(t,e){var n=(0,r.useRef)(e);return t((function(){n.current=e})),(0,r.useCallback)((function(){n.current&&n.current.apply(n,arguments)}),[])}function s(t){return o(r.useEffect,t)}function a(t){return o(i.L,t)}},9742:function(t,e){"use strict";e.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,o=u(t),s=o[0],a=o[1],c=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,a)),l=0,f=a>0?s-4:s;for(n=0;n<f;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;2===a&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,c[l++]=255&e);1===a&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e);return c},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=16383,a=0,u=r-i;a<u;a+=s)o.push(c(t,a,a+s>u?u:a+s));1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"="));return o.join("")};for(var n=[],r=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=o.length;s<a;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},8764:function(t,e,n){"use strict";var r=n(9742),i=n(645),o="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50;var s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,u.prototype),e}function u(t,e,n){if("number"===typeof t){if("string"===typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return f(t)}return c(t,e,n)}function c(t,e,n){if("string"===typeof t)return function(t,e){"string"===typeof e&&""!==e||(e="utf8");if(!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|g(t,e),r=a(n),i=r.write(t,e);i!==n&&(r=r.slice(0,i));return r}(t,e);if(ArrayBuffer.isView(t))return h(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(U(t,ArrayBuffer)||t&&U(t.buffer,ArrayBuffer))return d(t,e,n);if("undefined"!==typeof SharedArrayBuffer&&(U(t,SharedArrayBuffer)||t&&U(t.buffer,SharedArrayBuffer)))return d(t,e,n);if("number"===typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return u.from(r,e,n);var i=function(t){if(u.isBuffer(t)){var e=0|p(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!==typeof t.length||V(t.length)?a(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}(t);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof t[Symbol.toPrimitive])return u.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function l(t){if("number"!==typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t){return l(t),a(t<0?0:0|p(t))}function h(t){for(var e=t.length<0?0:0|p(t.length),n=a(e),r=0;r<e;r+=1)n[r]=255&t[r];return n}function d(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,u.prototype),r}function p(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function g(t,e){if(u.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||U(t,ArrayBuffer))return t.byteLength;if("string"!==typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return B(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(t).length;default:if(i)return r?-1:B(t).length;e=(""+e).toLowerCase(),i=!0}}function m(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return C(this,e,n);case"ascii":return P(this,e,n);case"latin1":case"binary":return k(this,e,n);case"base64":return S(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,i){if(0===t.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),V(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:b(t,e,n,r,i);if("number"===typeof e)return e&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):b(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(t,e,n,r,i){var o,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var l=-1;for(o=n;o<a;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){f=!1;break}if(f)return o}return-1}function x(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=e.length;r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(e.substr(2*s,2),16);if(V(a))return s;t[n+s]=a}return s}function w(t,e,n,r){return $(B(e,t.length-n),t,n,r)}function _(t,e,n,r){return $(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function E(t,e,n,r){return _(t,e,n,r)}function A(t,e,n,r){return $(z(e),t,n,r)}function O(t,e,n,r){return $(function(t,e){for(var n,r,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=(n=t.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function S(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function C(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,s,a,u,c=t[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128===(192&(o=t[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=t[i+1],s=t[i+2],128===(192&o)&&128===(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128===(192&o)&&128===(192&s)&&128===(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=M)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=M));return n}(r)}e.kMaxLength=s,u.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(n){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(t,e,n){return function(t,e,n){return l(t),t<=0?a(t):void 0!==e?"string"===typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},u.allocUnsafe=function(t){return f(t)},u.allocUnsafeSlow=function(t){return f(t)},u.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==u.prototype},u.compare=function(t,e){if(U(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),U(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(U(o,Uint8Array)&&(o=u.from(o)),!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=g,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?C(this,0,t):m.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(t,e,n,r,i){if(U(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(r,i),l=t.slice(e,n),f=0;f<a;++f)if(c[f]!==l[f]){o=c[f],s=l[f];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"===typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return x(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":return _(this,t,e,n);case"latin1":case"binary":return E(this,t,e,n);case"base64":return A(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function P(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function k(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=e;o<n;++o)i+=Z[t[o]];return i}function D(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function F(t,e,n){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function j(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function R(t,e,n,r,o){return e=+e,n>>>=0,o||L(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function I(t,e,n,r,o){return e=+e,n>>>=0,o||L(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var r=this.subarray(t,e);return Object.setPrototypeOf(r,u.prototype),r},u.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return t>>>=0,e||F(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return t>>>=0,e||F(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return t>>>=0,e||F(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return t>>>=0,e||F(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return t>>>=0,e||F(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||F(t,e,this.length);for(var r=e,i=1,o=this[t+--r];r>0&&(i*=256);)o+=this[t+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return t>>>=0,e||F(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){t>>>=0,e||F(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){t>>>=0,e||F(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return t>>>=0,e||F(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return t>>>=0,e||F(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return t>>>=0,e||F(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return t>>>=0,e||F(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return t>>>=0,e||F(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return t>>>=0,e||F(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e>>>=0,n>>>=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e>>>=0,n>>>=0,r)||j(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,1,255,0),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);j(this,t,e,n,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<n&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){var i=Math.pow(2,8*n-1);j(this,t,e,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||j(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},u.prototype.writeFloatLE=function(t,e,n){return R(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return R(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return I(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return I(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(!u.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i=r-n;if(this===t&&"function"===typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,r);else if(this===t&&n<e&&e<r)for(var o=i-1;o>=0;--o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,r),e);return i},u.prototype.fill=function(t,e,n,r){if("string"===typeof t){if("string"===typeof e?(r=e,e=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){var i=t.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(t=i)}}else"number"===typeof t?t&=255:"boolean"===typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"===typeof t)for(o=e;o<n;++o)this[o]=t;else{var s=u.isBuffer(t)?t:u.from(t,r),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=s[o%a]}return this};var N=/[^+/0-9A-Za-z-_]/g;function B(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(N,"")).length<2)return"";for(;t.length%4!==0;)t+="=";return t}(t))}function $(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function U(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function V(t){return t!==t}var Z=function(){for(var t="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)e[r+i]=t[n]+t[i];return e}()},6313:function(t,e,n){var r=n(8764).Buffer,i=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var e,n,i;try{e=Map}catch(u){e=function(){}}try{n=Set}catch(u){n=function(){}}try{i=Promise}catch(u){i=function(){}}function o(s,u,c,l,f){"object"===typeof u&&(c=u.depth,l=u.prototype,f=u.includeNonEnumerable,u=u.circular);var h=[],d=[],p="undefined"!=typeof r;return"undefined"==typeof u&&(u=!0),"undefined"==typeof c&&(c=1/0),function s(c,g){if(null===c)return null;if(0===g)return c;var m,y;if("object"!=typeof c)return c;if(t(c,e))m=new e;else if(t(c,n))m=new n;else if(t(c,i))m=new i((function(t,e){c.then((function(e){t(s(e,g-1))}),(function(t){e(s(t,g-1))}))}));else if(o.__isArray(c))m=[];else if(o.__isRegExp(c))m=new RegExp(c.source,a(c)),c.lastIndex&&(m.lastIndex=c.lastIndex);else if(o.__isDate(c))m=new Date(c.getTime());else{if(p&&r.isBuffer(c))return m=r.allocUnsafe?r.allocUnsafe(c.length):new r(c.length),c.copy(m),m;t(c,Error)?m=Object.create(c):"undefined"==typeof l?(y=Object.getPrototypeOf(c),m=Object.create(y)):(m=Object.create(l),y=l)}if(u){var v=h.indexOf(c);if(-1!=v)return d[v];h.push(c),d.push(m)}for(var b in t(c,e)&&c.forEach((function(t,e){var n=s(e,g-1),r=s(t,g-1);m.set(n,r)})),t(c,n)&&c.forEach((function(t){var e=s(t,g-1);m.add(e)})),c){var x;y&&(x=Object.getOwnPropertyDescriptor(y,b)),x&&null==x.set||(m[b]=s(c[b],g-1))}if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(c);for(b=0;b<w.length;b++){var _=w[b];(!(A=Object.getOwnPropertyDescriptor(c,_))||A.enumerable||f)&&(m[_]=s(c[_],g-1),A.enumerable||Object.defineProperty(m,_,{enumerable:!1}))}}if(f){var E=Object.getOwnPropertyNames(c);for(b=0;b<E.length;b++){var A,O=E[b];(A=Object.getOwnPropertyDescriptor(c,O))&&A.enumerable||(m[O]=s(c[O],g-1),Object.defineProperty(m,O,{enumerable:!1}))}}return m}(s,c)}function s(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return o.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},o.__objToStr=s,o.__isDate=function(t){return"object"===typeof t&&"[object Date]"===s(t)},o.__isArray=function(t){return"object"===typeof t&&"[object Array]"===s(t)},o.__isRegExp=function(t){return"object"===typeof t&&"[object RegExp]"===s(t)},o.__getRegExpFlags=a,o}();t.exports&&(t.exports=i)},8244:function(t,e,n){"use strict";n.d(e,{Oq:function(){return d},dO:function(){return c},jn:function(){return s},iz:function(){return p},Dz:function(){return o},cv:function(){return f},oc:function(){return h}});var r="Invariant failed";var i=function(t,e){if(!t)throw new Error(r)},o=function(t){var e=t.top,n=t.right,r=t.bottom,i=t.left;return{top:e,right:n,bottom:r,left:i,width:n-i,height:r-e,x:i,y:e,center:{x:(n+i)/2,y:(r+e)/2}}},s=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},a=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},u={top:0,right:0,bottom:0,left:0},c=function(t){var e=t.borderBox,n=t.margin,r=void 0===n?u:n,i=t.border,c=void 0===i?u:i,l=t.padding,f=void 0===l?u:l,h=o(s(e,r)),d=o(a(e,c)),p=o(a(d,f));return{marginBox:h,borderBox:o(e),paddingBox:d,contentBox:p,margin:r,border:c,padding:f}},l=function(t){var e=t.slice(0,-2);if("px"!==t.slice(-2))return 0;var n=Number(e);return isNaN(n)&&i(!1),n},f=function(t,e){var n,r,i=t.borderBox,o=t.border,s=t.margin,a=t.padding,u=(r=e,{top:(n=i).top+r.y,left:n.left+r.x,bottom:n.bottom+r.y,right:n.right+r.x});return c({borderBox:u,border:o,margin:s,padding:a})},h=function(t,e){return void 0===e&&(e={x:window.pageXOffset,y:window.pageYOffset}),f(t,e)},d=function(t,e){var n={top:l(e.marginTop),right:l(e.marginRight),bottom:l(e.marginBottom),left:l(e.marginLeft)},r={top:l(e.paddingTop),right:l(e.paddingRight),bottom:l(e.paddingBottom),left:l(e.paddingLeft)},i={top:l(e.borderTopWidth),right:l(e.borderRightWidth),bottom:l(e.borderBottomWidth),left:l(e.borderLeftWidth)};return c({borderBox:t,margin:n,padding:r,border:i})},p=function(t){var e=t.getBoundingClientRect(),n=window.getComputedStyle(t);return d(e,n)}},1077:function(t,e,n){"use strict";function r(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}n.d(e,{Z:function(){return r}})},1220:function(t,e,n){"use strict";n.d(e,{Z:function(){return f}});var r=Array.prototype,i=r.slice,o=(r.map,n(4355));function s(t){return function(){return t}}function a(t,e){let n,r;if(void 0===e)for(const i of t)null!=i&&(void 0===n?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(void 0===n?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}function u(t){return t}var c=n(7614);function l(t){return Math.ceil(Math.log(function(t,e){let n=0;if(void 0===e)for(let r of t)null!=r&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(i=+i)>=i&&++n}return n}(t))/Math.LN2)+1}function f(){var t=u,e=a,n=l;function r(r){Array.isArray(r)||(r=Array.from(r));var i,s,u=r.length,l=new Array(u);for(i=0;i<u;++i)l[i]=t(r[i],i,r);var f=e(l),h=f[0],d=f[1],p=n(l,h,d);if(!Array.isArray(p)){const t=d,n=+p;if(e===a&&([h,d]=function(t,e,n){let r;for(;;){const i=(0,c.G9)(t,e,n);if(i===r||0===i||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}(h,d,n)),(p=(0,c.ZP)(h,d,n))[p.length-1]>=d)if(t>=d&&e===a){const t=(0,c.G9)(h,d,n);isFinite(t)&&(t>0?d=(Math.floor(d/t)+1)*t:t<0&&(d=(Math.ceil(d*-t)+1)/-t))}else p.pop()}for(var g=p.length;p[0]<=h;)p.shift(),--g;for(;p[g-1]>d;)p.pop(),--g;var m,y=new Array(g+1);for(i=0;i<=g;++i)(m=y[i]=[]).x0=i>0?p[i-1]:h,m.x1=i<g?p[i]:d;for(i=0;i<u;++i)h<=(s=l[i])&&s<=d&&y[(0,o.ZP)(p,s,0,g)].push(r[i]);return y}return r.value=function(e){return arguments.length?(t="function"===typeof e?e:s(e),r):t},r.domain=function(t){return arguments.length?(e="function"===typeof t?t:s([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"===typeof t?t:Array.isArray(t)?s(i.call(t)):s(t),r):n},r}},4355:function(t,e,n){"use strict";n.d(e,{ml:function(){return a},Nw:function(){return u}});var r=n(1077),i=n(9173),o=n(2921);const s=(0,i.Z)(r.Z),a=s.right,u=s.left;(0,i.Z)(o.Z).center;e.ZP=a},9173:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(1077);function i(t){let e=t,n=t;function i(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>(0,r.Z)(t(e),n)}(t)),{left:i,center:function(t,n,r,o){null==r&&(r=0),null==o&&(o=t.length);const s=i(t,n,r,o-1);return s>r&&e(t[s-1],n)>-e(t[s],n)?s-1:s},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}}}},2921:function(t,e,n){"use strict";function r(t){return null===t?NaN:+t}function*i(t,e){if(void 0===e)for(let n of t)null!=n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}n.d(e,{Z:function(){return r},K:function(){return i}})},7614:function(t,e,n){"use strict";n.d(e,{ZP:function(){return s},G9:function(){return a},ly:function(){return u}});var r=Math.sqrt(50),i=Math.sqrt(10),o=Math.sqrt(2);function s(t,e,n){var r,i,o,s,u=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=a(t,e,n))||!isFinite(s))return[];if(s>0){let n=Math.round(t/s),r=Math.round(e/s);for(n*s<t&&++n,r*s>e&&--r,o=new Array(i=r-n+1);++u<i;)o[u]=(n+u)*s}else{s=-s;let n=Math.round(t*s),r=Math.round(e*s);for(n/s<t&&++n,r/s>e&&--r,o=new Array(i=r-n+1);++u<i;)o[u]=(n+u)/s}return r&&o.reverse(),o}function a(t,e,n){var s=(e-t)/Math.max(0,n),a=Math.floor(Math.log(s)/Math.LN10),u=s/Math.pow(10,a);return a>=0?(u>=r?10:u>=i?5:u>=o?2:1)*Math.pow(10,a):-Math.pow(10,-a)/(u>=r?10:u>=i?5:u>=o?2:1)}function u(t,e,n){var s=Math.abs(e-t)/Math.max(0,n),a=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),u=s/a;return u>=r?a*=10:u>=i?a*=5:u>=o&&(a*=2),e<t?-a:a}},7484:function(t){t.exports=function(){"use strict";var t=1e3,e=6e4,n=36e5,r="millisecond",i="second",o="minute",s="hour",a="day",u="week",c="month",l="quarter",f="year",h="date",d="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},y=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},v={s:y,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+y(r,2,"0")+":"+y(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),i=e.clone().add(r,c),o=n-i<0,s=e.clone().add(r+(o?-1:1),c);return+(-(r+(n-i)/(o?i-s:s-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:c,y:f,w:u,d:a,D:h,h:s,m:o,s:i,ms:r,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},b="en",x={};x[b]=m;var w=function(t){return t instanceof O},_=function(t,e,n){var r;if(!t)return b;if("string"==typeof t)x[t]&&(r=t),e&&(x[t]=e,r=t);else{var i=t.name;x[i]=t,r=i}return!n&&r&&(b=r),r||!n&&b},E=function(t,e){if(w(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new O(n)},A=v;A.l=_,A.i=w,A.w=function(t,e){return E(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var O=function(){function m(t){this.$L=_(t.locale,null,!0),this.parse(t)}var y=m.prototype;return y.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(A.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(p);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},y.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},y.$utils=function(){return A},y.isValid=function(){return!(this.$d.toString()===d)},y.isSame=function(t,e){var n=E(t);return this.startOf(e)<=n&&n<=this.endOf(e)},y.isAfter=function(t,e){return E(t)<this.startOf(e)},y.isBefore=function(t,e){return this.endOf(e)<E(t)},y.$g=function(t,e,n){return A.u(t)?this[e]:this.set(n,t)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(t,e){var n=this,r=!!A.u(e)||e,l=A.p(t),d=function(t,e){var i=A.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?i:i.endOf(a)},p=function(t,e){return A.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},g=this.$W,m=this.$M,y=this.$D,v="set"+(this.$u?"UTC":"");switch(l){case f:return r?d(1,0):d(31,11);case c:return r?d(1,m):d(0,m+1);case u:var b=this.$locale().weekStart||0,x=(g<b?g+7:g)-b;return d(r?y-x:y+(6-x),m);case a:case h:return p(v+"Hours",0);case s:return p(v+"Minutes",1);case o:return p(v+"Seconds",2);case i:return p(v+"Milliseconds",3);default:return this.clone()}},y.endOf=function(t){return this.startOf(t,!1)},y.$set=function(t,e){var n,u=A.p(t),l="set"+(this.$u?"UTC":""),d=(n={},n[a]=l+"Date",n[h]=l+"Date",n[c]=l+"Month",n[f]=l+"FullYear",n[s]=l+"Hours",n[o]=l+"Minutes",n[i]=l+"Seconds",n[r]=l+"Milliseconds",n)[u],p=u===a?this.$D+(e-this.$W):e;if(u===c||u===f){var g=this.clone().set(h,1);g.$d[d](p),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},y.set=function(t,e){return this.clone().$set(t,e)},y.get=function(t){return this[A.p(t)]()},y.add=function(r,l){var h,d=this;r=Number(r);var p=A.p(l),g=function(t){var e=E(d);return A.w(e.date(e.date()+Math.round(t*r)),d)};if(p===c)return this.set(c,this.$M+r);if(p===f)return this.set(f,this.$y+r);if(p===a)return g(1);if(p===u)return g(7);var m=(h={},h[o]=e,h[s]=n,h[i]=t,h)[p]||1,y=this.$d.getTime()+r*m;return A.w(y,this)},y.subtract=function(t,e){return this.add(-1*t,e)},y.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",i=A.z(this),o=this.$H,s=this.$m,a=this.$M,u=n.weekdays,c=n.months,l=function(t,n,i,o){return t&&(t[n]||t(e,r))||i[n].substr(0,o)},f=function(t){return A.s(o%12||12,t,"0")},h=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},p={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:A.s(a+1,2,"0"),MMM:l(n.monthsShort,a,c,3),MMMM:l(c,a),D:this.$D,DD:A.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,u,2),ddd:l(n.weekdaysShort,this.$W,u,3),dddd:u[this.$W],H:String(o),HH:A.s(o,2,"0"),h:f(1),hh:f(2),a:h(o,s,!0),A:h(o,s,!1),m:String(s),mm:A.s(s,2,"0"),s:String(this.$s),ss:A.s(this.$s,2,"0"),SSS:A.s(this.$ms,3,"0"),Z:i};return r.replace(g,(function(t,e){return e||p[t]||i.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(r,h,d){var p,g=A.p(h),m=E(r),y=(m.utcOffset()-this.utcOffset())*e,v=this-m,b=A.m(this,m);return b=(p={},p[f]=b/12,p[c]=b,p[l]=b/3,p[u]=(v-y)/6048e5,p[a]=(v-y)/864e5,p[s]=v/n,p[o]=v/e,p[i]=v/t,p)[g]||v,d?b:A.a(b)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return x[this.$L]},y.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=_(t,e,!0);return r&&(n.$L=r),n},y.clone=function(){return A.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},m}(),S=O.prototype;return E.prototype=S,[["$ms",r],["$s",i],["$m",o],["$H",s],["$W",a],["$M",c],["$y",f],["$D",h]].forEach((function(t){S[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),E.extend=function(t,e){return t.$i||(t(e,O,E),t.$i=!0),E},E.locale=_,E.isDayjs=w,E.unix=function(t){return E(1e3*t)},E.en=x[b],E.Ls=x,E.p={},E}()},9187:function(t){"use strict";function e(t,e,o){o=o||2;var s,a,u,f,h,p,g,m=e&&e.length,y=m?e[0]*o:t.length,v=n(t,0,y,o,!0),b=[];if(!v||v.next===v.prev)return b;if(m&&(v=function(t,e,i,o){var s,a,u,f=[];for(s=0,a=e.length;s<a;s++)(u=n(t,e[s]*o,s<a-1?e[s+1]*o:t.length,o,!1))===u.next&&(u.steiner=!0),f.push(d(u));for(f.sort(c),s=0;s<f.length;s++)i=r(i=l(f[s],i),i.next);return i}(t,e,v,o)),t.length>80*o){s=u=t[0],a=f=t[1];for(var x=o;x<y;x+=o)(h=t[x])<s&&(s=h),(p=t[x+1])<a&&(a=p),h>u&&(u=h),p>f&&(f=p);g=0!==(g=Math.max(u-s,f-a))?1/g:0}return i(v,b,o,s,a,g),b}function n(t,e,n,r,i){var o,s;if(i===S(t,e,n,r)>0)for(o=e;o<n;o+=r)s=E(o,t[o],t[o+1],s);else for(o=n-r;o>=e;o-=r)s=E(o,t[o],t[o+1],s);return s&&y(s,s.next)&&(A(s),s=s.next),s}function r(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!y(r,r.next)&&0!==m(r.prev,r,r.next))r=r.next;else{if(A(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function i(t,e,n,c,l,f,d){if(t){!d&&f&&function(t,e,n,r){var i=t;do{null===i.z&&(i.z=h(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var e,n,r,i,o,s,a,u,c=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,r=n,a=0,e=0;e<c&&(a++,r=r.nextZ);e++);for(u=c;a>0||u>0&&r;)0!==a&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,a--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(s>1)}(i)}(t,c,l,f);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,f?s(t,c,l,f):o(t))e.push(p.i/n),e.push(t.i/n),e.push(g.i/n),A(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?i(t=a(r(t),e,n),e,n,c,l,f,2):2===d&&u(t,e,n,c,l,f):i(r(t),e,n,c,l,f,1);break}}}function o(t){var e=t.prev,n=t,r=t.next;if(m(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(p(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&m(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function s(t,e,n,r){var i=t.prev,o=t,s=t.next;if(m(i,o,s)>=0)return!1;for(var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,c=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,l=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,f=h(a,u,e,n,r),d=h(c,l,e,n,r),g=t.prevZ,y=t.nextZ;g&&g.z>=f&&y&&y.z<=d;){if(g!==t.prev&&g!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;if(g=g.prevZ,y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;g&&g.z>=f;){if(g!==t.prev&&g!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;y&&y.z<=d;){if(y!==t.prev&&y!==t.next&&p(i.x,i.y,o.x,o.y,s.x,s.y,y.x,y.y)&&m(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function a(t,e,n){var i=t;do{var o=i.prev,s=i.next.next;!y(o,s)&&v(o,i,i.next,s)&&w(o,s)&&w(s,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(s.i/n),A(i),A(i.next),i=t=s),i=i.next}while(i!==t);return r(i)}function u(t,e,n,o,s,a){var u=t;do{for(var c=u.next.next;c!==u.prev;){if(u.i!==c.i&&g(u,c)){var l=_(u,c);return u=r(u,u.next),l=r(l,l.next),i(u,e,n,o,s,a),void i(l,e,n,o,s,a)}c=c.next}u=u.next}while(u!==t)}function c(t,e){return t.x-e.x}function l(t,e){var n=function(t,e){var n,r=e,i=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>s){if(s=a,a===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===s)return n;var u,c=n,l=n.x,h=n.y,d=1/0;r=n;do{i>=r.x&&r.x>=l&&i!==r.x&&p(o<h?i:s,o,l,h,o<h?s:i,o,r.x,r.y)&&(u=Math.abs(o-r.y)/(i-r.x),w(r,t)&&(u<d||u===d&&(r.x>n.x||r.x===n.x&&f(n,r)))&&(n=r,d=u)),r=r.next}while(r!==c);return n}(t,e);if(!n)return e;var i=_(n,t),o=r(n,n.next);return r(i,i.next),e===n?o:e}function f(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function h(t,e,n,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*i)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*i)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,r,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(n-s)*(e-a)>=0&&(n-s)*(o-a)-(i-s)*(r-a)>=0}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(w(t,e)&&w(e,t)&&function(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,r){var i=x(m(t,e,n)),o=x(m(t,e,r)),s=x(m(n,r,t)),a=x(m(n,r,e));return i!==o&&s!==a||(!(0!==i||!b(t,n,e))||(!(0!==o||!b(t,r,e))||(!(0!==s||!b(n,t,r))||!(0!==a||!b(n,e,r)))))}function b(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function x(t){return t>0?1:t<0?-1:0}function w(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function _(t,e){var n=new O(t.i,t.x,t.y),r=new O(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function E(t,e,n,r){var i=new O(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function A(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function O(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S(t,e,n,r){for(var i=0,o=e,s=n-r;o<n;o+=r)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,s=Math.abs(S(t,0,o,n));if(i)for(var a=0,u=e.length;a<u;a++){var c=e[a]*n,l=a<u-1?e[a+1]*n:t.length;s-=Math.abs(S(t,c,l,n))}var f=0;for(a=0;a<r.length;a+=3){var h=r[a]*n,d=r[a+1]*n,p=r[a+2]*n;f+=Math.abs((t[h]-t[p])*(t[d+1]-t[h+1])-(t[h]-t[d])*(t[p+1]-t[h+1]))}return 0===s&&0===f?0:Math.abs((f-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[i][o][s]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n}},4063:function(t){"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!==i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!==i--;){var s=o[i];if(!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n}},5035:function(t){"use strict";t.exports=function(t,e){e||(e={}),"function"===typeof e&&(e={cmp:e});var n,r="boolean"===typeof e.cycles&&e.cycles,i=e.cmp&&(n=e.cmp,function(t){return function(e,r){var i={key:e,value:t[e]},o={key:r,value:t[r]};return n(i,o)}}),o=[];return function t(e){if(e&&e.toJSON&&"function"===typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!==typeof e)return JSON.stringify(e);var n,s;if(Array.isArray(e)){for(s="[",n=0;n<e.length;n++)n&&(s+=","),s+=t(e[n])||"null";return s+"]"}if(null===e)return"null";if(-1!==o.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=o.push(e)-1,u=Object.keys(e).sort(i&&i(e));for(s="",n=0;n<u.length;n++){var c=u[n],l=t(e[c]);l&&(s&&(s+=","),s+=JSON.stringify(c)+":"+l)}return o.splice(a,1),"{"+s+"}"}}(t)}},9685:function(t,e,n){"use strict";n.d(e,{Ib:function(){return r},WT:function(){return i}});var r=1e-6,i="undefined"!==typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},5975:function(t,e,n){"use strict";n.d(e,{p4:function(){return i},U_:function(){return o},GH:function(){return s},Jp:function(){return a},Iu:function(){return u},bA:function(){return c},U1:function(){return l},lM:function(){return f},uD:function(){return h},jI:function(){return d},Q$:function(){return p},en:function(){return g},oy:function(){return m},G3:function(){return y},M5:function(){return v},zB:function(){return b},fS:function(){return x}});var r=n(9685);function i(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function o(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],f=e[9],h=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*a-r*s,b=n*u-i*s,x=n*c-o*s,w=r*u-i*a,_=r*c-o*a,E=i*c-o*u,A=l*g-f*p,O=l*m-h*p,S=l*y-d*p,C=f*m-h*g,M=f*y-d*g,P=h*y-d*m,k=v*P-b*M+x*C+w*S-_*O+E*A;return k?(k=1/k,t[0]=(a*P-u*M+c*C)*k,t[1]=(i*M-r*P-o*C)*k,t[2]=(g*E-m*_+y*w)*k,t[3]=(h*_-f*E-d*w)*k,t[4]=(u*S-s*P-c*O)*k,t[5]=(n*P-i*S+o*O)*k,t[6]=(m*x-p*E-y*b)*k,t[7]=(l*E-h*x+d*b)*k,t[8]=(s*M-a*S+c*A)*k,t[9]=(r*S-n*M-o*A)*k,t[10]=(p*_-g*x+y*v)*k,t[11]=(f*x-l*_-d*v)*k,t[12]=(a*O-s*C-u*A)*k,t[13]=(n*C-r*O+i*A)*k,t[14]=(g*b-p*w-m*v)*k,t[15]=(l*w-f*b+h*v)*k,t):null}function s(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],d=t[12],p=t[13],g=t[14],m=t[15];return(e*s-n*o)*(f*m-h*g)-(e*a-r*o)*(l*m-h*p)+(e*u-i*o)*(l*g-f*p)+(n*a-r*s)*(c*m-h*d)-(n*u-i*s)*(c*g-f*d)+(r*u-i*a)*(c*p-l*d)}function a(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],b=n[0],x=n[1],w=n[2],_=n[3];return t[0]=b*r+x*a+w*f+_*g,t[1]=b*i+x*u+w*h+_*m,t[2]=b*o+x*c+w*d+_*y,t[3]=b*s+x*l+w*p+_*v,b=n[4],x=n[5],w=n[6],_=n[7],t[4]=b*r+x*a+w*f+_*g,t[5]=b*i+x*u+w*h+_*m,t[6]=b*o+x*c+w*d+_*y,t[7]=b*s+x*l+w*p+_*v,b=n[8],x=n[9],w=n[10],_=n[11],t[8]=b*r+x*a+w*f+_*g,t[9]=b*i+x*u+w*h+_*m,t[10]=b*o+x*c+w*d+_*y,t[11]=b*s+x*l+w*p+_*v,b=n[12],x=n[13],w=n[14],_=n[15],t[12]=b*r+x*a+w*f+_*g,t[13]=b*i+x*u+w*h+_*m,t[14]=b*o+x*c+w*d+_*y,t[15]=b*s+x*l+w*p+_*v,t}function u(t,e,n){var r,i,o,s,a,u,c,l,f,h,d,p,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(r=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],f=e[8],h=e[9],d=e[10],p=e[11],t[0]=r,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=f,t[9]=h,t[10]=d,t[11]=p,t[12]=r*g+a*m+f*y+e[12],t[13]=i*g+u*m+h*y+e[13],t[14]=o*g+c*m+d*y+e[14],t[15]=s*g+l*m+p*y+e[15]),t}function c(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function l(t,e,n,i){var o,s,a,u,c,l,f,h,d,p,g,m,y,v,b,x,w,_,E,A,O,S,C,M,P=i[0],k=i[1],T=i[2],D=Math.hypot(P,k,T);return D<r.Ib?null:(P*=D=1/D,k*=D,T*=D,o=Math.sin(n),a=1-(s=Math.cos(n)),u=e[0],c=e[1],l=e[2],f=e[3],h=e[4],d=e[5],p=e[6],g=e[7],m=e[8],y=e[9],v=e[10],b=e[11],x=P*P*a+s,w=k*P*a+T*o,_=T*P*a-k*o,E=P*k*a-T*o,A=k*k*a+s,O=T*k*a+P*o,S=P*T*a+k*o,C=k*T*a-P*o,M=T*T*a+s,t[0]=u*x+h*w+m*_,t[1]=c*x+d*w+y*_,t[2]=l*x+p*w+v*_,t[3]=f*x+g*w+b*_,t[4]=u*E+h*A+m*O,t[5]=c*E+d*A+y*O,t[6]=l*E+p*A+v*O,t[7]=f*E+g*A+b*O,t[8]=u*S+h*C+m*M,t[9]=c*S+d*C+y*M,t[10]=l*S+p*C+v*M,t[11]=f*S+g*C+b*M,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function f(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*r,t[5]=s*i+l*r,t[6]=a*i+f*r,t[7]=u*i+h*r,t[8]=c*i-o*r,t[9]=l*i-s*r,t[10]=f*i-a*r,t[11]=h*i-u*r,t}function h(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[8],l=e[9],f=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*r,t[1]=s*i-l*r,t[2]=a*i-f*r,t[3]=u*i-h*r,t[8]=o*r+c*i,t[9]=s*r+l*i,t[10]=a*r+f*i,t[11]=u*r+h*i,t}function d(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],f=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*r,t[1]=s*i+l*r,t[2]=a*i+f*r,t[3]=u*i+h*r,t[4]=c*i-o*r,t[5]=l*i-s*r,t[6]=f*i-a*r,t[7]=h*i-u*r,t}function p(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(u,c,l),t}function g(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,f=r*a,h=i*s,d=i*a,p=i*u,g=o*s,m=o*a,y=o*u;return t[0]=1-f-p,t[1]=l+y,t[2]=h-m,t[3]=0,t[4]=l-y,t[5]=1-c-p,t[6]=d+g,t[7]=0,t[8]=h+m,t[9]=d-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function m(t,e,n,r,i,o,s){var a=1/(n-e),u=1/(i-r),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t}function y(t,e,n,r,i){var o,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(o=1/(r-i),t[10]=(i+r)*o,t[14]=2*i*r*o):(t[10]=-1,t[14]=-2*r),t}function v(t,e,n,r,i,o,s){var a=1/(e-n),u=1/(r-i),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(s+o)*c,t[15]=1,t}function b(t,e,n,i){var o,s,a,u,c,l,f,h,d,p,g=e[0],m=e[1],y=e[2],v=i[0],b=i[1],x=i[2],w=n[0],_=n[1],E=n[2];return Math.abs(g-w)<r.Ib&&Math.abs(m-_)<r.Ib&&Math.abs(y-E)<r.Ib?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(f=g-w,h=m-_,d=y-E,o=b*(d*=p=1/Math.hypot(f,h,d))-x*(h*=p),s=x*(f*=p)-v*d,a=v*h-b*f,(p=Math.hypot(o,s,a))?(o*=p=1/p,s*=p,a*=p):(o=0,s=0,a=0),u=h*a-d*s,c=d*o-f*a,l=f*s-h*o,(p=Math.hypot(u,c,l))?(u*=p=1/p,c*=p,l*=p):(u=0,c=0,l=0),t[0]=o,t[1]=u,t[2]=f,t[3]=0,t[4]=s,t[5]=c,t[6]=h,t[7]=0,t[8]=a,t[9]=l,t[10]=d,t[11]=0,t[12]=-(o*g+s*m+a*y),t[13]=-(u*g+c*m+l*y),t[14]=-(f*g+h*m+d*y),t[15]=1,t)}function x(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],d=t[10],p=t[11],g=t[12],m=t[13],y=t[14],v=t[15],b=e[0],x=e[1],w=e[2],_=e[3],E=e[4],A=e[5],O=e[6],S=e[7],C=e[8],M=e[9],P=e[10],k=e[11],T=e[12],D=e[13],F=e[14],j=e[15];return Math.abs(n-b)<=r.Ib*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(i-x)<=r.Ib*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-w)<=r.Ib*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-_)<=r.Ib*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(a-E)<=r.Ib*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(u-A)<=r.Ib*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(c-O)<=r.Ib*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(l-S)<=r.Ib*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(f-C)<=r.Ib*Math.max(1,Math.abs(f),Math.abs(C))&&Math.abs(h-M)<=r.Ib*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-P)<=r.Ib*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(p-k)<=r.Ib*Math.max(1,Math.abs(p),Math.abs(k))&&Math.abs(g-T)<=r.Ib*Math.max(1,Math.abs(g),Math.abs(T))&&Math.abs(m-D)<=r.Ib*Math.max(1,Math.abs(m),Math.abs(D))&&Math.abs(y-F)<=r.Ib*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(v-j)<=r.Ib*Math.max(1,Math.abs(v),Math.abs(j))}},1437:function(t,e,n){"use strict";n.d(e,{IH:function(){return i},bA:function(){return o},kE:function(){return s},tk:function(){return a},t7:function(){return u},kK:function(){return c},fF:function(){return l},lu:function(){return f}});var r=n(9685);function i(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function o(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function s(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function a(t,e){return t[0]=-e[0],t[1]=-e[1],t}function u(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function c(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function l(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var f=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};!function(){var t=function(){var t=new r.WT(2);return r.WT!=Float32Array&&(t[0]=0,t[1]=0),t}()}()},7160:function(t,e,n){"use strict";n.d(e,{Ue:function(){return i},al:function(){return o},IH:function(){return s},tk:function(){return a},Fv:function(){return u},AK:function(){return c},kC:function(){return l},fF:function(){return f},kK:function(){return h},VC:function(){return d},lM:function(){return p},uD:function(){return g},jI:function(){return m},EU:function(){return y},lu:function(){return v},dC:function(){return b},Zh:function(){return x}});var r=n(9685);function i(){var t=new r.WT(3);return r.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function o(t,e,n){var i=new r.WT(3);return i[0]=t,i[1]=e,i[2]=n,i}function s(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function a(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function u(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function c(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function l(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2];return t[0]=i*u-o*a,t[1]=o*s-r*u,t[2]=r*a-i*s,t}function f(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[3]*r+n[7]*i+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/s,t}function h(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function d(t,e,n){var r=n[0],i=n[1],o=n[2],s=n[3],a=e[0],u=e[1],c=e[2],l=i*c-o*u,f=o*a-r*c,h=r*u-i*a,d=i*h-o*f,p=o*l-r*h,g=r*f-i*l,m=2*s;return l*=m,f*=m,h*=m,d*=2,p*=2,g*=2,t[0]=a+l+d,t[1]=u+f+p,t[2]=c+h+g,t}function p(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function g(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function m(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function y(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],s=e[1],a=e[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),l=u&&c(t,e)/u;return Math.acos(Math.min(Math.max(l,-1),1))}var v=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},b=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t},x=function(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)};!function(){var t=i()}()},8333:function(t,e,n){"use strict";n.d(e,{d9:function(){return i},al:function(){return o},JG:function(){return s},t8:function(){return a},IH:function(){return u},bA:function(){return c},kE:function(){return l},we:function(){return f},Fv:function(){return h},AK:function(){return d},t7:function(){return p},fF:function(){return g},VC:function(){return m},I6:function(){return y},fS:function(){return v}});var r=n(9685);function i(t){var e=new r.WT(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(t,e,n,i){var o=new r.WT(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o}function s(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function l(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function f(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function h(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],s=n*n+r*r+i*i+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=o*s,t}function d(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function p(t,e,n,r){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=s+r*(n[2]-s),t[3]=a+r*(n[3]-a),t}function g(t,e,n){var r=e[0],i=e[1],o=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*s,t}function m(t,e,n){var r=e[0],i=e[1],o=e[2],s=n[0],a=n[1],u=n[2],c=n[3],l=c*r+a*o-u*i,f=c*i+u*r-s*o,h=c*o+s*i-a*r,d=-s*r-a*i-u*o;return t[0]=l*c+d*-s+f*-u-h*-a,t[1]=f*c+d*-a+h*-s-l*-u,t[2]=h*c+d*-u+l*-a-f*-s,t[3]=e[3],t}function y(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function v(t,e){var n=t[0],i=t[1],o=t[2],s=t[3],a=e[0],u=e[1],c=e[2],l=e[3];return Math.abs(n-a)<=r.Ib*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=r.Ib*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=r.Ib*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(s-l)<=r.Ib*Math.max(1,Math.abs(s),Math.abs(l))}!function(){var t=function(){var t=new r.WT(4);return r.WT!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}()}()},840:function(t,e,n){var r;!function(i,o,s,a){"use strict";var u,c=["","webkit","Moz","MS","ms","o"],l=o.createElement("div"),f=Math.round,h=Math.abs,d=Date.now;function p(t,e,n){return setTimeout(w(t,n),e)}function g(t,e,n){return!!Array.isArray(t)&&(m(t,n[e],n),!0)}function m(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function y(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=i.console&&(i.console.warn||i.console.log);return o&&o.call(i.console,r,n),t.apply(this,arguments)}}u="function"!==typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==a&&null!==r)for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}return e}:Object.assign;var v=y((function(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;)(!n||n&&t[r[i]]===a)&&(t[r[i]]=e[r[i]]),i++;return t}),"extend","Use `assign`."),b=y((function(t,e){return v(t,e,!0)}),"merge","Use `assign`.");function x(t,e,n){var r,i=e.prototype;(r=t.prototype=Object.create(i)).constructor=t,r._super=i,n&&u(r,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function _(t,e){return"function"==typeof t?t.apply(e&&e[0]||a,e):t}function E(t,e){return t===a?e:t}function A(t,e,n){m(M(e),(function(e){t.addEventListener(e,n,!1)}))}function O(t,e,n){m(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function S(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function C(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function P(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function k(t){return Array.prototype.slice.call(t,0)}function T(t,e,n){for(var r=[],i=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];P(i,s)<0&&r.push(t[o]),i[o]=s,o++}return n&&(r=e?r.sort((function(t,n){return t[e]>n[e]})):r.sort()),r}function D(t,e){for(var n,r,i=e[0].toUpperCase()+e.slice(1),o=0;o<c.length;){if((r=(n=c[o])?n+i:e)in t)return r;o++}return a}var F=1;function j(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||i}var L="ontouchstart"in i,R=D(i,"PointerEvent")!==a,I=L&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),N="touch",B="mouse",z=24,$=["x","y"],U=["clientX","clientY"];function V(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){_(t.options.enable,[t])&&n.handler(e)},this.init()}function Z(t,e,n){var r=n.pointers.length,i=n.changedPointers.length,o=1&e&&r-i===0,s=12&e&&r-i===0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,r=e.pointers,i=r.length;n.firstInput||(n.firstInput=W(e));i>1&&!n.firstMultiple?n.firstMultiple=W(e):1===i&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,u=s?s.center:o.center,c=e.center=q(r);e.timeStamp=d(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=Y(u,c),e.distance=X(u,c),function(t,e){var n=e.center,r=t.offsetDelta||{},i=t.prevDelta||{},o=t.prevInput||{};1!==e.eventType&&4!==o.eventType||(i=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y});e.deltaX=i.x+(n.x-r.x),e.deltaY=i.y+(n.y-r.y)}(n,e),e.offsetDirection=H(e.deltaX,e.deltaY);var l=G(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=l.x,e.overallVelocityY=l.y,e.overallVelocity=h(l.x)>h(l.y)?l.x:l.y,e.scale=s?(f=s.pointers,p=r,X(p[0],p[1],U)/X(f[0],f[1],U)):1,e.rotation=s?function(t,e){return Y(e[1],e[0],U)+Y(t[1],t[0],U)}(s.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,r,i,o,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(8!=e.eventType&&(u>25||s.velocity===a)){var c=e.deltaX-s.deltaX,l=e.deltaY-s.deltaY,f=G(u,c,l);r=f.x,i=f.y,n=h(f.x)>h(f.y)?f.x:f.y,o=H(c,l),t.lastInterval=e}else n=s.velocity,r=s.velocityX,i=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=r,e.velocityY=i,e.direction=o}(n,e);var f,p;var g=t.element;S(e.srcEvent.target,g)&&(g=e.srcEvent.target);e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function W(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:d(),pointers:e,center:q(e),deltaX:t.deltaX,deltaY:t.deltaY}}function q(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,r=0,i=0;i<e;)n+=t[i].clientX,r+=t[i].clientY,i++;return{x:f(n/e),y:f(r/e)}}function G(t,e,n){return{x:e/t||0,y:n/t||0}}function H(t,e){return t===e?1:h(t)>=h(e)?t<0?2:4:e<0?8:16}function X(t,e,n){n||(n=$);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return Math.sqrt(r*r+i*i)}function Y(t,e,n){n||(n=$);var r=e[n[0]]-t[n[0]],i=e[n[1]]-t[n[1]];return 180*Math.atan2(i,r)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(j(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(j(this.element),this.evWin,this.domHandler)}};var K={mousedown:1,mousemove:2,mouseup:4},J="mousedown",Q="mousemove mouseup";function tt(){this.evEl=J,this.evWin=Q,this.pressed=!1,V.apply(this,arguments)}x(tt,V,{handler:function(t){var e=K[t.type];1&e&&0===t.button&&(this.pressed=!0),2&e&&1!==t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:B,srcEvent:t}))}});var et={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},nt={2:N,3:"pen",4:B,5:"kinect"},rt="pointerdown",it="pointermove pointerup pointercancel";function ot(){this.evEl=rt,this.evWin=it,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(rt="MSPointerDown",it="MSPointerMove MSPointerUp MSPointerCancel"),x(ot,V,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),i=et[r],o=nt[t.pointerType]||t.pointerType,s=o==N,a=P(e,t.pointerId,"pointerId");1&i&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):12&i&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,i,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var st={touchstart:1,touchmove:2,touchend:4,touchcancel:8},at="touchstart",ut="touchstart touchmove touchend touchcancel";function ct(){this.evTarget=at,this.evWin=ut,this.started=!1,V.apply(this,arguments)}function lt(t,e){var n=k(t.touches),r=k(t.changedTouches);return 12&e&&(n=T(n.concat(r),"identifier",!0)),[n,r]}x(ct,V,{handler:function(t){var e=st[t.type];if(1===e&&(this.started=!0),this.started){var n=lt.call(this,t,e);12&e&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:t})}}});var ft={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ht="touchstart touchmove touchend touchcancel";function dt(){this.evTarget=ht,this.targetIds={},V.apply(this,arguments)}function pt(t,e){var n=k(t.touches),r=this.targetIds;if(3&e&&1===n.length)return r[n[0].identifier]=!0,[n,n];var i,o,s=k(t.changedTouches),a=[],u=this.target;if(o=n.filter((function(t){return S(t.target,u)})),1===e)for(i=0;i<o.length;)r[o[i].identifier]=!0,i++;for(i=0;i<s.length;)r[s[i].identifier]&&a.push(s[i]),12&e&&delete r[s[i].identifier],i++;return a.length?[T(o.concat(a),"identifier",!0),a]:void 0}x(dt,V,{handler:function(t){var e=ft[t.type],n=pt.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:N,srcEvent:t})}});function gt(){V.apply(this,arguments);var t=w(this.handler,this);this.touch=new dt(this.manager,t),this.mouse=new tt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function mt(t,e){1&t?(this.primaryTouch=e.changedPointers[0].identifier,yt.call(this,e)):12&t&&yt.call(this,e)}function yt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches;setTimeout((function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)}),2500)}}function vt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var i=this.lastTouches[r],o=Math.abs(e-i.x),s=Math.abs(n-i.y);if(o<=25&&s<=25)return!0}return!1}x(gt,V,{handler:function(t,e,n){var r=n.pointerType==N,i=n.pointerType==B;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)mt.call(this,e,n);else if(i&&vt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var bt=D(l.style,"touchAction"),xt=bt!==a,wt="compute",_t="auto",Et="manipulation",At="none",Ot="pan-x",St="pan-y",Ct=function(){if(!xt)return!1;var t={},e=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||i.CSS.supports("touch-action",n)})),t}();function Mt(t,e){this.manager=t,this.set(e)}Mt.prototype={set:function(t){t==wt&&(t=this.compute()),xt&&this.manager.element.style&&Ct[t]&&(this.manager.element.style[bt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return m(this.manager.recognizers,(function(e){_(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(C(t,At))return At;var e=C(t,Ot),n=C(t,St);if(e&&n)return At;if(e||n)return e?Ot:St;if(C(t,Et))return Et;return _t}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var r=this.actions,i=C(r,At)&&!Ct.none,o=C(r,St)&&!Ct["pan-y"],s=C(r,Ot)&&!Ct["pan-x"];if(i){var a=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(a&&u&&c)return}if(!s||!o)return i||o&&6&n||s&&n&z?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Pt=32;function kt(t){this.options=u({},this.defaults,t||{}),this.id=F++,this.manager=null,this.options.enable=E(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Tt(t){return 16&t?"cancel":8&t?"end":4&t?"move":2&t?"start":""}function Dt(t){return 16==t?"down":8==t?"up":2==t?"left":4==t?"right":""}function Ft(t,e){var n=e.manager;return n?n.get(t):t}function jt(){kt.apply(this,arguments)}function Lt(){jt.apply(this,arguments),this.pX=null,this.pY=null}function Rt(){jt.apply(this,arguments)}function It(){kt.apply(this,arguments),this._timer=null,this._input=null}function Nt(){jt.apply(this,arguments)}function Bt(){jt.apply(this,arguments)}function zt(){kt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function $t(t,e){return(e=e||{}).recognizers=E(e.recognizers,$t.defaults.preset),new Ut(t,e)}kt.prototype={defaults:{},set:function(t){return u(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(g(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=Ft(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return g(t,"dropRecognizeWith",this)||(t=Ft(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(g(t,"requireFailure",this))return this;var e=this.requireFail;return-1===P(e,t=Ft(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(g(t,"dropRequireFailure",this))return this;t=Ft(t,this);var e=P(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function r(n){e.manager.emit(n,t)}n<8&&r(e.options.event+Tt(n)),r(e.options.event),t.additionalEvent&&r(t.additionalEvent),n>=8&&r(e.options.event+Tt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Pt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(33&this.requireFail[t].state))return!1;t++}return!0},recognize:function(t){var e=u({},t);if(!_(this.options.enable,[this,e]))return this.reset(),void(this.state=Pt);56&this.state&&(this.state=1),this.state=this.process(e),30&this.state&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(jt,kt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=6&e,i=this.attrTest(t);return r&&(8&n||!i)?16|e:r||i?4&n?8|e:2&e?4|e:2:Pt}}),x(Lt,jt,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var t=this.options.direction,e=[];return 6&t&&e.push(St),t&z&&e.push(Ot),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,i=t.direction,o=t.deltaX,s=t.deltaY;return i&e.direction||(6&e.direction?(i=0===o?1:o<0?2:4,n=o!=this.pX,r=Math.abs(t.deltaX)):(i=0===s?1:s<0?8:16,n=s!=this.pY,r=Math.abs(t.deltaY))),t.direction=i,n&&r>e.threshold&&i&e.direction},attrTest:function(t){return jt.prototype.attrTest.call(this,t)&&(2&this.state||!(2&this.state)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Dt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x(Rt,jt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[At]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||2&this.state)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(It,kt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[_t]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime>e.time;if(this._input=t,!r||!n||12&t.eventType&&!i)this.reset();else if(1&t.eventType)this.reset(),this._timer=p((function(){this.state=8,this.tryEmit()}),e.time,this);else if(4&t.eventType)return 8;return Pt},reset:function(){clearTimeout(this._timer)},emit:function(t){8===this.state&&(t&&4&t.eventType?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=d(),this.manager.emit(this.options.event,this._input)))}}),x(Nt,jt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[At]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||2&this.state)}}),x(Bt,jt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Lt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return 30&n?e=t.overallVelocity:6&n?e=t.overallVelocityX:n&z&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&4&t.eventType},emit:function(t){var e=Dt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x(zt,kt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Et]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,i=t.deltaTime<e.time;if(this.reset(),1&t.eventType&&0===this.count)return this.failTimeout();if(r&&i&&n){if(4!=t.eventType)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||X(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0===this.count%e.taps)return this.hasRequireFailures()?(this._timer=p((function(){this.state=8,this.tryEmit()}),e.interval,this),2):8}return Pt},failTimeout:function(){return this._timer=p((function(){this.state=Pt}),this.options.interval,this),Pt},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),$t.VERSION="2.0.7",$t.defaults={domEvents:!1,touchAction:wt,enable:!0,inputTarget:null,inputClass:null,preset:[[Nt,{enable:!1}],[Rt,{enable:!1},["rotate"]],[Bt,{direction:6}],[Lt,{direction:6},["swipe"]],[zt],[zt,{event:"doubletap",taps:2},["tap"]],[It]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Ut(t,e){var n;this.options=u({},$t.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((n=this).options.inputClass||(R?ot:I?dt:L?gt:tt))(n,Z),this.touchAction=new Mt(this,this.options.touchAction),Vt(this,!0),m(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function Vt(t,e){var n,r=t.element;r.style&&(m(t.options.cssProps,(function(i,o){n=D(r.style,o),e?(t.oldCssProps[n]=r.style[n],r.style[n]=i):r.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}Ut.prototype={set:function(t){return u(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var r=this.recognizers,i=e.curRecognizer;(!i||i&&8&i.state)&&(i=e.curRecognizer=null);for(var o=0;o<r.length;)n=r[o],2===e.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(t),!i&&14&n.state&&(i=e.curRecognizer=n),o++}},get:function(t){if(t instanceof kt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(g(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(g(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=P(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return m(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return m(M(t),(function(t){e?n[t]&&n[t].splice(P(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},u($t,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Pt,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:z,DIRECTION_ALL:30,Manager:Ut,Input:V,TouchAction:Mt,TouchInput:dt,MouseInput:tt,PointerEventInput:ot,TouchMouseInput:gt,SingleTouchInput:ct,Recognizer:kt,AttrRecognizer:jt,Tap:zt,Pan:Lt,Swipe:Bt,Pinch:Rt,Rotate:Nt,Press:It,on:A,off:O,each:m,merge:b,extend:v,assign:u,inherit:x,bindFn:w,prefixed:D}),("undefined"!==typeof i?i:"undefined"!==typeof self?self:{}).Hammer=$t,(r=function(){return $t}.call(e,n,e,t))===a||(t.exports=r)}(window,document)},8679:function(t,e,n){"use strict";var r=n(9864),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function u(t){return r.isMemo(t)?s:a[t.$$typeof]||i}a[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[r.Memo]=s;var c=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,d=Object.getPrototypeOf,p=Object.prototype;t.exports=function t(e,n,r){if("string"!==typeof n){if(p){var i=d(n);i&&i!==p&&t(e,i,r)}var s=l(n);f&&(s=s.concat(f(n)));for(var a=u(e),g=u(n),m=0;m<s.length;++m){var y=s[m];if(!o[y]&&(!r||!r[y])&&(!g||!g[y])&&(!a||!a[y])){var v=h(n,y);try{c(e,y,v)}catch(b){}}}}return e}},645:function(t,e){e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=a;l>0;o=256*o+t[e+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(e*u-1)*Math.pow(2,i),s+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[n+d]=255&s,d+=p,s/=256,c-=8);t[n+d-p]|=128*g}},9593:function(t,e,n){"use strict";const r=n(320),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),u=Symbol("maxAge"),c=Symbol("dispose"),l=Symbol("noDisposeOnSet"),f=Symbol("lruList"),h=Symbol("cache"),d=Symbol("updateAgeOnGet"),p=()=>1;const g=(t,e,n)=>{const r=t[h].get(e);if(r){const e=r.value;if(m(t,e)){if(v(t,r),!t[a])return}else n&&(t[d]&&(r.value.now=Date.now()),t[f].unshiftNode(r));return e.value}},m=(t,e)=>{if(!e||!e.maxAge&&!t[u])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[u]&&n>t[u]},y=t=>{if(t[o]>t[i])for(let e=t[f].tail;t[o]>t[i]&&null!==e;){const n=e.prev;v(t,e),e=n}},v=(t,e)=>{if(e){const n=e.value;t[c]&&t[c](n.key,n.value),t[o]-=n.length,t[h].delete(n.key),t[f].removeNode(e)}};class b{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const x=(t,e,n,r)=>{let i=n.value;m(t,i)&&(v(t,n),t[a]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};t.exports=class{constructor(t){if("number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||p;if(this[s]="function"!==typeof e?p:e,this[a]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[u]=t.maxAge||0,this[c]=t.dispose,this[l]=t.noDisposeOnSet||!1,this[d]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!==typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,y(this)}get max(){return this[i]}set allowStale(t){this[a]=!!t}get allowStale(){return this[a]}set maxAge(t){if("number"!==typeof t)throw new TypeError("maxAge must be a non-negative number");this[u]=t,y(this)}get maxAge(){return this[u]}set lengthCalculator(t){"function"!==typeof t&&(t=p),t!==this[s]&&(this[s]=t,this[o]=0,this[f].forEach((t=>{t.length=this[s](t.value,t.key),this[o]+=t.length}))),y(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[f].length}rforEach(t,e){e=e||this;for(let n=this[f].tail;null!==n;){const r=n.prev;x(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[f].head;null!==n;){const r=n.next;x(this,t,n,e),n=r}}keys(){return this[f].toArray().map((t=>t.key))}values(){return this[f].toArray().map((t=>t.value))}reset(){this[c]&&this[f]&&this[f].length&&this[f].forEach((t=>this[c](t.key,t.value))),this[h]=new Map,this[f]=new r,this[o]=0}dump(){return this[f].map((t=>!m(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[f]}set(t,e,n){if((n=n||this[u])&&"number"!==typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,a=this[s](e,t);if(this[h].has(t)){if(a>this[i])return v(this,this[h].get(t)),!1;const s=this[h].get(t).value;return this[c]&&(this[l]||this[c](t,s.value)),s.now=r,s.maxAge=n,s.value=e,this[o]+=a-s.length,s.length=a,this.get(t),y(this),!0}const d=new b(t,e,a,r,n);return d.length>this[i]?(this[c]&&this[c](t,e),!1):(this[o]+=d.length,this[f].unshift(d),this[h].set(t,this[f].head),y(this),!0)}has(t){if(!this[h].has(t))return!1;const e=this[h].get(t).value;return!m(this,e)}get(t){return g(this,t,!0)}peek(t){return g(this,t,!1)}pop(){const t=this[f].tail;return t?(v(this,t),t.value):null}del(t){v(this,this[h].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[h].forEach(((t,e)=>g(this,e,!1)))}}},845:function(t,e){"use strict";var n=Number.isNaN||function(t){return"number"===typeof t&&t!==t};function r(t,e){if(t.length!==e.length)return!1;for(var r=0;r<t.length;r++)if(i=t[r],o=e[r],!(i===o||n(i)&&n(o)))return!1;var i,o;return!0}e.Z=function(t,e){var n;void 0===e&&(e=r);var i,o=[],s=!1;return function(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];return s&&n===this&&e(r,o)||(i=t.apply(this,r),s=!0,n=this,o=r),i}}},2317:function(t,e,n){"use strict";n.d(e,{Q:function(){return B}});var r=n(840),i=n.n(r);const o={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}(n,(e=>e.pointerId===t.pointerId))||n.push(t)),e.call(this,t)}}(i().PointerEventInput),i().MouseInput.prototype.handler=function(t){let e=o[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const s=i().Manager;var a=i();const u=a?[[a.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[a.Rotate,{enable:!1}],[a.Pinch,{enable:!1}],[a.Swipe,{enable:!1}],[a.Pan,{threshold:0,enable:!1}],[a.Press,{enable:!1}],[a.Tap,{event:"doubletap",taps:2,enable:!1}],[a.Tap,{event:"anytap",enable:!1}],[a.Tap,{enable:!1}]]:null,c={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},l={doubletap:["tap"]},f={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},h={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},d={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},p={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},g="undefined"!==typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",m="undefined"!==typeof window?window:n.g;"undefined"!==typeof n.g?n.g:window,"undefined"!==typeof document&&document;let y=!1;try{const t={get passive(){return y=!0,!0}};m.addEventListener("test",t,t),m.removeEventListener("test",t,t)}catch(z){}const v=-1!==g.indexOf("firefox"),{WHEEL_EVENTS:b}=h,x="wheel",w=4.000244140625;class _{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.events=b.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!y&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===x&&(this.options.enable=e)}handleEvent(t){if(!this.options.enable)return;let e=t.deltaY;m.WheelEvent&&(v&&t.deltaMode===m.WheelEvent.DOM_DELTA_PIXEL&&(e/=m.devicePixelRatio),t.deltaMode===m.WheelEvent.DOM_DELTA_LINE&&(e*=40));const n={x:t.clientX,y:t.clientY};0!==e&&e%w===0&&(e=Math.floor(e/w)),t.shiftKey&&e&&(e*=.25),this._onWheel(t,-e,n)}_onWheel(t,e,n){this.callback({type:x,center:n,delta:e,srcEvent:t,pointerType:"mouse",target:t.target})}}const{MOUSE_EVENTS:E}=h,A="pointermove",O="pointerover",S="pointerout",C="pointerleave";class M{constructor(t,e,n={}){this.element=t,this.callback=e,this.pressed=!1,this.options=Object.assign({enable:!0},n),this.enableMoveEvent=this.options.enable,this.enableLeaveEvent=this.options.enable,this.enableOutEvent=this.options.enable,this.enableOverEvent=this.options.enable,this.events=E.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===A&&(this.enableMoveEvent=e),t===O&&(this.enableOverEvent=e),t===S&&(this.enableOutEvent=e),t===C&&(this.enableLeaveEvent=e)}handleEvent(t){this.handleOverEvent(t),this.handleOutEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this.callback({type:O,srcEvent:t,pointerType:"mouse",target:t.target})}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this.callback({type:S,srcEvent:t,pointerType:"mouse",target:t.target})}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this.callback({type:C,srcEvent:t,pointerType:"mouse",target:t.target})}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this.callback({type:A,srcEvent:t,pointerType:"mouse",target:t.target});break;case"mouseup":this.pressed=!1}}}const{KEY_EVENTS:P}=h,k="keydown",T="keyup";class D{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=P.concat(n.events||[]),this.handleEvent=this.handleEvent.bind(this),t.tabIndex=n.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===k&&(this.enableDownEvent=e),t===T&&(this.enableUpEvent=e)}handleEvent(t){const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:k,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:T,srcEvent:t,key:t.key,target:t.target}))}}const F="contextmenu";class j{constructor(t,e,n={}){this.element=t,this.callback=e,this.options=Object.assign({enable:!0},n),this.handleEvent=this.handleEvent.bind(this),t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===F&&(this.options.enable=e)}handleEvent(t){this.options.enable&&this.callback({type:F,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const L={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4};const R={srcElement:"root",priority:0};class I{constructor(t){this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this.handleEvent=this.handleEvent.bind(this),this._active=!1}isEmpty(){return!this._active}add(t,e,n,r=!1,i=!1){const{handlers:o,handlersByElement:s}=this;n&&("object"!==typeof n||n.addEventListener)&&(n={srcElement:n}),n=n?Object.assign({},R,n):R;let a=s.get(n.srcElement);a||(a=[],s.set(n.srcElement,a));const u={type:t,handler:e,srcElement:n.srcElement,priority:n.priority};r&&(u.once=!0),i&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=a.length-1;for(;c>=0&&!(a[c].priority>=u.priority);)c--;a.splice(c+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:r}=this;for(let i=n.length-1;i>=0;i--){const o=n[i];if(o.type===t&&o.handler===e){n.splice(i,1);const t=r.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&r.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}handleEvent(t){if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const r=()=>{t.handled=!0},i=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:u,once:c}=n[s];if(u(Object.assign({},t,{type:a,stopPropagation:r,stopImmediatePropagation:i})),c&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.element;return Object.assign({},t,function(t){const e=L[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let o=!1,s=!1,a=!1;return 4===e||2===e&&!Number.isFinite(n)?(o=1===i,s=2===i,a=3===i):2===e?(o=Boolean(1&n),s=Boolean(4&n),a=Boolean(2&n)):1===e&&(o=0===r,s=1===r,a=2===r),{leftButton:o,middleButton:s,rightButton:a}}(t),function(t,e){const{srcEvent:n}=t;if(!t.center&&!Number.isFinite(n.clientX))return null;const r=t.center||{x:n.clientX,y:n.clientY},i=e.getBoundingClientRect(),o=i.width/e.offsetWidth||1,s=i.height/e.offsetHeight||1;return{center:r,offsetCenter:{x:(r.x-i.left-e.clientLeft)/o,y:(r.y-i.top-e.clientTop)/s}}}(t,e),{handled:!1,rootElement:e})}}const N={events:null,recognizers:null,recognizerOptions:{},Manager:s,touchAction:"none",tabIndex:0};class B{constructor(t=null,e={}){this.options=Object.assign({},N,e),this.events=new Map,this._onBasicInput=this._onBasicInput.bind(this),this._onOtherEvent=this._onOtherEvent.bind(this),this.setElement(t);const{events:n}=e;n&&this.on(n)}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||u}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(c).forEach((t=>{const e=this.manager.get(t);e&&c[t].forEach((t=>{e.recognizeWith(t)}))}));for(const r in e.recognizerOptions){const t=this.manager.get(r);if(t){const n=e.recognizerOptions[r];delete n.enable,t.set(n)}}this.wheelInput=new _(t,this._onOtherEvent,{enable:!1}),this.moveInput=new M(t,this._onOtherEvent,{enable:!1}),this.keyInput=new D(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new j(t,this._onOtherEvent,{enable:!1});for(const[r,i]of this.events)i.isEmpty()||(this._toggleRecognizer(i.recognizerName,!0),this.manager.on(r,i.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const r=n.get(t);if(r&&r.options.enable!==e){r.set({enable:e});const i=l[t];i&&!this.options.recognizers&&i.forEach((i=>{const o=n.get(i);e?(o.requireFailure(t),r.dropRequireFailure(i)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,r,i){if("string"!==typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,r,i);return}const{manager:o,events:s}=this,a=p[t]||t;let u=s.get(a);u||(u=new I(this),s.set(a,u),u.recognizerName=d[a]||a,o&&o.on(a,u.handleEvent)),u.add(t,e,n,r,i),u.isEmpty()||this._toggleRecognizer(u.recognizerName,!0)}_removeEventHandler(t,e){if("string"!==typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,r=p[t]||t,i=n.get(r);if(i&&(i.remove(t,e),i.isEmpty())){const{recognizerName:t}=i;let e=!1;for(const r of n.values())if(r.recognizerName===t&&!r.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}_onBasicInput(t){const{srcEvent:e}=t,n=f[e.type];n&&this.manager.emit(n,t)}_onOtherEvent(t){this.manager.emit(t.type,t)}}},5622:function(){},2443:function(){},8417:function(){},3614:function(t,e,n){"use strict";t.exports=i;var r=n(645);function i(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var o=4294967296,s=1/o,a="undefined"===typeof TextDecoder?null:new TextDecoder("utf8");function u(t){return t.type===i.Bytes?t.readVarint()+t.pos:t.pos+1}function c(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function l(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function f(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function h(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function d(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function p(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function g(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function m(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function y(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function v(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function b(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function x(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function w(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function _(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}i.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=7&r,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=x(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=_(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=x(this.buf,this.pos)+x(this.buf,this.pos+4)*o;return this.pos+=8,t},readSFixed64:function(){var t=x(this.buf,this.pos)+_(this.buf,this.pos+4)*o;return this.pos+=8,t},readFloat:function(){var t=r.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=r.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,r=this.buf;return e=127&(n=r[this.pos++]),n<128?e:(e|=(127&(n=r[this.pos++]))<<7,n<128?e:(e|=(127&(n=r[this.pos++]))<<14,n<128?e:(e|=(127&(n=r[this.pos++]))<<21,n<128?e:function(t,e,n){var r,i,o=n.buf;if(i=o[n.pos++],r=(112&i)>>4,i<128)return c(t,r,e);if(i=o[n.pos++],r|=(127&i)<<3,i<128)return c(t,r,e);if(i=o[n.pos++],r|=(127&i)<<10,i<128)return c(t,r,e);if(i=o[n.pos++],r|=(127&i)<<17,i<128)return c(t,r,e);if(i=o[n.pos++],r|=(127&i)<<24,i<128)return c(t,r,e);if(i=o[n.pos++],r|=(1&i)<<31,i<128)return c(t,r,e);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=r[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&a?function(t,e,n){return a.decode(t.subarray(e,n))}(this.buf,e,t):function(t,e,n){var r="",i=e;for(;i<n;){var o,s,a,u=t[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>n)break;1===l?u<128&&(c=u):2===l?128===(192&(o=t[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(o=t[i+1],s=t[i+2],128===(192&o)&&128===(192&s)&&((c=(15&u)<<12|(63&o)<<6|63&s)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(o=t[i+1],s=t[i+2],a=t[i+3],128===(192&o)&&128===(192&s)&&128===(192&a)&&((c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,r+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),r+=String.fromCharCode(c),i+=l}return r}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==i.Bytes)return t.push(this.readVarint(e));var n=u(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==i.Bytes)return t.push(this.readSVarint());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==i.Bytes)return t.push(this.readBoolean());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==i.Bytes)return t.push(this.readFloat());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==i.Bytes)return t.push(this.readDouble());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed32());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed32());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readFixed64());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==i.Bytes)return t.push(this.readSFixed64());var e=u(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===i.Varint)for(;this.buf[this.pos++]>127;);else if(e===i.Bytes)this.pos=this.readVarint()+this.pos;else if(e===i.Fixed32)this.pos+=4;else{if(e!==i.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),w(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),w(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),w(this.buf,-1&t,this.pos),w(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),w(this.buf,-1&t,this.pos),w(this.buf,Math.floor(t*s),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(t,e){var n,r;t>=0?(n=t%4294967296|0,r=t/4294967296|0):(r=~(-t/4294967296),4294967295^(n=~(-t%4294967296))?n=n+1|0:(n=0,r=r+1|0));if(t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),function(t,e,n){n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos++]=127&t|128,t>>>=7,n.buf[n.pos]=127&t}(n,0,e),function(t,e){var n=(7&t)<<4;if(e.buf[e.pos++]|=n|((t>>>=3)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;if(e.buf[e.pos++]=127&t|((t>>>=7)?128:0),!t)return;e.buf[e.pos++]=127&t}(r,e)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(t,e,n){for(var r,i,o=0;o<e.length;o++){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){r>56319||o+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):i=r;continue}if(r<56320){t[n++]=239,t[n++]=191,t[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(t[n++]=239,t[n++]=191,t[n++]=189,i=null);r<128?t[n++]=r:(r<2048?t[n++]=r>>6|192:(r<65536?t[n++]=r>>12|224:(t[n++]=r>>18|240,t[n++]=r>>12&63|128),t[n++]=r>>6&63|128),t[n++]=63&r|128)}return n}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&l(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),r.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),r.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&l(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,i.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,f,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,h,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,g,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,d,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,p,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,m,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,y,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,v,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,b,e)},writeBytesField:function(t,e){this.writeTag(t,i.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,i.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,i.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,i.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,i.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,i.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,i.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}}},8297:function(t,e,n){"use strict";var r=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.isMobile=function(){return"undefined"!==typeof i.window.orientation},e.default=function(t){if(!t&&!(0,o.default)())return"Node";if((0,s.default)(t))return"Electron";var e="undefined"!==typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";var r=-1!==n.indexOf("MSIE "),a=-1!==n.indexOf("Trident/");if(r||a)return"IE";if(i.window.chrome)return"Chrome";if(i.window.safari)return"Safari";if(i.window.mozInnerScreenX)return"Firefox";return"Unknown"};var i=n(2361),o=r(n(2999)),s=r(n(3941))},2361:function(t,e,n){"use strict";var r=n(4155),i=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.console=e.process=e.document=e.global=e.window=e.self=void 0;var o=i(n(8)),s={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document,process:"object"===("undefined"===typeof r?"undefined":(0,o.default)(r))&&r},a=s.self||s.window||s.global;e.self=a;var u=s.window||s.self||s.global;e.window=u;var c=s.global||s.self||s.window;e.global=c;var l=s.document||{};e.document=l;var f=s.process||{};e.process=f;var h=console;e.console=h},9718:function(t,e,n){"use strict";var r=n(5318),i=n(8);Object.defineProperty(e,"CO",{enumerable:!0,get:function(){return o.global}}),Object.defineProperty(e,"jU",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"qs",{enumerable:!0,get:function(){return a.default}});var o=n(2361),s=l(n(2999)),a=l(n(8297)),u=r(n(3941));function c(t){if("function"!==typeof WeakMap)return null;var e=new WeakMap,n=new WeakMap;return(c=function(t){return t?n:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!==i(t)&&"function"!==typeof t)return{default:t};var n=c(e);if(n&&n.has(t))return n.get(t);var r={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&Object.prototype.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(r,s,a):r[s]=t[s]}return r.default=t,n&&n.set(t,r),r}},2999:function(t,e,n){"use strict";var r=n(4155),i=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a,e.isBrowserMainThread=function(){return a()&&"undefined"!==typeof document};var o=i(n(8)),s=i(n(3941));function a(){return!("object"===("undefined"===typeof r?"undefined":(0,o.default)(r))&&"[object process]"===String(r)&&!1)||(0,s.default)()}},3941:function(t,e,n){"use strict";var r=n(4155),i=n(5318);Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!==typeof window&&"object"===(0,o.default)(window.process)&&"renderer"===window.process.type)return!0;if("undefined"!==typeof r&&"object"===(0,o.default)(r.versions)&&Boolean(r.versions.electron))return!0;var e="object"===("undefined"===typeof navigator?"undefined":(0,o.default)(navigator))&&"string"===typeof navigator.userAgent&&navigator.userAgent,n=t||e;if(n&&n.indexOf("Electron")>=0)return!0;return!1};var o=i(n(8))},6073:function(t,e,n){"use strict";n.d(e,{u9:function(){return o},N4:function(){return s}});var r=n(4155);const i={self:"undefined"!==typeof self&&self,window:"undefined"!==typeof window&&window,global:"undefined"!==typeof n.g&&n.g,document:"undefined"!==typeof document&&document,process:"object"===typeof r&&r},o=i.window||i.self||i.global,s=i.process||{};console},5989:function(t,e,n){"use strict";n.d(e,{Z:function(){return o}});var r=n(1202),i=n(4155);function o(){return!("object"===typeof i&&"[object process]"===String(i)&&!1)||(0,r.Z)()}},1202:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(4155);function i(t){if("undefined"!==typeof window&&"object"===typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!==typeof r&&"object"===typeof r.versions&&Boolean(r.versions.electron))return!0;const e="object"===typeof navigator&&"string"===typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}},4708:function(t,e,n){"use strict";n.d(e,{Z:function(){return b}});var r=n(5989);const i="undefined"!==typeof __VERSION__?__VERSION__:"untranspiled source",o=(0,r.Z)();class s{constructor(t,e,n="sessionStorage"){this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(e){return null}}(n),this.id=t,this.config={},Object.assign(this.config,e),this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){return this.config={},this.updateConfiguration(t)}updateConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}return this}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function a(t,e,n,r=600){const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}const u={BLACK:30,RED:31,GREEN:32,YELLOW:33,BLUE:34,MAGENTA:35,CYAN:36,WHITE:37,BRIGHT_BLACK:90,BRIGHT_RED:91,BRIGHT_GREEN:92,BRIGHT_YELLOW:93,BRIGHT_BLUE:94,BRIGHT_MAGENTA:95,BRIGHT_CYAN:96,BRIGHT_WHITE:97};function c(t){return"string"===typeof t?u[t.toUpperCase()]||u.WHITE:t}function l(t,e){if(!t)throw new Error(e||"Assertion failed")}var f=n(6073);function h(){let t;if(o&&f.u9.performance)t=f.u9.performance.now();else if(f.N4.hrtime){const e=f.N4.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}const d={debug:o&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},p={enabled:!0,level:0};function g(){}const m={},y={once:!0};function v(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}class b{constructor({id:t}={id:""}){this.id=t,this.VERSION=i,this._startTs=h(),this._deltaTs=h(),this.LOG_THROTTLE_TIMEOUT=0,this._storage=new s("__probe-".concat(this.id,"__"),p),this.userData={},this.timeStamp("".concat(this.id," started")),function(t,e=["constructor"]){const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)"function"===typeof t[i]&&(e.find((t=>i===t))||(t[i]=t[i].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((h()-this._startTs).toPrecision(10))}getDelta(){return Number((h()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.updateConfiguration({enabled:t}),this}setLevel(t){return this._storage.updateConfiguration({level:t}),this}assert(t,e){l(t,e)}warn(t){return this._getLogFunction(0,t,d.warn,arguments,y)}error(t){return this._getLogFunction(0,t,d.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,d.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,d.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){return this._getLogFunction(t,e,d.debug||d.info,arguments,y)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||g,n&&[n],{tag:v(e)}):g}image({logLevel:t,priority:e,image:r,message:i="",scale:s=1}){return this._shouldLog(t||e)?o?function({image:t,message:e="",scale:n=1}){if("string"===typeof t){const r=new Image;return r.onload=()=>{const t=a(r,e,n);console.log(...t)},r.src=t,g}const r=t.nodeName||"";if("img"===r.toLowerCase())return console.log(...a(t,e,n)),g;if("canvas"===r.toLowerCase()){const r=new Image;return r.onload=()=>console.log(...a(r,e,n)),r.src=t.toDataURL(),g}return g}({image:r,message:i,scale:s}):function({image:t,message:e="",scale:r=1}){let i=null;try{i=n(5307)}catch(o){}if(i)return()=>i(t,{fit:"box",width:"".concat(Math.round(80*r),"%")}).then((t=>console.log(t)));return g}({image:r,message:i,scale:s}):g}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}get(t){return this._storage.config[t]}set(t,e){this._storage.updateConfiguration({[t]:e})}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||g)}group(t,e,n={collapsed:!1}){n=w({logLevel:t,message:e,opts:n});const{collapsed:r}=n;return n.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(n)}groupCollapsed(t,e,n={}){return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||g)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=x(t)}_getLogFunction(t,e,n,r=[],i){if(this._shouldLog(t)){i=w({logLevel:t,message:e,args:r,opts:i}),l(n=n||i.method),i.total=this.getTotal(),i.delta=this.getDelta(),this._deltaTs=h();const s=i.tag||i.message;if(i.once){if(m[s])return g;m[s]=h()}return e=function(t,e,n){if("string"===typeof e){const a=n.time?function(t,e=8){const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";e=n.time?"".concat(t,": ").concat(a,"  ").concat(e):"".concat(t,": ").concat(e),r=e,i=n.color,s=n.background,o||"string"!==typeof r||(i&&(i=c(i),r="\x1b[".concat(i,"m").concat(r,"\x1b[39m")),s&&(i=c(s),r="\x1b[".concat(s+10,"m").concat(r,"\x1b[49m"))),e=r}var r,i,s;return e}(this.id,i.message,i),n.bind(console,e,...i.args)}return g}}function x(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return l(Number.isFinite(e)&&e>=0),e}function w(t){const{logLevel:e,message:n}=t;t.logLevel=x(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(t.args=r,typeof e){case"string":case"function":void 0!==n&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"===typeof t.message&&(t.message=t.message());const i=typeof t.message;return l("string"===i||"object"===i),Object.assign(t,t.opts)}b.VERSION=i},4155:function(t){var e,n,r=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"===typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"===typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var a,u=[],c=!1,l=-1;function f(){c&&a&&(c=!1,a.length?u=a.concat(u):l=-1,u.length&&h())}function h(){if(!c){var t=s(f);c=!0;for(var e=u.length;e;){for(a=u,u=[];++l<e;)a&&a[l].run();l=-1,e=u.length}a=null,c=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new d(t,e)),1!==u.length||c||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},5729:function(t,e){"use strict";e.Z=function(t){var e=[],n=null,r=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];e=i,n||(n=requestAnimationFrame((function(){n=null,t.apply(void 0,e)})))};return r.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},r}},9921:function(t,e){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,o=n?Symbol.for("react.fragment"):60107,s=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case r:switch(t=t.type){case l:case f:case o:case a:case s:case d:return t;default:switch(t=t&&t.$$typeof){case c:case h:case m:case g:case u:return t;default:return e}}case i:return e}}}function _(t){return w(t)===f}e.AsyncMode=l,e.ConcurrentMode=f,e.ContextConsumer=c,e.ContextProvider=u,e.Element=r,e.ForwardRef=h,e.Fragment=o,e.Lazy=m,e.Memo=g,e.Portal=i,e.Profiler=a,e.StrictMode=s,e.Suspense=d,e.isAsyncMode=function(t){return _(t)||w(t)===l},e.isConcurrentMode=_,e.isContextConsumer=function(t){return w(t)===c},e.isContextProvider=function(t){return w(t)===u},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===r},e.isForwardRef=function(t){return w(t)===h},e.isFragment=function(t){return w(t)===o},e.isLazy=function(t){return w(t)===m},e.isMemo=function(t){return w(t)===g},e.isPortal=function(t){return w(t)===i},e.isProfiler=function(t){return w(t)===a},e.isStrictMode=function(t){return w(t)===s},e.isSuspense=function(t){return w(t)===d},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===o||t===f||t===a||t===s||t===d||t===p||"object"===typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===g||t.$$typeof===u||t.$$typeof===c||t.$$typeof===h||t.$$typeof===v||t.$$typeof===b||t.$$typeof===x||t.$$typeof===y)},e.typeOf=w},9864:function(t,e,n){"use strict";t.exports=n(9921)},5281:function(t,e,n){"use strict";n.d(e,{ZP:function(){return ke}});var r=n(7462);function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){if(t){if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}function s(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||o(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a=n(4942),u=n(7294),c=n(5697);function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(t,e)||o(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var f=n(7013),h=function(){if("undefined"!==typeof Map)return Map;function t(t,e){var n=-1;return t.some((function(t,r){return t[0]===e&&(n=r,!0)})),n}return function(){function e(){this.__entries__=[]}return Object.defineProperty(e.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var n=t(this.__entries__,e),r=this.__entries__[n];return r&&r[1]},e.prototype.set=function(e,n){var r=t(this.__entries__,e);~r?this.__entries__[r][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,r=t(n,e);~r&&n.splice(r,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];t.call(e,i[1],i[0])}},e}()}(),d="undefined"!==typeof window&&"undefined"!==typeof document&&window.document===document,p="undefined"!==typeof n.g&&n.g.Math===Math?n.g:"undefined"!==typeof self&&self.Math===Math?self:"undefined"!==typeof window&&window.Math===Math?window:Function("return this")(),g="function"===typeof requestAnimationFrame?requestAnimationFrame.bind(p):function(t){return setTimeout((function(){return t(Date.now())}),1e3/60)};var m=["top","right","bottom","left","width","height","size","weight"],y="undefined"!==typeof MutationObserver,v=function(){function t(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,r=!1,i=0;function o(){n&&(n=!1,t()),r&&a()}function s(){g(o)}function a(){var t=Date.now();if(n){if(t-i<2)return;r=!0}else n=!0,r=!1,setTimeout(s,e);i=t}return a}(this.refresh.bind(this),20)}return t.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},t.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},t.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},t.prototype.updateObservers_=function(){var t=this.observers_.filter((function(t){return t.gatherActive(),t.hasActive()}));return t.forEach((function(t){return t.broadcastActive()})),t.length>0},t.prototype.connect_=function(){d&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),y?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},t.prototype.disconnect_=function(){d&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},t.prototype.onTransitionEnd_=function(t){var e=t.propertyName,n=void 0===e?"":e;m.some((function(t){return!!~n.indexOf(t)}))&&this.refresh()},t.getInstance=function(){return this.instance_||(this.instance_=new t),this.instance_},t.instance_=null,t}(),b=function(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];Object.defineProperty(t,i,{value:e[i],enumerable:!1,writable:!1,configurable:!0})}return t},x=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||p},w=C(0,0,0,0);function _(t){return parseFloat(t)||0}function E(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return e.reduce((function(e,n){return e+_(t["border-"+n+"-width"])}),0)}function A(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return w;var r=x(t).getComputedStyle(t),i=function(t){for(var e={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=t["padding-"+i];e[i]=_(o)}return e}(r),o=i.left+i.right,s=i.top+i.bottom,a=_(r.width),u=_(r.height);if("border-box"===r.boxSizing&&(Math.round(a+o)!==e&&(a-=E(r,"left","right")+o),Math.round(u+s)!==n&&(u-=E(r,"top","bottom")+s)),!function(t){return t===x(t).document.documentElement}(t)){var c=Math.round(a+o)-e,l=Math.round(u+s)-n;1!==Math.abs(c)&&(a-=c),1!==Math.abs(l)&&(u-=l)}return C(i.left,i.top,a,u)}var O="undefined"!==typeof SVGGraphicsElement?function(t){return t instanceof x(t).SVGGraphicsElement}:function(t){return t instanceof x(t).SVGElement&&"function"===typeof t.getBBox};function S(t){return d?O(t)?function(t){var e=t.getBBox();return C(0,0,e.width,e.height)}(t):A(t):w}function C(t,e,n,r){return{x:t,y:e,width:n,height:r}}var M=function(){function t(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=C(0,0,0,0),this.target=t}return t.prototype.isActive=function(){var t=S(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},t.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},t}(),P=function(t,e){var n=function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o="undefined"!==typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return b(s,{x:e,y:n,width:r,height:i,top:n,right:e+r,bottom:i+n,left:e}),s}(e);b(this,{target:t,contentRect:n})},k=function(){function t(t,e,n){if(this.activeObservations_=[],this.observations_=new h,"function"!==typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=n}return t.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof x(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new M(t)),this.controller_.addObserver(this),this.controller_.refresh())}},t.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!==typeof Element&&Element instanceof Object){if(!(t instanceof x(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},t.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},t.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach((function(e){e.isActive()&&t.activeObservations_.push(e)}))},t.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map((function(t){return new P(t.target,t.broadcastRect())}));this.callback_.call(t,e,t),this.clearActive()}},t.prototype.clearActive=function(){this.activeObservations_.splice(0)},t.prototype.hasActive=function(){return this.activeObservations_.length>0},t}(),T="undefined"!==typeof WeakMap?new WeakMap:new h,D=function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=v.getInstance(),r=new k(e,n,this);T.set(this,r)};["observe","unobserve","disconnect"].forEach((function(t){D.prototype[t]=function(){var e;return(e=T.get(this))[t].apply(e,arguments)}}));var F="undefined"!==typeof p.ResizeObserver?p.ResizeObserver:D;function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function L(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function R(t,e,n){return e&&L(t.prototype,e),n&&L(t,n),t}"undefined"!==typeof window?window:n.g,"undefined"!==typeof n.g?n.g:window;var I="undefined"!==typeof document?document:{};function N(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function B(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?N(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function z(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return $(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function $(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var U=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function V(t){if(!t)return null;if("string"===typeof t)return t;t.toJS&&(t=t.toJS());var e,n={},r=z(t.layers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n[i.id]=i}}catch(s){r.e(s)}finally{r.f()}var o=t.layers.map((function(t){var e=n[t.ref],r=null;if("interactive"in t&&delete(r=B({},t)).interactive,e){delete(r=r||B({},t)).ref;var i,o=z(U);try{for(o.s();!(i=o.n()).done;){var a=i.value;a in e&&(r[a]=e[a])}}catch(s){o.e(s)}finally{o.f()}}return r||t}));return B(B({},t),{},{layers:o})}var Z=n(4155);var W={container:c.object,gl:c.object,mapboxApiAccessToken:c.string,mapboxApiUrl:c.string,attributionControl:c.bool,preserveDrawingBuffer:c.bool,reuseMaps:c.bool,transformRequest:c.func,mapOptions:c.object,mapStyle:c.oneOfType([c.string,c.object]),preventStyleDiffing:c.bool,visible:c.bool,asyncRender:c.bool,onLoad:c.func,onError:c.func,width:c.number,height:c.number,viewState:c.object,longitude:c.number,latitude:c.number,zoom:c.number,bearing:c.number,pitch:c.number,altitude:c.number},q={container:I.body,mapboxApiAccessToken:function(){var t=null;if("undefined"!==typeof window&&window.location){var e=window.location.search.match(/access_token=([^&\/]*)/);t=e&&e[1]}t||"undefined"===typeof Z||(t=t||Z.env.MapboxAccessToken||Z.env.REACT_APP_MAPBOX_ACCESS_TOKEN);return t||"no-token"}(),mapboxApiUrl:"https://api.mapbox.com",preserveDrawingBuffer:!1,attributionControl:!0,reuseMaps:!1,mapOptions:{},mapStyle:"mapbox://styles/mapbox/light-v8",preventStyleDiffing:!1,visible:!0,asyncRender:!1,onLoad:function(){},onError:function(t){t&&console.error(t.error)},width:0,height:0,longitude:0,latitude:0,zoom:0,bearing:0,pitch:0,altitude:1.5};function G(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"component";t.debug&&c.checkPropTypes(W,t,"prop",e)}var H=function(){function t(e){var n=this;if(j(this,t),(0,a.Z)(this,"props",q),(0,a.Z)(this,"width",0),(0,a.Z)(this,"height",0),(0,a.Z)(this,"_fireLoadEvent",(function(){n.props.onLoad({type:"load",target:n._map})})),(0,a.Z)(this,"_handleError",(function(t){n.props.onError(t)})),!e.mapboxgl)throw new Error("Mapbox not available");this.mapboxgl=e.mapboxgl,t.initialized||(t.initialized=!0,this._checkStyleSheet(this.mapboxgl.version)),this._initialize(e)}return R(t,[{key:"finalize",value:function(){return this._destroy(),this}},{key:"setProps",value:function(t){return this._update(this.props,t),this}},{key:"redraw",value:function(){var t=this._map;t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}},{key:"getMap",value:function(){return this._map}},{key:"_reuse",value:function(e){this._map=t.savedMap;var n=this._map.getContainer(),r=e.container;for(r.classList.add("mapboxgl-map");n.childNodes.length>0;)r.appendChild(n.childNodes[0]);this._map._container=r,t.savedMap=null,e.mapStyle&&this._map.setStyle(V(e.mapStyle),{diff:!1}),this._map.isStyleLoaded()?this._fireLoadEvent():this._map.once("styledata",this._fireLoadEvent)}},{key:"_create",value:function(e){if(e.reuseMaps&&t.savedMap)this._reuse(e);else{if(e.gl){var n=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=n,e.gl}}var r={container:e.container,center:[0,0],zoom:8,pitch:0,bearing:0,maxZoom:24,style:V(e.mapStyle),interactive:!1,trackResize:!1,attributionControl:e.attributionControl,preserveDrawingBuffer:e.preserveDrawingBuffer};e.transformRequest&&(r.transformRequest=e.transformRequest),this._map=new this.mapboxgl.Map(Object.assign({},r,e.mapOptions)),this._map.once("load",this._fireLoadEvent),this._map.on("error",this._handleError)}return this}},{key:"_destroy",value:function(){this._map&&(this.props.reuseMaps&&!t.savedMap?(t.savedMap=this._map,this._map.off("load",this._fireLoadEvent),this._map.off("error",this._handleError),this._map.off("styledata",this._fireLoadEvent)):this._map.remove(),this._map=null)}},{key:"_initialize",value:function(t){var e=this;G(t=Object.assign({},q,t),"Mapbox"),this.mapboxgl.accessToken=t.mapboxApiAccessToken||q.mapboxApiAccessToken,this.mapboxgl.baseApiUrl=t.mapboxApiUrl,this._create(t);var n=t.container;Object.defineProperty(n,"offsetWidth",{get:function(){return e.width}}),Object.defineProperty(n,"clientWidth",{get:function(){return e.width}}),Object.defineProperty(n,"offsetHeight",{get:function(){return e.height}}),Object.defineProperty(n,"clientHeight",{get:function(){return e.height}});var r=this._map.getCanvas();r&&(r.style.outline="none"),this._updateMapViewport({},t),this._updateMapSize({},t),this.props=t}},{key:"_update",value:function(t,e){if(this._map){G(e=Object.assign({},this.props,e),"Mapbox");var n=this._updateMapViewport(t,e),r=this._updateMapSize(t,e);this._updateMapStyle(t,e),e.asyncRender||!n&&!r||this.redraw(),this.props=e}}},{key:"_updateMapStyle",value:function(t,e){t.mapStyle!==e.mapStyle&&this._map.setStyle(V(e.mapStyle),{diff:!e.preventStyleDiffing})}},{key:"_updateMapSize",value:function(t,e){var n=t.width!==e.width||t.height!==e.height;return n&&(this.width=e.width,this.height=e.height,this._map.resize()),n}},{key:"_updateMapViewport",value:function(t,e){var n=this._getViewState(t),r=this._getViewState(e),i=r.latitude!==n.latitude||r.longitude!==n.longitude||r.zoom!==n.zoom||r.pitch!==n.pitch||r.bearing!==n.bearing||r.altitude!==n.altitude;return i&&(this._map.jumpTo(this._viewStateToMapboxProps(r)),r.altitude!==n.altitude&&(this._map.transform.altitude=r.altitude)),i}},{key:"_getViewState",value:function(t){var e=t.viewState||t,n=e.longitude,r=e.latitude,i=e.zoom,o=e.pitch,s=void 0===o?0:o,a=e.bearing,u=void 0===a?0:a,c=e.altitude;return{longitude:n,latitude:r,zoom:i,pitch:s,bearing:u,altitude:void 0===c?1.5:c}}},{key:"_checkStyleSheet",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0.47.0";if("undefined"!==typeof I)try{var e=I.createElement("div");e.className="mapboxgl-map",e.style.display="none",I.body.appendChild(e);var n="static"!==window.getComputedStyle(e).position;if(!n){var r=I.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("type","text/css"),r.setAttribute("href","https://api.tiles.mapbox.com/mapbox-gl-js/v".concat(t,"/mapbox-gl.css")),I.head.appendChild(r)}}catch(i){}}},{key:"_viewStateToMapboxProps",value:function(t){return{center:[t.longitude,t.latitude],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}}}]),t}();(0,a.Z)(H,"initialized",!1),(0,a.Z)(H,"propTypes",W),(0,a.Z)(H,"defaultProps",q),(0,a.Z)(H,"savedMap",null);var X=n(4742),Y=n.n(X);function K(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function J(t,e){if(t===e)return!0;if(K(t)&&K(e)){if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!J(t[n],e[n]))return!1;return!0}return Math.abs(t-e)<=1e-7}function Q(t,e,n){return Math.max(e,Math.min(n,t))}function tt(t,e,n){return K(t)?t.map((function(t,r){return tt(t,e[r],n)})):n*e+(1-n)*t}function et(t,e){if(!t)throw new Error(e||"react-map-gl: assertion failed.")}function nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function rt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var it={minZoom:0,maxZoom:24,minPitch:0,maxPitch:85},ot=0,st=0,at=1.5,ut=function(){function t(e){var n=e.width,r=e.height,i=e.latitude,o=e.longitude,s=e.zoom,a=e.bearing,u=void 0===a?st:a,c=e.pitch,l=void 0===c?ot:c,f=e.altitude,h=void 0===f?at:f,d=e.maxZoom,p=void 0===d?it.maxZoom:d,g=e.minZoom,m=void 0===g?it.minZoom:g,y=e.maxPitch,v=void 0===y?it.maxPitch:y,b=e.minPitch,x=void 0===b?it.minPitch:b,w=e.transitionDuration,_=e.transitionEasing,E=e.transitionInterpolator,A=e.transitionInterruption,O=e.startPanLngLat,S=e.startZoomLngLat,C=e.startRotatePos,M=e.startBearing,P=e.startPitch,k=e.startZoom;j(this,t),et(Number.isFinite(n),"`width` must be supplied"),et(Number.isFinite(r),"`height` must be supplied"),et(Number.isFinite(o),"`longitude` must be supplied"),et(Number.isFinite(i),"`latitude` must be supplied"),et(Number.isFinite(s),"`zoom` must be supplied"),this._viewportProps=this._applyConstraints({width:n,height:r,latitude:i,longitude:o,zoom:s,bearing:u,pitch:l,altitude:h,maxZoom:p,minZoom:m,maxPitch:v,minPitch:x,transitionDuration:w,transitionEasing:_,transitionInterpolator:E,transitionInterruption:A}),this._state={startPanLngLat:O,startZoomLngLat:S,startRotatePos:C,startBearing:M,startPitch:P,startZoom:k}}return R(t,[{key:"getViewportProps",value:function(){return this._viewportProps}},{key:"getState",value:function(){return this._state}},{key:"panStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startPanLngLat:this._unproject(e)})}},{key:"pan",value:function(t){var e=t.pos,n=t.startPos,r=this._state.startPanLngLat||this._unproject(n);if(!r)return this;var i=l(this._calculateNewLngLat({startPanLngLat:r,pos:e}),2),o=i[0],s=i[1];return this._getUpdatedMapState({longitude:o,latitude:s})}},{key:"panEnd",value:function(){return this._getUpdatedMapState({startPanLngLat:null})}},{key:"rotateStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startRotatePos:e,startBearing:this._viewportProps.bearing,startPitch:this._viewportProps.pitch})}},{key:"rotate",value:function(t){var e,n=t.pos,r=t.deltaAngleX,i=void 0===r?0:r,o=t.deltaAngleY,s=void 0===o?0:o,a=this._state,u=a.startRotatePos,c=a.startBearing,l=a.startPitch;return Number.isFinite(c)&&Number.isFinite(l)?(e=n?this._calculateNewPitchAndBearing(rt(rt({},this._getRotationParams(n,u)),{},{startBearing:c,startPitch:l})):{bearing:c+i,pitch:l+s},this._getUpdatedMapState(e)):this}},{key:"rotateEnd",value:function(){return this._getUpdatedMapState({startBearing:null,startPitch:null})}},{key:"zoomStart",value:function(t){var e=t.pos;return this._getUpdatedMapState({startZoomLngLat:this._unproject(e),startZoom:this._viewportProps.zoom})}},{key:"zoom",value:function(t){var e=t.pos,n=t.startPos,r=t.scale;et(r>0,"`scale` must be a positive number");var i=this._state,o=i.startZoom,s=i.startZoomLngLat;Number.isFinite(o)||(o=this._viewportProps.zoom,s=this._unproject(n)||this._unproject(e)),et(s,"`startZoomLngLat` prop is required for zoom behavior to calculate where to position the map.");var a=this._calculateNewZoom({scale:r,startZoom:o||0}),u=l(new f.DW(Object.assign({},this._viewportProps,{zoom:a})).getMapCenterByLngLatPosition({lngLat:s,pos:e}),2),c=u[0],h=u[1];return this._getUpdatedMapState({zoom:a,longitude:c,latitude:h})}},{key:"zoomEnd",value:function(){return this._getUpdatedMapState({startZoomLngLat:null,startZoom:null})}},{key:"_getUpdatedMapState",value:function(e){return new t(Object.assign({},this._viewportProps,this._state,e))}},{key:"_applyConstraints",value:function(t){var e=t.maxZoom,n=t.minZoom,r=t.zoom;t.zoom=Q(r,n,e);var i=t.maxPitch,o=t.minPitch,s=t.pitch;return t.pitch=Q(s,o,i),Object.assign(t,(0,f.QA)(t)),t}},{key:"_unproject",value:function(t){var e=new f.DW(this._viewportProps);return t&&e.unproject(t)}},{key:"_calculateNewLngLat",value:function(t){var e=t.startPanLngLat,n=t.pos;return new f.DW(this._viewportProps).getMapCenterByLngLatPosition({lngLat:e,pos:n})}},{key:"_calculateNewZoom",value:function(t){var e=t.scale,n=t.startZoom,r=this._viewportProps,i=r.maxZoom,o=r.minZoom;return Q(n+Math.log2(e),o,i)}},{key:"_calculateNewPitchAndBearing",value:function(t){var e=t.deltaScaleX,n=t.deltaScaleY,r=t.startBearing,i=t.startPitch;n=Q(n,-1,1);var o=this._viewportProps,s=o.minPitch,a=o.maxPitch,u=i;return n>0?u=i+n*(a-i):n<0&&(u=i-n*(s-i)),{pitch:u,bearing:r+180*e}}},{key:"_getRotationParams",value:function(t,e){var n=t[0]-e[0],r=t[1]-e[1],i=t[1],o=e[1],s=this._viewportProps,a=s.width,u=s.height,c=n/a,l=0;return r>0?Math.abs(u-o)>5&&(l=r/(o-u)*1.2):r<0&&o>5&&(l=1-i/o),{deltaScaleX:c,deltaScaleY:l=Math.min(1,Math.max(-1,l))}}}]),t}();function ct(t){return t[0].toLowerCase()+t.slice(1)}function lt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ft(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?lt(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ht=(0,u.createContext)({viewport:null,map:null,container:null,onViewportChange:null,onViewStateChange:null,eventManager:null}),dt=ht.Provider;ht.Provider=function(t){var e=t.value,n=t.children,r=l((0,u.useState)(null),2),i=r[0],o=r[1],s=(0,u.useContext)(ht);return e=ft(ft({setMap:o},s),{},{map:s&&s.map||i},e),u.createElement(dt,{value:e},n)};var pt=ht,gt="undefined"!==typeof window?u.useLayoutEffect:u.useEffect;function mt(t,e){var n=e.longitude,r=e.latitude;return t&&t.queryTerrainElevation&&t.queryTerrainElevation([n,r])||0}function yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function vt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var bt="A valid API access token is required to use Mapbox data";function xt(t){var e=t.map,n=t.props,r=t.width,i=t.height,o=vt(vt(vt({},n),n.viewState),{},{width:r,height:i});return o.position=[0,0,mt(e,o)],new f.DW(o)}var wt={position:"absolute",width:"100%",height:"100%",overflow:"hidden"},_t=Object.assign({},H.propTypes,{width:c.oneOfType([c.number,c.string]),height:c.oneOfType([c.number,c.string]),onResize:c.func,disableTokenWarning:c.bool,visible:c.bool,className:c.string,style:c.object,visibilityConstraints:c.object}),Et=Object.assign({},H.defaultProps,{disableTokenWarning:!1,visible:!0,onResize:function(){},className:"",style:null,visibilityConstraints:it});function At(){return u.createElement("div",{key:"warning",id:"no-token-warning",style:{position:"absolute",left:0,top:0}},u.createElement("h3",{key:"header"},bt),u.createElement("div",{key:"text"},"For information on setting up your basemap, read"),u.createElement("a",{key:"link",href:"https://visgl.github.io/react-map-gl/docs/get-started/mapbox-tokens"},"Note on Map Tokens"))}var Ot=(0,u.forwardRef)((function(t,e){var n=l((0,u.useState)(!0),2),r=n[0],i=n[1],o=l((0,u.useState)({width:0,height:0}),2),s=o[0],a=o[1],c=(0,u.useRef)(null),f=(0,u.useRef)(null),h=(0,u.useRef)(null),d=(0,u.useRef)(null),p=(0,u.useContext)(pt);gt((function(){if(Ot.supported()){var e=new H(vt(vt(vt({},t),s),{},{mapboxgl:Y(),container:f.current,onError:function(e){401===(e.error&&e.error.status||e.status)&&r&&(console.error(bt),i(!1)),t.onError(e)}}));c.current=e,p&&p.setMap&&p.setMap(e.getMap());var n=new F((function(e){if(e[0].contentRect){var n=e[0].contentRect,r=n.width,i=n.height;a({width:r,height:i}),t.onResize({width:r,height:i})}}));return n.observe(h.current),function(){e.finalize(),c.current=null,n.disconnect()}}}),[]),gt((function(){c.current&&c.current.setProps(vt(vt({},t),s))}));var g=c.current&&c.current.getMap();(0,u.useImperativeHandle)(e,(function(){return function(t){return{getMap:function(){return t.current&&t.current.getMap()},queryRenderedFeatures:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.current&&t.current.getMap();return r&&r.queryRenderedFeatures(e,n)}}}(c)}),[]);var m=(0,u.useCallback)((function(t){var e=t.target;e===d.current&&e.scrollTo(0,0)}),[]),y=g&&u.createElement(dt,{value:vt(vt({},p),{},{viewport:p.viewport||xt(vt({map:g,props:t},s)),map:g,container:p.container||h.current})},u.createElement("div",{key:"map-overlays",className:"overlays",ref:d,style:wt,onScroll:m},t.children)),v=t.className,b=t.width,x=t.height,w=t.style,_=t.visibilityConstraints,E=Object.assign({position:"relative"},w,{width:b,height:x}),A=t.visible&&function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:it;for(var n in e){var r=n.slice(0,3),i=ct(n.slice(3));if("min"===r&&t[i]<e[n])return!1;if("max"===r&&t[i]>e[n])return!1}return!0}(t.viewState||t,_),O=Object.assign({},wt,{visibility:A?"inherit":"hidden"});return u.createElement("div",{key:"map-container",ref:h,style:E},u.createElement("div",{key:"map-mapbox",ref:f,style:O,className:v}),y,!r&&!t.disableTokenWarning&&u.createElement(At,null))}));Ot.supported=function(){return Y()&&Y().supported()},Ot.propTypes=_t,Ot.defaultProps=Et;var St=Ot;function Ct(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Mt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Mt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Pt=function(){function t(){j(this,t),(0,a.Z)(this,"propNames",[])}return R(t,[{key:"arePropsEqual",value:function(t,e){var n,r=Ct(this.propNames||[]);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(!J(t[i],e[i]))return!1}}catch(o){r.e(o)}finally{r.f()}return!0}},{key:"initializeProps",value:function(t,e){return{start:t,end:e}}},{key:"interpolateProps",value:function(t,e,n){et(!1,"interpolateProps is not implemented")}},{key:"getDuration",value:function(t,e){return e.transitionDuration}}]),t}();function kt(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var Tt=n(9611);function Dt(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&(0,Tt.Z)(t,e)}function Ft(t){return(Ft="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jt(t,e){if(e&&("object"===Ft(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return kt(t)}function Lt(t){return(Lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rt={longitude:1,bearing:1};function It(t){return Number.isFinite(t)||Array.isArray(t)}function Nt(t,e,n){return function(t){return t in Rt}(t)&&Math.abs(n-e)>180&&(n=n<0?n+360:n-360),n}function Bt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return zt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $t(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Lt(t);if(e){var i=Lt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jt(this,n)}}var Ut=["longitude","latitude","zoom","bearing","pitch"],Vt=["latitude","longitude","zoom","width","height"],Zt=["bearing","pitch"],Wt={speed:1.2,curve:1.414};!function(t){Dt(n,t);var e=$t(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return j(this,n),t=e.call(this),(0,a.Z)(kt(t),"propNames",Ut),t.props=Object.assign({},Wt,r),t}R(n,[{key:"initializeProps",value:function(t,e){var n,r={},i={},o=Bt(Vt);try{for(o.s();!(n=o.n()).done;){var s=n.value,a=t[s],u=e[s];et(It(a)&&It(u),"".concat(s," must be supplied for transition")),r[s]=a,i[s]=Nt(s,a,u)}}catch(p){o.e(p)}finally{o.f()}var c,l=Bt(Zt);try{for(l.s();!(c=l.n()).done;){var f=c.value,h=t[f]||0,d=e[f]||0;r[f]=h,i[f]=Nt(f,h,d)}}catch(p){l.e(p)}finally{l.f()}return{start:r,end:i}}},{key:"interpolateProps",value:function(t,e,n){var r,i=(0,f.if)(t,e,n,this.props),o=Bt(Zt);try{for(o.s();!(r=o.n()).done;){var s=r.value;i[s]=tt(t[s],e[s],n)}}catch(a){o.e(a)}finally{o.f()}return i}},{key:"getDuration",value:function(t,e){var n=e.transitionDuration;return"auto"===n&&(n=(0,f.up)(t,e,this.props)),n}}])}(Pt);function qt(t,e){var n;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"===typeof t)return Gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gt(t,e)}(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Ht(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Lt(t);if(e){var i=Lt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jt(this,n)}}var Xt=["longitude","latitude","zoom","bearing","pitch"],Yt=function(t){Dt(n,t);var e=Ht(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return j(this,n),t=e.call(this),Array.isArray(r)&&(r={transitionProps:r}),t.propNames=r.transitionProps||Xt,r.around&&(t.around=r.around),t}return R(n,[{key:"initializeProps",value:function(t,e){var n={},r={};if(this.around){n.around=this.around;var i=new f.DW(t).unproject(this.around);Object.assign(r,e,{around:new f.DW(e).project(i),aroundLngLat:i})}var o,s=qt(this.propNames);try{for(s.s();!(o=s.n()).done;){var a=o.value,u=t[a],c=e[a];et(It(u)&&It(c),"".concat(a," must be supplied for transition")),n[a]=u,r[a]=Nt(a,u,c)}}catch(l){s.e(l)}finally{s.f()}return{start:n,end:r}}},{key:"interpolateProps",value:function(t,e,n){var r,i={},o=qt(this.propNames);try{for(o.s();!(r=o.n()).done;){var s=r.value;i[s]=tt(t[s],e[s],n)}}catch(h){o.e(h)}finally{o.f()}if(e.around){var a=l(new f.DW(Object.assign({},e,i)).getMapCenterByLngLatPosition({lngLat:e.aroundLngLat,pos:tt(t.around,e.around,n)}),2),u=a[0],c=a[1];i.longitude=u,i.latitude=c}return i}}]),n}(Pt),Kt=function(){};var Jt=1,Qt=2,te=3,ee=4,ne={transitionDuration:0,transitionEasing:function(t){return t},transitionInterpolator:new Yt,transitionInterruption:Jt,onTransitionStart:Kt,onTransitionInterrupt:Kt,onTransitionEnd:Kt},re=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};j(this,t),(0,a.Z)(this,"_animationFrame",null),(0,a.Z)(this,"_onTransitionFrame",(function(){e._animationFrame=requestAnimationFrame(e._onTransitionFrame),e._updateViewport()})),this.props=null,this.onViewportChange=n.onViewportChange||Kt,this.onStateChange=n.onStateChange||Kt,this.time=n.getTime||Date.now}return R(t,[{key:"getViewportInTransition",value:function(){return this._animationFrame?this.state.propsInTransition:null}},{key:"processViewportChange",value:function(t){var e=this.props;if(this.props=t,!e||this._shouldIgnoreViewportChange(e,t))return!1;if(this._isTransitionEnabled(t)){var n=Object.assign({},e),r=Object.assign({},t);if(this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this.state.interruption===Qt?Object.assign(n,this.state.endProps):Object.assign(n,this.state.propsInTransition),this.state.interruption===ee)){var i=this.time(),o=(i-this.state.startTime)/this.state.duration;r.transitionDuration=this.state.duration-(i-this.state.startTime),r.transitionEasing=function(t,e){var n=t(e);return function(r){return 1/(1-n)*(t(r*(1-e)+e)-n)}}(this.state.easing,o),r.transitionInterpolator=n.transitionInterpolator}return r.onTransitionStart(),this._triggerTransition(n,r),!0}return this._isTransitionInProgress()&&(e.onTransitionInterrupt(),this._endTransition()),!1}},{key:"_isTransitionInProgress",value:function(){return Boolean(this._animationFrame)}},{key:"_isTransitionEnabled",value:function(t){var e=t.transitionDuration,n=t.transitionInterpolator;return(e>0||"auto"===e)&&Boolean(n)}},{key:"_isUpdateDueToCurrentTransition",value:function(t){return!!this.state.propsInTransition&&this.state.interpolator.arePropsEqual(t,this.state.propsInTransition)}},{key:"_shouldIgnoreViewportChange",value:function(t,e){return!t||(this._isTransitionInProgress()?this.state.interruption===te||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e))}},{key:"_triggerTransition",value:function(t,e){et(this._isTransitionEnabled(e)),this._animationFrame&&cancelAnimationFrame(this._animationFrame);var n=e.transitionInterpolator,r=n.getDuration?n.getDuration(t,e):e.transitionDuration;if(0!==r){var i=e.transitionInterpolator.initializeProps(t,e),o={inTransition:!0,isZooming:t.zoom!==e.zoom,isPanning:t.longitude!==e.longitude||t.latitude!==e.latitude,isRotating:t.bearing!==e.bearing||t.pitch!==e.pitch};this.state={duration:r,easing:e.transitionEasing,interpolator:e.transitionInterpolator,interruption:e.transitionInterruption,startTime:this.time(),startProps:i.start,endProps:i.end,animation:null,propsInTransition:{}},this._onTransitionFrame(),this.onStateChange(o)}}},{key:"_endTransition",value:function(){this._animationFrame&&(cancelAnimationFrame(this._animationFrame),this._animationFrame=null),this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1})}},{key:"_updateViewport",value:function(){var t=this.time(),e=this.state,n=e.startTime,r=e.duration,i=e.easing,o=e.interpolator,s=e.startProps,a=e.endProps,u=!1,c=(t-n)/r;c>=1&&(c=1,u=!0),c=i(c);var l=o.interpolateProps(s,a,c),f=new ut(Object.assign({},this.props,l));this.state.propsInTransition=f.getViewportProps(),this.onViewportChange(this.state.propsInTransition,this.props),u&&(this._endTransition(),this.props.onTransitionEnd())}}]),t}();(0,a.Z)(re,"defaultProps",ne);var ie=n(2317);function oe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?oe(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ae={transitionDuration:0},ue={transitionDuration:300,transitionEasing:function(t){return t},transitionInterpolator:new Yt,transitionInterruption:Jt},ce=300,le=function(t){return 1-(1-t)*(1-t)},fe=["wheel"],he=["panstart","panmove","panend"],de=["pinchstart","pinchmove","pinchend"],pe=["tripanstart","tripanmove","tripanend"],ge=["doubletap"],me=["keydown"],ye=function(){function t(){var e=this;j(this,t),(0,a.Z)(this,"events",[]),(0,a.Z)(this,"scrollZoom",!0),(0,a.Z)(this,"dragPan",!0),(0,a.Z)(this,"dragRotate",!0),(0,a.Z)(this,"doubleClickZoom",!0),(0,a.Z)(this,"touchZoom",!0),(0,a.Z)(this,"touchRotate",!1),(0,a.Z)(this,"keyboard",!0),(0,a.Z)(this,"_interactionState",{isDragging:!1}),(0,a.Z)(this,"_events",{}),(0,a.Z)(this,"_setInteractionState",(function(t){Object.assign(e._interactionState,t),e.onStateChange&&e.onStateChange(e._interactionState)})),(0,a.Z)(this,"_onTransition",(function(t,n){e.onViewportChange(t,e._interactionState,n)})),this.handleEvent=this.handleEvent.bind(this),this._transitionManager=new re({onViewportChange:this._onTransition,onStateChange:this._setInteractionState})}return R(t,[{key:"handleEvent",value:function(t){this.mapState=this.getMapState();var e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}},{key:"getCenter",value:function(t){var e=t.offsetCenter;return[e.x,e.y]}},{key:"isFunctionKeyPressed",value:function(t){var e=t.srcEvent;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}},{key:"blockEvents",value:function(t){var e=this,n=setTimeout((function(){e._eventStartBlocked===n&&(e._eventStartBlocked=null)}),t);this._eventStartBlocked=n}},{key:"updateViewport",value:function(t,e,n){var r=this.mapState instanceof ut?this.mapState.getViewportProps():this.mapState,i=se(se({},t.getViewportProps()),e),o=Object.keys(i).some((function(t){return r[t]!==i[t]}));this._state=t.getState(),this._setInteractionState(n),o&&this.onViewportChange(i,this._interactionState,r)}},{key:"getMapState",value:function(t){return new ut(se(se(se({},this.mapStateProps),this._state),t))}},{key:"isDragging",value:function(){return this._interactionState.isDragging}},{key:"setOptions",value:function(t){var e=t.onViewportChange,n=t.onStateChange,r=t.eventManager,i=void 0===r?this.eventManager:r,o=t.isInteractive,s=void 0===o||o,a=t.scrollZoom,u=void 0===a?this.scrollZoom:a,c=t.dragPan,l=void 0===c?this.dragPan:c,f=t.dragRotate,h=void 0===f?this.dragRotate:f,d=t.doubleClickZoom,p=void 0===d?this.doubleClickZoom:d,g=t.touchZoom,m=void 0===g?this.touchZoom:g,y=t.touchRotate,v=void 0===y?this.touchRotate:y,b=t.keyboard,x=void 0===b?this.keyboard:b;this.onViewportChange=e,this.onStateChange=n;var w=this.mapStateProps||{},_=w.height!==t.height||w.width!==t.width;this.mapStateProps=t,_&&(this.mapState=w,this.updateViewport(new ut(t))),this._transitionManager.processViewportChange(t),this.eventManager!==i&&(this.eventManager=i,this._events={},this.toggleEvents(this.events,!0)),this.toggleEvents(fe,s&&Boolean(u)),this.toggleEvents(he,s&&Boolean(l||h)),this.toggleEvents(de,s&&Boolean(m||v)),this.toggleEvents(pe,s&&Boolean(v)),this.toggleEvents(ge,s&&Boolean(p)),this.toggleEvents(me,s&&Boolean(x)),this.scrollZoom=u,this.dragPan=l,this.dragRotate=h,this.doubleClickZoom=p,this.touchZoom=m,this.touchRotate=v,this.keyboard=x}},{key:"toggleEvents",value:function(t,e){var n=this;this.eventManager&&t.forEach((function(t){n._events[t]!==e&&(n._events[t]=e,e?n.eventManager.on(t,n.handleEvent):n.eventManager.off(t,n.handleEvent))}))}},{key:"_onPanStart",value:function(t){var e=this.getCenter(t);this._panRotate=this.isFunctionKeyPressed(t)||t.rightButton;var n=this._panRotate?this.mapState.rotateStart({pos:e}):this.mapState.panStart({pos:e});return this.updateViewport(n,ae,{isDragging:!0}),!0}},{key:"_onPan",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotate(t):this._onPanMove(t))}},{key:"_onPanEnd",value:function(t){return!!this.isDragging()&&(this._panRotate?this._onPanRotateEnd(t):this._onPanMoveEnd(t))}},{key:"_onPanMove",value:function(t){if(!this.dragPan)return!1;var e=this.getCenter(t),n=this.mapState.pan({pos:e});return this.updateViewport(n,ae,{isPanning:!0}),!0}},{key:"_onPanMoveEnd",value:function(t){if(this.dragPan){var e=this.dragPan.inertia,n=void 0===e?ce:e;if(n&&t.velocity){var r=this.getCenter(t),i=[r[0]+t.velocityX*n/2,r[1]+t.velocityY*n/2],o=this.mapState.pan({pos:i}).panEnd();return this.updateViewport(o,se(se({},ue),{},{transitionDuration:n,transitionEasing:le}),{isDragging:!1,isPanning:!0}),!0}}var s=this.mapState.panEnd();return this.updateViewport(s,null,{isDragging:!1,isPanning:!1}),!0}},{key:"_onPanRotate",value:function(t){if(!this.dragRotate)return!1;var e=this.getCenter(t),n=this.mapState.rotate({pos:e});return this.updateViewport(n,ae,{isRotating:!0}),!0}},{key:"_onPanRotateEnd",value:function(t){if(this.dragRotate){var e=this.dragRotate.inertia,n=void 0===e?ce:e;if(n&&t.velocity){var r=this.getCenter(t),i=[r[0]+t.velocityX*n/2,r[1]+t.velocityY*n/2],o=this.mapState.rotate({pos:i}).rotateEnd();return this.updateViewport(o,se(se({},ue),{},{transitionDuration:n,transitionEasing:le}),{isDragging:!1,isRotating:!0}),!0}}var s=this.mapState.panEnd();return this.updateViewport(s,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onWheel",value:function(t){if(!this.scrollZoom)return!1;var e=this.scrollZoom,n=e.speed,r=void 0===n?.01:n,i=e.smooth,o=void 0!==i&&i;t.preventDefault();var s=this.getCenter(t),a=t.delta,u=2/(1+Math.exp(-Math.abs(a*r)));a<0&&0!==u&&(u=1/u);var c=this.mapState.zoom({pos:s,scale:u});return c.getViewportProps().zoom!==this.mapStateProps.zoom&&(this.updateViewport(c,se(se({},ue),{},{transitionInterpolator:new Yt({around:s}),transitionDuration:o?250:1}),{isPanning:!0,isZooming:!0}),!0)}},{key:"_onPinchStart",value:function(t){var e=this.getCenter(t),n=this.mapState.zoomStart({pos:e}).rotateStart({pos:e});return this._startPinchRotation=t.rotation,this._lastPinchEvent=t,this.updateViewport(n,ae,{isDragging:!0}),!0}},{key:"_onPinch",value:function(t){if(!this.isDragging())return!1;if(!this.touchZoom&&!this.touchRotate)return!1;var e=this.mapState;if(this.touchZoom){var n=t.scale,r=this.getCenter(t);e=e.zoom({pos:r,scale:n})}if(this.touchRotate){var i=t.rotation;e=e.rotate({deltaAngleX:this._startPinchRotation-i})}return this.updateViewport(e,ae,{isDragging:!0,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:Boolean(this.touchRotate)}),this._lastPinchEvent=t,!0}},{key:"_onPinchEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchZoom){var e=this.touchZoom.inertia,n=void 0===e?ce:e,r=this._lastPinchEvent;if(n&&r&&t.scale!==r.scale){var i=this.getCenter(t),o=this.mapState.rotateEnd(),s=Math.log2(t.scale),a=(s-Math.log2(r.scale))/(t.deltaTime-r.deltaTime),u=Math.pow(2,s+a*n/2);return o=o.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(o,se(se({},ue),{},{transitionInterpolator:new Yt({around:i}),transitionDuration:n,transitionEasing:le}),{isDragging:!1,isPanning:Boolean(this.touchZoom),isZooming:Boolean(this.touchZoom),isRotating:!1}),this.blockEvents(n),!0}}var c=this.mapState.zoomEnd().rotateEnd();return this._state.startPinchRotation=0,this.updateViewport(c,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1}),this._startPinchRotation=null,this._lastPinchEvent=null,!0}},{key:"_onTriplePanStart",value:function(t){var e=this.getCenter(t),n=this.mapState.rotateStart({pos:e});return this.updateViewport(n,ae,{isDragging:!0}),!0}},{key:"_onTriplePan",value:function(t){if(!this.isDragging())return!1;if(!this.touchRotate)return!1;var e=this.getCenter(t);e[0]-=t.deltaX;var n=this.mapState.rotate({pos:e});return this.updateViewport(n,ae,{isRotating:!0}),!0}},{key:"_onTriplePanEnd",value:function(t){if(!this.isDragging())return!1;if(this.touchRotate){var e=this.touchRotate.inertia,n=void 0===e?ce:e;if(n&&t.velocityY){var r=this.getCenter(t),i=[r[0],r[1]+=t.velocityY*n/2],o=this.mapState.rotate({pos:i});return this.updateViewport(o,se(se({},ue),{},{transitionDuration:n,transitionEasing:le}),{isDragging:!1,isRotating:!0}),this.blockEvents(n),!1}}var s=this.mapState.rotateEnd();return this.updateViewport(s,null,{isDragging:!1,isRotating:!1}),!0}},{key:"_onDoubleTap",value:function(t){if(!this.doubleClickZoom)return!1;var e=this.getCenter(t),n=this.isFunctionKeyPressed(t),r=this.mapState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(r,Object.assign({},ue,{transitionInterpolator:new Yt({around:e})}),{isZooming:!0}),!0}},{key:"_onKeyDown",value:function(t){if(!this.keyboard)return!1;var e,n=this.isFunctionKeyPressed(t),r=this.keyboard,i=r.zoomSpeed,o=void 0===i?2:i,s=r.moveSpeed,a=void 0===s?100:s,u=r.rotateSpeedX,c=void 0===u?15:u,l=r.rotateSpeedY,f=void 0===l?10:l,h=this.mapStateProps;switch(t.srcEvent.keyCode){case 189:e=n?this.getMapState({zoom:h.zoom-Math.log2(o)-1}):this.getMapState({zoom:h.zoom-Math.log2(o)});break;case 187:e=n?this.getMapState({zoom:h.zoom+Math.log2(o)+1}):this.getMapState({zoom:h.zoom+Math.log2(o)});break;case 37:e=n?this.getMapState({bearing:h.bearing-c}):this.mapState.pan({pos:[a,0],startPos:[0,0]});break;case 39:e=n?this.getMapState({bearing:h.bearing+c}):this.mapState.pan({pos:[-a,0],startPos:[0,0]});break;case 38:e=n?this.getMapState({pitch:h.pitch+f}):this.mapState.pan({pos:[0,a],startPos:[0,0]});break;case 40:e=n?this.getMapState({pitch:h.pitch-f}):this.mapState.pan({pos:[0,-a],startPos:[0,0]});break;default:return!1}return this.updateViewport(e,ue)}}]),t}();function ve(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function be(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ve(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var xe=Object.assign({},St.propTypes,{maxZoom:c.number,minZoom:c.number,maxPitch:c.number,minPitch:c.number,onViewStateChange:c.func,onViewportChange:c.func,onInteractionStateChange:c.func,transitionDuration:c.oneOfType([c.number,c.string]),transitionInterpolator:c.object,transitionInterruption:c.number,transitionEasing:c.func,onTransitionStart:c.func,onTransitionInterrupt:c.func,onTransitionEnd:c.func,scrollZoom:c.oneOfType([c.bool,c.object]),dragPan:c.oneOfType([c.bool,c.object]),dragRotate:c.oneOfType([c.bool,c.object]),doubleClickZoom:c.bool,touchZoom:c.oneOfType([c.bool,c.object]),touchRotate:c.oneOfType([c.bool,c.object]),keyboard:c.oneOfType([c.bool,c.object]),onHover:c.func,onClick:c.func,onDblClick:c.func,onContextMenu:c.func,onMouseDown:c.func,onMouseMove:c.func,onMouseUp:c.func,onTouchStart:c.func,onTouchMove:c.func,onTouchEnd:c.func,onMouseEnter:c.func,onMouseLeave:c.func,onMouseOut:c.func,onWheel:c.func,touchAction:c.string,eventRecognizerOptions:c.object,clickRadius:c.number,interactiveLayerIds:c.array,getCursor:c.func,controller:c.instanceOf(ye)}),we=Object.assign({},St.defaultProps,it,re.defaultProps,{onViewStateChange:null,onViewportChange:null,onClick:null,onNativeClick:null,onHover:null,onContextMenu:function(t){return t.preventDefault()},scrollZoom:!0,dragPan:!0,dragRotate:!0,doubleClickZoom:!0,touchZoom:!0,touchRotate:!1,keyboard:!0,touchAction:"none",eventRecognizerOptions:{},clickRadius:0,getCursor:function(t){var e=t.isDragging,n=t.isHovering;return e?"grabbing":n?"pointer":"grab"}});function _e(t){if(t.lngLat||!t.offsetCenter)return t;var e=t.offsetCenter,n=e.x,r=e.y;if(!Number.isFinite(n)||!Number.isFinite(r))return t;var i=[n,r];t.point=i;var o=this.viewport,s=o.unproject(i,{targetZ:o.meterOffset[2]});return t.lngLat=[s[0],s[1]],t}function Ee(t){var e=this.map;if(!e||!t)return null;var n={},r=this.props.clickRadius;this.props.interactiveLayerIds&&(n.layers=this.props.interactiveLayerIds);try{return e.queryRenderedFeatures(r?[[t[0]-r,t[1]+r],[t[0]+r,t[1]-r]]:t,n)}catch(i){return null}}function Ae(t,e){var n=this.props[t];n&&n(_e.call(this,e))}function Oe(t){Ae.call(this,"touch"===t.pointerType?"onTouchStart":"onMouseDown",t)}function Se(t){Ae.call(this,"touch"===t.pointerType?"onTouchEnd":"onMouseUp",t)}function Ce(t){if(Ae.call(this,"touch"===t.pointerType?"onTouchMove":"onMouseMove",t),!this.state.isDragging){var e,n=this.props,r=n.onHover,i=n.interactiveLayerIds;t=_e.call(this,t),(i||r)&&(e=Ee.call(this,t.point));var o=Boolean(i&&e&&e.length>0),s=o&&!this.state.isHovering,a=!o&&this.state.isHovering;(r||s)&&(t.features=e,r&&r(t)),s&&Ae.call(this,"onMouseEnter",t),a&&Ae.call(this,"onMouseLeave",t),(s||a)&&this.setState({isHovering:o})}}function Me(t){var e=this.props,n=e.onClick,r=e.onNativeClick,i=e.onDblClick,o=e.doubleClickZoom,s=[],a=i||o;switch(t.type){case"anyclick":s.push(r),a||s.push(n);break;case"click":a&&s.push(n)}(s=s.filter(Boolean)).length&&((t=_e.call(this,t)).features=Ee.call(this,t.point),s.forEach((function(e){return e(t)})))}var Pe=(0,u.forwardRef)((function(t,e){var n=(0,u.useContext)(pt),i=(0,u.useMemo)((function(){return t.controller||new ye}),[]),o=(0,u.useMemo)((function(){return new ie.Q(null,{touchAction:t.touchAction,recognizerOptions:t.eventRecognizerOptions})}),[]),a=(0,u.useRef)(null),c=(0,u.useRef)(null),l=(0,u.useRef)({width:0,height:0,state:{isHovering:!1,isDragging:!1}}).current;l.props=t,l.map=c.current&&c.current.getMap(),l.setState=function(e){l.state=be(be({},l.state),e),a.current.style.cursor=t.getCursor(l.state)};var f,h,d=!0,p=function(t,e,n){if(d)f=[t,e,n];else{var r=l.props,i=r.onViewStateChange,o=r.onViewportChange;Object.defineProperty(t,"position",{get:function(){return[0,0,mt(l.map,t)]}}),i&&i({viewState:t,interactionState:e,oldViewState:n}),o&&o(t,e,n)}};(0,u.useImperativeHandle)(e,(function(){return function(t){return{getMap:t.current&&t.current.getMap,queryRenderedFeatures:t.current&&t.current.queryRenderedFeatures}}(c)}),[]);var g=(0,u.useMemo)((function(){return be(be({},n),{},{eventManager:o,container:n.container||a.current})}),[n,a.current]);g.onViewportChange=p,g.viewport=n.viewport||xt(l),l.viewport=g.viewport;var m=function(t){var e=t.isDragging,n=void 0!==e&&e;if(n!==l.state.isDragging&&l.setState({isDragging:n}),d)h=t;else{var r=l.props.onInteractionStateChange;r&&r(t)}},y=function(){l.width&&l.height&&i.setOptions(be(be(be({},l.props),l.props.viewState),{},{isInteractive:Boolean(l.props.onViewStateChange||l.props.onViewportChange),onViewportChange:p,onStateChange:m,eventManager:o,width:l.width,height:l.height}))};(0,u.useEffect)((function(){return o.setElement(a.current),o.on({pointerdown:Oe.bind(l),pointermove:Ce.bind(l),pointerup:Se.bind(l),pointerleave:Ae.bind(l,"onMouseOut"),click:Me.bind(l),anyclick:Me.bind(l),dblclick:Ae.bind(l,"onDblClick"),wheel:Ae.bind(l,"onWheel"),contextmenu:Ae.bind(l,"onContextMenu")}),function(){o.destroy()}}),[]),gt((function(){f&&p.apply(void 0,s(f)),h&&m(h)})),y();var v=t.width,b=t.height,x=t.style,w=t.getCursor,_=(0,u.useMemo)((function(){return be(be({position:"relative"},x),{},{width:v,height:b,cursor:w(l.state)})}),[x,v,b,w,l.state]);return f&&l._child||(l._child=u.createElement(dt,{value:g},u.createElement("div",{key:"event-canvas",ref:a,style:_},u.createElement(St,(0,r.Z)({},t,{width:"100%",height:"100%",style:null,onResize:function(t){var e=t.width,n=t.height;l.width=e,l.height=n,y(),l.props.onResize({width:e,height:n})},ref:c}))))),d=!1,l._child}));Pe.supported=St.supported,Pe.propTypes=xe,Pe.defaultProps=we;var ke=Pe;function Te(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!Te(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"===Ft(t)&&"object"===Ft(e)){var r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(var o=0,s=r;o<s.length;o++){var a=s[o];if(!e.hasOwnProperty(a))return!1;if(!Te(t[a],e[a]))return!1}return!0}return!1}function De(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Fe={type:c.string.isRequired,id:c.string},je=0;function Le(t,e,n){if(t.style&&t.style._loaded){var r=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?De(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},n);return delete r.id,delete r.children,t.addSource(e,r),t.getSource(e)}return null}function Re(t){var e=(0,u.useContext)(pt),n=(0,u.useRef)({id:t.id,type:t.type}),r=l((0,u.useState)(0),2)[1],i=(0,u.useMemo)((function(){return t.id||"jsx-source-".concat(je++)}),[]),o=e.map;(0,u.useEffect)((function(){if(o){var t=function(){return r((function(t){return t+1}))};return o.on("styledata",t),function(){o.off("styledata",t),requestAnimationFrame((function(){o.style&&o.style._loaded&&o.getSource(i)&&o.removeSource(i)}))}}}),[o,i]);var s=o&&o.style&&o.getSource(i);return s?function(t,e,n){et(e.id===n.id,"source id changed"),et(e.type===n.type,"source type changed");var r="",i=0;for(var o in e)"children"===o||"id"===o||Te(n[o],e[o])||(r=o,i++);if(i){var s=e.type;if("geojson"===s)t.setData(e.data);else if("image"===s)t.updateImage({url:e.url,coordinates:e.coordinates});else if("canvas"!==s&&"video"!==s||1!==i||"coordinates"!==r)if("vector"===s&&t.setUrl)switch(r){case"url":t.setUrl(e.url);break;case"tiles":t.setTiles(e.tiles)}else console.warn("Unable to update <Source> prop: ".concat(r));else t.setCoordinates(e.coordinates)}}(s,t,n.current):s=Le(o,i,t),n.current=t,s&&u.Children.map(t.children,(function(t){return t&&(0,u.cloneElement)(t,{source:i})}))||null}Re.propTypes=Fe;var Ie=n(3366);function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Be(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var ze={type:c.oneOf(["fill","line","symbol","circle","fill-extrusion","raster","background","heatmap","hillshade","sky"]).isRequired,id:c.string,source:c.string,beforeId:c.string};function $e(t,e,n,r){var i=n.layout,o=void 0===i?{}:i,s=n.paint,a=void 0===s?{}:s,u=n.filter,c=n.minzoom,l=n.maxzoom,f=n.beforeId,h=function(t,e){if(null==t)return{};var n,r,i=(0,Ie.Z)(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}(n,["layout","paint","filter","minzoom","maxzoom","beforeId"]);if(f!==r.beforeId&&t.moveLayer(e,f),o!==r.layout){var d=r.layout||{};for(var p in o)Te(o[p],d[p])||t.setLayoutProperty(e,p,o[p]);for(var g in d)o.hasOwnProperty(g)||t.setLayoutProperty(e,g,void 0)}if(a!==r.paint){var m=r.paint||{};for(var y in a)Te(a[y],m[y])||t.setPaintProperty(e,y,a[y]);for(var v in m)a.hasOwnProperty(v)||t.setPaintProperty(e,v,void 0)}for(var b in Te(u,r.filter)||t.setFilter(e,u),c===r.minzoom&&l===r.maxzoom||t.setLayerZoomRange(e,c,l),h)Te(h[b],r[b])||t.setLayerProperty(e,b,h[b])}var Ue=0;function Ve(t){var e=(0,u.useContext)(pt),n=(0,u.useRef)({id:t.id,type:t.type}),r=l((0,u.useState)(0),2)[1],i=(0,u.useMemo)((function(){return t.id||"jsx-layer-".concat(Ue++)}),[]),o=e.map;return(0,u.useEffect)((function(){if(o){var t=function(){return r((function(t){return t+1}))};return o.on("styledata",t),function(){o.off("styledata",t),o.style&&o.style._loaded&&o.removeLayer(i)}}}),[o]),o&&o.style&&o.getLayer(i)?function(t,e,n,r){et(n.id===r.id,"layer id changed"),et(n.type===r.type,"layer type changed");try{$e(t,e,n,r)}catch(i){console.warn(i)}}(o,i,t,n.current):function(t,e,n){if(t.style&&t.style._loaded){var r=Be(Be({},n),{},{id:e});delete r.beforeId,t.addLayer(r,n.beforeId)}}(o,i,t),n.current=t,null}Ve.propTypes=ze;var Ze={captureScroll:!1,captureDrag:!0,captureClick:!0,captureDoubleClick:!0,capturePointerMove:!1},We={captureScroll:c.bool,captureDrag:c.bool,captureClick:c.bool,captureDoubleClick:c.bool,capturePointerMove:c.bool};function qe(t){var e=t.containerRef.current,n=t.context.eventManager;if(e&&n){var r={wheel:function(e){var n=t.props;n.captureScroll&&e.stopPropagation(),n.onScroll&&n.onScroll(e,t)},panstart:function(e){var n=t.props;n.captureDrag&&e.stopPropagation(),n.onDragStart&&n.onDragStart(e,t)},anyclick:function(e){var n=t.props;n.captureClick&&e.stopPropagation(),n.onNativeClick&&n.onNativeClick(e,t)},click:function(e){var n=t.props;n.captureClick&&e.stopPropagation(),n.onClick&&n.onClick(e,t)},dblclick:function(e){var n=t.props;n.captureDoubleClick&&e.stopPropagation(),n.onDoubleClick&&n.onDoubleClick(e,t)},pointermove:function(e){var n=t.props;n.capturePointerMove&&e.stopPropagation(),n.onPointerMove&&n.onPointerMove(e,t)}};return n.watch(r,e),function(){n.off(r)}}}function Ge(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=(0,u.useContext)(pt),n=(0,u.useRef)(null),r=(0,u.useRef)({props:t,state:{},context:e,containerRef:n}),i=r.current;return i.props=t,i.context=e,(0,u.useEffect)((function(){return qe(i)}),[e.eventManager]),i}function He(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Lt(t);if(e){var i=Lt(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return jt(this,n)}}function Xe(t){var e=t.instance,n=Ge(t),r=n.context,i=n.containerRef;return e._context=r,e._containerRef=i,e._render()}var Ye=function(t){Dt(n,t);var e=He(n);function n(){var t;j(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return t=e.call.apply(e,[this].concat(i)),(0,a.Z)(kt(t),"_context",{}),(0,a.Z)(kt(t),"_containerRef",(0,u.createRef)()),(0,a.Z)(kt(t),"_onScroll",(function(t){})),(0,a.Z)(kt(t),"_onDragStart",(function(t){})),(0,a.Z)(kt(t),"_onDblClick",(function(t){})),(0,a.Z)(kt(t),"_onClick",(function(t){})),(0,a.Z)(kt(t),"_onPointerMove",(function(t){})),t}return R(n,[{key:"_render",value:function(){throw new Error("_render() not implemented")}},{key:"render",value:function(){return u.createElement(Xe,(0,r.Z)({instance:this},this.props,{onScroll:this._onScroll,onDragStart:this._onDragStart,onDblClick:this._onDblClick,onClick:this._onClick,onPointerMove:this._onPointerMove}))}}]),n}(u.PureComponent);function Ke(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ke(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ke(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}(0,a.Z)(Ye,"propTypes",We),(0,a.Z)(Ye,"defaultProps",Ze);var Qe=Object.assign({},We,{draggable:c.bool,onDrag:c.func,onDragEnd:c.func,onDragStart:c.func,offsetLeft:c.number,offsetTop:c.number}),tn=Object.assign({},Ze,{draggable:!1,offsetLeft:0,offsetTop:0});function en(t){var e=t.offsetCenter;return[e.x,e.y]}function nn(t,e,n,r){var i=t[0]+e[0]-n.offsetLeft,o=t[1]+e[1]-n.offsetTop;return r.viewport.unproject([i,o])}function rn(t,e){var n=e.props,r=e.callbacks,i=e.state,o=e.context,s=e.containerRef;if(n.draggable){t.stopPropagation();var a=en(t),u=function(t,e){var n=t.center,r=n.x,i=n.y;if(e){var o=e.getBoundingClientRect();return[o.left-r,o.top-i]}return null}(t,s.current);if(i.setDragPos(a),i.setDragOffset(u),r.onDragStart&&u){var c=Object.assign({},t);c.lngLat=nn(a,u,n,o),r.onDragStart(c)}}}function on(t){var e=t.context.eventManager;if(e&&t.state.dragPos){var n={panmove:function(e){return function(t,e){var n=e.props,r=e.callbacks,i=e.state,o=e.context;t.stopPropagation();var s=en(t);i.setDragPos(s);var a=i.dragOffset;if(r.onDrag&&a){var u=Object.assign({},t);u.lngLat=nn(s,a,n,o),r.onDrag(u)}}(e,t)},panend:function(e){return function(t,e){var n=e.props,r=e.callbacks,i=e.state,o=e.context;t.stopPropagation();var s=i.dragPos,a=i.dragOffset;if(i.setDragPos(null),i.setDragOffset(null),r.onDragEnd&&s&&a){var u=Object.assign({},t);u.lngLat=nn(s,a,n,o),r.onDragEnd(u)}}(e,t)},pancancel:function(e){return function(t,e){var n=e.state;t.stopPropagation(),n.setDragPos(null),n.setDragOffset(null)}(e,t)}};return e.watch(n),function(){e.off(n)}}}var sn="undefined"!==typeof window&&window.devicePixelRatio||1,an=function(t){return Math.round(t*sn)/sn},un=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";if(null===t)return e;var r="x"===n?t.offsetWidth:t.offsetHeight;return an(e/100*r)/r*100},cn=Object.assign({},Qe,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired}),ln=Object.assign({},tn,{className:""});function fn(t){var e=function(t){var e=l((0,u.useState)(null),2),n=e[0],r=e[1],i=l((0,u.useState)(null),2),o=i[0],s=i[1],a=Ge(Je(Je({},t),{},{onDragStart:rn}));return a.callbacks=t,a.state.dragPos=n,a.state.setDragPos=r,a.state.dragOffset=o,a.state.setDragOffset=s,(0,u.useEffect)((function(){return on(a)}),[a.context.eventManager,Boolean(n)]),a}(t),n=e.state,r=e.containerRef,i=t.children,o=t.className,s=t.draggable,a=n.dragPos,c=function(t){var e=t.props,n=t.state,r=t.context,i=e.longitude,o=e.latitude,s=e.offsetLeft,a=e.offsetTop,u=n.dragPos,c=n.dragOffset,f=r.viewport,h=r.map;if(u&&c)return[u[0]+c[0],u[1]+c[1]];var d=mt(h,{longitude:i,latitude:o}),p=l(f.project([i,o,d]),2),g=p[0],m=p[1];return[g+=s,m+=a]}(e),f=l(c,2),h=f[0],d=f[1],p="translate(".concat(an(h),"px, ").concat(an(d),"px)"),g=s?a?"grabbing":"grab":"auto",m=(0,u.useMemo)((function(){var t={position:"absolute",left:0,top:0,transform:p,cursor:g};return u.createElement("div",{className:"mapboxgl-marker ".concat(o),ref:e.containerRef,style:t},i)}),[i,o]),y=r.current;return y&&(y.style.transform=p,y.style.cursor=g),m}fn.defaultProps=ln,fn.propTypes=cn;u.memo(fn);var hn={top:{x:.5,y:0},"top-left":{x:0,y:0},"top-right":{x:1,y:0},bottom:{x:.5,y:1},"bottom-left":{x:0,y:1},"bottom-right":{x:1,y:1},left:{x:0,y:.5},right:{x:1,y:.5}},dn=Object.keys(hn);var pn=Object.assign({},We,{className:c.string,longitude:c.number.isRequired,latitude:c.number.isRequired,altitude:c.number,offsetLeft:c.number,offsetTop:c.number,tipSize:c.number,closeButton:c.bool,closeOnClick:c.bool,anchor:c.oneOf(Object.keys(hn)),dynamicPosition:c.bool,sortByDepth:c.bool,onClose:c.func}),gn=Object.assign({},Ze,{className:"",offsetLeft:0,offsetTop:0,tipSize:10,anchor:"bottom",dynamicPosition:!0,sortByDepth:!1,closeButton:!0,closeOnClick:!0,onClose:function(){}});function mn(t,e,n,r){var i=l(r,2),o=i[0],s=i[1],a=t.anchor,u=t.dynamicPosition,c=t.tipSize;return n&&u?function(t){var e=t.x,n=t.y,r=t.width,i=t.height,o=t.selfWidth,s=t.selfHeight,a=t.anchor,u=t.padding,c=void 0===u?0:u,l=hn[a],f=l.x,h=l.y,d=n-h*s,p=d+s,g=Math.max(0,c-d)+Math.max(0,p-i+c);if(g>0){var m=h,y=g;for(h=0;h<=1;h+=.5)p=(d=n-h*s)+s,(g=Math.max(0,c-d)+Math.max(0,p-i+c))<y&&(y=g,m=h);h=m}var v=.5;.5===h&&(f=Math.floor(f),v=1);var b=e-f*o,x=b+o,w=Math.max(0,c-b)+Math.max(0,x-r+c);if(w>0){var _=f,E=w;for(f=0;f<=1;f+=v)x=(b=e-f*o)+o,(w=Math.max(0,c-b)+Math.max(0,x-r+c))<E&&(E=w,_=f);f=_}return dn.find((function(t){var e=hn[t];return e.x===f&&e.y===h}))||a}({x:o,y:s,anchor:a,padding:c,width:e.width,height:e.height,selfWidth:n.clientWidth,selfHeight:n.clientHeight}):a}function yn(t){var e=(0,u.useRef)(null),n=Ge(t),r=n.context,i=n.containerRef,o=l((0,u.useState)(!1),2)[1];(0,u.useEffect)((function(){o(!0)}),[e.current]),(0,u.useEffect)((function(){if(r.eventManager&&t.closeOnClick){var e=function(){return n.props.onClose()};return r.eventManager.on("anyclick",e),function(){r.eventManager.off("anyclick",e)}}}),[r.eventManager,t.closeOnClick]);var s=r.viewport,a=r.map,c=t.className,f=t.longitude,h=t.latitude,d=t.tipSize,p=t.closeButton,g=t.children,m=t.altitude;void 0===m&&(m=mt(a,{longitude:f,latitude:h}));var y=s.project([f,h,m]),v=mn(t,s,e.current,y),b=function(t,e,n,r,i){var o=l(r,3),s=o[0],a=o[1],u=o[2],c=t.offsetLeft,f=t.offsetTop,h=t.sortByDepth,d=hn[i],p=s+c,g=a+f,m=un(n,100*-d.x),y=un(n,100*-d.y,"y"),v={position:"absolute",transform:"\n      translate(".concat(m,"%, ").concat(y,"%)\n      translate(").concat(an(p),"px, ").concat(an(g),"px)\n    "),display:void 0,zIndex:void 0};return h?(u>1||u<-1||s<0||s>e.width||a<0||a>e.height?v.display="none":v.zIndex=Math.floor((1-u)/2*1e5),v):v}(t,s,i.current,y,v),x=(0,u.useCallback)((function(t){n.props.onClose();var e=n.context.eventManager;e&&e.once("click",(function(t){return t.stopPropagation()}),t.target)}),[]);return u.createElement("div",{className:"mapboxgl-popup mapboxgl-popup-anchor-".concat(v," ").concat(c),style:b,ref:i},u.createElement("div",{key:"tip",className:"mapboxgl-popup-tip",style:{borderWidth:d}}),u.createElement("div",{key:"content",ref:e,className:"mapboxgl-popup-content"},p&&u.createElement("button",{key:"close-button",className:"mapboxgl-popup-close-button",type:"button",onClick:x},"\xd7"),g))}yn.propTypes=pn,yn.defaultProps=gn;u.memo(yn);function vn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var bn=Object.assign({},We,{toggleLabel:c.string,className:c.string,style:c.object,compact:c.bool,customAttribution:c.oneOfType([c.string,c.arrayOf(c.string)])}),xn=Object.assign({},Ze,{className:"",toggleLabel:"Toggle Attribution"});function wn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=(0,u.useRef)(null),o=l((0,u.useState)(!1),2),s=o[0],c=o[1];(0,u.useEffect)((function(){var e;return n.map&&(e=function(t,e,n,r){var i=new(Y().AttributionControl)(t);return i._map=e,i._container=n,i._innerContainer=r,i._updateAttributions(),i._updateEditLink(),e.on("styledata",i._updateData),e.on("sourcedata",i._updateData),i}({customAttribution:t.customAttribution},n.map,r.current,i.current)),function(){return e&&function(t){t._map.off("styledata",t._updateData),t._map.off("sourcedata",t._updateData)}(e)}}),[n.map]);var f=void 0===t.compact?n.viewport.width<=640:t.compact;(0,u.useEffect)((function(){!f&&s&&c(!1)}),[f]);var h=(0,u.useCallback)((function(){return c((function(t){return!t}))}),[]),d=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?vn(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:d,className:t.className},u.createElement("div",{ref:r,"aria-pressed":s,className:"mapboxgl-ctrl mapboxgl-ctrl-attrib ".concat(f?"mapboxgl-compact":""," ").concat(s?"mapboxgl-compact-show":"")},u.createElement("button",{type:"button",className:"mapboxgl-ctrl-attrib-button",title:t.toggleLabel,onClick:h}),u.createElement("div",{ref:i,className:"mapboxgl-ctrl-attrib-inner",role:"list"})))}wn.propTypes=bn,wn.defaultProps=xn;u.memo(wn);function _n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var En=Object.assign({},We,{className:c.string,style:c.object,container:c.object,label:c.string}),An=Object.assign({},Ze,{className:"",container:null,label:"Toggle fullscreen"});function On(t){var e=Ge(t),n=e.context,r=e.containerRef,i=l((0,u.useState)(!1),2),o=i[0],s=i[1],c=l((0,u.useState)(!1),2),f=c[0],h=c[1],d=l((0,u.useState)(null),2),p=d[0],g=d[1];(0,u.useEffect)((function(){var t=new(Y().FullscreenControl);g(t),h(t._checkFullscreenSupport());var e=function(){var e=!t._fullscreen;t._fullscreen=e,s(e)};return I.addEventListener(t._fullscreenchange,e),function(){I.removeEventListener(t._fullscreenchange,e)}}),[]);var m=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_n(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_n(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);if(!f)return null;var y=t.className,v=t.label,b=o?"shrink":"fullscreen";return u.createElement("div",{style:m,className:y},u.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},u.createElement("button",{key:b,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(b),type:"button",title:v,onClick:function(){p&&(p._container=t.container||n.container,p._onClickFullscreen())}},u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}On.propTypes=En,On.defaultProps=An;var Sn;u.memo(On);function Cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Mn=function(){},Pn=Object.assign({},We,{className:c.string,style:c.object,label:c.string,disabledLabel:c.string,auto:c.bool,positionOptions:c.object,fitBoundsOptions:c.object,trackUserLocation:c.bool,showUserLocation:c.bool,showAccuracyCircle:c.bool,onViewStateChange:c.func,onViewportChange:c.func,onGeolocate:c.func}),kn=Object.assign({},Ze,{className:"",label:"Find My Location",disabledLabel:"Location Not Available",auto:!1,positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0,showAccuracyCircle:!0,onGeolocate:function(){}});function Tn(t,e){var n=e.context,r=e.props,i=function(t){var e=new(Y().LngLat)(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,r=e.toBounds(n);return[[r._ne.lng,r._ne.lat],[r._sw.lng,r._sw.lat]]}(t),o=n.viewport.fitBounds(i,r.fitBoundsOptions),s=o.longitude,a=o.latitude,u=o.zoom,c=Object.assign({},n.viewport,{longitude:s,latitude:a,zoom:u}),l=new ut(c),f=Object.assign({},l.getViewportProps(),ue),h=r.onViewportChange||n.onViewportChange||Mn;(r.onViewStateChange||n.onViewStateChange||Mn)({viewState:f}),h(f)}function Dn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=(0,u.useRef)(null),o=l((0,u.useState)(null),2),s=o[0],c=o[1],f=l((0,u.useState)(!1),2),h=f[0],d=f[1];(0,u.useEffect)((function(){var r;return n.map&&(void 0!==Sn?Promise.resolve(Sn):void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then((function(t){return Sn="denied"!==t.state})):(Sn=Boolean(window.navigator.geolocation),Promise.resolve(Sn))).then((function(o){d(o),i.current&&((r=function(t,e,n){var r=new(Y().GeolocateControl)(e);r._container=I.createElement("div"),r._map={on:function(){},_getUIString:function(){return""}},r._setupUI(!0),r._map=t.map,r._geolocateButton=n;var i=t.eventManager;return r.options.trackUserLocation&&i&&i.on("panstart",(function(){"ACTIVE_LOCK"===r._watchState&&(r._watchState="BACKGROUND",n.classList.add("mapboxgl-ctrl-geolocate-background"),n.classList.remove("mapboxgl-ctrl-geolocate-active"))})),r.on("geolocate",e.onGeolocate),r}(n,t,i.current))._updateCamera=function(t){return Tn(t,e)},c(r))})),function(){r&&r._clearWatch()}}),[n.map]);var p=(0,u.useCallback)((function(){s&&(s.options=e.props,s.trigger())}),[s]);(0,u.useEffect)((function(){t.auto&&p()}),[s,t.auto]),(0,u.useEffect)((function(){s&&s._onZoom()}),[n.viewport.zoom]);var g=t.className,m=t.label,y=t.disabledLabel,v=t.trackUserLocation,b=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cn(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:b,className:g},u.createElement("div",{key:"geolocate-control",className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},u.createElement("button",{key:"geolocate",className:"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate",ref:i,disabled:!h,"aria-pressed":!v,type:"button",title:h?m:y,"aria-label":h?m:y,onClick:p},u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))))}Dn.propTypes=Pn,Dn.defaultProps=kn;u.memo(Dn);function Fn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var jn=function(){},Ln=Object.assign({},We,{className:c.string,style:c.object,onViewStateChange:c.func,onViewportChange:c.func,showCompass:c.bool,showZoom:c.bool,zoomInLabel:c.string,zoomOutLabel:c.string,compassLabel:c.string}),Rn=Object.assign({},Ze,{className:"",showCompass:!0,showZoom:!0,zoomInLabel:"Zoom In",zoomOutLabel:"Zoom Out",compassLabel:"Reset North"});function In(t){return function(t,e){for(var n=(t||"").split(".").map(Number),r=(e||"").split(".").map(Number),i=0;i<3;i++){var o=n[i]||0,s=r[i]||0;if(o<s)return-1;if(o>s)return 1}return 0}(t,"1.6.0")>=0?2:1}function Nn(t,e,n){var r=t.viewport,i=new ut(Object.assign({},r,n)),o=Object.assign({},i.getViewportProps(),ue),s=e.onViewportChange||t.onViewportChange||jn;(e.onViewStateChange||t.onViewStateChange||jn)({viewState:o}),s(o)}function Bn(t,e,n,r){return u.createElement("button",{key:t,className:"mapboxgl-ctrl-icon mapboxgl-ctrl-".concat(t),type:"button",title:e,onClick:n},r||u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"}))}function zn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=t.className,o=t.showCompass,s=t.showZoom,c=t.zoomInLabel,l=t.zoomOutLabel,f=t.compassLabel,h=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Fn(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:h,className:i},u.createElement("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group",ref:r},s&&Bn("zoom-in",c,(function(){Nn(n,t,{zoom:n.viewport.zoom+1})})),s&&Bn("zoom-out",l,(function(){Nn(n,t,{zoom:n.viewport.zoom-1})})),o&&Bn("compass",f,(function(){Nn(n,t,{bearing:0,pitch:0})}),function(t){var e=(0,u.useMemo)((function(){return t.map?In(t.map.version):2}),[t.map]),n=t.viewport.bearing,r={transform:"rotate(".concat(-n,"deg)")};return 2===e?u.createElement("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",style:r}):u.createElement("span",{className:"mapboxgl-ctrl-compass-arrow",style:r})}(n))))}zn.propTypes=Ln,zn.defaultProps=Rn;u.memo(zn);function $n(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Un=Object.assign({},We,{className:c.string,style:c.object,maxWidth:c.number,unit:c.oneOf(["imperial","metric","nautical"])}),Vn=Object.assign({},Ze,{className:"",maxWidth:100,unit:"metric"});function Zn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=l((0,u.useState)(null),2),o=i[0],s=i[1];(0,u.useEffect)((function(){if(n.map){var t=new(Y().ScaleControl);t._map=n.map,t._container=r.current,s(t)}}),[n.map]),o&&(o.options=t,o._onMove());var c=(0,u.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$n(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute"},t.style)}),[t.style]);return u.createElement("div",{style:c,className:t.className},u.createElement("div",{ref:r,className:"mapboxgl-ctrl mapboxgl-ctrl-scale"}))}Zn.propTypes=Un,Zn.defaultProps=Vn;u.memo(Zn);var Wn="undefined"!==typeof window&&window.devicePixelRatio||1,qn=Object.assign({},We,{redraw:c.func.isRequired});function Gn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=l((0,u.useState)(null),2),o=i[0],s=i[1];(0,u.useEffect)((function(){s(r.current.getContext("2d"))}),[]);var a=n.viewport,c=n.isDragging;return o&&(o.save(),o.scale(Wn,Wn),t.redraw({width:a.width,height:a.height,ctx:o,isDragging:c,project:a.project,unproject:a.unproject}),o.restore()),u.createElement("canvas",{ref:r,width:a.width*Wn,height:a.height*Wn,style:{width:"".concat(a.width,"px"),height:"".concat(a.height,"px"),position:"absolute",left:0,top:0}})}Gn.propTypes=qn,Gn.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function Hn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Xn=Object.assign({},We,{redraw:c.func.isRequired,style:c.object});function Yn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=n.viewport,o=n.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Hn(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0,width:i.width,height:i.height},t.style);return u.createElement("div",{ref:r,style:s},t.redraw({width:i.width,height:i.height,isDragging:o,project:i.project,unproject:i.unproject}))}Yn.propTypes=Xn,Yn.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};function Kn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var Jn=Object.assign({},We,{redraw:c.func.isRequired,style:c.object});function Qn(t){var e=Ge(t),n=e.context,r=e.containerRef,i=n.viewport,o=n.isDragging,s=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Kn(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({position:"absolute",left:0,top:0},t.style);return u.createElement("svg",{width:i.width,height:i.height,ref:r,style:s},t.redraw({width:i.width,height:i.height,isDragging:o,project:i.project,unproject:i.unproject}))}Qn.propTypes=Jn,Qn.defaultProps={captureScroll:!1,captureDrag:!1,captureClick:!1,captureDoubleClick:!1,capturePointerMove:!1};Y()&&Y().setRTLTextPlugin},8216:function(t,e,n){"use strict";n.d(e,{zt:function(){return l},$j:function(){return V},I0:function(){return H},v9:function(){return J}});var r=n(7294),i=(n(5697),r.createContext(null));var o=function(t){t()},s=function(){return o};var a={notify:function(){},get:function(){return[]}};function u(t,e){var n,r=a;function i(){u.onStateChange&&u.onStateChange()}function o(){n||(n=e?e.addNestedSub(i):t.subscribe(i),r=function(){var t=s(),e=null,n=null;return{clear:function(){e=null,n=null},notify:function(){t((function(){for(var t=e;t;)t.callback(),t=t.next}))},get:function(){for(var t=[],n=e;n;)t.push(n),n=n.next;return t},subscribe:function(t){var r=!0,i=n={callback:t,next:null,prev:n};return i.prev?i.prev.next=i:e=i,function(){r&&null!==e&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}())}var u={addNestedSub:function(t){return o(),r.subscribe(t)},notifyNestedSubs:function(){r.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:o,tryUnsubscribe:function(){n&&(n(),n=void 0,r.clear(),r=a)},getListeners:function(){return r}};return u}var c="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?r.useLayoutEffect:r.useEffect;var l=function(t){var e=t.store,n=t.context,o=t.children,s=(0,r.useMemo)((function(){var t=u(e);return t.onStateChange=t.notifyNestedSubs,{store:e,subscription:t}}),[e]),a=(0,r.useMemo)((function(){return e.getState()}),[e]);c((function(){var t=s.subscription;return t.trySubscribe(),a!==e.getState()&&t.notifyNestedSubs(),function(){t.tryUnsubscribe(),t.onStateChange=null}}),[s,a]);var l=n||i;return r.createElement(l.Provider,{value:s},o)},f=n(7462),h=n(3366),d=n(8679),p=n.n(d),g=n(9864),m=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],y=["reactReduxForwardedRef"],v=[],b=[null,null];function x(t,e){var n=t[1];return[e.payload,n+1]}function w(t,e,n){c((function(){return t.apply(void 0,e)}),n)}function _(t,e,n,r,i,o,s){t.current=r,e.current=i,n.current=!1,o.current&&(o.current=null,s())}function E(t,e,n,r,i,o,s,a,u,c){if(t){var l=!1,f=null,h=function(){if(!l){var t,n,h=e.getState();try{t=r(h,i.current)}catch(d){n=d,f=d}n||(f=null),t===o.current?s.current||u():(o.current=t,a.current=t,s.current=!0,c({type:"STORE_UPDATED",payload:{error:n}}))}};n.onStateChange=h,n.trySubscribe(),h();return function(){if(l=!0,n.tryUnsubscribe(),n.onStateChange=null,f)throw f}}}var A=function(){return[null,0]};function O(t,e){void 0===e&&(e={});var n=e,o=n.getDisplayName,s=void 0===o?function(t){return"ConnectAdvanced("+t+")"}:o,a=n.methodName,c=void 0===a?"connectAdvanced":a,l=n.renderCountProp,d=void 0===l?void 0:l,O=n.shouldHandleStateChanges,S=void 0===O||O,C=n.storeKey,M=void 0===C?"store":C,P=(n.withRef,n.forwardRef),k=void 0!==P&&P,T=n.context,D=void 0===T?i:T,F=(0,h.Z)(n,m),j=D;return function(e){var n=e.displayName||e.name||"Component",i=s(n),o=(0,f.Z)({},F,{getDisplayName:s,methodName:c,renderCountProp:d,shouldHandleStateChanges:S,storeKey:M,displayName:i,wrappedComponentName:n,WrappedComponent:e}),a=F.pure;var l=a?r.useMemo:function(t){return t()};function m(n){var i=(0,r.useMemo)((function(){var t=n.reactReduxForwardedRef,e=(0,h.Z)(n,y);return[n.context,t,e]}),[n]),s=i[0],a=i[1],c=i[2],d=(0,r.useMemo)((function(){return s&&s.Consumer&&(0,g.isContextConsumer)(r.createElement(s.Consumer,null))?s:j}),[s,j]),p=(0,r.useContext)(d),m=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(p)&&Boolean(p.store);var O=m?n.store:p.store,C=(0,r.useMemo)((function(){return function(e){return t(e.dispatch,o)}(O)}),[O]),M=(0,r.useMemo)((function(){if(!S)return b;var t=u(O,m?null:p.subscription),e=t.notifyNestedSubs.bind(t);return[t,e]}),[O,m,p]),P=M[0],k=M[1],T=(0,r.useMemo)((function(){return m?p:(0,f.Z)({},p,{subscription:P})}),[m,p,P]),D=(0,r.useReducer)(x,v,A),F=D[0][0],L=D[1];if(F&&F.error)throw F.error;var R=(0,r.useRef)(),I=(0,r.useRef)(c),N=(0,r.useRef)(),B=(0,r.useRef)(!1),z=l((function(){return N.current&&c===I.current?N.current:C(O.getState(),c)}),[O,F,c]);w(_,[I,R,B,c,z,N,k]),w(E,[S,O,P,C,I,R,B,N,k,L],[O,P,C]);var $=(0,r.useMemo)((function(){return r.createElement(e,(0,f.Z)({},z,{ref:a}))}),[a,e,z]);return(0,r.useMemo)((function(){return S?r.createElement(d.Provider,{value:T},$):$}),[d,$,T])}var O=a?r.memo(m):m;if(O.WrappedComponent=e,O.displayName=m.displayName=i,k){var C=r.forwardRef((function(t,e){return r.createElement(O,(0,f.Z)({},t,{reactReduxForwardedRef:e}))}));return C.displayName=i,C.WrappedComponent=e,p()(C,e)}return p()(O,e)}}function S(t,e){return t===e?0!==t||0!==e||1/t===1/e:t!==t&&e!==e}function C(t,e){if(S(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(e,n[i])||!S(t[n[i]],e[n[i]]))return!1;return!0}function M(t){return function(e,n){var r=t(e,n);function i(){return r}return i.dependsOnOwnProps=!1,i}}function P(t){return null!==t.dependsOnOwnProps&&void 0!==t.dependsOnOwnProps?Boolean(t.dependsOnOwnProps):1!==t.length}function k(t,e){return function(e,n){n.displayName;var r=function(t,e){return r.dependsOnOwnProps?r.mapToProps(t,e):r.mapToProps(t)};return r.dependsOnOwnProps=!0,r.mapToProps=function(e,n){r.mapToProps=t,r.dependsOnOwnProps=P(t);var i=r(e,n);return"function"===typeof i&&(r.mapToProps=i,r.dependsOnOwnProps=P(i),i=r(e,n)),i},r}}var T=[function(t){return"function"===typeof t?k(t):void 0},function(t){return t?void 0:M((function(t){return{dispatch:t}}))},function(t){return t&&"object"===typeof t?M((function(e){return function(t,e){var n={},r=function(r){var i=t[r];"function"===typeof i&&(n[r]=function(){return e(i.apply(void 0,arguments))})};for(var i in t)r(i);return n}(t,e)})):void 0}];var D=[function(t){return"function"===typeof t?k(t):void 0},function(t){return t?void 0:M((function(){return{}}))}];function F(t,e,n){return(0,f.Z)({},n,t,e)}var j=[function(t){return"function"===typeof t?function(t){return function(e,n){n.displayName;var r,i=n.pure,o=n.areMergedPropsEqual,s=!1;return function(e,n,a){var u=t(e,n,a);return s?i&&o(u,r)||(r=u):(s=!0,r=u),r}}}(t):void 0},function(t){return t?void 0:function(){return F}}],L=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function R(t,e,n,r){return function(i,o){return n(t(i,o),e(r,o),o)}}function I(t,e,n,r,i){var o,s,a,u,c,l=i.areStatesEqual,f=i.areOwnPropsEqual,h=i.areStatePropsEqual,d=!1;function p(i,d){var p=!f(d,s),g=!l(i,o);return o=i,s=d,p&&g?(a=t(o,s),e.dependsOnOwnProps&&(u=e(r,s)),c=n(a,u,s)):p?(t.dependsOnOwnProps&&(a=t(o,s)),e.dependsOnOwnProps&&(u=e(r,s)),c=n(a,u,s)):g?function(){var e=t(o,s),r=!h(e,a);return a=e,r&&(c=n(a,u,s)),c}():c}return function(i,l){return d?p(i,l):(a=t(o=i,s=l),u=e(r,s),c=n(a,u,s),d=!0,c)}}function N(t,e){var n=e.initMapStateToProps,r=e.initMapDispatchToProps,i=e.initMergeProps,o=(0,h.Z)(e,L),s=n(t,o),a=r(t,o),u=i(t,o);return(o.pure?I:R)(s,a,u,t,o)}var B=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function z(t,e,n){for(var r=e.length-1;r>=0;r--){var i=e[r](t);if(i)return i}return function(e,r){throw new Error("Invalid value of type "+typeof t+" for "+n+" argument when connecting component "+r.wrappedComponentName+".")}}function $(t,e){return t===e}function U(t){var e=void 0===t?{}:t,n=e.connectHOC,r=void 0===n?O:n,i=e.mapStateToPropsFactories,o=void 0===i?D:i,s=e.mapDispatchToPropsFactories,a=void 0===s?T:s,u=e.mergePropsFactories,c=void 0===u?j:u,l=e.selectorFactory,d=void 0===l?N:l;return function(t,e,n,i){void 0===i&&(i={});var s=i,u=s.pure,l=void 0===u||u,p=s.areStatesEqual,g=void 0===p?$:p,m=s.areOwnPropsEqual,y=void 0===m?C:m,v=s.areStatePropsEqual,b=void 0===v?C:v,x=s.areMergedPropsEqual,w=void 0===x?C:x,_=(0,h.Z)(s,B),E=z(t,o,"mapStateToProps"),A=z(e,a,"mapDispatchToProps"),O=z(n,c,"mergeProps");return r(d,(0,f.Z)({methodName:"connect",getDisplayName:function(t){return"Connect("+t+")"},shouldHandleStateChanges:Boolean(t),initMapStateToProps:E,initMapDispatchToProps:A,initMergeProps:O,pure:l,areStatesEqual:g,areOwnPropsEqual:y,areStatePropsEqual:b,areMergedPropsEqual:w},_))}}var V=U();function Z(){return(0,r.useContext)(i)}function W(t){void 0===t&&(t=i);var e=t===i?Z:function(){return(0,r.useContext)(t)};return function(){return e().store}}var q=W();function G(t){void 0===t&&(t=i);var e=t===i?q:W(t);return function(){return e().dispatch}}var H=G(),X=function(t,e){return t===e};function Y(t){void 0===t&&(t=i);var e=t===i?Z:function(){return(0,r.useContext)(t)};return function(t,n){void 0===n&&(n=X);var i=e(),o=function(t,e,n,i){var o,s=(0,r.useReducer)((function(t){return t+1}),0)[1],a=(0,r.useMemo)((function(){return u(n,i)}),[n,i]),l=(0,r.useRef)(),f=(0,r.useRef)(),h=(0,r.useRef)(),d=(0,r.useRef)(),p=n.getState();try{if(t!==f.current||p!==h.current||l.current){var g=t(p);o=void 0!==d.current&&e(g,d.current)?d.current:g}else o=d.current}catch(m){throw l.current&&(m.message+="\nThe error may be correlated with this previous error:\n"+l.current.stack+"\n\n"),m}return c((function(){f.current=t,h.current=p,d.current=o,l.current=void 0})),c((function(){function t(){try{var t=n.getState();if(t===h.current)return;var r=f.current(t);if(e(r,d.current))return;d.current=r,h.current=t}catch(m){l.current=m}s()}return a.onStateChange=t,a.trySubscribe(),t(),function(){return a.tryUnsubscribe()}}),[n,a]),o}(t,n,i.store,i.subscription);return(0,r.useDebugValue)(o),o}}var K,J=Y(),Q=n(3935);K=Q.unstable_batchedUpdates,o=K},38:function(t,e,n){"use strict";n.d(e,{Z:function(){return Fb}});var r={};n.r(r),n.d(r,{JsonPatchError:function(){return E},_areEquals:function(){return F},applyOperation:function(){return M},applyPatch:function(){return P},applyReducer:function(){return k},deepClone:function(){return A},getValueByPointer:function(){return C},validate:function(){return D},validator:function(){return T}});var i={};n.r(i),n.d(i,{compare:function(){return $},generate:function(){return B},observe:function(){return N},unobserve:function(){return I}});var o={};n.r(o),n.d(o,{accessPathDepth:function(){return me},accessPathWithDatum:function(){return le},compile:function(){return Cy},contains:function(){return Zt},deepEqual:function(){return It},deleteNestedProperty:function(){return ue},duplicate:function(){return Nt},entries:function(){return ie},every:function(){return qt},fieldIntersection:function(){return te},flatAccessWithDatum:function(){return fe},getFirstDefined:function(){return ye},hasIntersection:function(){return Jt},hash:function(){return Ut},internalField:function(){return we},isBoolean:function(){return oe},isEmpty:function(){return ee},isEqual:function(){return Yt},isInternalField:function(){return _e},isNullOrFalse:function(){return Vt},isNumeric:function(){return Ae},keys:function(){return ne},logicalExpr:function(){return ae},mergeDeep:function(){return Gt},normalize:function(){return vl},normalizeAngle:function(){return Ee},omit:function(){return zt},pick:function(){return Bt},prefixGenerator:function(){return Qt},removePathFromField:function(){return ge},replaceAll:function(){return pe},replacePathInField:function(){return de},resetIdCounter:function(){return xe},setEqual:function(){return Kt},some:function(){return Wt},stringify:function(){return $t},titleCase:function(){return ce},unique:function(){return Xt},uniqueId:function(){return be},vals:function(){return re},varName:function(){return se},version:function(){return My}});var s={};n.r(s),n.d(s,{dark:function(){return Ty},excel:function(){return Fy},fivethirtyeight:function(){return Ny},ggplot2:function(){return zy},googlecharts:function(){return av},latimes:function(){return qy},quartz:function(){return Xy},urbaninstitute:function(){return rv},version:function(){return uv},vox:function(){return Ky}});var a=n(5697),u=n.n(a),c=n(7294);const l={};function f(t=l,e=l){const n=Object.keys(t),r=Object.keys(e);return t===e||n.length===r.length&&n.every((n=>t[n]===e[n]))}var h=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=Object.prototype.hasOwnProperty;function p(t,e){return d.call(t,e)}function g(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);e=[];for(var r in t)p(t,r)&&e.push(r);return e}function m(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function y(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function v(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function b(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function x(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(x(t[e]))return!0}else if("object"===typeof t){var r=g(t),i=r.length;for(e=0;e<i;e++)if(x(t[r[e]]))return!0}return!1}function w(t,e){var n=[t];for(var r in e){var i="object"===typeof e[r]?JSON.stringify(e[r],null,2):e[r];"undefined"!==typeof i&&n.push(r+": "+i)}return n.join("\n")}var _=function(t){function e(e,n,r,i,o){var s=this.constructor,a=t.call(this,w(e,{name:n,index:r,operation:i,tree:o}))||this;return a.name=n,a.index=r,a.operation=i,a.tree=o,Object.setPrototypeOf(a,s.prototype),a.message=w(e,{name:n,index:r,operation:i,tree:o}),a}return h(e,t),e}(Error),E=_,A=m,O={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=C(n,this.path);r&&(r=m(r));var i=M(n,{op:"remove",path:this.from}).removed;return M(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=C(n,this.from);return M(n,{op:"add",path:this.path,value:m(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:F(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},S={add:function(t,e,n){return y(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:O.move,copy:O.copy,test:O.test,_get:O._get};function C(t,e){if(""==e)return t;var n={op:"_get",path:e};return M(t,n),n.value}function M(t,e,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(e,0,t,e.path):T(e,0)),""===e.path){var s={newDocument:t};if("add"===e.op)return s.newDocument=e.value,s;if("replace"===e.op)return s.newDocument=e.value,s.removed=t,s;if("move"===e.op||"copy"===e.op)return s.newDocument=C(t,e.from),"move"===e.op&&(s.removed=t),s;if("test"===e.op){if(s.test=F(t,e.value),!1===s.test)throw new E("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return s.newDocument=t,s}if("remove"===e.op)return s.removed=t,s.newDocument=null,s;if("_get"===e.op)return e.value=t,s;if(n)throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,t);return s}r||(t=m(t));var a=(e.path||"").split("/"),u=t,c=1,l=a.length,f=void 0,h=void 0,d=void 0;for(d="function"==typeof n?n:T;;){if((h=a[c])&&-1!=h.indexOf("~")&&(h=b(h)),i&&"__proto__"==h)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===f&&(void 0===u[h]?f=a.slice(0,c).join("/"):c==l-1&&(f=e.path),void 0!==f&&d(e,0,t,f)),c++,Array.isArray(u)){if("-"===h)h=u.length;else{if(n&&!y(h))throw new E("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,t);y(h)&&(h=~~h)}if(c>=l){if(n&&"add"===e.op&&h>u.length)throw new E("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,t);if(!1===(s=S[e.op].call(e,u,h,t)).test)throw new E("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return s}}else if(c>=l){if(!1===(s=O[e.op].call(e,u,h,t)).test)throw new E("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return s}if(u=u[h],n&&c<l&&(!u||"object"!==typeof u))throw new E("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,e,t)}}function P(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=m(t));for(var o=new Array(e.length),s=0,a=e.length;s<a;s++)o[s]=M(t,e[s],n,!0,i,s),t=o[s].newDocument;return o.newDocument=t,o}function k(t,e,n){var r=M(t,e);if(!1===r.test)throw new E("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function T(t,e,n,r){if("object"!==typeof t||null===t||Array.isArray(t))throw new E("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!O[t.op])throw new E("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!==typeof t.path)throw new E("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new E('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!==typeof t.from)throw new E("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&x(t.value))throw new E("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new E("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new E("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var s=D([{op:"_get",path:t.from,value:void 0}],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new E("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function D(t,e,n){try{if(!Array.isArray(t))throw new E("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)P(m(e),m(t),n||!0);else{n=n||T;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof E)return i;throw i}}function F(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,o=Array.isArray(t),s=Array.isArray(e);if(o&&s){if((r=t.length)!=e.length)return!1;for(n=r;0!==n--;)if(!F(t[n],e[n]))return!1;return!0}if(o!=s)return!1;var a=Object.keys(t);if((r=a.length)!==Object.keys(e).length)return!1;for(n=r;0!==n--;)if(!e.hasOwnProperty(a[n]))return!1;for(n=r;0!==n--;)if(!F(t[i=a[n]],e[i]))return!1;return!0}return t!==t&&e!==e}var j=new WeakMap,L=function(t){this.observers=new Map,this.obj=t},R=function(t,e){this.callback=t,this.observer=e};function I(t,e){e.unobserve()}function N(t,e){var n,r=function(t){return j.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new L(t),j.set(t,r);if(n)return n;if(n={},r.value=m(t),e){n.callback=e,n.next=null;var o=function(){B(n)},s=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!==typeof window&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return n.patches=[],n.object=t,n.unobserve=function(){B(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!==typeof window&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},r.observers.set(e,new R(e,n)),n}function B(t,e){void 0===e&&(e=!1);var n=j.get(t.object);z(n.value,t.object,t.patches,"",e),t.patches.length&&P(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function z(t,e,n,r,i){if(e!==t){"function"===typeof e.toJSON&&(e=e.toJSON());for(var o=g(e),s=g(t),a=!1,u=s.length-1;u>=0;u--){var c=t[f=s[u]];if(!p(e,f)||void 0===e[f]&&void 0!==c&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+v(f),value:m(c)}),n.push({op:"remove",path:r+"/"+v(f)}),a=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}),!0);else{var l=e[f];"object"==typeof c&&null!=c&&"object"==typeof l&&null!=l&&Array.isArray(c)===Array.isArray(l)?z(c,l,n,r+"/"+v(f),i):c!==l&&(!0,i&&n.push({op:"test",path:r+"/"+v(f),value:m(c)}),n.push({op:"replace",path:r+"/"+v(f),value:m(l)}))}}if(a||o.length!=s.length)for(u=0;u<o.length;u++){var f;p(t,f=o[u])||void 0===e[f]||n.push({op:"add",path:r+"/"+v(f),value:m(e[f])})}}}function $(t,e,n){void 0===n&&(n=!1);var r=[];return z(t,e,r,"",n),r}Object.assign({},r,i,{JsonPatchError:_,deepClone:m,escapePathComponent:v,unescapePathComponent:b});var U=n(1801),V=n.n(U),Z=n(2543),W=n(5277);var q={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},G={"*":(t,e)=>t*e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,">":(t,e)=>t>e,"<":(t,e)=>t<e,"<=":(t,e)=>t<=e,">=":(t,e)=>t>=e,"==":(t,e)=>t==e,"!=":(t,e)=>t!=e,"===":(t,e)=>t===e,"!==":(t,e)=>t!==e,"&":(t,e)=>t&e,"|":(t,e)=>t|e,"^":(t,e)=>t^e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e},H={"+":t=>+t,"-":t=>-t,"~":t=>~t,"!":t=>!t};const X=Array.prototype.slice,Y=(t,e,n)=>{const r=n?n(e[0]):e[0];return r[t].apply(r,X.call(e,1))};var K={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(t,e,n)=>Math.max(e,Math.min(n,t)),now:Date.now,utc:Date.UTC,datetime:(t,e,n,r,i,o,s)=>new Date(t,e||0,null!=n?n:1,r||0,i||0,o||0,s||0),date:t=>new Date(t).getDate(),day:t=>new Date(t).getDay(),year:t=>new Date(t).getFullYear(),month:t=>new Date(t).getMonth(),hours:t=>new Date(t).getHours(),minutes:t=>new Date(t).getMinutes(),seconds:t=>new Date(t).getSeconds(),milliseconds:t=>new Date(t).getMilliseconds(),time:t=>new Date(t).getTime(),timezoneoffset:t=>new Date(t).getTimezoneOffset(),utcdate:t=>new Date(t).getUTCDate(),utcday:t=>new Date(t).getUTCDay(),utcyear:t=>new Date(t).getUTCFullYear(),utcmonth:t=>new Date(t).getUTCMonth(),utchours:t=>new Date(t).getUTCHours(),utcminutes:t=>new Date(t).getUTCMinutes(),utcseconds:t=>new Date(t).getUTCSeconds(),utcmilliseconds:t=>new Date(t).getUTCMilliseconds(),length:t=>t.length,join:function(){return Y("join",arguments)},indexof:function(){return Y("indexOf",arguments)},lastindexof:function(){return Y("lastIndexOf",arguments)},slice:function(){return Y("slice",arguments)},reverse:t=>t.slice().reverse(),parseFloat:parseFloat,parseInt:parseInt,upper:t=>String(t).toUpperCase(),lower:t=>String(t).toLowerCase(),substring:function(){return Y("substring",arguments,String)},split:function(){return Y("split",arguments,String)},replace:function(){return Y("replace",arguments,String)},trim:t=>String(t).trim(),regexp:RegExp,test:(t,e)=>RegExp(t).test(e)};const J=["view","item","group","xy","x","y"],Q={Literal:(t,e)=>e.value,Identifier:(t,e)=>{const n=e.name;return t.memberDepth>0?n:"datum"===n?t.datum:"event"===n?t.event:"item"===n?t.item:q[n]||t.params["$"+n]},MemberExpression:(t,e)=>{const n=!e.computed,r=t(e.object);n&&(t.memberDepth+=1);const i=t(e.property);return n&&(t.memberDepth-=1),r[i]},CallExpression:(t,e)=>{const n=e.arguments;let r=e.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?t(n[0])?t(n[1]):t(n[2]):(t.fn[r]||K[r]).apply(t.fn,n.map(t))},ArrayExpression:(t,e)=>e.elements.map(t),BinaryExpression:(t,e)=>G[e.operator](t(e.left),t(e.right)),UnaryExpression:(t,e)=>H[e.operator](t(e.argument)),ConditionalExpression:(t,e)=>t(e.test)?t(e.consequent):t(e.alternate),LogicalExpression:(t,e)=>"&&"===e.operator?t(e.left)&&t(e.right):t(e.left)||t(e.right),ObjectExpression:(t,e)=>e.properties.reduce(((e,n)=>{t.memberDepth+=1;const r=t(n.key);return t.memberDepth-=1,e[r]=t(n.value),e}),{})};function tt(t,e,n,r,i,o){const s=t=>Q[t.type](s,t);return s.memberDepth=0,s.fn=Object.create(e),s.params=n,s.datum=r,s.event=i,s.item=o,J.forEach((t=>s.fn[t]=(...e)=>i.vega[t](...e))),s(t)}var et={operator(t,e){const n=e.ast,r=t.functions;return t=>tt(n,r,t)},parameter(t,e){const n=e.ast,r=t.functions;return(t,e)=>tt(n,r,e,t)},event(t,e){const n=e.ast,r=t.functions;return t=>tt(n,r,void 0,void 0,t)},handler(t,e){const n=e.ast,r=t.functions;return(t,e)=>{const i=e.item&&e.item.datum;return tt(n,r,t,i,e)}},encode(t,e){const{marktype:n,channels:r}=e,i=t.functions,o="group"===n||"image"===n||"rect"===n;return(t,e)=>{const s=t.datum;let a,u=0;for(const n in r)a=tt(r[n].ast,i,e,s,void 0,t),t[n]!==a&&(t[n]=a,u=1);return"rule"!==n&&function(t,e,n){let r;e.x2&&(e.x?(n&&t.x>t.x2&&(r=t.x,t.x=t.x2,t.x2=r),t.width=t.x2-t.x):t.x=t.x2-(t.width||0)),e.xc&&(t.x=t.xc-(t.width||0)/2),e.y2&&(e.y?(n&&t.y>t.y2&&(r=t.y,t.y=t.y2,t.y2=r),t.height=t.y2-t.y):t.y=t.y2-(t.height||0)),e.yc&&(t.y=t.yc-(t.height||0)/2)}(t,r,o),u}}};function nt(t,e,n){return t.fields=e||[],t.fname=n,t}function rt(t){return 1===t.length?it(t[0]):ot(t)}const it=t=>function(e){return e[t]},ot=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function st(t){throw Error(t)}function at(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o||r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||st("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&st("Access path missing closing bracket: "+t),s&&st("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function ut(t,e,n){const r=at(t);return t=1===r.length?r[0]:t,nt((n&&n.get||rt)(r),[t],e||t)}ut("id");const ct=nt((t=>t),[],"identity");nt((()=>0),[],"zero"),nt((()=>1),[],"one"),nt((()=>!0),[],"true"),nt((()=>!1),[],"false");function lt(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}var ft=Array.isArray;function ht(t){return t===Object(t)}const dt=t=>"__proto__"!==t;function pt(...t){return t.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=mt(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;gt(t,n,e[n],r)}return t}),{})}function gt(t,e,n,r){if(!dt(e))return;let i,o;if(ht(n)&&!ft(n))for(i in o=ht(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?gt(o,i,n[i]):dt(i)&&(o[i]=n[i]);else t[e]=n}function mt(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function yt(t){return null!=t?ft(t)?t:[t]:[]}function vt(t){return"function"===typeof t}const bt=Object.prototype.hasOwnProperty;function xt(t,e){return bt.call(t,e)}function wt(t){return"boolean"===typeof t}function _t(t){return"number"===typeof t}function Et(t){return"string"===typeof t}function At(t){return ft(t)?"["+t.map(At)+"]":ht(t)||Et(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Ot(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function t(){var e=isNaN(arguments[0])?1:Number(arguments[0]);return e?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,t.call(r,e-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(t){return Array.prototype.map.apply(this,arguments).flat()},writable:!0});var St=n(6313),Ct=n.n(St),Mt=n(4063),Pt=n.n(Mt),kt=n(5035),Tt=n.n(kt);function Dt(t){return!!t.or}function Ft(t){return!!t.and}function jt(t){return!!t.not}function Lt(t,e){if(jt(t))Lt(t.not,e);else if(Ft(t))for(const n of t.and)Lt(n,e);else if(Dt(t))for(const n of t.or)Lt(n,e);else e(t)}function Rt(t,e){return jt(t)?{not:Rt(t.not,e)}:Ft(t)?{and:t.and.map((t=>Rt(t,e)))}:Dt(t)?{or:t.or.map((t=>Rt(t,e)))}:e(t)}const It=Pt(),Nt=Ct();function Bt(t,e){const n={};for(const r of e)xt(t,r)&&(n[r]=t[r]);return n}function zt(t,e){const n=Object.assign({},t);for(const r of e)delete n[r];return n}Set.prototype.toJSON=function(){return`Set(${[...this].map((t=>Tt()(t))).join(",")})`};const $t=Tt();function Ut(t){if(_t(t))return t;const e=Et(t)?t:Tt()(t);if(e.length<250)return e;let n=0;for(let r=0;r<e.length;r++){n=(n<<5)-n+e.charCodeAt(r),n&=n}return n}function Vt(t){return!1===t||null===t}function Zt(t,e){return t.includes(e)}function Wt(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function qt(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function Gt(t,...e){for(const n of e)Ht(t,null!==n&&void 0!==n?n:{});return t}function Ht(t,e){for(const n of ne(e))gt(t,n,e[n],!0)}function Xt(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function Yt(t,e){const n=ne(t),r=ne(e);if(n.length!==r.length)return!1;for(const i of n)if(t[i]!==e[i])return!1;return!0}function Kt(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function Jt(t,e){for(const n of t)if(e.has(n))return!0;return!1}function Qt(t){const e=new Set;for(const n of t){const t=at(n).map(((t,e)=>0===e?t:`[${t}]`)),r=t.map(((e,n)=>t.slice(0,n+1).join("")));for(const n of r)e.add(n)}return e}function te(t,e){return void 0===t||void 0===e||Jt(Qt(t),Qt(e))}function ee(t){return 0===ne(t).length}const ne=Object.keys,re=Object.values,ie=Object.entries;function oe(t){return!0===t||!1===t}function se(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function ae(t,e){return jt(t)?`!(${ae(t.not,e)})`:Ft(t)?`(${t.and.map((t=>ae(t,e))).join(") && (")})`:Dt(t)?`(${t.or.map((t=>ae(t,e))).join(") || (")})`:e(t)}function ue(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&ue(t[n],e)&&delete t[n],ee(t)}function ce(t){return t.charAt(0).toUpperCase()+t.substr(1)}function le(t,e="datum"){const n=at(t),r=[];for(let i=1;i<=n.length;i++){const t=`[${n.slice(0,i).map(At).join("][")}]`;r.push(`${e}${t}`)}return r.join(" && ")}function fe(t,e="datum"){return`${e}[${At(at(t).join("."))}]`}function he(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function de(t){return`${at(t).map(he).join("\\.")}`}function pe(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function ge(t){return`${at(t).join(".")}`}function me(t){return t?at(t).length:0}function ye(...t){for(const e of t)if(void 0!==e)return e}let ve=42;function be(t){const e=++ve;return t?String(t)+e:e}function xe(){ve=42}function we(t){return _e(t)?t:`__${t}`}function _e(t){return t.startsWith("__")}function Ee(t){if(void 0!==t)return(t%360+360)%360}function Ae(t){return!!_t(t)||!isNaN(t)&&!isNaN(parseFloat(t))}var Oe=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Se="row",Ce="column",Me="facet",Pe="x",ke="y",Te="x2",De="y2",Fe="radius",je="radius2",Le="theta",Re="theta2",Ie="latitude",Ne="longitude",Be="latitude2",ze="longitude2",$e="color",Ue="fill",Ve="stroke",Ze="shape",We="size",qe="angle",Ge="opacity",He="fillOpacity",Xe="strokeOpacity",Ye="strokeWidth",Ke="strokeDash",Je="text",Qe="order",tn="detail",en="key",nn="tooltip",rn="href",on="url",sn="description",an={theta:1,theta2:1,radius:1,radius2:1};function un(t){return t in an}const cn={longitude:1,longitude2:1,latitude:1,latitude2:1};const ln=ne(cn),fn=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),an),cn),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function hn(t){return t===$e||t===Ue||t===Ve}const dn={row:1,column:1,facet:1},pn=ne(dn),gn=Object.assign(Object.assign({},fn),dn),mn=ne(gn),{order:yn,detail:vn,tooltip:bn}=gn,xn=Oe(gn,["order","detail","tooltip"]),{row:wn,column:_n,facet:En}=xn,An=Oe(xn,["row","column","facet"]);ne(xn),ne(An);function On(t){return!!gn[t]}const Sn=[Te,De,Be,ze,Re,je];function Cn(t){return Mn(t)!==t}function Mn(t){switch(t){case Te:return Pe;case De:return ke;case Be:return Ie;case ze:return Ne;case Re:return Le;case je:return Fe}return t}function Pn(t){if(un(t))switch(t){case Le:return"startAngle";case Re:return"endAngle";case Fe:return"outerRadius";case je:return"innerRadius"}return t}function kn(t){switch(t){case Pe:return Te;case ke:return De;case Ie:return Be;case Ne:return ze;case Le:return Re;case Fe:return je}}function Tn(t){switch(t){case Pe:case Te:return"width";case ke:case De:return"height"}}ne(fn);const{x:Dn,y:Fn,x2:jn,y2:Ln,latitude:Rn,longitude:In,latitude2:Nn,longitude2:Bn,theta:zn,theta2:$n,radius:Un,radius2:Vn}=fn,Zn=Oe(fn,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),Wn=ne(Zn),qn={x:1,y:1},Gn=ne(qn);function Hn(t){return t in qn}const Xn={theta:1,radius:1},Yn=ne(Xn);function Kn(t){return"width"===t?Pe:ke}const{text:Jn,tooltip:Qn,href:tr,url:er,description:nr,detail:rr,key:ir,order:or}=Zn,sr=Oe(Zn,["text","tooltip","href","url","description","detail","key","order"]),ar=ne(sr);const ur=Object.assign(Object.assign(Object.assign({},qn),Xn),sr),cr=ne(ur);function lr(t){return!!ur[t]}function fr(t,e){return function(t){switch(t){case $e:case Ue:case Ve:case sn:case tn:case en:case nn:case rn:case Qe:case Ge:case He:case Xe:case Ye:case Me:case Se:case Ce:return hr;case Pe:case ke:case Ie:case Ne:return pr;case Te:case De:case Be:case ze:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case We:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Ke:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case Ze:return{point:"always",geoshape:"always"};case Je:return{text:"always"};case qe:return{point:"always",square:"always",text:"always"};case on:return{image:"always"};case Le:case Fe:return{text:"always",arc:"always"};case Re:case je:return{arc:"always"}}}(t)[e]}const hr={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:dr}=hr,pr=Oe(hr,["geoshape"]);function gr(t){switch(t){case Pe:case ke:case Le:case Fe:case We:case qe:case Ye:case Ge:case He:case Xe:case Te:case De:case Re:case je:return;case Me:case Se:case Ce:case Ze:case Ke:case Je:case nn:case rn:case on:case sn:return"discrete";case $e:case Ue:case Ve:return"flexible";case Ie:case Ne:case Be:case ze:case tn:case en:case Qe:return}}const mr={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},yr={count:1,min:1,max:1};function vr(t){return!!t&&!!t.argmin}function br(t){return!!t&&!!t.argmax}ne(mr);function xr(t){return Et(t)&&!!mr[t]}const wr=["count","valid","missing","distinct"];function _r(t){return Et(t)&&Zt(wr,t)}const Er=["count","sum","distinct","valid","missing"],Ar=Ot(["mean","average","median","q1","q3","min","max"]);function Or(t){return wt(t)&&(t=za(t,void 0)),"bin"+ne(t).map((e=>Pr(t[e])?se(`_${e}_${ie(t[e])}`):se(`_${e}_${t[e]}`))).join("")}function Sr(t){return!0===t||Mr(t)&&!t.binned}function Cr(t){return"binned"===t||Mr(t)&&!0===t.binned}function Mr(t){return ht(t)}function Pr(t){return null===t||void 0===t?void 0:t.param}function kr(t){switch(t){case Se:case Ce:case We:case $e:case Ue:case Ve:case Ye:case Ge:case He:case Xe:case Ze:return 6;case Ke:return 4;default:return 10}}function Tr(t){return t&&!!t.expr}function Dr(t){const e=ne(t||{}),n={};for(const r of e)n[r]=Zr(t[r]);return n}var Fr=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function jr(t){const{anchor:e,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:u,subtitleFont:c,subtitleFontSize:l,subtitleFontStyle:f,subtitleFontWeight:h,subtitleLineHeight:d,subtitlePadding:p}=t,g=Fr(t,["anchor","frame","offset","orient","angle","limit","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),m=Object.assign(Object.assign({},g),a?{fill:a}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e?{anchor:e}:{}),n?{frame:n}:{}),r?{offset:r}:{}),i?{orient:i}:{}),void 0!==o?{angle:o}:{}),void 0!==s?{limit:s}:{}),v=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{subtitleColor:u}:{}),c?{subtitleFont:c}:{}),l?{subtitleFontSize:l}:{}),f?{subtitleFontStyle:f}:{}),h?{subtitleFontWeight:h}:{}),d?{subtitleLineHeight:d}:{}),p?{subtitlePadding:p}:{});return{titleMarkConfig:m,subtitleMarkConfig:Bt(t,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:y,subtitle:v}}function Lr(t){return Et(t)||ft(t)&&Et(t[0])}function Rr(t){return t&&!!t.signal}function Ir(t){return!!t.step}function Nr(t){return!ft(t)&&("field"in t&&"data"in t)}const Br=ne({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),zr={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},$r=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];var Ur=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Vr(t){const e=ft(t.condition)?t.condition.map(Wr):Wr(t.condition);return Object.assign(Object.assign({},Zr(t)),{condition:e})}function Zr(t){if(Tr(t)){const{expr:e}=t,n=Ur(t,["expr"]);return Object.assign({signal:e},n)}return t}function Wr(t){if(Tr(t)){const{expr:e}=t,n=Ur(t,["expr"]);return Object.assign({signal:e},n)}return t}function qr(t){if(Tr(t)){const{expr:e}=t,n=Ur(t,["expr"]);return Object.assign({signal:e},n)}return Rr(t)?t:void 0!==t?{value:t}:void 0}function Gr(t){return Rr(t)?t.signal:At(t.value)}function Hr(t){return Rr(t)?t.signal:null==t?null:At(t)}function Xr(t){var e;return[].concat(t.type,null!==(e=t.style)&&void 0!==e?e:[])}function Yr(t,e,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?Kr(t,e,n,r):void 0}function Kr(t,e,n,{vgChannel:r}={}){return ye(r?Jr(t,e,n.style):void 0,Jr(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function Jr(t,e,n){return Qr(t,Xr(e),n)}function Qr(t,e,n){let r;e=yt(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function ti(t,e){return yt(t).reduce(((t,n)=>{var r;return t.field.push(Sa(n,e)),t.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),t}),{field:[],order:[]})}function ei(t,e){const n=[...t];return e.forEach((t=>{for(const e of n)if(It(e,t))return;n.push(t)})),n}function ni(t,e){return It(t,e)||!e?t:t?[...yt(t),...yt(e)].join(", "):e}function ri(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((Lr(n)||Rr(n))&&(Lr(r)||Rr(r)))return{explicit:t.explicit,value:ni(n,r)};if(Lr(n)||Rr(n))return{explicit:t.explicit,value:n};if(Lr(r)||Rr(r))return{explicit:t.explicit,value:r};if(!Lr(n)&&!Rr(n)&&!Lr(r)&&!Rr(r))return{explicit:t.explicit,value:ei(n,r)};throw new Error("It should never reach here")}function ii(t){return`Invalid specification ${$t(t)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const oi='Autosize "fit" only works for single views and layered views.';function si(t){return`${"width"==t?"Width":"Height"} "container" only works for single views and layered views.`}function ai(t){return`${"width"==t?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==t?"x":"y"}".`}function ui(t){return t?`Dropping "fit-${t}" because spec has discrete ${Tn(t)}.`:'Dropping "fit" because spec has discrete size.'}function ci(t){return`Unknown field for ${t}. Cannot calculate view size.`}function li(t){return`Cannot project a selection on encoding channel "${t}", which has no field.`}function fi(t,e){return`Cannot project a selection on encoding channel "${t}" as it uses an aggregate function ("${e}").`}function hi(t){return`Selection not supported for ${t} yet.`}const di="The same selection must be used to override scale domains in a layered view.";function pi(t){return`The "columns" property cannot be used when "${t}" has nested row/column.`}function gi(t,e,n){return`An ancestor parsed field "${t}" as ${n} but a child wants to parse the field as ${e}.`}function mi(t){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${t} are dropped.`}function yi(t){return`Invalid field type "${t}".`}function vi(t,e){const{fill:n,stroke:r}=e;return`Dropping color ${t} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function bi(t,e){return`Dropping ${$t(t)} from channel "${e}" since it does not contain any data field, datum, value, or signal.`}function xi(t,e,n){return`${t} dropped as it is incompatible with "${e}"${n?` when ${n}`:""}.`}function wi(t){return`${t} encoding should be discrete (ordinal / nominal / binned).`}function _i(t){return`${t} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Ei(t,e){return`Using discrete channel "${t}" to encode "${e}" field can be misleading as it does not encode ${"ordinal"===e?"order":"magnitude"}.`}function Ai(t){return`Using unaggregated domain with raw field has no effect (${$t(t)}).`}function Oi(t){return`Unaggregated domain not applicable for "${t}" since it produces values outside the origin domain of the source data.`}function Si(t){return`Unaggregated domain is currently unsupported for log scale (${$t(t)}).`}function Ci(t,e,n){return`${n}-scale's "${e}" is dropped as it does not work with ${t} scale.`}function Mi(t){return`The step for "${t}" is dropped because the ${"width"===t?"x":"y"} is continuous.`}const Pi="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function ki(t,e){return`Invalid ${t}: ${$t(e)}.`}function Ti(t){return`1D error band does not support ${t}.`}function Di(t){return`Channel ${t} is required for "binned" bin.`}const Fi=function(t,e){let n=t||0;return{level(t){return arguments.length?(n=+t,this):n},error(){return n>=1&&lt(e||"error","ERROR",arguments),this},warn(){return n>=2&&lt(e||"warn","WARN",arguments),this},info(){return n>=3&&lt(e||"log","INFO",arguments),this},debug(){return n>=4&&lt(e||"log","DEBUG",arguments),this}}}(2);let ji=Fi;function Li(){return ji=Fi,ji}function Ri(...t){ji.warn(...t)}function Ii(t){if(t&&ht(t))for(const e of qi)if(e in t)return!0;return!1}new WeakMap;const Ni=["january","february","march","april","may","june","july","august","september","october","november","december"],Bi=Ni.map((t=>t.substr(0,3))),zi=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],$i=zi.map((t=>t.substr(0,3)));function Ui(t,e){const n=[];if(e&&void 0!==t.day&&ne(t).length>1&&(Ri(function(t){return`Dropping day from datetime ${$t(t)} as day cannot be combined with other units.`}(t)),delete(t=Nt(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(Ae(t)&&(t=+t),_t(t))return t-1;{const e=t.toLowerCase(),n=Ni.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=Bi.indexOf(r);if(-1!==i)return i;throw new Error(ki("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(Ae(t)&&(t=+t),_t(t))return t>4&&Ri(ki("quarter",t)),t-1;throw new Error(ki("quarter",t))}(t.quarter):t.quarter;n.push(_t(r)?3*r:`${r}*3`)}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(Ae(t)&&(t=+t),_t(t))return t%7;{const e=t.toLowerCase(),n=zi.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=$i.indexOf(r);if(-1!==i)return i;throw new Error(ki("day",t))}}(t.day):t.day;n.push(_t(r)?r+1:`${r}+1`)}else n.push(1);for(const r of["hours","minutes","seconds","milliseconds"]){const e=t[r];n.push("undefined"===typeof e?0:e)}return n}function Vi(t){const e=Ui(t,!0).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}var Zi=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Wi={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},qi=ne(Wi);function Gi(t){return t.startsWith("utc")}const Hi={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function Xi(t){return qi.filter((e=>Yi(t,e)))}function Yi(t,e){const n=t.indexOf(e);return!(n<0)&&(!(n>0&&"seconds"===e&&"i"===t.charAt(n-1))&&(!(t.length>n+3&&"day"===e&&"o"===t.charAt(n+3))&&!(n>0&&"year"===e&&"f"===t.charAt(n-1))))}function Ki(t,e,{end:n}={end:!1}){const r=le(e),i=Gi(t)?"utc":"";let o;const s={};for(const u of qi)Yi(t,u)&&(s[u]="quarter"===(a=u)?`(${i}quarter(${r})-1)`:`${i}${a}(${r})`,o=u);var a;return n&&(s[o]+="+1"),function(t){const e=Ui(t,!1).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}(s)}function Ji(t){if(!t)return;const e=Xi(t);return`timeUnitSpecifier(${$t(e)}, ${$t(Hi)})`}function Qi(t){if(!t)return;let e;return Et(t)?e={unit:t}:ht(t)&&(e=Object.assign(Object.assign({},t),t.unit?{unit:t.unit}:{})),Gi(e.unit)&&(e.utc=!0,e.unit=e.unit.substr(3)),e}function to(t){return t&&!!t.field&&void 0!==t.equal}function eo(t){return t&&!!t.field&&void 0!==t.lt}function no(t){return t&&!!t.field&&void 0!==t.lte}function ro(t){return t&&!!t.field&&void 0!==t.gt}function io(t){return t&&!!t.field&&void 0!==t.gte}function oo(t){if(null===t||void 0===t?void 0:t.field){if(ft(t.range)&&2===t.range.length)return!0;if(Rr(t.range))return!0}return!1}function so(t){return t&&!!t.field&&(ft(t.oneOf)||ft(t.in))}function ao(t){return so(t)||to(t)||oo(t)||eo(t)||ro(t)||no(t)||io(t)}function uo(t,e){return Va(t,{timeUnit:e,wrapTime:!0})}function co(t,e=!0){var n;const{field:r}=t,i=null===(n=Qi(t.timeUnit))||void 0===n?void 0:n.unit,o=i?`time(${Ki(i,r)})`:Sa(t,{expr:"datum"});if(to(t))return`${o}===${uo(t.equal,i)}`;if(eo(t)){return`${o}<${uo(t.lt,i)}`}if(ro(t)){return`${o}>${uo(t.gt,i)}`}if(no(t)){return`${o}<=${uo(t.lte,i)}`}if(io(t)){return`${o}>=${uo(t.gte,i)}`}if(so(t))return`indexof([${function(t,e){return t.map((t=>uo(t,e)))}(t.oneOf,i).join(",")}], ${o}) !== -1`;if(function(t){return t&&!!t.field&&void 0!==t.valid}(t))return lo(o,t.valid);if(oo(t)){const{range:n}=t,r=Rr(n)?{signal:`${n.signal}[0]`}:n[0],s=Rr(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==r&&null!==s&&e)return"inrange("+o+", ["+uo(r,i)+", "+uo(s,i)+"])";const a=[];return null!==r&&a.push(`${o} >= ${uo(r,i)}`),null!==s&&a.push(`${o} <= ${uo(s,i)}`),a.length>0?a.join(" && "):"true"}throw new Error(`Invalid field predicate: ${$t(t)}`)}function lo(t,e=!0){return e?`isValid(${t}) && isFinite(+${t})`:`!isValid(${t}) || !isFinite(+${t})`}function fo(t){var e;return ao(t)&&t.timeUnit?Object.assign(Object.assign({},t),{timeUnit:null===(e=Qi(t.timeUnit))||void 0===e?void 0:e.unit}):t}const ho={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};const po=ho.quantitative,go=ho.ordinal,mo=ho.temporal,yo=ho.nominal,vo=ho.geojson;ne(ho);var bo=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const xo="linear",wo="log",_o="pow",Eo="sqrt",Ao="symlog",Oo="time",So="utc",Co="quantile",Mo="quantize",Po="threshold",ko="point",To="band",Do={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};ne(Do);function Fo(t,e){const n=Do[t],r=Do[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}const jo={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Lo(t){return jo[t]}const Ro=["linear","log","pow","sqrt","symlog","time","utc"],Io=Ot(Ro),No=Ot(["linear","log","pow","sqrt","symlog"]);const Bo=Ot(["quantile","quantize","threshold"]),zo=Ot(Ro.concat(["quantile","quantize","threshold","sequential","identity"])),$o=Ot(["ordinal","bin-ordinal","point","band"]);function Uo(t){return t in $o}function Vo(t){return t in zo}function Zo(t){return t in Io}function Wo(t){return t in Bo}function qo(t){return null===t||void 0===t?void 0:t.param}const Go={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:Ho,domain:Xo,range:Yo,rangeMax:Ko,rangeMin:Jo,scheme:Qo}=(ne(Go),Go),ts=bo(Go,["type","domain","range","rangeMax","rangeMin","scheme"]),es=ne(ts);function ns(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(t);case"bins":return!["point","band","identity","ordinal"].includes(t);case"round":return Zo(t)||"band"===t||"point"===t;case"padding":case"rangeMin":case"rangeMax":return Zo(t)||["point","band"].includes(t);case"paddingOuter":case"align":return["point","band"].includes(t);case"paddingInner":return"band"===t;case"domainMax":case"domainMid":case"domainMin":case"clamp":return Zo(t);case"nice":return Zo(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return Vo(t)&&!Zt(["log","time","utc","threshold","quantile"],t)}}function rs(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return hn(t)?void 0:`Cannot use the scale property "${t}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}const is={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},os=is.arc,ss=is.area,as=is.bar,us=is.image,cs=is.line,ls=is.point,fs=is.rect,hs=is.rule,ds=is.text,ps=is.tick,gs=is.trail,ms=is.circle,ys=is.square,vs=is.geoshape;function bs(t){return["line","area","trail"].includes(t)}function xs(t){return["rect","bar","image","arc"].includes(t)}const ws=ne(is);function _s(t){return t.type}Ot(ws);const Es=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],As=ne({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),Os=ne({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function Ss(t){return t&&void 0!=t.band}const Cs={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},Ms={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},Ps={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5};function ks(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:o}=t,s=Rs(t);return da(n)&&!_r(n.aggregate)&&i&&Zo(i.get("type"))&&!1===i.get("zero")?Ts({fieldDef:n,channel:e,markDef:r,ref:s,config:o}):s}function Ts({fieldDef:t,channel:e,markDef:n,ref:r,config:i}){if(bs(n.type))return r;return null===Yr("invalid",n,i)?r:[Ds(t,e),r]}function Ds(t,e){const n=Fs(t,!0),r="y"===Mn(e)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function Fs(t,e=!0){return lo(Et(t)?t:Sa(t,{expr:"datum"}),!e)}function js(t,e,n,r){const i={};if(e&&(i.scale=e),ga(t)){const{datum:e}=t;Ii(e)?i.signal=Vi(e):Rr(e)?i.signal=e.signal:Tr(e)?i.signal=e.expr:i.value=e}else i.field=Sa(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function Ls({scaleName:t,fieldOrDatumDef:e,fieldOrDatumDef2:n,offset:r,startSuffix:i,bandPosition:o=.5}){const s=0<o&&o<1?"datum":void 0,a=Sa(e,{expr:s,suffix:i}),u=void 0!==n?Sa(n,{expr:s}):Sa(e,{suffix:"end",expr:s}),c={};if(0===o||1===o){c.scale=t;const e=0===o?a:u;c.field=e}else{const e=Rr(o)?`${o.signal} * ${a} + (1-${o.signal}) * ${u}`:`${o} * ${a} + ${1-o} * ${u}`;c.signal=`scale("${t}", ${e})`}return r&&(c.offset=r),c}function Rs({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:c,bandPosition:l}){var f;if(e){if(va(e)){if(ba(e)){null!==l&&void 0!==l||(l=aa({fieldDef:e,fieldDef2:n,markDef:r,config:i}));const{bin:s,timeUnit:c,type:f}=e;if(Sr(s)||l&&c&&f===mo)return(null===a||void 0===a?void 0:a.impute)?js(e,o,{binSuffix:"mid"},{offset:u}):l?Ls({scaleName:o,fieldOrDatumDef:e,bandPosition:l,offset:u}):js(e,o,Wa(e,t)?{binSuffix:"range"}:{},{offset:u});if(Cr(s)){if(da(n))return Ls({scaleName:o,fieldOrDatumDef:e,fieldOrDatumDef2:n,bandPosition:l,offset:u});Ri(Di(t===Pe?Te:De))}}const c=null===s||void 0===s?void 0:s.get("type");return js(e,o,Uo(c)?{binSuffix:"range"}:{},{offset:u,band:"band"===c?null!==(f=null!==l&&void 0!==l?l:e.bandPosition)&&void 0!==f?f:.5:void 0})}if(xa(e)){const n=e.value,r=u?{offset:u}:{};return Object.assign(Object.assign({},Is(t,n)),r)}}return vt(c)&&(c=c()),c?Object.assign(Object.assign({},c),u?{offset:u}:{}):c}function Is(t,e){return Zt(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:Zt(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:qr(e)}function Ns(t){return t&&"number"!==t&&"time"!==t}function Bs(t,e,n){return`${t}(${e}${n?`, ${$t(n)}`:""})`}function zs({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:o}){var s,a;if(Ns(n))return Us({fieldOrDatumDef:t,format:e,formatType:n,expr:r,config:o});const u=$s(t,r,i);if(Ua(t)){const n=function(t,e,n,r,i){return!e||n?`${i?"utc":"time"}Format(${t}, '${n=Et(n)?n:r}')`:function(t,e,n){if(!t)return;const r=Ji(t);return`${n||Gi(t)?"utc":"time"}Format(${e}, ${r})`}(e,t,i)}(u,da(t)?null===(s=Qi(t.timeUnit))||void 0===s?void 0:s.unit:void 0,e,o.timeFormat,wa(t)&&(null===(a=t.scale)||void 0===a?void 0:a.type)===So);return n?{signal:n}:void 0}if(e=Ws(pa(t),e,o),da(t)&&Sr(t.bin)){return{signal:Hs(u,Sa(t,{expr:r,binSuffix:"end"}),e,n,o)}}return e||"quantitative"===pa(t)?{signal:`${qs(u,e)}`}:{signal:`isValid(${u}) ? ${u} : ""+${u}`}}function $s(t,e,n){return da(t)?n?`${Sa(t,{expr:e,suffix:"end"})}-${Sa(t,{expr:e,suffix:"start"})}`:Sa(t,{expr:e}):function(t){const{datum:e}=t;return Ii(e)?Vi(e):`${$t(e)}`}(t)}function Us({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){if(null!==s&&void 0!==s||(s=$s(t,r,i)),da(t)&&Sr(t.bin)){return{signal:Hs(s,Sa(t,{expr:r,binSuffix:"end"}),e,n,o)}}return{signal:Bs(n,s,e)}}function Vs(t,e,n,r,i,o){var s;if(!Ns(r)){if(Ua(t)){return function(t,e,n,r){if(t)return t;if(e)return{signal:Ji(e)};return r?void 0:n.timeFormat}(n,da(t)?null===(s=Qi(t.timeUnit))||void 0===s?void 0:s.unit:void 0,i,o)}return Ws(e,n,i)}}function Zs(t,e,n){return t&&(Rr(t)||"number"===t||"time"===t)?t:Ua(e)&&"time"!==n&&"utc"!==n?"time":void 0}function Ws(t,e,n){return Et(e)?e:t===po?n.numberFormat:void 0}function qs(t,e){return`format(${t}, "${e||""}")`}function Gs(t,e,n,r){var i;return Ns(n)?Bs(n,t,e):qs(t,null!==(i=Et(e)?e:void 0)&&void 0!==i?i:r.numberFormat)}function Hs(t,e,n,r,i){const o=Gs(t,n,r,i),s=Gs(e,n,r,i);return`${lo(t,!1)} ? "null" : ${o} + " \u2013 " + ${s}`}const Xs="min",Ys={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Ks(t){return t in Ys}function Js(t){return!!t&&!!t.encoding}function Qs(t){return!!t&&("count"===t.op||!!t.field)}function ta(t){return!!t&&ft(t)}function ea(t){return"row"in t||"column"in t}function na(t){return!!t&&"header"in t}function ra(t){return"facet"in t}var ia=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function oa(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),i?{aggregate:i}:{}),{field:e})}function sa(t){return"sort"in t}function aa({fieldDef:t,fieldDef2:e,markDef:n,config:r}){if(va(t)&&void 0!==t.bandPosition)return t.bandPosition;if(da(t)){const{timeUnit:i,bin:o}=t;if(i&&!e)return xs(n.type)?0:Kr("timeUnitBandPosition",n,r);if(Sr(o))return.5}}function ua({channel:t,fieldDef:e,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){var a,u,c;const l=Tn(t),f=Yr(s?"size":l,r,i,{vgChannel:l});if(void 0!==f)return f;if(da(e)){const{timeUnit:t,bin:s}=e;if(t&&!n)return{band:Kr("timeUnitBandSize",r,i)};if(Sr(s)&&!Uo(o))return{band:1}}return xs(r.type)?o?Uo(o)?(null===(a=i[r.type])||void 0===a?void 0:a.discreteBandSize)||{band:1}:null===(u=i[r.type])||void 0===u?void 0:u.continuousBandSize:null===(c=i[r.type])||void 0===c?void 0:c.discreteBandSize:void 0}function ca(t,e,n,r){return!!(Sr(t.bin)||t.timeUnit&&ba(t)&&"temporal"===t.type)&&void 0!==aa({fieldDef:t,fieldDef2:e,markDef:n,config:r})}function la(t){return t&&"condition"in t}function fa(t){const e=t&&t.condition;return!!e&&!ft(e)&&da(e)}function ha(t){const e=t&&t.condition;return!!e&&!ft(e)&&va(e)}function da(t){return t&&(!!t.field||"count"===t.aggregate)}function pa(t){return t&&t.type}function ga(t){return t&&"datum"in t}function ma(t){return ba(t)&&!Ca(t)||ya(t)}function ya(t){return ga(t)&&_t(t.datum)}function va(t){return da(t)||ga(t)}function ba(t){return t&&("field"in t||"count"===t.aggregate)&&"type"in t}function xa(t){return t&&"value"in t&&"value"in t}function wa(t){return t&&("scale"in t||"sort"in t)}function _a(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function Ea(t){return t&&"legend"in t}function Aa(t){return t&&("format"in t||"formatType"in t)}function Oa(t){return zt(t,["legend","axis","header","scale"])}function Sa(t,e={}){var n,r,i;let o=t.field;const s=e.prefix;let a=e.suffix,u="";if(function(t){return"count"===t.aggregate}(t))o=we("count");else{let s;if(!e.nofn)if(function(t){return"op"in t}(t))s=t.op;else{const{bin:c,aggregate:l,timeUnit:f}=t;Sr(c)?(s=Or(c),a=(null!==(n=e.binSuffix)&&void 0!==n?n:"")+(null!==(r=e.suffix)&&void 0!==r?r:"")):l?br(l)?(u=`["${o}"]`,o=`argmax_${l.argmax}`):vr(l)?(u=`["${o}"]`,o=`argmin_${l.argmin}`):s=String(l):f&&(s=function(t){const e=Qi(t),{utc:n}=e,r=Zi(e,["utc"]);return r.unit?(n?"utc":"")+ne(r).map((t=>se(`${"unit"===t?"":`_${t}_`}${r[t]}`))).join(""):(n?"utc":"")+"timeunit"+ne(r).map((t=>se(`_${t}_${r[t]}`))).join("")}(f),a=(!["range","mid"].includes(e.binSuffix)&&e.binSuffix||"")+(null!==(i=e.suffix)&&void 0!==i?i:""))}s&&(o=o?`${s}_${o}`:s)}return a&&(o=`${o}_${a}`),s&&(o=`${s}_${o}`),e.forAs?ge(o):e.expr?fe(o,e.expr)+u:de(o)+u}function Ca(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return da(t)&&!!t.bin;case"temporal":return!1}throw new Error(yi(t.type))}const Ma=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(br(e))return`${i} for argmax(${e.argmax})`;if(vr(e))return`${i} for argmin(${e.argmin})`;const o=Qi(r),s=e||(null===o||void 0===o?void 0:o.unit)||(null===o||void 0===o?void 0:o.maxbins)&&"timeunit"||Sr(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}(t);default:return function(t,e){var n;const{field:r,bin:i,timeUnit:o,aggregate:s}=t;if("count"===s)return e.countTitle;if(Sr(i))return`${r} (binned)`;if(o){const t=null===(n=Qi(o))||void 0===n?void 0:n.unit;if(t)return`${r} (${Xi(t).join("-")})`}else if(s)return br(s)?`${r} for max ${s.argmax}`:vr(s)?`${r} for min ${s.argmin}`:`${ce(s)} of ${r}`;return r}(t,e)}};let Pa=Ma;function ka(t){Pa=t}function Ta(t,e,{allowDisabling:n,includeDefault:r=!0}){var i,o;const s=null===(i=Da(t))||void 0===i?void 0:i.title;if(!da(t))return s;const a=t,u=r?Fa(a,e):void 0;return n?ye(s,a.title,u):null!==(o=null!==s&&void 0!==s?s:a.title)&&void 0!==o?o:u}function Da(t){return _a(t)&&t.axis?t.axis:Ea(t)&&t.legend?t.legend:na(t)&&t.header?t.header:void 0}function Fa(t,e){return Pa(t,e)}function ja(t){var e;if(Aa(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{const n=null!==(e=Da(t))&&void 0!==e?e:{},{format:r,formatType:i}=n;return{format:r,formatType:i}}}function La(t){return da(t)?t:fa(t)?t.condition:void 0}function Ra(t){return va(t)?t:ha(t)?t.condition:void 0}function Ia(t,e,n,r={}){if(Et(t)||_t(t)||wt(t)){return Ri(function(t,e,n){return`Channel ${t} is a ${e}. Converted to {value: ${$t(n)}}.`}(e,Et(t)?"string":_t(t)?"number":"boolean",t)),{value:t}}return va(t)?Na(t,e,n,r):ha(t)?Object.assign(Object.assign({},t),{condition:Na(t.condition,e,n,r)}):t}function Na(t,e,n,r){if(Aa(t)){const{format:i,formatType:o}=t,s=ia(t,["format","formatType"]);if(Ns(o)&&!n.customFormatTypes)return Ri(mi(e)),Na(s,e,n,r)}else{const i=_a(t)?"axis":Ea(t)?"legend":na(t)?"header":null;if(i&&t[i]){const o=t[i],{format:s,formatType:a}=o,u=ia(o,["format","formatType"]);if(Ns(a)&&!n.customFormatTypes)return Ri(mi(e)),Na(Object.assign(Object.assign({},t),{[i]:u}),e,n,r)}}return da(t)?Ba(t,e,r):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=_t(n)?"quantitative":Et(n)?"nominal":Ii(n)?"temporal":void 0,Object.assign(Object.assign({},t),{type:e})}(t)}function Ba(t,e,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=t,a=Object.assign({},t);if(n||!r||xr(r)||br(r)||vr(r)||(Ri(function(t){return`Invalid aggregation operator "${t}".`}(r)),delete a.aggregate),i&&(a.timeUnit=Qi(i)),s&&(a.field=`${s}`),Sr(o)&&(a.bin=za(o,e)),Cr(o)&&!Hn(e)&&Ri(function(t){return`Channel ${t} should not be used with "binned" bin.`}(e)),ba(a)){const{type:t}=a,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case po:return"quantitative";case"t":case mo:return"temporal";case"o":case go:return"ordinal";case"n":case yo:return"nominal";case vo:return"geojson"}}(t);t!==e&&(a.type=e),"quantitative"!==t&&_r(r)&&(Ri(function(t,e){return`Invalid field type "${t}" for aggregate: "${e}", using "quantitative" instead.`}(t,r)),a.type="quantitative")}else if(!Cn(e)){const t=function(t,e){var n;switch(e){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(sa(t)&&ft(t.sort))return"ordinal";const{aggregate:r,bin:i,timeUnit:o}=t;if(o)return"temporal";if(i||r&&!br(r)&&!vr(r))return"quantitative";if(wa(t)&&(null===(n=t.scale)||void 0===n?void 0:n.type))switch(Do[t.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(a,e);a.type=t}if(ba(a)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:`Channel ${e} should not be used with a geojson data.`};switch(e){case Se:case Ce:case Me:return Ca(t)?$a:{compatible:!1,warning:wi(e)};case Pe:case ke:case $e:case Ue:case Ve:case Je:case tn:case en:case nn:case rn:case on:case qe:case Le:case Fe:case sn:return $a;case Ne:case ze:case Ie:case Be:return n!==po?{compatible:!1,warning:`Channel ${e} should be used with a quantitative field only, not ${t.type} field.`}:$a;case Ge:case He:case Xe:case Ye:case We:case Re:case je:case Te:case De:return"nominal"!==n||t.sort?$a:{compatible:!1,warning:`Channel ${e} should not be used with an unsorted discrete field.`};case Ze:case Ke:return Ca(t)||function(t){var e;return wa(t)&&Wo(null===(e=t.scale)||void 0===e?void 0:e.type)}(t)?$a:{compatible:!1,warning:_i(e)};case Qe:return"nominal"!==t.type||"sort"in t?$a:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,e)||{};!1===t&&Ri(n)}if(sa(a)&&Et(a.sort)){const{sort:t}=a;if(Ks(t))return Object.assign(Object.assign({},a),{sort:{encoding:t}});const e=t.substr(1);if("-"===t.charAt(0)&&Ks(e))return Object.assign(Object.assign({},a),{sort:{encoding:e,order:"descending"}})}if(na(a)){const{header:t}=a;if(t){const{orient:e}=t,n=ia(t,["orient"]);if(e)return Object.assign(Object.assign({},a),{header:Object.assign(Object.assign({},n),{labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e})})}}return a}function za(t,e){return wt(t)?{maxbins:kr(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:Object.assign(Object.assign({},t),{maxbins:kr(e)})}const $a={compatible:!0};function Ua(t){const{formatType:e}=ja(t);return"time"===e||!e&&((n=t)&&("temporal"===n.type||da(n)&&!!n.timeUnit));var n}function Va(t,{timeUnit:e,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){var o;const s=e&&(null===(o=Qi(e))||void 0===o?void 0:o.unit);let a,u=s||"temporal"===n;return Tr(t)?a=t.expr:Rr(t)?a=t.signal:Ii(t)?(u=!0,a=Vi(t)):(Et(t)||_t(t))&&u&&(a=`datetime(${$t(t)})`,function(t){return!!Wi[t]}(s)&&(_t(t)&&t<1e4||Et(t)&&isNaN(Date.parse(t)))&&(a=Vi({[s]:t}))),a?r&&u?`time(${a})`:a:i?void 0:$t(t)}function Za(t,e){const{type:n}=t;return e.map((e=>{const r=Va(e,{timeUnit:da(t)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e}))}function Wa(t,e){return Sr(t.bin)?lr(e)&&["ordinal","nominal"].includes(t.type):(console.warn("Only call this method for binned field defs."),!1)}const qa={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Ga(t){return t&&t.condition}const Ha=["domain","grid","labels","ticks","title"],Xa={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Ya={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Ka=Object.assign(Object.assign({},Ya),{style:1,labelExpr:1,encoding:1});function Ja(t){return!!Ka[t]}ne(Ka);const Qa=ne({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function tu(t){return"mark"in t}class eu{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!tu(t)&&(_s(e=t.mark)?e.type:e)===this.name;var e}}var nu=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function ru(t,e){const n=t&&t[e];return!!n&&(ft(n)?Wt(n,(t=>!!t.field)):da(n)||fa(n))}function iu(t){return Wt(mn,(e=>{if(ru(t,e)){const n=t[e];if(ft(n))return Wt(n,(t=>!!t.aggregate));{const t=La(n);return t&&!!t.aggregate}}return!1}))}function ou(t,e){const n=[],r=[],i=[],o=[],s={};return uu(t,((a,u)=>{if(da(a)){const{field:c,aggregate:l,bin:f,timeUnit:h}=a,d=nu(a,["field","aggregate","bin","timeUnit"]);if(l||h||f){const t=Da(a),p=null===t||void 0===t?void 0:t.title;let g=Sa(a,{forAs:!0});const m=Object.assign(Object.assign(Object.assign({},p?[]:{title:Ta(a,e,{allowDisabling:!0})}),d),{field:g});if(l){let t;if(br(l)?(t="argmax",g=Sa({op:"argmax",field:l.argmax},{forAs:!0}),m.field=`${g}.${c}`):vr(l)?(t="argmin",g=Sa({op:"argmin",field:l.argmin},{forAs:!0}),m.field=`${g}.${c}`):"boxplot"!==l&&"errorbar"!==l&&"errorband"!==l&&(t=l),t){const e={op:t,as:g};c&&(e.field=c),o.push(e)}}else if(n.push(g),ba(a)&&Sr(f)){if(r.push({bin:f,field:c,as:g}),n.push(Sa(a,{binSuffix:"end"})),Wa(a,u)&&n.push(Sa(a,{binSuffix:"range"})),Hn(u)){const t={field:`${g}_end`};s[`${u}2`]=t}m.bin="binned",Cn(u)||(m.type=po)}else if(h){i.push({timeUnit:h,field:c,as:g});const t=ba(a)&&a.type!==mo&&"time";t&&(u===Je||u===nn?m.formatType=t:!function(t){return!!Zn[t]}(u)?Hn(u)&&(m.axis=Object.assign({formatType:t},m.axis)):m.legend=Object.assign({formatType:t},m.legend))}s[u]=m}else n.push(c),s[u]=t[u]}else s[u]=t[u]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function su(t,e,n,r){return ne(t).reduce(((i,o)=>{if(!On(o))return Ri(function(t){return`${t}-encoding is dropped as ${t} is not a valid encoding channel.`}(o)),i;const s=t[o];if("angle"!==o||"arc"!==e||t.theta||(Ri("Arc marks uses theta channel rather than angle, replacing angle with theta."),o=Le),!function(t,e,n){const r=fr(e,n);if(!r)return!1;if("binned"===r){const n=t[e===Te?Pe:ke];return!!(da(n)&&da(t[e])&&Cr(n.bin))}return!0}(t,o,e))return Ri(xi(o,e)),i;if(o===We&&"line"===e){const e=La(t[o]);if(null===e||void 0===e?void 0:e.aggregate)return Ri("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead."),i}if(o===$e&&(n?"fill"in t:"stroke"in t))return Ri(vi("encoding",{fill:"fill"in t,stroke:"stroke"in t})),i;if(o===tn||o===Qe&&!ft(s)&&!xa(s)||o===nn&&ft(s))s&&(i[o]=yt(s).reduce(((t,e)=>(da(e)?t.push(Ba(e,o)):Ri(bi(e,o)),t)),[]));else{if(o===nn&&null===s)i[o]=null;else if(!da(s)&&!ga(s)&&!xa(s)&&!la(s)&&!Rr(s))return Ri(bi(s,o)),i;i[o]=Ia(s,o,r)}return i}),{})}function au(t,e){const n={};for(const r of ne(t)){const i=Ia(t[r],r,e,{compositeMark:!0});n[r]=i}return n}function uu(t,e,n){if(t)for(const r of ne(t)){const i=t[r];if(ft(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function cu(t,e){return ne(e).reduce(((n,r)=>{switch(r){case Pe:case ke:case rn:case sn:case on:case Te:case De:case Le:case Re:case Fe:case je:case Ie:case Ne:case Be:case ze:case Je:case Ze:case qe:case nn:return n;case Qe:if("line"===t||"trail"===t)return n;case tn:case en:{const t=e[r];if(ft(t)||da(t))for(const e of yt(t))e.aggregate||n.push(Sa(e,{}));return n}case We:if("trail"===t)return n;case $e:case Ue:case Ve:case Ge:case He:case Xe:case Ke:case Ye:{const t=La(e[r]);return t&&!t.aggregate&&n.push(Sa(t,{})),n}}}),[])}var lu=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function fu(t,e,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};return{tooltip:[...t.map((({fieldPrefix:t,titlePrefix:n})=>{const i=r?` of ${hu(e)}`:"";return{field:t+e.field,type:e.type,title:Rr(n)?{signal:`${n}"${escape(i)}"`}:n+i}})),...Xt(function(t){const e=[];for(const n of ne(t))if(ru(t,n)){const r=yt(t[n]);for(const t of r)da(t)?e.push(t):fa(t)&&e.push(t.condition)}return e}(n).map(Oa),Ut)]}}function hu(t){const{title:e,field:n}=t;return ye(e,n)}function du(t,e,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:u,positionPrefix:c,endPositionPrefix:l,extraEncoding:f={}})=>{const h=hu(n);return pu(t,a,i,{mark:u,encoding:Object.assign(Object.assign(Object.assign({[e]:Object.assign(Object.assign(Object.assign({field:`${c}_${n.field}`,type:n.type},void 0!==h?{title:h}:{}),void 0!==o?{scale:o}:{}),void 0!==s?{axis:s}:{})},Et(l)?{[`${e}2`]:{field:`${l}_${n.field}`}}:{}),r),f)})}}function pu(t,e,n,r){const{clip:i,color:o,opacity:s}=t,a=t.type;return t[e]||void 0===t[e]&&n[e]?[Object.assign(Object.assign({},r),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[e]),i?{clip:i}:{}),o?{color:o}:{}),s?{opacity:s}:{}),_s(r.mark)?r.mark:{type:r.mark}),{style:`${a}-${e}`}),wt(t[e])?{}:t[e])})]:[]}function gu(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],u=r[`${i}Error2`];return{continuousAxisChannelDef:mu(o,n),continuousAxisChannelDef2:mu(s,n),continuousAxisChannelDefError:mu(a,n),continuousAxisChannelDefError2:mu(u,n),continuousAxis:i}}function mu(t,e){if(null===t||void 0===t?void 0:t.aggregate){const{aggregate:n}=t,r=lu(t,["aggregate"]);return n!==e&&Ri(function(t,e){return`Continuous axis should not have customized aggregation function ${t}; ${e} already agregates the axis.`}(n,e)),r}return t}function yu(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(_s(n)&&n.orient)return n.orient;if(ma(i)){if(ma(o)){const t=da(i)&&i.aggregate,n=da(o)&&o.aggregate;if(t||n!==e){if(n||t!==e){if(t===e&&n===e)throw new Error("Both x and y cannot have aggregate");return Ua(o)&&!Ua(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(ma(o))return"vertical";throw new Error(`Need a valid continuous axis for ${e}s`)}var vu=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const bu="boxplot",xu=new eu(bu,_u);function wu(t){return _t(t)?"tukey":t}function _u(t,{config:e}){var n,r;t=Object.assign(Object.assign({},t),{encoding:au(t.encoding,e)});const{mark:i,encoding:o,params:s,projection:a}=t,u=vu(t,["mark","encoding","params","projection"]),c=_s(i)?i:{type:i};s&&Ri(hi("boxplot"));const l=null!==(n=c.extent)&&void 0!==n?n:e.boxplot.extent,f=Yr("size",c,e),h=wu(l),{bins:d,timeUnits:p,transform:g,continuousAxisChannelDef:m,continuousAxis:y,groupby:v,aggregate:b,encodingWithoutContinuousAxis:x,ticksOrient:w,boxOrient:_,customTooltipWithoutAggregatedField:E}=function(t,e,n){const r=yu(t,bu),{continuousAxisChannelDef:i,continuousAxis:o}=gu(t,r,bu),s=i.field,a=wu(e),u=[...Eu(s),{op:"median",field:s,as:`mid_box_${s}`},{op:"min",field:s,as:("min-max"===a?"lower_whisker_":"min_")+s},{op:"max",field:s,as:("min-max"===a?"upper_whisker_":"max_")+s}],c="min-max"===a||"tukey"===a?[]:[{calculate:`datum["upper_box_${s}"] - datum["lower_box_${s}"]`,as:`iqr_${s}`},{calculate:`min(datum["upper_box_${s}"] + datum["iqr_${s}"] * ${e}, datum["max_${s}"])`,as:`upper_whisker_${s}`},{calculate:`max(datum["lower_box_${s}"] - datum["iqr_${s}"] * ${e}, datum["min_${s}"])`,as:`lower_whisker_${s}`}],l=t.encoding,f=o,h=(l[f],vu(l,["symbol"===typeof f?f:f+""])),{customTooltipWithoutAggregatedField:d,filteredEncoding:p}=function(t){const{tooltip:e}=t,n=lu(t,["tooltip"]);if(!e)return{filteredEncoding:n};let r,i;if(ft(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return ft(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(h),{bins:g,timeUnits:m,aggregate:y,groupby:v,encoding:b}=ou(p,n),x="vertical"===r?"horizontal":"vertical",w=r,_=[...g,...m,{aggregate:[...y,...u],groupby:v},...c];return{bins:g,timeUnits:m,transform:_,groupby:v,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:b,ticksOrient:x,boxOrient:w,customTooltipWithoutAggregatedField:d}}(t,l,e),{color:A,size:O}=x,S=vu(x,["color","size"]),C=t=>du(c,y,m,t,e.boxplot),M=C(S),P=C(x),k=C(Object.assign(Object.assign({},S),O?{size:O}:{})),T=fu([{fieldPrefix:"min-max"===h?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===h?"lower_whisker_":"min_",titlePrefix:"Min"}],m,x),D={type:"tick",color:"black",opacity:1,orient:w,invalid:null,aria:!1},F="min-max"===h?T:fu([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,x),j=[...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:F}),...M({partName:"rule",mark:{type:"rule",invalid:null,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:F}),...M({partName:"ticks",mark:D,positionPrefix:"lower_whisker",extraEncoding:F}),...M({partName:"ticks",mark:D,positionPrefix:"upper_whisker",extraEncoding:F})],L=[..."tukey"!==h?j:[],...P({partName:"box",mark:Object.assign(Object.assign({type:"bar"},f?{size:f}:{}),{orient:_,invalid:null,ariaRoleDescription:"box"}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:T}),...k({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},ht(e.boxplot.median)&&e.boxplot.median.color?{color:e.boxplot.median.color}:{}),f?{size:f}:{}),{orient:w,aria:!1}),positionPrefix:"mid_box",extraEncoding:T})];if("min-max"===h)return Object.assign(Object.assign({},u),{transform:(null!==(r=u.transform)&&void 0!==r?r:[]).concat(g),layer:L});const R=`datum["lower_box_${m.field}"]`,I=`datum["upper_box_${m.field}"]`,N=`(${I} - ${R})`,B=`${R} - ${l} * ${N}`,z=`${I} + ${l} * ${N}`,$=`datum["${m.field}"]`,U={joinaggregate:Eu(m.field),groupby:v},V={transform:[{filter:`(${B} <= ${$}) && (${$} <= ${z})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${m.field}`},{op:"max",field:m.field,as:`upper_whisker_${m.field}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${m.field}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${m.field}`},...b],groupby:v}],layer:j},{tooltip:Z}=S,W=vu(S,["tooltip"]),{scale:q,axis:G}=m,H=hu(m),X=zt(G,["title"]),Y=pu(c,"outliers",e.boxplot,{transform:[{filter:`(${$} < ${B}) || (${$} > ${z})`}],mark:"point",encoding:Object.assign(Object.assign(Object.assign({[y]:Object.assign(Object.assign(Object.assign({field:m.field,type:m.type},void 0!==H?{title:H}:{}),void 0!==q?{scale:q}:{}),ee(X)?{}:{axis:X})},W),A?{color:A}:{}),E?{tooltip:E}:{})})[0];let K;const J=[...d,...p,U];return Y?K={transform:J,layer:[Y,V]}:(K=V,K.transform.unshift(...J)),Object.assign(Object.assign({},u),{layer:[K,{transform:g,layer:L}]})}function Eu(t){return[{op:"q1",field:t,as:`lower_box_${t}`},{op:"q3",field:t,as:`upper_box_${t}`}]}var Au=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const Ou="errorbar",Su=new eu(Ou,Cu);function Cu(t,{config:e}){t=Object.assign(Object.assign({},t),{encoding:au(t.encoding,e)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:u,tooltipEncoding:c}=Pu(t,Ou,e);delete o.size;const l=du(a,i,r,o,e.errorbar),f=a.thickness,h=a.size,d=Object.assign(Object.assign({type:"tick",orient:s,aria:!1},void 0!==f?{thickness:f}:{}),void 0!==h?{size:h}:{}),p=[...l({partName:"ticks",mark:d,positionPrefix:"lower",extraEncoding:c}),...l({partName:"ticks",mark:d,positionPrefix:"upper",extraEncoding:c}),...l({partName:"rule",mark:Object.assign({type:"rule",ariaRoleDescription:"errorbar"},void 0!==f?{size:f}:{}),positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:c})];return Object.assign(Object.assign(Object.assign({},u),{transform:n}),p.length>1?{layer:p}:Object.assign({},p[0]))}function Mu(t,e){const{encoding:n}=t;if(function(t){return(va(t.x)||va(t.y))&&!va(t.x2)&&!va(t.y2)&&!va(t.xError)&&!va(t.xError2)&&!va(t.yError)&&!va(t.yError2)}(n))return{orient:yu(t,e),inputType:"raw"};const r=function(t){return va(t.x2)||va(t.y2)}(n),i=function(t){return va(t.xError)||va(t.xError2)||va(t.yError)||va(t.yError2)}(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${e} cannot be both type aggregated-upper-lower and aggregated-error`);const t=n.x2,r=n.y2;if(va(t)&&va(r))throw new Error(`${e} cannot have both x2 and y2`);if(va(t)){if(ma(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${e}`)}if(va(r)){if(ma(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${e}`)}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,a=n.yError2;if(va(r)&&!va(t))throw new Error(`${e} cannot have xError2 without xError`);if(va(a)&&!va(i))throw new Error(`${e} cannot have yError2 without yError`);if(va(t)&&va(i))throw new Error(`${e} cannot have both xError and yError with both are quantiative`);if(va(t)){if(ma(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(va(i)){if(ma(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}function Pu(t,e,n){var r;const{mark:i,encoding:o,params:s,projection:a}=t,u=Au(t,["mark","encoding","params","projection"]),c=_s(i)?i:{type:i};s&&Ri(hi(e));const{orient:l,inputType:f}=Mu(t,e),{continuousAxisChannelDef:h,continuousAxisChannelDef2:d,continuousAxisChannelDefError:p,continuousAxisChannelDefError2:g,continuousAxis:m}=gu(t,l,e),{errorBarSpecificAggregate:y,postAggregateCalculates:v,tooltipSummary:b,tooltipTitleWithFieldName:x}=function(t,e,n,r,i,o,s,a){let u=[],c=[];const l=e.field;let f,h=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":a.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!==("iqr"===n)&&Ri(function(t,e,n){return`${t} is not usually used with ${e} for ${n}.`}(e,n,s)),"stderr"===n||"stdev"===n)u=[{op:n,field:l,as:`extent_${l}`},{op:e,field:l,as:`center_${l}`}],c=[{calculate:`datum["center_${l}"] + datum["extent_${l}"]`,as:`upper_${l}`},{calculate:`datum["center_${l}"] - datum["extent_${l}"]`,as:`lower_${l}`}],f=[{fieldPrefix:"center_",titlePrefix:ce(e)},{fieldPrefix:"upper_",titlePrefix:ku(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:ku(e,n,"-")}],h=!0;else{let t,e,r;"ci"===n?(t="mean",e="ci0",r="ci1"):(t="median",e="q1",r="q3"),u=[{op:e,field:l,as:`lower_${l}`},{op:r,field:l,as:`upper_${l}`},{op:t,field:l,as:`center_${l}`}],f=[{fieldPrefix:"upper_",titlePrefix:Ta({field:l,aggregate:r,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Ta({field:l,aggregate:e,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Ta({field:l,aggregate:t,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&Ri(function(t,e){return`${e?"extent ":""}${e&&t?"and ":""}${t?"center ":""}${e&&t?"are ":"is "}not needed when data are aggregated.`}(t.center,t.extent)),"aggregated-upper-lower"===o?(f=[],c=[{calculate:`datum["${n.field}"]`,as:`upper_${l}`},{calculate:`datum["${l}"]`,as:`lower_${l}`}]):"aggregated-error"===o&&(f=[{fieldPrefix:"",titlePrefix:l}],c=[{calculate:`datum["${l}"] + datum["${r.field}"]`,as:`upper_${l}`}],i?c.push({calculate:`datum["${l}"] + datum["${i.field}"]`,as:`lower_${l}`}):c.push({calculate:`datum["${l}"] - datum["${r.field}"]`,as:`lower_${l}`}));for(const t of c)f.push({fieldPrefix:t.as.substring(0,6),titlePrefix:pe(pe(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:c,errorBarSpecificAggregate:u,tooltipSummary:f,tooltipTitleWithFieldName:h}}(c,h,d,p,g,f,e,n),w=o,_=m,E=(w[_],"x"===m?"x2":"y2"),A=(w[E],"x"===m?"xError":"yError"),O=(w[A],"x"===m?"xError2":"yError2"),S=(w[O],Au(w,["symbol"===typeof _?_:_+"","symbol"===typeof E?E:E+"","symbol"===typeof A?A:A+"","symbol"===typeof O?O:O+""])),{bins:C,timeUnits:M,aggregate:P,groupby:k,encoding:T}=ou(S,n),D=[...P,...y],F="raw"!==f?[]:k,j=fu(b,h,T,x);return{transform:[...null!==(r=u.transform)&&void 0!==r?r:[],...C,...M,...0===D.length?[]:[{aggregate:D,groupby:F}],...v],groupby:F,continuousAxisChannelDef:h,continuousAxis:m,encodingWithoutContinuousAxis:T,ticksOrient:"vertical"===l?"horizontal":"vertical",markDef:c,outerSpec:u,tooltipEncoding:j}}function ku(t,e,n){return`${ce(t)} ${n} ${e}`}const Tu="errorband",Du=new eu(Tu,Fu);function Fu(t,{config:e}){t=Object.assign(Object.assign({},t),{encoding:au(t.encoding,e)});const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:u}=Pu(t,Tu,e),c=s,l=du(c,i,r,o,e.errorband),f=void 0!==t.encoding.x&&void 0!==t.encoding.y;let h={type:f?"area":"rect"},d={type:f?"line":"rule"};const p=Object.assign(Object.assign({},c.interpolate?{interpolate:c.interpolate}:{}),c.tension&&c.interpolate?{tension:c.tension}:{});return f?(h=Object.assign(Object.assign(Object.assign({},h),p),{ariaRoleDescription:"errorband"}),d=Object.assign(Object.assign(Object.assign({},d),p),{aria:!1})):c.interpolate?Ri(Ti("interpolate")):c.tension&&Ri(Ti("tension")),Object.assign(Object.assign({},a),{transform:n,layer:[...l({partName:"band",mark:h,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u}),...l({partName:"borders",mark:d,positionPrefix:"lower",extraEncoding:u}),...l({partName:"borders",mark:d,positionPrefix:"upper",extraEncoding:u})]})}const ju={};function Lu(t,e,n){const r=new eu(t,e);ju[t]={normalizer:r,parts:n}}Lu(bu,_u,["box","median","outliers","rule","ticks"]),Lu(Ou,Cu,["ticks","rule"]),Lu(Tu,Fu,["band","borders"]);const Ru=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Iu={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Nu={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Bu=ne(Iu),zu=ne(Nu),$u=ne({header:1,headerRow:1,headerColumn:1,headerFacet:1}),Uu=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Vu={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Zu=(ne(Vu),"_vgsid_"),Wu={point:{on:"click",fields:[Zu],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function qu(t){return!!t&&("legend"===t||!!t.legend)}function Gu(t){return qu(t)&&ht(t)}function Hu(t){return!!t.select}var Xu=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Yu(t){const e=[];for(const n of t||[]){if(Hu(n))continue;const{expr:t,bind:r}=n,i=Xu(n,["expr","bind"]);if(r&&t){const n=Object.assign(Object.assign({},i),{bind:r,init:t});e.push(n)}else{const n=Object.assign(Object.assign(Object.assign({},i),t?{update:t}:{}),r?{bind:r}:{});e.push(n)}}return e}function Ku(t){return"concat"in t}function Ju(t){return"vconcat"in t}function Qu(t){return"hconcat"in t}function tc(t){return ht(t)&&void 0!==t.step}function ec(t){return t.view||t.width||t.height}const nc=ne({align:1,bounds:1,center:1,columns:1,spacing:1});var rc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function ic(t,e){var n;return null!==(n=t[e])&&void 0!==n?n:t["width"===e?"continuousWidth":"continuousHeight"]}function oc(t,e){const n=sc(t,e);return tc(n)?n.step:ac}function sc(t,e){var n;return ye(null!==(n=t[e])&&void 0!==n?n:t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const ac=20;const uc={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:ac},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:Ms,circle:{},geoshape:{},image:{},line:{},point:{},rect:Ps,rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Wu,style:{},title:{},facet:{spacing:20},concat:{spacing:20}},cc=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],lc={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},fc={blue:cc[0],orange:cc[1],red:cc[2],teal:cc[3],green:cc[4],yellow:cc[5],purple:cc[6],pink:cc[7],brown:cc[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function hc(t){const e=ne(t||{}),n={};for(const r of e){const e=t[r];n[r]=Ga(e)?Vr(e):Zr(e)}return n}const dc=[...Os,...Qa,...$u,"background","padding","legend","lineBreak","scale","style","title","view"];function pc(t={}){const{color:e,font:n,fontSize:r,selection:i}=t,o=rc(t,["color","font","fontSize","selection"]),s=pt({},Nt(uc),n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(t={}){return{signals:[{name:"color",value:ht(t)?Object.assign(Object.assign({},fc),t):fc}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:ht(t)?Object.assign(Object.assign({},lc),t):lc}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&(0,W.writeConfig)(s,"selection",i,!0);const a=zt(s,dc);for(const u of["background","lineBreak","padding"])s[u]&&(a[u]=Zr(s[u]));for(const u of Os)s[u]&&(a[u]=Dr(s[u]));for(const u of Qa)s[u]&&(a[u]=hc(s[u]));for(const u of $u)s[u]&&(a[u]=Dr(s[u]));return s.legend&&(a.legend=Dr(s.legend)),s.scale&&(a.scale=Dr(s.scale)),s.style&&(a.style=function(t){const e=ne(t),n={};for(const r of e)n[r]=hc(t[r]);return n}(s.style)),s.title&&(a.title=Dr(s.title)),s.view&&(a.view=Dr(s.view)),a}const gc=["view",...ws],mc=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],yc=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},{area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]});function vc(t){t=Nt(t);for(const e of mc)delete t[e];if(t.axis)for(const e in t.axis)Ga(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of Ru)delete t.legend[e];if(t.mark){for(const e of As)delete t.mark[e];t.mark.tooltip&&ht(t.mark.tooltip)&&delete t.mark.tooltip}t.params&&(t.signals=(t.signals||[]).concat(Yu(t.params)),delete t.params);for(const e of gc){for(const r of As)delete t[e][r];const n=yc[e];if(n)for(const r of n)delete t[e][r];bc(t,e)}for(const e of ne(ju))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=jr(t.title);ee(e)||(t.style["group-title"]=Object.assign(Object.assign({},t.style["group-title"]),e));ee(n)||(t.style["group-subtitle"]=Object.assign(Object.assign({},t.style["group-subtitle"]),n));ee(r)?delete t.title:t.title=r}(t);for(const e in t)ht(t[e])&&ee(t[e])&&delete t[e];return ee(t)?void 0:t}function bc(t,e,n,r){const i=r?t[e][r]:t[e];"view"===e&&(n="cell");const o=Object.assign(Object.assign({},i),t.style[null!==n&&void 0!==n?n:e]);ee(o)||(t.style[null!==n&&void 0!==n?n:e]=o),r||delete t[e]}function xc(t){return"layer"in t}var wc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class _c{map(t,e){return ra(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):Qu(t)?this.mapHConcat(t,e):Ju(t)?this.mapVConcat(t,e):Ku(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(xc(t))return this.mapLayer(t,e);if(tu(t))return this.mapUnit(t,e);throw new Error(ii(t))}mapLayer(t,e){return Object.assign(Object.assign({},t),{layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))})}mapHConcat(t,e){return Object.assign(Object.assign({},t),{hconcat:t.hconcat.map((t=>this.map(t,e)))})}mapVConcat(t,e){return Object.assign(Object.assign({},t),{vconcat:t.vconcat.map((t=>this.map(t,e)))})}mapConcat(t,e){const{concat:n}=t,r=wc(t,["concat"]);return Object.assign(Object.assign({},r),{concat:n.map((t=>this.map(t,e)))})}mapFacet(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}mapRepeat(t,e){return Object.assign(Object.assign({},t),{spec:this.map(t.spec,e)})}}const Ec={zero:1,center:1,normalize:1};const Ac=new Set([os,as,ss,hs,ls,ms,ys,cs,ds,ps]),Oc=new Set([as,ss,os]);function Sc(t){return da(t)&&"quantitative"===pa(t)&&!t.bin}function Cc(t,e){var n,r;const i="x"===e?"y":"radius",o=t[e],s=t[i];if(da(o)&&da(s))if(Sc(o)&&Sc(s)){if(o.stack)return e;if(s.stack)return i;const t=da(o)&&!!o.aggregate;if(t!==(da(s)&&!!s.aggregate))return t?e:i;{const t=null===(n=o.scale)||void 0===n?void 0:n.type,a=null===(r=s.scale)||void 0===r?void 0:r.type;if(t&&"linear"!==t)return i;if(a&&"linear"!==a)return e}}else{if(Sc(o))return e;if(Sc(s))return i}else{if(Sc(o))return e;if(Sc(s))return i}}function Mc(t,e,n={}){var r,i;const o=_s(t)?t.type:t;if(!Ac.has(o))return null;const s=Cc(e,"x")||Cc(e,"theta");if(!s)return null;const a=e[s],u=da(a)?Sa(a,{}):void 0;let c=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(s),l=e[c],f=da(l)?Sa(l,{}):void 0;f===u&&(f=void 0,l=void 0,c=void 0);const h=Wn.reduce(((t,n)=>{if("tooltip"!==n&&ru(e,n)){const r=e[n];for(const e of yt(r)){const r=La(e);if(r.aggregate)continue;const i=Sa(r,{});i&&i===f||t.push({channel:n,fieldDef:r})}}return t}),[]);let d;if(void 0!==a.stack?d=wt(a.stack)?a.stack?"zero":null:a.stack:Oc.has(o)&&(d="zero"),!d||!(d in Ec))return null;var p;if(iu(e)&&0===h.length)return null;if((null===(r=null===a||void 0===a?void 0:a.scale)||void 0===r?void 0:r.type)&&(null===(i=null===a||void 0===a?void 0:a.scale)||void 0===i?void 0:i.type)!==xo){if(n.disallowNonLinearStack)return null;Ri(function(t){return`Cannot stack non-linear scale (${t}).`}(a.scale.type))}return va(e[kn(s)])?(void 0!==a.stack&&Ri(`Cannot stack "${p=s}" if there is already "${p}2".`),null):(da(a)&&a.aggregate&&!Zt(Er,a.aggregate)&&Ri(`Stacking is applied even though the aggregate function is non-summative ("${a.aggregate}").`),{groupbyChannel:l?c:void 0,groupbyField:f,fieldChannel:s,impute:null!==a.impute&&bs(o),stackBy:h,offset:d})}var Pc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function kc(t){const{point:e,line:n}=t,r=Pc(t,["point","line"]);return ne(r).length>1?r:r.type}function Tc(t){for(const e of["line","area","rule","trail"])t[e]&&(t=Object.assign(Object.assign({},t),{[e]:zt(t[e],["point","line"])}));return t}function Dc(t,e={},n){return"transparent"===t.point?{opacity:0}:t.point?ht(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?ht(e.point)?e.point:{}:void 0}function Fc(t,e={}){return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class jc{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(tu(t)){const{mark:n,encoding:r}=t,i=_s(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!Dc(i,e[i.type],r);case"area":return!!Dc(i,e[i.type],r)||!!Fc(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{params:i,projection:o,mark:s,encoding:a}=t,u=Pc(t,["params","projection","mark","encoding"]),c=au(a,r),l=_s(s)?s:{type:s},f=Dc(l,r[l.type],c),h="area"===l.type&&Fc(l,r[l.type]),d=[Object.assign(Object.assign({},i?{params:i}:{}),{mark:kc(Object.assign(Object.assign({},"area"===l.type&&void 0===l.opacity&&void 0===l.fillOpacity?{opacity:.7}:{}),l)),encoding:zt(c,["shape"])})],p=Mc(l,c);let g=c;if(p){const{fieldChannel:t,offset:e}=p;g=Object.assign(Object.assign({},c),{[t]:Object.assign(Object.assign({},c[t]),e?{stack:e}:{})})}return h&&d.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"line"},Bt(l,["clip","interpolate","tension","tooltip"])),h),encoding:g})),f&&d.push(Object.assign(Object.assign({},o?{projection:o}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},Bt(l,["clip","tooltip"])),f),encoding:g})),n(Object.assign(Object.assign({},u),{layer:d}),Object.assign(Object.assign({},e),{config:Tc(r)}))}}var Lc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Rc(t,e){return e?ea(t)?Uc(t,e):Bc(t,e):t}function Ic(t,e){return e?Uc(t,e):t}function Nc(t,e,n){const r=e[t];return function(t){return t&&!Et(t)&&"repeat"in t}(r)?r.repeat in n?Object.assign(Object.assign({},e),{[t]:n[r.repeat]}):void Ri(function(t){return`Unknown repeated value "${t}".`}(r.repeat)):e}function Bc(t,e){if(void 0!==(t=Nc("field",t,e))){if(null===t)return null;if(sa(t)&&Qs(t.sort)){const n=Nc("field",t.sort,e);t=Object.assign(Object.assign({},t),n?{sort:n}:{})}return t}}function zc(t,e){if(da(t))return Bc(t,e);{const n=Nc("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function $c(t,e){if(!va(t)){if(ha(t)){const n=zc(t.condition,e);if(n)return Object.assign(Object.assign({},t),{condition:n});{const{condition:e}=t;return Lc(t,["condition"])}}return t}{const n=zc(t,e);if(n)return n;if(la(t))return{condition:t.condition}}}function Uc(t,e){const n={};for(const r in t)if(xt(t,r)){const i=t[r];if(ft(i))n[r]=i.map((t=>$c(t,e))).filter((t=>t));else{const t=$c(i,e);void 0!==t&&(n[r]=t)}}return n}class Vc{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(tu(t)){const{encoding:e,mark:n}=t;if("line"===n||_s(n)&&"line"===n.type)for(const t of Sn){const n=e[Mn(t)];if(e[t]&&(da(n)&&!Cr(n.bin)||ga(n)))return!0}}return!1}run(t,e,n){const{encoding:r,mark:i}=t;var o,s;return Ri((o=!!r.x2,s=!!r.y2,`Line mark is for continuous lines and thus cannot be used with ${o&&s?"x2 and y2":o?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),n(Object.assign(Object.assign({},t),{mark:ht(i)?Object.assign(Object.assign({},i),{type:"rule"}):"rule"}),e)}}var Zc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Wc({parentEncoding:t,encoding:e={},layer:n}){let r={};if(t){const i=new Set([...ne(t),...ne(e)]);for(const o of i){const i=e[o],s=t[o];if(va(i)){const t=Object.assign(Object.assign({},s),i);r[o]=t}else ha(i)?r[o]=Object.assign(Object.assign({},i),{condition:Object.assign(Object.assign({},s),i.condition)}):i||null===i?r[o]=i:(n||xa(s)||Rr(s)||va(s)||ft(s))&&(r[o]=s)}}else r=e;return!r||ee(r)?void 0:r}function qc(t){const{parentProjection:e,projection:n}=t;return e&&n&&Ri(function(t){const{parentProjection:e,projection:n}=t;return`Layer's shared projection ${$t(e)} is overridden by a child projection ${$t(n)}.`}({parentProjection:e,projection:n})),null!==n&&void 0!==n?n:e}function Gc(t){return"filter"in t}function Hc(t){return"lookup"in t}function Xc(t){return"pivot"in t}function Yc(t){return"density"in t}function Kc(t){return"quantile"in t}function Jc(t){return"regression"in t}function Qc(t){return"loess"in t}function tl(t){return"sample"in t}function el(t){return"window"in t}function nl(t){return"joinaggregate"in t}function rl(t){return"flatten"in t}function il(t){return"calculate"in t}function ol(t){return"bin"in t}function sl(t){return"impute"in t}function al(t){return"timeUnit"in t}function ul(t){return"aggregate"in t}function cl(t){return"stack"in t}function ll(t){return"fold"in t}var fl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function hl(t,e){const{transform:n}=t,r=fl(t,["transform"]);if(n){const t=n.map((t=>{if(Gc(t))return{filter:gl(t,e)};if(ol(t)&&Mr(t.bin))return Object.assign(Object.assign({},t),{bin:pl(t.bin)});if(Hc(t)){const e=t.from,{selection:n}=e,r=fl(e,["selection"]);return n?Object.assign(Object.assign({},t),{from:Object.assign({param:n},r)}):t}return t}));return Object.assign(Object.assign({},r),{transform:t})}return t}function dl(t,e){var n,r;const i=Nt(t);if(da(i)&&Mr(i.bin)&&(i.bin=pl(i.bin)),wa(i)&&(null===(r=null===(n=i.scale)||void 0===n?void 0:n.domain)||void 0===r?void 0:r.selection)){const t=i.scale.domain,{selection:e}=t,n=fl(t,["selection"]);i.scale.domain=Object.assign(Object.assign({},n),e?{param:e}:{})}if(la(i))if((0,W.isArray)(i.condition))i.condition=i.condition.map((t=>{const{selection:n,param:r,test:i}=t,o=fl(t,["selection","param","test"]);return r?t:Object.assign(Object.assign({},o),{test:gl(t,e)})}));else{const t=dl(i.condition,e),{selection:n,param:r,test:o}=t,s=fl(t,["selection","param","test"]);i.condition=r?i.condition:Object.assign(Object.assign({},s),{test:gl(i.condition,e)})}return i}function pl(t){const e=t.extent;if(null===e||void 0===e?void 0:e.selection){const{selection:n}=e,r=fl(e,["selection"]);return Object.assign(Object.assign({},t),{extent:Object.assign(Object.assign({},r),{param:n})})}return t}function gl(t,e){const n=t=>Rt(t,(t=>{var n,r,i;const o={param:t,empty:null===(n=e.emptySelections[t])||void 0===n||n};return null!==(r=(i=e.selectionPredicates)[t])&&void 0!==r||(i[t]=[]),e.selectionPredicates[t].push(o),o}));return t.selection?n(t.selection):Rt(t.test||t.filter,(t=>t.selection?n(t.selection):t))}class ml extends _c{map(t,e){var n;const r=null!==(n=e.selections)&&void 0!==n?n:[];if(t.params&&!tu(t)){const e=[];for(const n of t.params)Hu(n)?r.push(n):e.push(n);t.params=e}return e.selections=r,super.map(t,yl(t,e))}mapUnit(t,e){var n;const r=e.selections;if(!r||!r.length)return t;const i=(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name),o=[];for(const s of r)if(s.views&&s.views.length)for(const e of s.views)((0,W.isString)(e)&&(e===t.name||i.indexOf(e)>=0)||(0,W.isArray)(e)&&e.map((t=>i.indexOf(t))).every(((t,e,n)=>-1!==t&&(0===e||t>n[e-1]))))&&o.push(s);else o.push(s);return o.length&&(t.params=o),t}}for(const jb of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const t=ml.prototype[jb];ml.prototype[jb]=function(e,n){return t.call(this,e,yl(e,n))}}function yl(t,e){var n;return t.name?Object.assign(Object.assign({},e),{path:(null!==(n=e.path)&&void 0!==n?n:[]).concat(t.name)}):e}function vl(t,e){void 0===e&&(e=pc(t.config));const n=function(t,e={}){const n={config:e};return wl.map(bl.map(xl.map(t,n),n),n)}(t,e),{width:r,height:i}=t,o=function(t,e,n){let{width:r,height:i}=e;const o=tu(t)||xc(t),s={};o?"container"==r&&"container"==i?(s.type="fit",s.contains="padding"):"container"==r?(s.type="fit-x",s.contains="padding"):"container"==i&&(s.type="fit-y",s.contains="padding"):("container"==r&&(Ri(si("width")),r=void 0),"container"==i&&(Ri(si("height")),i=void 0));const a=Object.assign(Object.assign(Object.assign({type:"pad"},s),n?_l(n.autosize):{}),_l(t.autosize));"fit"!==a.type||o||(Ri(oi),a.type="pad");"container"==r&&"fit"!=a.type&&"fit-x"!=a.type&&Ri(ai("width"));"container"==i&&"fit"!=a.type&&"fit-y"!=a.type&&Ri(ai("height"));if(It(a,{type:"pad"}))return;return a}(n,{width:r,height:i,autosize:t.autosize},e);return Object.assign(Object.assign({},n),o?{autosize:o}:{})}const bl=new class extends _c{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[xu,Su,Du,new jc,new Vc]}map(t,e){if(tu(t)){const n=ru(t.encoding,Se),r=ru(t.encoding,Ce),i=ru(t.encoding,Me);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=Ic(t.encoding,e.repeater),o=Object.assign(Object.assign({},t),i?{encoding:i}:{});if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,e);const s=this.mapLayerOrUnit.bind(this);for(const a of this.nonFacetUnitNormalizers)if(a.hasMatchingType(o,e.config))return a.run(o,e,s);return o}mapRepeat(t,e){return function(t){return!ft(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r}=t,i=Zc(t,["repeat","spec"]),{row:o,column:s,layer:a}=n,{repeater:u={},repeaterPrefix:c=""}=e;return o||s?this.mapRepeat(Object.assign(Object.assign({},t),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),s?{column:s}:{}),spec:{repeat:{layer:a},spec:r}}),e):Object.assign(Object.assign({},i),{layer:a.map((t=>{const n=Object.assign(Object.assign({},u),{layer:t}),i=`${(r.name||"")+c}child__layer_${se(t)}`,o=this.mapLayerOrUnit(r,Object.assign(Object.assign({},e),{repeater:n,repeaterPrefix:i}));return o.name=i,o}))})}mapNonLayerRepeat(t,e){var n;const{repeat:r,spec:i,data:o}=t,s=Zc(t,["repeat","spec","data"]);!ft(r)&&t.columns&&(t=zt(t,["columns"]),Ri(pi("repeat")));const a=[],{repeater:u={},repeaterPrefix:c=""}=e,l=!ft(r)&&r.row||[u?u.row:null],f=!ft(r)&&r.column||[u?u.column:null],h=ft(r)&&r||[u?u.repeat:null];for(const p of h)for(const t of l)for(const n of f){const o={repeat:p,row:t,column:n,layer:u.layer},s=(i.name||"")+c+"child__"+(ft(r)?`${se(p)}`:(r.row?`row_${se(t)}`:"")+(r.column?`column_${se(n)}`:"")),l=this.map(i,Object.assign(Object.assign({},e),{repeater:o,repeaterPrefix:s}));l.name=s,a.push(zt(l,["data"]))}const d=ft(r)?t.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=i.data)&&void 0!==n?n:o,align:"all"},s),{columns:d,concat:a})}mapFacet(t,e){const{facet:n}=t;return ea(n)&&t.columns&&(t=zt(t,["columns"]),Ri(pi("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:s}=e,a=qc({parentProjection:o,projection:r}),u=Wc({parentEncoding:i,encoding:Ic(n,e.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},t),a?{projection:a}:{}),u?{encoding:u}:{}),{config:s})}mapFacetedUnit(t,e){const n=t.encoding,{row:r,column:i,facet:o}=n,s=Zc(n,["row","column","facet"]),{mark:a,width:u,projection:c,height:l,view:f,params:h,encoding:d}=t,p=Zc(t,["mark","width","projection","height","view","params","encoding"]),{facetMapping:g,layout:m}=this.getFacetMappingAndLayout({row:r,column:i,facet:o},e),y=Ic(s,e.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},p),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},u?{width:u}:{}),l?{height:l}:{}),f?{view:f}:{}),c?{projection:c}:{}),{mark:a,encoding:y}),h?{params:h}:{})}),e)}getFacetMappingAndLayout(t,e){var n;const{row:r,column:i,facet:o}=t;if(r||i){o&&Ri(`Facet encoding dropped as ${(s=[...r?[Se]:[],...i?[Ce]:[]]).join(" and ")} ${s.length>1?"are":"is"} also specified.`);const e={},a={};for(const r of[Se,Ce]){const i=t[r];if(i){const{align:t,center:o,spacing:s,columns:u}=i,c=Zc(i,["align","center","spacing","columns"]);e[r]=c;for(const e of["align","center","spacing"])void 0!==i[e]&&(null!==(n=a[e])&&void 0!==n||(a[e]={}),a[e][r]=i[e])}}return{facetMapping:e,layout:a}}{const{align:t,center:n,spacing:r,columns:i}=o;return{facetMapping:Rc(Zc(o,["align","center","spacing","columns"]),e.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},t?{align:t}:{}),n?{center:n}:{}),r?{spacing:r}:{}),i?{columns:i}:{})}}var s}mapLayer(t,e){var{parentEncoding:n,parentProjection:r}=e,i=Zc(e,["parentEncoding","parentProjection"]);const{encoding:o,projection:s}=t,a=Zc(t,["encoding","projection"]),u=Object.assign(Object.assign({},i),{parentEncoding:Wc({parentEncoding:n,encoding:o,layer:!0}),parentProjection:qc({parentProjection:r,projection:s})});return super.mapLayer(a,u)}},xl=new class extends _c{map(t,e){var n,r;return null!==(n=e.emptySelections)&&void 0!==n||(e.emptySelections={}),null!==(r=e.selectionPredicates)&&void 0!==r||(e.selectionPredicates={}),t=hl(t,e),super.map(t,e)}mapLayerOrUnit(t,e){if((t=hl(t,e)).encoding){const n={};for(const[r,i]of ie(t.encoding))n[r]=dl(i,e);t=Object.assign(Object.assign({},t),{encoding:n})}return super.mapLayerOrUnit(t,e)}mapUnit(t,e){const n=t,{selection:r}=n,i=fl(n,["selection"]);return r?Object.assign(Object.assign({},i),{params:ie(r).map((([t,n])=>{var r;const i=n,{init:o,bind:s,empty:a}=i,u=fl(i,["init","bind","empty"]);"single"===u.type?(u.type="point",u.toggle=!1):"multi"===u.type&&(u.type="point"),e.emptySelections[t]="none"!==a;for(const c of re(null!==(r=e.selectionPredicates[t])&&void 0!==r?r:{}))c.empty="none"!==a;return{name:t,value:o,select:u,bind:s}}))}):t}},wl=new ml;function _l(t){return Et(t)?{type:t}:null!==t&&void 0!==t?t:{}}const El=["background","padding"];function Al(t,e){const n={};for(const r of El)t&&void 0!==t[r]&&(n[r]=Zr(t[r]));return e&&(n.params=t.params),n}class Ol{constructor(t={},e={}){this.explicit=t,this.implicit=e}clone(){return new Ol(Nt(this.explicit),Nt(this.implicit))}combine(){return Object.assign(Object.assign({},this.explicit),this.implicit)}get(t){return ye(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:e,explicit:n}){void 0!==e&&this.set(t,e,n)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,{explicit:e,implicit:n}){void 0!==e[t]?this.set(t,e[t],!0):void 0!==n[t]&&this.set(t,n[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of ne(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function Sl(t){return{explicit:!0,value:t}}function Cl(t){return{explicit:!1,value:t}}function Ml(t){return(e,n,r,i)=>{const o=t(e.value,n.value);return o>0?e:o<0?n:Pl(e,n,r,i)}}function Pl(t,e,n,r){return t.explicit&&e.explicit&&Ri(function(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${$t(n)} and ${$t(r)}). Using ${$t(n)}.`}(n,r,t.value,e.value)),t}function kl(t,e,n,r,i=Pl){return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:It(t.value,e.value)?t:i(t,e,n,r)}class Tl extends Ol{constructor(t={},e={},n=!1){super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function Dl(t){return"url"in t}function Fl(t){return"values"in t}function jl(t){return"name"in t&&!Dl(t)&&!Fl(t)&&!Ll(t)}function Ll(t){return t&&(Rl(t)||Il(t)||Nl(t))}function Rl(t){return"sequence"in t}function Il(t){return"sphere"in t}function Nl(t){return"graticule"in t}var Bl;!function(t){t[t.Raw=0]="Raw",t[t.Main=1]="Main",t[t.Row=2]="Row",t[t.Column=3]="Column",t[t.Lookup=4]="Lookup"}(Bl||(Bl={}));const zl="[",$l="]",Ul=/[[\]{}]/,Vl={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Zl,Wl;function ql(t,e,n){return Zl=e||"view",Wl=n||Vl,Hl(t.trim()).map(Xl)}function Gl(t,e,n,r,i){const o=t.length;let s,a=0;for(;e<o;++e){if(s=t[e],!a&&s===n)return e;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return e}function Hl(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=Gl(t,i,",","[{","]}"),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function Xl(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=Gl(t,r,$l,zl,$l),r===e)throw"Empty between selector: "+t;if(n=Hl(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(">"!==(t=t.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+t;n=n.map(Xl);const i=Xl(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:Zl},n=[];let r,i,o=[0,0],s=0,a=0,u=t.length,c=0;if("}"===t[u-1]){if(c=t.lastIndexOf("{"),!(c>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(",");if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(c+1,u-1))}catch(l){throw"Invalid throttle specification: "+t}u=(t=t.slice(0,c).trim()).length,c=0}if(!u)throw t;"@"===t[0]&&(s=++c);r=Gl(t,c,":"),r<u&&(n.push(t.substring(a,r).trim()),a=c=++r);if(c=Gl(t,c,zl),c===u)n.push(t.substring(a,u).trim());else if(n.push(t.substring(a,c).trim()),i=[],a=++c,a===u)throw"Unmatched left bracket: "+t;for(;c<u;){if(c=Gl(t,c,$l),c===u)throw"Unmatched left bracket: "+t;if(i.push(t.substring(a,c).trim()),c<u-1&&t[++c]!==zl)throw"Expected left bracket: "+t;a=++c}if(!(u=n.length)||Ul.test(n[u-1]))throw"Invalid event selector: "+t;u>1?(e.type=n[1],s?e.markname=n[0].slice(1):!function(t){return Wl[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);o[0]&&(e.throttle=o[0]);o[1]&&(e.debounce=o[1]);return e}(t)}var Yl=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Kl(t,e=!0,n=ct){if(ft(t)){const r=t.map((t=>Kl(t,e,n)));return e?`[${r.join(", ")}]`:r}return Ii(t)?n(e?Vi(t):function(t){const e=Ui(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n($t(t)):t}function Jl(t,e){var n;for(const r of re(null!==(n=t.component.selection)&&void 0!==n?n:{})){const n=r.name;let i=`${n}${uh}, ${"global"===r.resolve?"true":`{unit: ${hh(t)}}`}`;for(const o of fh)o.defined(r)&&(o.signals&&(e=o.signals(t,r,e)),o.modifyExpr&&(i=o.modifyExpr(t,r,i)));e.push({name:n+ch,on:[{events:{signal:r.name+uh},update:`modify(${At(r.name+ah)}, ${i})`}]})}return tf(e)}function Ql(t,e){var n;for(const r of re(null!==(n=t.component.selection)&&void 0!==n?n:{}))for(const n of fh)n.defined(r)&&n.marks&&(e=n.marks(t,r,e));return e}function tf(t){return t.map((t=>(t.on&&!t.on.length&&delete t.on,t)))}class ef{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.includes(t)?Ri("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const n of this._children)n.parent=t;this._children=[],t.removeChild(this),t.parent.removeChild(t),this.parent=e,t.parent=this}}class nf extends ef{constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${be()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}var rf=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class of extends ef{constructor(t,e){super(t),this.formula=e}clone(){return new of(null,Nt(this.formula))}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,e)=>{const{field:n,timeUnit:r}=e;if(r){const i=Sa(e,{forAs:!0});t[Ut({as:i,field:n,timeUnit:r})]={as:i,field:n,timeUnit:r}}return t}),{});return ee(n)?null:new of(t,n)}static makeFromTransform(t,e){const n=Object.assign({},e),{timeUnit:r}=n,i=rf(n,["timeUnit"]),o=Qi(r),s=Object.assign(Object.assign({},i),{timeUnit:o});return new of(t,{[Ut(s)]:s})}merge(t){this.formula=Object.assign({},this.formula);for(const e in t.formula)this.formula[e]||(this.formula[e]=t.formula[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}removeFormulas(t){const e={};for(const[n,r]of ie(this.formula))t.has(r.as)||(e[n]=r);this.formula=e}producedFields(){return new Set(re(this.formula).map((t=>t.as)))}dependentFields(){return new Set(re(this.formula).map((t=>t.field)))}hash(){return`TimeUnit ${Ut(this.formula)}`}assemble(){const t=[];for(const e of re(this.formula)){const{field:n,as:r,timeUnit:i}=e,o=Qi(i),{unit:s,utc:a}=o,u=rf(o,["unit","utc"]);t.push(Object.assign(Object.assign(Object.assign(Object.assign({field:de(n),type:"timeunit"},s?{units:Xi(s)}:{}),a?{timezone:"utc"}:{}),u),{as:[r,`${r}_end`]}))}return t}}var sf=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const af="_tuple_fields";class uf{constructor(...t){this.items=t,this.hasChannel={},this.hasField={}}}var cf={defined:()=>!0,parse:(t,e,n)=>{var r;const i=e.name,o=null!==(r=e.project)&&void 0!==r?r:e.project=new uf,s={},a={},u=new Set,c=(t,e)=>{const n="visual"===e?t.channel:t.field;let r=se(`${i}_${n}`);for(let o=1;u.has(r);o++)r=se(`${i}_${n}_${o}`);return u.add(r),{[e]:r}},l=e.type,f=t.config.selection[l],h=void 0!==n.value?yt(n.value):null;let{fields:d,encodings:p}=ht(n.select)?n.select:{};if(!d&&!p&&h)for(const g of h)if(ht(g))for(const t of ne(g))An[t]?(p||(p=[])).push(t):"interval"===l?(Ri('Interval selections should be initialized using "x" and/or "y" keys.'),p=f.encodings):(d||(d=[])).push(t);d||p||(p=f.encodings,"fields"in f&&(d=f.fields));for(const g of null!==p&&void 0!==p?p:[]){const e=t.fieldDef(g);if(e){let n=e.field;if(e.aggregate){Ri(fi(g,e.aggregate));continue}if(!n){Ri(li(g));continue}if(e.timeUnit){n=t.vgField(g);const r={timeUnit:e.timeUnit,as:n,field:e.field};a[Ut(r)]=r}if(!s[n]){let r="E";if("interval"===l){Vo(t.getScaleComponent(g).get("type"))&&(r="R")}else e.bin&&(r="R-RE");const i={field:n,channel:g,type:r};i.signals=Object.assign(Object.assign({},c(i,"data")),c(i,"visual")),o.items.push(s[n]=i),o.hasField[n]=o.hasChannel[g]=s[n]}}else Ri(li(g))}for(const g of null!==d&&void 0!==d?d:[]){if(o.hasField[g])continue;const t={type:"E",field:g};t.signals=Object.assign({},c(t,"data")),o.items.push(t),o.hasField[g]=t}h&&(e.init=h.map((t=>o.items.map((e=>ht(t)?void 0!==t[e.channel]?t[e.channel]:t[e.field]:t))))),ee(a)||(o.timeUnit=new of(null,a))},signals:(t,e,n)=>{const r=e.name+af;return n.filter((t=>t.name===r)).length>0?n:n.concat({name:r,value:e.project.items.map((t=>{const{signals:e,hasLegend:n}=t,r=sf(t,["signals","hasLegend"]);return r.field=de(r.field),r}))})}};var lf={defined:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!lr(i))continue;const o=t.getScaleComponent(i),s=o?o.get("type"):void 0;o&&Vo(s)?(o.set("selectionExtent",{param:e.name,field:r.field},!0),n.push(r)):Ri("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter((t=>0===n.filter((e=>e.name===t.signals.data)).length));if(!t.parent||hf(t)||0===r.length)return n;const i=n.filter((t=>t.name===e.name))[0];let o=i.update;if(o.indexOf(lh)>=0)i.update=`{${r.map((t=>`${At(de(t.field))}: ${t.signals.data}`)).join(", ")}}`;else{for(const t of r){const e=`${At(de(t.field))}: ${t.signals.data}`;o.includes(e)||(o=`${o.substring(0,o.length-1)}, ${e}}`)}i.update=o}return n.concat(r.map((t=>({name:t.signals.data}))))},signals:(t,e,n)=>{if(t.parent&&!hf(t))for(const r of e.scales){const t=n.filter((t=>t.name===r.signals.data))[0];t.push="outer",delete t.value,delete t.update}return n}};function ff(t,e){return`domain(${At(t.scaleName(e))})`}function hf(t){var e;return t.parent&&Cm(t.parent)&&(null!==(e=!t.parent.parent)&&void 0!==e?e:hf(t.parent.parent))}var df=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};const pf="_brush",gf="_scale_trigger";var mf={defined:t=>"interval"===t.type,signals:(t,e,n)=>{const r=e.name,i=r+af,o=lf.defined(e),s=e.init?e.init[0]:null,a=[],u=[];if(e.translate&&!o){const t=`!event.item || event.item.mark.name !== ${At(r+pf)}`;yf(e,((e,n)=>{var r,i;const o=yt(null!==(r=(i=n.between[0]).filter)&&void 0!==r?r:i.filter=[]);return o.includes(t)||o.push(t),e}))}e.project.items.forEach(((r,i)=>{const o=r.channel;if(o!==Pe&&o!==ke)return void Ri("Interval selections only support x and y encoding channels.");const c=s?s[i]:null,l=function(t,e,n,r){const i=n.channel,o=n.signals.visual,s=n.signals.data,a=lf.defined(e),u=At(t.scaleName(i)),c=t.getScaleComponent(i),l=c?c.get("type"):void 0,f=t=>`scale(${u}, ${t})`,h=t.getSizeSignalRef(i===Pe?"width":"height").signal,d=`${i}(unit)`,p=yf(e,((t,e)=>[...t,{events:e.between[0],update:`[${d}, ${d}]`},{events:e,update:`[${o}[0], clamp(${d}, 0, ${h})]`}]));return p.push({events:{signal:e.name+gf},update:Vo(l)?`[${f(`${s}[0]`)}, ${f(`${s}[1]`)}]`:"[0, 0]"}),a?[{name:s,on:[]}]:[Object.assign(Object.assign({name:o},r?{init:Kl(r,!0,f)}:{value:[]}),{on:p}),Object.assign(Object.assign({name:s},r?{init:Kl(r)}:{}),{on:[{events:{signal:o},update:`${o}[0] === ${o}[1] ? null : invert(${u}, ${o})`}]})]}(t,e,r,c),f=r.signals.data,h=r.signals.visual,d=At(t.scaleName(o)),p=Vo(t.getScaleComponent(o).get("type"))?"+":"";n.push(...l),a.push(f),u.push({scaleName:t.scaleName(o),expr:`(!isArray(${f}) || (${p}invert(${d}, ${h})[0] === ${p}${f}[0] && ${p}invert(${d}, ${h})[1] === ${p}${f}[1]))`})})),!o&&u.length&&n.push({name:r+gf,value:{},on:[{events:u.map((t=>({scale:t.scaleName}))),update:`${u.map((t=>t.expr)).join(" && ")} ? ${r+gf} : {}`}]});const c=`unit: ${hh(t)}, fields: ${i}, values`;return n.concat(Object.assign(Object.assign({name:r+uh},s?{init:`{${c}: ${Kl(s)}}`}:{}),a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${c}: [${a}]} : null`}]}:{}))},marks:(t,e,n)=>{const r=e.name,{x:i,y:o}=e.project.hasChannel,s=i&&i.signals.visual,a=o&&o.signals.visual,u=`data(${At(e.name+ah)})`;if(lf.defined(e)||!i&&!o)return n;const c={x:void 0!==i?{signal:`${s}[0]`}:{value:0},y:void 0!==o?{signal:`${a}[0]`}:{value:0},x2:void 0!==i?{signal:`${s}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${a}[1]`}:{field:{group:"height"}}};if("global"===e.resolve)for(const m of ne(c))c[m]=[Object.assign({test:`${u}.length && ${u}[0].unit === ${hh(t)}`},c[m]),{value:0}];const l=e.mark,{fill:f,fillOpacity:h,cursor:d}=l,p=df(l,["fill","fillOpacity","cursor"]),g=ne(p).reduce(((t,e)=>(t[e]=[{test:[void 0!==i&&`${s}[0] !== ${s}[1]`,void 0!==o&&`${a}[0] !== ${a}[1]`].filter((t=>t)).join(" && "),value:p[e]},{value:null}],t)),{});return[{name:`${r+pf}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:f},fillOpacity:{value:h}},update:c}},...n,{name:r+pf,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},d?{cursor:{value:d}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},c),g)}}]}};function yf(t,e){return t.events.reduce(((t,n)=>n.between?e(t,n):(Ri(`${n} is not an ordered event stream for interval selections.`),t)),[])}var vf={defined:t=>"point"===t.type,signals:(t,e,n)=>{var r;const i=e.name,o=i+af,s=e.project,a="(item().isVoronoi ? datum.datum : datum)",u=s.items.map((e=>{const n=t.fieldDef(e.channel);return(null===n||void 0===n?void 0:n.bin)?`[${a}[${At(t.vgField(e.channel,{}))}], ${a}[${At(t.vgField(e.channel,{binSuffix:"end"}))}]]`:`${a}[${At(e.field)}]`})).join(", "),c=`unit: ${hh(t)}, fields: ${o}, values`,l=e.events,f=re(null!==(r=t.component.selection)&&void 0!==r?r:{}).reduce(((t,e)=>"interval"===e.type?t.concat(e.name+pf):t),[]).map((t=>`indexof(item().mark.name, '${t}') < 0`)).join(" && "),h="datum && item().mark.marktype !== 'group'"+(f?` && ${f}`:"");return n.concat([{name:i+uh,on:l?[{events:l,update:`${h} ? {${c}: [${u}]} : null`,force:!0}]:[]}])}};function bf(t,e,n,r){const i=la(e)&&e.condition,o=r(e);if(i){return{[n]:[...yt(i).map((e=>{const n=r(e);if(function(t){return t.param}(e)){const{param:r,empty:i}=e,o=Zd(t,{param:r,empty:i});return Object.assign({test:o},n)}{const r=qd(t,e.test);return Object.assign({test:r},n)}})),...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function xf(t,e="text"){const n=t.encoding[e];return bf(t,n,e,(e=>wf(e,t.config)))}function wf(t,e,n="datum"){if(t){if(xa(t))return qr(t.value);if(va(t)){const{format:r,formatType:i}=ja(t);return zs({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function _f(t,e={}){const{encoding:n,markDef:r,config:i,stack:o}=t,s=n.tooltip;if(ft(s))return{tooltip:Af({tooltip:s},o,i,e)};{const a=e.reactiveGeom?"datum.datum":"datum";return bf(t,s,"tooltip",(t=>{const s=wf(t,i,a);if(s)return s;if(null===t)return;let u=Yr("tooltip",r,i);return!0===u&&(u={content:"encoding"}),Et(u)?{value:u}:ht(u)?Rr(u)?u:"encoding"===u.content?Af(n,o,i,e):{signal:a}:void 0}))}}function Ef(t,e,n,{reactiveGeom:r}={}){const i={},o=r?"datum.datum":"datum",s=[];function a(r,a){const u=Mn(a),c=ba(r)?r:Object.assign(Object.assign({},r),{type:t[u].type}),l=yt(c.title||Fa(c,n)).join(", ");let f;if(Hn(a)){const r="x"===a?"x2":"y2",s=La(t[r]);if(Cr(c.bin)&&s){const t=Sa(c,{expr:o}),e=Sa(s,{expr:o}),{format:a,formatType:u}=ja(c);f=Hs(t,e,a,u,n),i[r]=!0}else if(e&&e.fieldChannel===a&&"normalize"===e.offset){const{format:t,formatType:e}=ja(c);f=zs({fieldOrDatumDef:c,format:t,formatType:e,expr:o,config:n,normalizeStack:!0}).signal}}null!==f&&void 0!==f||(f=wf(c,n,o).signal),s.push({channel:a,key:l,value:f})}uu(t,((t,e)=>{da(t)?a(t,e):fa(t)&&a(t.condition,e)}));const u={};for(const{channel:c,key:l,value:f}of s)i[c]||u[l]||(u[l]=f);return u}function Af(t,e,n,{reactiveGeom:r}={}){const i=Ef(t,e,n,{reactiveGeom:r}),o=ie(i).map((([t,e])=>`"${t}": ${e}`));return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function Of(t){const{markDef:e,config:n}=t,r=Yr("aria",e,n);return!1===r?{}:Object.assign(Object.assign(Object.assign({},r?{aria:r}:{}),function(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=Yr("ariaRoleDescription",n,r);if(null!=i)return{ariaRoleDescription:{value:i}};return e in zr?{}:{ariaRoleDescription:{value:e}}}(t)),function(t){const{encoding:e,markDef:n,config:r,stack:i}=t,o=e.description;if(o)return bf(t,o,"description",(e=>wf(e,t.config)));const s=Yr("description",n,r);if(null!=s)return{description:qr(s)};if(!1===r.aria)return{};const a=Ef(e,i,r);if(ee(a))return;return{description:{signal:ie(a).map((([t,e],n)=>`"${n>0?"; ":""}${t}: " + (${e})`)).join(" + ")}}}(t))}function Sf(t,e,n={}){const{markDef:r,encoding:i,config:o}=e,{vgChannel:s}=n;let{defaultRef:a,defaultValue:u}=n;void 0===a&&(null!==u&&void 0!==u||(u=Yr(t,r,o,{vgChannel:s,ignoreVgConfig:!0})),void 0!==u&&(a=qr(u)));const c=i[t];return bf(e,c,null!==s&&void 0!==s?s:t,(n=>Rs({channel:t,channelDef:n,markDef:r,config:o,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:a})))}function Cf(t,e={filled:void 0}){var n,r,i,o;const{markDef:s,encoding:a,config:u}=t,{type:c}=s,l=null!==(n=e.filled)&&void 0!==n?n:Yr("filled",s,u),f=Zt(["bar","point","circle","square","geoshape"],c)?"transparent":void 0,h=null!==(i=null!==(r=Yr(!0===l?"color":void 0,s,u,{vgChannel:"fill"}))&&void 0!==r?r:u.mark[!0===l&&"color"])&&void 0!==i?i:f,d=null!==(o=Yr(!1===l?"color":void 0,s,u,{vgChannel:"stroke"}))&&void 0!==o?o:u.mark[!1===l&&"color"],p=l?"fill":"stroke",g=Object.assign(Object.assign({},h?{fill:qr(h)}:{}),d?{stroke:qr(d)}:{});return s.color&&(l?s.fill:s.stroke)&&Ri(vi("property",{fill:"fill"in s,stroke:"stroke"in s})),Object.assign(Object.assign(Object.assign(Object.assign({},g),Sf("color",t,{vgChannel:p,defaultValue:l?h:d})),Sf("fill",t,{defaultValue:a.fill?h:void 0})),Sf("stroke",t,{defaultValue:a.stroke?d:void 0}))}function Mf(t,e){const n=e[function(t){switch(t){case Pe:return"xOffset";case ke:return"yOffset";case Te:return"x2Offset";case De:return"y2Offset";case Le:return"thetaOffset";case Fe:return"radiusOffset";case Re:return"theta2Offset";case je:return"radius2Offset"}}(t)];if(n)return n}function Pf(t,e,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=e,u=i[t],c=i[kn(t)],l=e.scaleName(t),f=e.getScaleComponent(t),h=Mf(t,o),d=kf({model:e,defaultPos:n,channel:t,scaleName:l,scale:f}),p=!u&&Hn(t)&&(i.latitude||i.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=t;if(va(n)&&i&&e===i.fieldChannel){if(da(n)){let t=n.bandPosition;if(void 0!==t||"text"!==s.type||"radius"!==e&&"theta"!==e||(t=.5),void 0!==t)return Ls({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:t,offset:o})}return js(n,r,{suffix:"end"},{offset:o})}return ks(t)}({channel:t,channelDef:u,channel2Def:c,markDef:o,config:s,scaleName:l,scale:f,stack:a,offset:h,defaultRef:d});return p?{[r||t]:p}:void 0}function kf({model:t,defaultPos:e,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=t;return()=>{const a=Mn(n),u=Pn(n),c=Yr(n,o,s,{vgChannel:u});if(void 0!==c)return Is(n,c);switch(e){case"zeroOrMin":case"zeroOrMax":if(r){const t=i.get("type");if(Zt([wo,Oo,So],t));else if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}if("zeroOrMin"===e)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":{const e=t[Tn(n)];return Object.assign(Object.assign({},e),{mult:.5})}}}}const Tf={left:"x",center:"xc",right:"x2"},Df={top:"y",middle:"yc",bottom:"y2"};function Ff(t,e,n,r="middle"){if("radius"===t||"theta"===t)return Pn(t);const i="x"===t?"align":"baseline",o=Yr(i,e,n);let s;return Rr(o)?(Ri(function(t){return`The ${t} for range marks cannot be an expression`}(i)),s=void 0):s=o,"x"===t?Tf[s||("top"===r?"left":"center")]:Df[s||r]}function jf(t,e,{defaultPos:n,defaultPos2:r,range:i}){return i?Lf(t,e,{defaultPos:n,defaultPos2:r}):Pf(t,e,{defaultPos:n})}function Lf(t,e,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=e,s=kn(t),a=Tn(t),u=function(t,e,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=t,u=Mn(n),c=Tn(n),l=Pn(n),f=r[u],h=t.scaleName(u),d=t.getScaleComponent(u),p=Mf(n in r||n in o?n:u,t.markDef);if(!f&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const e=Tn(n),r=t.markDef[e];return null!=r?{[e]:{value:r}}:{[l]:{field:t.getName(n)}}}const g=function({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:u,defaultRef:c}){if(va(e)&&a&&t.charAt(0)===a.fieldChannel.charAt(0))return js(e,o,{suffix:"start"},{offset:u});return ks({channel:t,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:u,defaultRef:c})}({channel:n,channelDef:f,channel2Def:r[n],markDef:o,config:a,scaleName:h,scale:d,stack:s,offset:p,defaultRef:void 0});if(void 0!==g)return{[l]:g};return Rf(n,o)||Rf(n,{[n]:Jr(n,o,a.style),[c]:Jr(c,o,a.style)})||Rf(n,a[i])||Rf(n,a.mark)||{[l]:kf({model:t,defaultPos:e,channel:n,scaleName:h,scale:d})()}}(e,r,s),c=u[a]?Ff(t,i,o):Pn(t);return Object.assign(Object.assign({},Pf(t,e,{defaultPos:n,vgChannel:c})),u)}function Rf(t,e){const n=Tn(t),r=Pn(t);if(void 0!==e[r])return{[r]:Is(t,e[r])};if(void 0!==e[t])return{[r]:Is(t,e[t])};if(e[n]){const r=e[n];if(!Ss(r))return{[n]:Is(t,r)};Ri(function(t){return`Position range does not support relative band size for ${t}.`}(n))}}function If(t,e,n){var r,i,o,s;const{config:a,encoding:u,markDef:c}=t,l=kn(e),f=Tn(e),h=u[e],d=u[l],p=t.getScaleComponent(e),g=p?p.get("type"):void 0,m=t.scaleName(e),y=c.orient,v=null!==(i=null!==(r=u[f])&&void 0!==r?r:u.size)&&void 0!==i?i:Yr("size",c,a,{vgChannel:f}),b="bar"===n&&("x"===e?"vertical"===y:"horizontal"===y);if(!da(h)||!(Sr(h.bin)||Cr(h.bin)||h.timeUnit&&!d)||v&&!Ss(v)||Uo(g))return(va(h)&&Uo(g)||b)&&!d?function(t,e,n){const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,u=n.scaleName(e),c=n.getScaleComponent(e),l=Tn(e),f=kn(e),h="horizontal"===a&&"y"===e||"vertical"===a&&"x"===e;let d;(i.size||r.size)&&(h?d=Sf("size",n,{vgChannel:l,defaultRef:qr(r.size)}):Ri(function(t){return`Cannot apply size to non-oriented mark "${t}".`}(r.type)));const p=ua({channel:e,fieldDef:t,markDef:r,config:o,scaleType:null===c||void 0===c?void 0:c.get("type"),useVlSizeChannel:h});d=d||{[l]:Nf(l,u,c,o,p)};const g="band"===(null===c||void 0===c?void 0:c.get("type"))&&"band"in d[l]?"top":"middle",m=Ff(e,r,o,g),y="xc"===m||"yc"===m,v=Mf(e,r),b=ks({channel:e,channelDef:t,markDef:r,config:o,scaleName:u,scale:c,stack:s,offset:v,defaultRef:kf({model:n,defaultPos:"mid",channel:e,scaleName:u,scale:c}),bandPosition:y?.5:Rr(p)?{signal:`(1-${p})/2`}:Ss(p)?(1-p.band)/2:0});if(l)return Object.assign({[m]:b},d);{const t=Pn(f),e=d[l],n=v?Object.assign(Object.assign({},e),{offset:v}):e;return{[m]:b,[t]:ft(b)?[b[0],Object.assign(Object.assign({},b[1]),{offset:n})]:Object.assign(Object.assign({},b),{offset:n})}}}(h,e,t):Lf(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"});{const n=ua({channel:e,fieldDef:h,markDef:c,config:a,scaleType:g}),r=null===(o=t.component.axes[e])||void 0===o?void 0:o[0];return function({fieldDef:t,fieldDef2:e,channel:n,bandSize:r,scaleName:i,markDef:o,spacing:s=0,axisTranslate:a,reverse:u,config:c}){const l=kn(n),f=Pn(n),h=Pn(l),d=Mf(n,o),p=Rr(r)?{signal:`(1-${r.signal})/2`}:Ss(r)?(1-r.band)/2:.5;if(Sr(t.bin)||t.timeUnit)return{[h]:zf({channel:n,fieldDef:t,scaleName:i,markDef:o,bandPosition:p,offset:Bf(l,s,u,a,d),config:c}),[f]:zf({channel:n,fieldDef:t,scaleName:i,markDef:o,bandPosition:Rr(p)?{signal:`1-${p.signal}`}:1-p,offset:Bf(n,s,u,a,d),config:c})};if(Cr(t.bin)){const r=js(t,i,{},{offset:Bf(l,s,u,a,d)});if(da(e))return{[h]:r,[f]:js(e,i,{},{offset:Bf(n,s,u,a,d)})};if(Mr(t.bin)&&t.bin.step)return{[h]:r,[f]:{signal:`scale("${i}", ${Sa(t,{expr:"datum"})} + ${t.bin.step})`,offset:Bf(n,s,u,a,d)}}}return void Ri(Di(l))}({fieldDef:h,fieldDef2:d,channel:e,markDef:c,scaleName:m,bandSize:n,axisTranslate:null!==(s=null===r||void 0===r?void 0:r.get("translate"))&&void 0!==s?s:.5,spacing:Hn(e)?Yr("binSpacing",c,a):void 0,reverse:p.get("reverse"),config:a})}}function Nf(t,e,n,r,i){if(Ss(i)){if(!n)return{mult:i.band,field:{group:t}};{const t=n.get("type");if("band"===t)return{scale:e,band:i.band};1!==i.band&&(Ri(function(t){return`Cannot use the relative band size with ${t} scale.`}(t)),i=void 0)}}else{if(Rr(i))return i;if(i)return{value:i}}if(n){const t=n.get("range");if(Ir(t)&&_t(t.step))return{value:t.step-2}}return{value:oc(r.view,t)-2}}function Bf(t,e,n,r,i){if(un(t))return 0;const o="x"===t||"y2"===t?-e/2:e/2;if(Rr(n)||Rr(i)||Rr(r)){const t=Hr(n),e=Hr(i),s=Hr(r);return{signal:(s?`${s} + `:"")+(t?`(${t} ? -1 : 1) * `:"")+(e?`(${e} + ${o})`:o)}}return i=i||0,r+(n?-i-o:+i+o)}function zf({channel:t,fieldDef:e,scaleName:n,markDef:r,bandPosition:i,offset:o,config:s}){return Ts({fieldDef:e,channel:t,markDef:r,ref:Ls({scaleName:n,fieldOrDatumDef:e,bandPosition:i,offset:o}),config:s})}const $f=new Set(["aria","width","height"]);function Uf(t,e){const{fill:n,stroke:r}="include"===e.color?Cf(t):{};return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(t,e){return Br.reduce(((n,r)=>($f.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=qr(t[r])),n)),{})}(t.markDef,e)),Vf(t,"fill",n)),Vf(t,"stroke",r)),Sf("opacity",t)),Sf("fillOpacity",t)),Sf("strokeOpacity",t)),Sf("strokeWidth",t)),Sf("strokeDash",t)),function(t){const{encoding:e,mark:n}=t,r=e.order;return!bs(n)&&xa(r)?bf(t,r,"zindex",(t=>qr(t.value))):{}}(t)),_f(t)),xf(t,"href")),Of(t))}function Vf(t,e,n){const{config:r,mark:i,markDef:o}=t;if("hide"===Yr("invalid",o,r)&&n&&!bs(i)){const r=function(t,{invalid:e=!1,channels:n}){const r=n.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&Vo(i)&&(e[o]=!0)}return e}),{}),i=ne(r);if(i.length>0){const t=e?"||":"&&";return i.map((t=>Fs(t,e))).join(` ${t} `)}return}(t,{invalid:!0,channels:cr});if(r)return{[e]:[{test:r,value:null},...yt(n)]}}return n?{[e]:n}:{}}function Zf(t){const{config:e,markDef:n}=t;if(Yr("invalid",n,e)){const e=function(t,{invalid:e=!1,channels:n}){const r=n.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&Vo(i)&&(e[o]=!0)}return e}),{}),i=ne(r);if(i.length>0){const t=e?"||":"&&";return i.map((t=>Fs(t,e))).join(` ${t} `)}return}(t,{channels:Gn});if(e)return{defined:{signal:e}}}return{}}function Wf(t,e){if(void 0!==e)return{[t]:qr(e)}}const qf="voronoi";var Gf={defined:t=>"point"===t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName(qf)},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,o=t.mark;if(bs(o))return Ri(function(t){return`The "nearest" transform is not supported for ${t} marks.`}(o)),n;const s={name:t.getName(qf),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},_f(t,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let a=0,u=!1;return n.forEach(((e,n)=>{var r;const i=null!==(r=e.name)&&void 0!==r?r:"";i===t.component.mark[0].name?a=n:i.indexOf(qf)>=0&&(u=!0)})),u||n.splice(a+1,0,s),n}};var Hf={defined:t=>"point"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!qu(t.bind),parse:(t,e,n)=>ph(e,n),topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,o=e.bind,s=e.init&&e.init[0],a=Gf.defined(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((t,i)=>{var u,c;const l=se(`${r}_${t.field}`);n.filter((t=>t.name===l)).length||n.unshift(Object.assign(Object.assign({name:l},s?{init:Kl(s[i])}:{value:null}),{on:e.events?[{events:e.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${At(t.field)}] : null`}]:[],bind:null!==(c=null!==(u=o[t.field])&&void 0!==u?u:o[t.channel])&&void 0!==c?c:o}))})),n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.filter((t=>t.name===r+uh))[0],s=r+af,a=i.items.map((t=>se(`${r}_${t.field}`))),u=a.map((t=>`${t} !== null`)).join(" && ");return a.length&&(o.update=`${u} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}};const Xf="_toggle";var Yf={defined:t=>"point"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+Xf,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+uh,r=e.name+Xf;return`${r} ? null : ${n}, `+("global"===e.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${hh(t)}}, `)+`${r} ? ${n} : null`}};const Kf={defined:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e)=>{e.clear&&(e.clear=Et(e.clear)?ql(e.clear,"view"):e.clear)},topLevelSignals:(t,e,n)=>{if(Hf.defined(e))for(const r of e.project.items){const t=n.findIndex((t=>t.name===se(`${e.name}_${r.field}`)));-1!==t&&n[t].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const i of e.project.items){const t=n.findIndex((t=>t.name===i.signals.visual));if(r(t,"[0, 0]"),-1===t){r(n.findIndex((t=>t.name===i.signals.data)),"null")}}else{let t=n.findIndex((t=>t.name===e.name+uh));r(t,"null"),Yf.defined(e)&&(t=n.findIndex((t=>t.name===e.name+Xf)),r(t,"false"))}return n}};const Jf={defined:t=>{const e="global"===t.resolve&&t.bind&&qu(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==Zu;return e&&!n&&Ri("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n)=>{var r;const i=Nt(n);if(i.select=Et(i.select)?{type:i.select,toggle:e.toggle}:Object.assign(Object.assign({},i.select),{toggle:e.toggle}),ph(e,i),(0,W.isObject)(n.select)&&(n.select.on||n.select.clear)){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events)n.filter=yt(null!==(r=n.filter)&&void 0!==r?r:[]),n.filter.includes(t)||n.filter.push(t)}const o=Gu(e.bind)?e.bind.legend:"click",s=Et(o)?ql(o,"view"):yt(o);e.bind={legend:{merge:s}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=Gu(e.bind)&&e.bind.legend,o=t=>e=>{const n=Nt(e);return n.markname=t,n};for(const s of e.project.items){if(!s.hasLegend)continue;const t=`${se(s.field)}_legend`,a=`${r}_${t}`;if(0===n.filter((t=>t.name===a)).length){const r=i.merge.map(o(`${t}_symbols`)).concat(i.merge.map(o(`${t}_labels`))).concat(i.merge.map(o(`${t}_entries`)));n.unshift(Object.assign(Object.assign({name:a},e.init?{}:{value:null}),{on:[{events:r,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${a}`,force:!0}]}))}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.find((t=>t.name===r+uh)),s=r+af,a=i.items.filter((t=>t.hasLegend)).map((t=>se(`${r}_${se(t.field)}_legend`))),u=`${a.map((t=>`${t} !== null`)).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;e.events&&a.length>0?o.on.push({events:a.map((t=>({signal:t}))),update:u}):a.length>0&&(o.update=u,delete o.value,delete o.on);const c=n.find((t=>t.name===r+Xf)),l=Gu(e.bind)&&e.bind.legend;return c&&(e.events?c.on.push(Object.assign(Object.assign({},c.on[0]),{events:l})):c.on[0].events=l),n}};const Qf="_translate_anchor",th="_translate_delta",eh={defined:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=lf.defined(e),o=r+Qf,{x:s,y:a}=e.project.hasChannel;let u=ql(e.translate,"scope");return i||(u=u.map((t=>(t.between[0].markname=r+pf,t)))),n.push({name:o,value:{},on:[{events:u.map((t=>t.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==s?`, extent_x: ${i?ff(t,Pe):`slice(${s.signals.visual})`}`:"")+(void 0!==a?`, extent_y: ${i?ff(t,ke):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+th,value:{},on:[{events:u,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==s&&nh(t,e,s,"width",n),void 0!==a&&nh(t,e,a,"height",n),n}};function nh(t,e,n,r,i){var o,s;const a=e.name,u=a+Qf,c=a+th,l=n.channel,f=lf.defined(e),h=i.filter((t=>t.name===n.signals[f?"data":"visual"]))[0],d=t.getSizeSignalRef(r).signal,p=t.getScaleComponent(l),g=p.get("type"),m=p.get("reverse"),y=`${u}.extent_${l}`,v=`${f?"log"===g?"panLog":"symlog"===g?"panSymlog":"pow"===g?"panPow":"panLinear":"panLinear"}(${y}, ${`${f?l===Pe?m?"":"-":m?"-":"":""}${c}.${l} / ${f?`${d}`:`span(${y})`}`}${f?"pow"===g?`, ${null!==(o=p.get("exponent"))&&void 0!==o?o:1}`:"symlog"===g?`, ${null!==(s=p.get("constant"))&&void 0!==s?s:1}`:"":""})`;h.on.push({events:{signal:c},update:f?v:`clampRange(${v}, 0, ${d})`})}const rh="_zoom_anchor",ih="_zoom_delta",oh={defined:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=lf.defined(e),o=r+ih,{x:s,y:a}=e.project.hasChannel,u=At(t.scaleName(Pe)),c=At(t.scaleName(ke));let l=ql(e.zoom,"scope");return i||(l=l.map((t=>(t.markname=r+pf,t)))),n.push({name:r+rh,on:[{events:l,update:i?"{"+[u?`x: invert(${u}, x(unit))`:"",c?`y: invert(${c}, y(unit))`:""].filter((t=>!!t)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:l,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==s&&sh(t,e,s,"width",n),void 0!==a&&sh(t,e,a,"height",n),n}};function sh(t,e,n,r,i){var o,s;const a=e.name,u=n.channel,c=lf.defined(e),l=i.filter((t=>t.name===n.signals[c?"data":"visual"]))[0],f=t.getSizeSignalRef(r).signal,h=t.getScaleComponent(u),d=h.get("type"),p=c?ff(t,u):l.name,g=a+ih,m=`${c?"log"===d?"zoomLog":"symlog"===d?"zoomSymlog":"pow"===d?"zoomPow":"zoomLinear":"zoomLinear"}(${p}, ${`${a}_zoom_anchor.${u}`}, ${g}${c?"pow"===d?`, ${null!==(o=h.get("exponent"))&&void 0!==o?o:1}`:"symlog"===d?`, ${null!==(s=h.get("constant"))&&void 0!==s?s:1}`:"":""})`;l.on.push({events:{signal:g},update:c?m:`clampRange(${m}, 0, ${f})`})}const ah="_store",uh="_tuple",ch="_modify",lh="vlSelectionResolve",fh=[vf,mf,cf,Yf,Hf,lf,Jf,Kf,eh,oh,Gf];function hh(t,{escape:e}={escape:!0}){let n=e?At(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!Om(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of pn)t[e]&&(n+=` + '__facet_${e}_' + (facet[${At(r.vgField(e))}])`)}return n}function dh(t){var e;return re(null!==(e=t.component.selection)&&void 0!==e?e:{}).reduce(((t,e)=>t||e.project.items.some((t=>t.field===Zu))),!1)}function ph(t,e){!(0,W.isString)(e.select)&&e.select.on||delete t.events,!(0,W.isString)(e.select)&&e.select.clear||delete t.clear,!(0,W.isString)(e.select)&&e.select.toggle||delete t.toggle}function gh(t,e,n){return t.fields=e||[],t.fname=n,t}function mh(t){return 1===t.length?yh(t[0]):vh(t)}const yh=t=>function(e){return e[t]},vh=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function bh(t){throw Error(t)}function xh(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function c(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)c(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o||r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&c(),a=r=i+1):"]"===o&&(a||bh("Access path missing open bracket: "+t),a>0&&c(),a=0,r=i+1):i>r?c():r=i+1}return a&&bh("Access path missing closing bracket: "+t),s&&bh("Access path missing closing quote: "+t),i>r&&(i++,c()),e}function wh(t,e,n){const r=xh(t);return t=1===r.length?r[0]:t,gh((n&&n.get||mh)(r),[t],e||t)}wh("id"),gh((t=>t),[],"identity"),gh((()=>0),[],"zero"),gh((()=>1),[],"one"),gh((()=>!0),[],"true"),gh((()=>!1),[],"false");Array.isArray;Object.prototype.hasOwnProperty;const _h="RawCode",Eh="Literal",Ah="Property",Oh="Identifier",Sh="ArrayExpression",Ch="BinaryExpression",Mh="CallExpression",Ph="ConditionalExpression",kh="LogicalExpression",Th="MemberExpression",Dh="ObjectExpression",Fh="UnaryExpression";function jh(t){this.type=t}var Lh,Rh,Ih,Nh,Bh;jh.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case Sh:return t.elements;case Ch:case kh:return[t.left,t.right];case Mh:return[t.callee].concat(t.arguments);case Ph:return[t.test,t.consequent,t.alternate];case Th:return[t.object,t.property];case Dh:return t.properties;case Ah:return[t.key,t.value];case Fh:return[t.argument];case Oh:case Eh:case _h:default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};(Lh={})[1]="Boolean",Lh[2]="<end>",Lh[3]="Identifier",Lh[4]="Keyword",Lh[5]="Null",Lh[6]="Numeric",Lh[7]="Punctuator",Lh[8]="String",Lh[9]="RegularExpression";var zh="Identifier",$h="Unexpected token %0",Uh="Invalid regular expression",Vh="Invalid regular expression: missing /",Zh="Octal literals are not allowed in strict mode.",Wh="ILLEGAL",qh="Disabled.",Gh=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Hh=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Xh(t,e){if(!t)throw new Error("ASSERT: "+e)}function Yh(t){return t>=48&&t<=57}function Kh(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function Jh(t){return"01234567".indexOf(t)>=0}function Qh(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function td(t){return 10===t||13===t||8232===t||8233===t}function ed(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&Gh.test(String.fromCharCode(t))}function nd(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&Hh.test(String.fromCharCode(t))}const rd={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function id(){for(;Ih<Nh;){const t=Rh.charCodeAt(Ih);if(!Qh(t)&&!td(t))break;++Ih}}function od(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)Ih<Nh&&Kh(Rh[Ih])?(r=Rh[Ih++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):wd({},$h,Wh);return String.fromCharCode(i)}function sd(){var t,e,n,r;for(e=0,"}"===(t=Rh[Ih])&&wd({},$h,Wh);Ih<Nh&&Kh(t=Rh[Ih++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&wd({},$h,Wh),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function ad(){var t,e;for(t=Rh.charCodeAt(Ih++),e=String.fromCharCode(t),92===t&&(117!==Rh.charCodeAt(Ih)&&wd({},$h,Wh),++Ih,(t=od("u"))&&"\\"!==t&&ed(t.charCodeAt(0))||wd({},$h,Wh),e=t);Ih<Nh&&nd(t=Rh.charCodeAt(Ih));)++Ih,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==Rh.charCodeAt(Ih)&&wd({},$h,Wh),++Ih,(t=od("u"))&&"\\"!==t&&nd(t.charCodeAt(0))||wd({},$h,Wh),e+=t);return e}function ud(){var t,e;return t=Ih,{type:1===(e=92===Rh.charCodeAt(Ih)?ad():function(){var t,e;for(t=Ih++;Ih<Nh;){if(92===(e=Rh.charCodeAt(Ih)))return Ih=t,ad();if(!nd(e))break;++Ih}return Rh.slice(t,Ih)}()).length?3:rd.hasOwnProperty(e)?4:"null"===e?5:"true"===e||"false"===e?1:3,value:e,start:t,end:Ih}}function cd(){var t,e,n,r,i=Ih,o=Rh.charCodeAt(Ih),s=Rh[Ih];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++Ih,{type:7,value:String.fromCharCode(o),start:i,end:Ih};default:if(61===(t=Rh.charCodeAt(Ih+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return Ih+=2,{type:7,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:Ih};case 33:case 61:return Ih+=2,61===Rh.charCodeAt(Ih)&&++Ih,{type:7,value:Rh.slice(i,Ih),start:i,end:Ih}}}return">>>="===(r=Rh.substr(Ih,4))?{type:7,value:r,start:i,end:Ih+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:Ih+=3}:s===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===e?{type:7,value:e,start:i,end:Ih+=2}:("//"===e&&wd({},$h,Wh),"<>=!+-*%&|^/".indexOf(s)>=0?{type:7,value:s,start:i,end:++Ih}:void wd({},$h,Wh))}function ld(){var t,e,n;if(Xh(Yh((n=Rh[Ih]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=Ih,t="","."!==n){if(t=Rh[Ih++],n=Rh[Ih],"0"===t){if("x"===n||"X"===n)return++Ih,function(t){let e="";for(;Ih<Nh&&Kh(Rh[Ih]);)e+=Rh[Ih++];return 0===e.length&&wd({},$h,Wh),ed(Rh.charCodeAt(Ih))&&wd({},$h,Wh),{type:6,value:parseInt("0x"+e,16),start:t,end:Ih}}(e);if(Jh(n))return function(t){let e="0"+Rh[Ih++];for(;Ih<Nh&&Jh(Rh[Ih]);)e+=Rh[Ih++];return(ed(Rh.charCodeAt(Ih))||Yh(Rh.charCodeAt(Ih)))&&wd({},$h,Wh),{type:6,value:parseInt(e,8),octal:!0,start:t,end:Ih}}(e);n&&Yh(n.charCodeAt(0))&&wd({},$h,Wh)}for(;Yh(Rh.charCodeAt(Ih));)t+=Rh[Ih++];n=Rh[Ih]}if("."===n){for(t+=Rh[Ih++];Yh(Rh.charCodeAt(Ih));)t+=Rh[Ih++];n=Rh[Ih]}if("e"===n||"E"===n)if(t+=Rh[Ih++],"+"!==(n=Rh[Ih])&&"-"!==n||(t+=Rh[Ih++]),Yh(Rh.charCodeAt(Ih)))for(;Yh(Rh.charCodeAt(Ih));)t+=Rh[Ih++];else wd({},$h,Wh);return ed(Rh.charCodeAt(Ih))&&wd({},$h,Wh),{type:6,value:parseFloat(t),start:e,end:Ih}}function fd(){var t,e,n,r;return Bh=null,id(),t=Ih,e=function(){var t,e,n,r;for(Xh("/"===(t=Rh[Ih]),"Regular expression literal must start with a slash"),e=Rh[Ih++],n=!1,r=!1;Ih<Nh;)if(e+=t=Rh[Ih++],"\\"===t)td((t=Rh[Ih++]).charCodeAt(0))&&wd({},Vh),e+=t;else if(td(t.charCodeAt(0)))wd({},Vh);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||wd({},Vh),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";Ih<Nh&&nd((t=Rh[Ih]).charCodeAt(0));)++Ih,"\\"===t&&Ih<Nh?wd({},$h,Wh):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&wd({},Uh,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";wd({},Uh)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){wd({},Uh)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:Ih}}function hd(){if(id(),Ih>=Nh)return{type:2,start:Ih,end:Ih};const t=Rh.charCodeAt(Ih);return ed(t)?ud():40===t||41===t||59===t?cd():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(Xh("'"===(t=Rh[Ih])||'"'===t,"String literal must starts with a quote"),e=Ih,++Ih;Ih<Nh;){if((n=Rh[Ih++])===t){t="";break}if("\\"===n)if((n=Rh[Ih++])&&td(n.charCodeAt(0)))"\r"===n&&"\n"===Rh[Ih]&&++Ih;else switch(n){case"u":case"x":"{"===Rh[Ih]?(++Ih,i+=sd()):i+=od(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:Jh(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),Ih<Nh&&Jh(Rh[Ih])&&(o=!0,r=8*r+"01234567".indexOf(Rh[Ih++]),"0123".indexOf(n)>=0&&Ih<Nh&&Jh(Rh[Ih])&&(r=8*r+"01234567".indexOf(Rh[Ih++]))),i+=String.fromCharCode(r)):i+=n}else{if(td(n.charCodeAt(0)))break;i+=n}}return""!==t&&wd({},$h,Wh),{type:8,value:i,octal:o,start:e,end:Ih}}():46===t?Yh(Rh.charCodeAt(Ih+1))?ld():cd():Yh(t)?ld():cd()}function dd(){const t=Bh;return Ih=t.end,Bh=hd(),Ih=t.end,t}function pd(){const t=Ih;Bh=hd(),Ih=t}function gd(t,e,n){const r=new jh("||"===t||"&&"===t?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function md(t,e){const n=new jh("CallExpression");return n.callee=t,n.arguments=e,n}function yd(t){const e=new jh(zh);return e.name=t,e}function vd(t){const e=new jh("Literal");return e.value=t.value,e.raw=Rh.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function bd(t,e,n){const r=new jh("MemberExpression");return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function xd(t,e,n){const r=new jh("Property");return r.key=e,r.value=n,r.kind=t,r}function wd(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(Xh(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=Ih,n.description=i,n}function _d(t){2===t.type&&wd(t,"Unexpected end of input"),6===t.type&&wd(t,"Unexpected number"),8===t.type&&wd(t,"Unexpected string"),3===t.type&&wd(t,"Unexpected identifier"),4===t.type&&wd(t,"Unexpected reserved word"),wd(t,$h,t.value)}function Ed(t){const e=dd();7===e.type&&e.value===t||_d(e)}function Ad(t){return 7===Bh.type&&Bh.value===t}function Od(t){return 4===Bh.type&&Bh.value===t}function Sd(){const t=[];for(Ih=Bh.start,Ed("[");!Ad("]");)Ad(",")?(dd(),t.push(null)):(t.push(Nd()),Ad("]")||Ed(","));return dd(),function(t){const e=new jh("ArrayExpression");return e.elements=t,e}(t)}function Cd(){Ih=Bh.start;const t=dd();return 8===t.type||6===t.type?(t.octal&&wd(t,Zh),vd(t)):yd(t.value)}function Md(){var t,e,n;return Ih=Bh.start,3===(t=Bh).type?(n=Cd(),Ed(":"),xd("init",n,Nd())):2!==t.type&&7!==t.type?(e=Cd(),Ed(":"),xd("init",e,Nd())):void _d(t)}function Pd(){var t,e,n=[],r={},i=String;for(Ih=Bh.start,Ed("{");!Ad("}");)e="$"+((t=Md()).key.type===zh?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?wd({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),Ad("}")||Ed(",");return Ed("}"),function(t){const e=new jh("ObjectExpression");return e.properties=t,e}(n)}const kd={if:1};function Td(){var t,e,n;if(Ad("("))return function(){Ed("(");const t=Bd();return Ed(")"),t}();if(Ad("["))return Sd();if(Ad("{"))return Pd();if(t=Bh.type,Ih=Bh.start,3===t||kd[Bh.value])n=yd(dd().value);else if(8===t||6===t)Bh.octal&&wd(Bh,Zh),n=vd(dd());else{if(4===t)throw new Error(qh);1===t?((e=dd()).value="true"===e.value,n=vd(e)):5===t?((e=dd()).value=null,n=vd(e)):Ad("/")||Ad("/=")?(n=vd(fd()),pd()):_d(dd())}return n}function Dd(){const t=[];if(Ed("("),!Ad(")"))for(;Ih<Nh&&(t.push(Nd()),!Ad(")"));)Ed(",");return Ed(")"),t}function Fd(){return Ed("."),function(){Ih=Bh.start;const t=dd();return function(t){return 3===t.type||4===t.type||1===t.type||5===t.type}(t)||_d(t),yd(t.value)}()}function jd(){Ed("[");const t=Bd();return Ed("]"),t}function Ld(){const t=function(){var t;for(t=Td();;)if(Ad("."))t=bd(".",t,Fd());else if(Ad("("))t=md(t,Dd());else{if(!Ad("["))break;t=bd("[",t,jd())}return t}();if(7===Bh.type&&(Ad("++")||Ad("--")))throw new Error(qh);return t}function Rd(){var t,e;if(7!==Bh.type&&4!==Bh.type)e=Ld();else{if(Ad("++")||Ad("--"))throw new Error(qh);if(Ad("+")||Ad("-")||Ad("~")||Ad("!"))t=dd(),e=Rd(),e=function(t,e){const n=new jh("UnaryExpression");return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(Od("delete")||Od("void")||Od("typeof"))throw new Error(qh);e=Ld()}}return e}function Id(t){let e=0;if(7!==t.type&&4!==t.type)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function Nd(){var t,e;return t=function(){var t,e,n,r,i,o,s,a,u,c;if(t=Bh,u=Rd(),0===(i=Id(r=Bh)))return u;for(r.prec=i,dd(),e=[t,Bh],o=[u,r,s=Rd()];(i=Id(Bh))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),e.pop(),n=gd(a,u,s),o.push(n);(r=dd()).prec=i,o.push(r),e.push(Bh),n=Rd(),o.push(n)}for(n=o[c=o.length-1],e.pop();c>1;)e.pop(),n=gd(o[c-1].value,o[c-2],n),c-=2;return n}(),Ad("?")&&(dd(),e=Nd(),Ed(":"),t=function(t,e,n){const r=new jh("ConditionalExpression");return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,Nd())),t}function Bd(){const t=Nd();if(Ad(","))throw new Error(qh);return t}function zd(t){const e=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(e.push(...zd(t.object)),e.push(...zd(t.property))),e)}function $d(t){return"MemberExpression"===t.object.type?$d(t.object):"datum"===t.object.name}function Ud(t){const e=function(t){Ih=0,Nh=(Rh=t).length,Bh=null,pd();const e=Bd();if(2!==Bh.type)throw new Error("Unexpect token after expression.");return e}(t),n=new Set;return e.visit((t=>{"MemberExpression"===t.type&&$d(t)&&n.add(zd(t).slice(1).join("."))})),n}class Vd extends ef{constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=qd(this.model,this.filter,this),this._dependentFields=Ud(this.expr)}clone(){return new Vd(null,this.model,Nt(this.filter))}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function Zd(t,e,n,r="datum"){const i=Et(e)?e:e.param,o=se(i),s=At(o+ah);let a;try{a=t.getSelectionComponent(o,i)}catch(l){return`!!${o}`}if(a.project.timeUnit){const e=null!==n&&void 0!==n?n:t.component.data.raw,r=a.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}const u=`vlSelectionTest(${s}, ${r}${"global"===a.resolve?")":`, ${At(a.resolve)})`}`,c=`length(data(${s}))`;return!1===e.empty?`${c} && ${u}`:`!${c} || ${u}`}function Wd(t,e,n){const r=se(e),i=n.encoding;let o,s=n.field;try{o=t.getSelectionComponent(r,e)}catch(a){return r}if(i||s){if(i&&!s){const t=o.project.items.filter((t=>t.channel===i));!t.length||t.length>1?(s=o.project.items[0].field,Ri((t.length?"Multiple ":"No ")+`matching ${At(i)} encoding found for selection ${At(n.param)}. `+`Using "field": ${At(s)}.`)):s=t[0].field}}else s=o.project.items[0].field,o.project.items.length>1&&Ri(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${At(s)}.`);return`${o.name}[${At(de(s))}]`}function qd(t,e,n){return ae(e,(e=>Et(e)?e:function(t){return null===t||void 0===t?void 0:t.param}(e)?Zd(t,e,n):co(e)))}var Gd=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Hd(t,e,n,r){var i,o,s,a,u;null!==(i=t.encode)&&void 0!==i||(t.encode={}),null!==(o=(a=t.encode)[e])&&void 0!==o||(a[e]={}),null!==(s=(u=t.encode[e]).update)&&void 0!==s||(u.update={}),t.encode[e].update[n]=r}function Xd(t,e,n,r={header:!1}){var i,o;const s=t.combine(),{disable:a,orient:u,scale:c,labelExpr:l,title:f,zindex:h}=s,d=Gd(s,["disable","orient","scale","labelExpr","title","zindex"]);if(!a){for(const t in d){const n=Xa[t],r=d[t];if(n&&n!==e&&"both"!==n)delete d[t];else if(Ga(r)){const{condition:e}=r,n=Gd(r,["condition"]),i=yt(e),o=qa[t];if(o){const{vgProp:e,part:r}=o;Hd(d,r,e,[...i.map((t=>{const{test:e}=t,n=Gd(t,["test"]);return Object.assign({test:qd(null,e)},n)})),n]),delete d[t]}else if(null===o){const e={signal:i.map((t=>{const{test:e}=t,n=Gd(t,["test"]);return`${qd(null,e)} ? ${Gr(n)} : `})).join("")+Gr(n)};d[t]=e}}else if(Rr(r)){const e=qa[t];if(e){const{vgProp:n,part:i}=e;Hd(d,i,n,r),delete d[t]}}Zt(["labelAlign","labelBaseline"],t)&&null===d[t]&&delete d[t]}if("grid"===e){if(!d.grid)return;if(d.encode){const{grid:t}=d.encode;d.encode=Object.assign({},t?{grid:t}:{}),ee(d.encode)&&delete d.encode}return Object.assign(Object.assign({scale:c,orient:u},d),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ye(h,0)})}{if(!r.header&&t.mainExtracted)return;if(void 0!==l){let t=l;(null===(o=null===(i=d.encode)||void 0===i?void 0:i.labels)||void 0===o?void 0:o.update)&&Rr(d.encode.labels.update.text)&&(t=pe(l,"datum.label",d.encode.labels.update.text.signal)),Hd(d,"labels","text",{signal:t})}if(null===d.labelAlign&&delete d.labelAlign,d.encode){for(const e of Ha)t.hasAxisPart(e)||delete d.encode[e];ee(d.encode)&&delete d.encode}const e=function(t,e){if(t)return ft(t)&&!Lr(t)?t.map((t=>Fa(t,e))).join(", "):t}(f,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:c,orient:u,grid:!1},e?{title:e}:{}),d),!1===n.aria?{aria:!1}:{}),{zindex:ye(h,0)})}}}function Yd(t){const{axes:e}=t.component,n=[];for(const r of Gn)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}function Kd(t,e,n,r){return Object.assign.apply(null,[{},...t.map((t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},o=e["x"===n?"axisTop":"axisRight"]||{},s=new Set([...ne(i),...ne(o)]),a={};for(const e of s.values())a[e]={signal:`${r.signal} === "${t}" ? ${Hr(i[e])} : ${Hr(o[e])}`};return a}return e[t]}))])}function Jd(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:function(t){return t in No}(e)?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],o="x"===t?"axisX":"axisY",s=Rr(n)?"axisOrient":`axis${ce(n)}`,a=[...i,...i.map((t=>o+t.substr(4)))],u=["axis",s,o];return{vlOnlyAxisConfig:Kd(a,r,t,n),vgAxisConfig:Kd(u,r,t,n),axisConfigStyle:Qd([...u,...a],r)}}function Qd(t,e){var n;const r=[{}];for(const i of t){let t=null===(n=e[i])||void 0===n?void 0:n.style;if(t){t=yt(t);for(const n of t)r.push(e.style[n])}}return Object.assign.apply(null,r)}function tp(t,e,n,r={}){var i;const o=Qr(t,n,e);if(void 0!==o)return{configFrom:"style",configValue:o};for(const s of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==(null===(i=r[s])||void 0===i?void 0:i[t]))return{configFrom:s,configValue:r[s][t]};return{}}const ep={scale:({model:t,channel:e})=>t.scaleName(e),format:({fieldOrDatumDef:t,config:e,axis:n})=>{const{format:r,formatType:i}=n;return Vs(t,t.type,r,i,e,!0)},formatType:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return Zs(r,e,n)},grid:({fieldOrDatumDef:t,axis:e,scaleType:n})=>{var r;return null!==(r=e.grid)&&void 0!==r?r:function(t,e){return!Uo(t)&&da(e)&&!Sr(null===e||void 0===e?void 0:e.bin)&&!Cr(null===e||void 0===e?void 0:e.bin)}(n,t)},gridScale:({model:t,channel:e})=>function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n);return}(t,e),labelAlign:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelAlign||ip(e,n,r),labelAngle:({labelAngle:t})=>t,labelBaseline:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelBaseline||rp(e,n,r),labelFlush:({axis:t,fieldOrDatumDef:e,channel:n})=>{var r;return null!==(r=t.labelFlush)&&void 0!==r?r:function(t,e){if("x"===e&&Zt(["quantitative","temporal"],t))return!0;return}(e.type,n)},labelOverlap:({axis:t,fieldOrDatumDef:e,scaleType:n})=>{var r;return null!==(r=t.labelOverlap)&&void 0!==r?r:function(t,e,n,r){if(n&&!ht(r)||"nominal"!==t&&"ordinal"!==t)return"log"!==e&&"symlog"!==e||"greedy";return}(e.type,n,da(e)&&!!e.timeUnit,da(e)?e.sort:void 0)},orient:({orient:t})=>t,tickCount:({channel:t,model:e,axis:n,fieldOrDatumDef:r,scaleType:i})=>{var o;const s="x"===t?"width":"y"===t?"height":void 0,a=s?e.getSizeSignalRef(s):void 0;return null!==(o=n.tickCount)&&void 0!==o?o:function({fieldOrDatumDef:t,scaleType:e,size:n,values:r}){var i;if(!r&&!Uo(e)&&"log"!==e){if(da(t)){if(Sr(t.bin))return{signal:`ceil(${n.signal}/10)`};if(t.timeUnit&&Zt(["month","hours","day","quarter"],null===(i=Qi(t.timeUnit))||void 0===i?void 0:i.unit))return}return{signal:`ceil(${n.signal}/40)`}}return}({fieldOrDatumDef:r,scaleType:i,size:a,values:n.values})},title:({axis:t,model:e,channel:n})=>{if(void 0!==t.title)return t.title;const r=op(e,n);if(void 0!==r)return r;const i=e.typedFieldDef(n),o="x"===n?"x2":"y2",s=e.fieldDef(o);return ei(i?[oa(i)]:[],da(s)?[oa(s)]:[])},values:({axis:t,fieldOrDatumDef:e})=>function(t,e){const n=t.values;if(ft(n))return Za(e,n);if(Rr(n))return n;return}(t,e),zindex:({axis:t,fieldOrDatumDef:e,mark:n})=>{var r;return null!==(r=t.zindex)&&void 0!==r?r:function(t,e){if("rect"===t&&Ca(e))return 1;return 0}(n,e)}};function np(t){return`(((${t.signal} % 360) + 360) % 360)`}function rp(t,e,n,r){if(void 0!==t){if("x"===n){if(Rr(t)){const n=np(t);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${Rr(e)?`(${e.signal} === "top")`:"top"===e} ? "bottom" : "top"`}}if(45<t&&t<135||225<t&&t<315)return"middle";if(Rr(e)){const n=t<=45||315<=t?"===":"!==";return{signal:`${e.signal} ${n} "top" ? "bottom" : "top"`}}return(t<=45||315<=t)===("top"===e)?"bottom":"top"}if(Rr(t)){const n=np(t);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${Rr(e)?`(${e.signal} === "left")`:"left"===e} ? "top" : "bottom"`}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(Rr(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:`${e.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=t&&t<=135)===("left"===e)?"top":"bottom"}}function ip(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(Rr(t)){const n=np(t);return{signal:`(${i?`(${n} + 90)`:n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${Rr(e)?`(${e.signal} === "${o}")`:e===o} ? "left" : "right"`}}if((t+i)%180===0)return r?null:"center";if(Rr(e)){const n=i<t&&t<180+i?"===":"!==";return{signal:`${`${e.signal} ${n} "${o}"`} ? "left" : "right"`}}return(i<t&&t<180+i)===(e===o)?"left":"right"}function op(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;return o&&s?ni(o,s):o||(s||(void 0!==o?o:void 0!==s?s:void 0))}class sp extends ef{constructor(t,e){super(t),this.transform=e,this._dependentFields=Ud(this.transform.calculate)}clone(){return new sp(null,Nt(this.transform))}static parseAllForSortIndex(t,e){return e.forEachFieldDef(((e,n)=>{if(wa(e)&&ta(e.sort)){const{field:r,timeUnit:i}=e,o=e.sort,s=o.map(((t,e)=>`${co({field:r,timeUnit:i,equal:t})} ? ${e} : `)).join("")+o.length;t=new sp(t,{calculate:s,as:ap(e,n,{forAs:!0})})}})),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Ut(this.transform)}`}}function ap(t,e,n){return Sa(t,Object.assign({prefix:e,suffix:"sort_index"},null!==n&&void 0!==n?n:{}))}function up(t,e){return Zt(["top","bottom"],e)?"column":Zt(["left","right"],e)||"row"===t?"row":"column"}function cp(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return ye((e||{})[t],i[t],n.header[t])}function lp(t,e,n,r){const i={};for(const o of t){const t=cp(o,e||{},n,r);void 0!==t&&(i[o]=t)}return i}const fp=["row","column"],hp=["header","footer"];function dp(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=lp(["titleAnchor","titleAngle","titleOrient"],i.header,r,e),u=up(e,a),c=Ee(s);return{name:`${e}-title`,type:"group",role:`${u}-title`,title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===e?{orient:"left"}:{}),{style:"guide-title"}),gp(c,u)),pp(u,c,o)),_p(r,i,e,Bu,Iu))}}function pp(t,e,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=ip(e,"row"===t?"left":"top","row"===t?"y":"x");return r?{align:r}:{}}function gp(t,e){const n=rp(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function mp(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of hp)if(n[i])for(const o of n[i]){const s=bp(t,e,i,n,o);null!=s&&r.push(s)}return r}function yp(t,e){var n;const{sort:r}=t;return Qs(r)?{field:Sa(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:ft(r)?{field:ap(t,e,{expr:"datum"}),order:"ascending"}:{field:Sa(t,{expr:"datum"}),order:null!==r&&void 0!==r?r:"ascending"}}function vp(t,e,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:u}=lp(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t.header,n,e),c=zs({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,l=up(e,a);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:u?pe(pe(u,"datum.label",c),"datum.value",Sa(t,{expr:"parent"})):c}},"row"===e?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),gp(o,l)),pp(l,o,s)),_p(n,t,e,zu,Nu))}function bp(t,e,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=t.config?t.config:void 0;if(s&&i.labels){const{labelOrient:t}=lp(["labelOrient"],s.header,a,e);("row"===e&&!Zt(["top","bottom"],t)||"column"===e&&!Zt(["left","right"],t))&&(o=vp(s,e,a))}const u=Om(t)&&!ea(t.facet),c=i.axes,l=(null===c||void 0===c?void 0:c.length)>0;if(o||l){const a="row"===e?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName(`${e}_${n}`),type:"group",role:`${e}-${n}`},r.facetFieldDef?{from:{data:t.getName(`${e}_domain`)},sort:yp(s,e)}:{}),l&&u?{from:{data:t.getName(`facet_domain_${e}`)}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:{[a]:i.sizeSignal}}}:{}),l?{axes:c}:{})}}return null}const xp={column:{start:0,end:1},row:{start:1,end:0}};function wp(t,e){return xp[e][t]}function _p(t,e,n,r,i){const o={};for(const s of r){if(!i[s])continue;const r=cp(s,null===e||void 0===e?void 0:e.header,t,n);void 0!==r&&(o[i[s]]=r)}return o}function Ep(t){return[...Ap(t,"width"),...Ap(t,"height"),...Ap(t,"childWidth"),...Ap(t,"childHeight")]}function Ap(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),o=e.get("range");if(Uo(r)&&Ir(o)){const r=t.scaleName(n);if(Om(t.parent)){if("independent"===t.parent.component.resolve.scale[n])return[Op(r,o)]}return[Op(r,o),{name:i,update:Sp(r,e,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${ic(t.config.view,e?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function Op(t,e){return{name:`${t}_step`,value:e.step}}function Sp(t,e,n){const r=e.get("type"),i=e.get("padding"),o=ye(e.get("paddingOuter"),i);let s=e.get("paddingInner");return s="band"===r?void 0!==s?s:i:1,`bandspace(${n}, ${Hr(s)}, ${Hr(o)}) * ${t}_step`}function Cp(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function Mp(t,e){return ne(t).reduce(((n,r)=>{const i=t[r];return Object.assign(Object.assign({},n),bf(e,i,r,(t=>qr(t.value))))}),{})}function Pp(t,e){if(Om(e))return"theta"===t?"independent":"shared";if(Cm(e))return"shared";if(Sm(e))return Hn(t)||"theta"===t||"radius"===t?"independent":"shared";throw new Error("invalid model type for resolve")}function kp(t,e){const n=t.scale[e],r=Hn(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&Ri(function(t){return`Setting the scale to be independent for "${t}" means we also have to set the guide (axis or legend) to be independent.`}(e)),"independent"):t[r][e]||"shared"}const Tp=Object.assign(Object.assign({},Vu),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),Dp=ne(Tp);class Fp extends Ol{}const jp={symbols:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i,legendType:o}){var s,a,u,c,l,f,h,d;if("symbol"!==o)return;const{markDef:p,encoding:g,config:m,mark:y}=n,v=p.filled&&"trail"!==y;let b=Object.assign(Object.assign({},function(t,e,n){for(const r of n){const n=Kr(r,e.markDef,e.config);void 0!==n&&(t[r]=qr(n))}return t}({},n,Es)),Cf(n,{filled:v}));const x=null!==(s=i.get("symbolOpacity"))&&void 0!==s?s:m.legend.symbolOpacity,w=null!==(a=i.get("symbolFillColor"))&&void 0!==a?a:m.legend.symbolFillColor,_=null!==(u=i.get("symbolStrokeColor"))&&void 0!==u?u:m.legend.symbolStrokeColor,E=void 0===x?null!==(c=Lp(g.opacity))&&void 0!==c?c:p.opacity:void 0;if(b.fill)if("fill"===r||v&&r===$e)delete b.fill;else if(b.fill.field)w?delete b.fill:(b.fill=qr(null!==(l=m.legend.symbolBaseFillColor)&&void 0!==l?l:"black"),b.fillOpacity=qr(null!==E&&void 0!==E?E:1));else if(ft(b.fill)){const t=null!==(d=null!==(h=Rp(null!==(f=g.fill)&&void 0!==f?f:g.color))&&void 0!==h?h:p.fill)&&void 0!==d?d:v&&p.color;t&&(b.fill=qr(t))}if(b.stroke)if("stroke"===r||!v&&r===$e)delete b.stroke;else if(b.stroke.field||_)delete b.stroke;else if(ft(b.stroke)){const t=ye(Rp(g.stroke||g.color),p.stroke,v?p.color:void 0);t&&(b.stroke={value:t})}if(r!==Ge){const t=da(e)&&Np(n,i,e);t?b.opacity=[Object.assign({test:t},qr(null!==E&&void 0!==E?E:1)),qr(m.legend.unselectedOpacity)]:E&&(b.opacity=qr(E))}return b=Object.assign(Object.assign({},b),t),ee(b)?void 0:b},gradient:function(t,{model:e,legendType:n,legendCmpt:r}){var i;if("gradient"!==n)return;const{config:o,markDef:s,encoding:a}=e;let u={};const c=void 0===(null!==(i=r.get("gradientOpacity"))&&void 0!==i?i:o.legend.gradientOpacity)?Lp(a.opacity)||s.opacity:void 0;c&&(u.opacity=qr(c));return u=Object.assign(Object.assign({},u),t),ee(u)?void 0:u},labels:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=da(e)?Np(n,i,e):void 0,u=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:c,formatType:l}=o,f=Ns(l)?Us({fieldOrDatumDef:e,field:"datum.value",format:c,formatType:l,config:s}):void 0,h=Object.assign(Object.assign(Object.assign({},u?{opacity:u}:{}),f?{text:f}:{}),t);return ee(h)?void 0:h},entries:function(t,{legendCmpt:e}){const n=e.get("selections");return(null===n||void 0===n?void 0:n.length)?Object.assign(Object.assign({},t),{fill:{value:"transparent"}}):t}};function Lp(t){return Ip(t,((t,e)=>Math.max(t,e.value)))}function Rp(t){return Ip(t,((t,e)=>ye(t,e.value)))}function Ip(t,e){return function(t){const e=t&&t.condition;return!!e&&(ft(e)||xa(e))}(t)?yt(t.condition).reduce(e,t.value):xa(t)?t.value:void 0}function Np(t,e,n){const r=e.get("selections");if(!(null===r||void 0===r?void 0:r.length))return;const i=At(n.field);return r.map((t=>`(!length(data(${At(se(t)+ah)})) || (${t}[${i}] && indexof(${t}[${i}], datum.value) >= 0))`)).join(" || ")}const Bp={direction:({direction:t})=>t,format:({fieldOrDatumDef:t,legend:e,config:n})=>{const{format:r,formatType:i}=e;return Vs(t,t.type,r,i,n,!1)},formatType:({legend:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return Zs(r,e,n)},gradientLength:t=>{var e,n;const{legend:r,legendConfig:i}=t;return null!==(n=null!==(e=r.gradientLength)&&void 0!==e?e:i.gradientLength)&&void 0!==n?n:function({legendConfig:t,model:e,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:u}=t;if(Zo(i))return"horizontal"===n?"top"===r||"bottom"===r?Up(e,"width",s,o):s:Up(e,"height",u,a);return}(t)},labelOverlap:({legend:t,legendConfig:e,scaleType:n})=>{var r,i;return null!==(i=null!==(r=t.labelOverlap)&&void 0!==r?r:e.labelOverlap)&&void 0!==i?i:function(t){if(Zt(["quantile","threshold","log","symlog"],t))return"greedy";return}(n)},symbolType:({legend:t,markDef:e,channel:n,encoding:r})=>{var i;return null!==(i=t.symbolType)&&void 0!==i?i:function(t,e,n,r){var i;if("shape"!==e){const t=null!==(i=Rp(n))&&void 0!==i?i:r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(e.type,n,r.shape,e.shape)},title:({fieldOrDatumDef:t,config:e})=>Ta(t,e,{allowDisabling:!0}),type:({legendType:t,scaleType:e,channel:n})=>{if(hn(n)&&Zo(e)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:({fieldOrDatumDef:t,legend:e})=>function(t,e){const n=t.values;if(ft(n))return Za(e,n);if(Rr(n))return n;return}(e,t)};function zp(t){const{legend:e}=t;return ye(e.type,function({channel:t,timeUnit:e,scaleType:n}){if(hn(t)){if(Zt(["quarter","month","day"],e))return"symbol";if(Zo(n))return"gradient"}return"symbol"}(t))}function $p({legendConfig:t,legendType:e,orient:n,legend:r}){var i,o;return null!==(o=null!==(i=r.direction)&&void 0!==i?i:t[e?"gradientDirection":"symbolDirection"])&&void 0!==o?o:function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(n,e)}function Up(t,e,n,r){return{signal:`clamp(${t.getSizeSignalRef(e).signal}, ${n}, ${r})`}}function Vp(t){const e=Am(t)?function(t){const{encoding:e}=t,n={};for(const r of[$e,...Uu]){const i=Ra(e[r]);i&&t.getScaleComponent(r)&&(r===Ze&&da(i)&&i.type===vo||(n[r]=Wp(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){Vp(r);for(const i of ne(r.component.legends))n.legend[i]=kp(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=qp(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of ne(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function Zp(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!!(null===n||void 0===n?void 0:n.values);case"title":if("title"===e&&t===(null===r||void 0===r?void 0:r.title))return!0}return t===(n||{})[e]}function Wp(t,e){var n,r,i;let o=t.legend(e);const{markDef:s,encoding:a,config:u}=t,c=u.legend,l=new Fp({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){var r,i,o,s;const a=null===(r=t.fieldDef(e))||void 0===r?void 0:r.field;for(const u of re(null!==(i=t.component.selection)&&void 0!==i?i:{})){const t=null!==(o=u.project.hasField[a])&&void 0!==o?o:u.project.hasChannel[e];if(t&&Jf.defined(u)){const e=null!==(s=n.get("selections"))&&void 0!==s?s:[];e.push(u.name),n.set("selections",e,!1),t.hasLegend=!0}}}(t,e,l);const f=void 0!==o?!o:c.disable;if(l.set("disable",f,void 0!==o),f)return l;o=o||{};const h=t.getScaleComponent(e).get("type"),d=Ra(a[e]),p=da(d)?null===(n=Qi(d.timeUnit))||void 0===n?void 0:n.unit:void 0,g=o.orient||u.legend.orient||"right",m=zp({legend:o,channel:e,timeUnit:p,scaleType:h}),y={legend:o,channel:e,model:t,markDef:s,encoding:a,fieldOrDatumDef:d,legendConfig:c,config:u,scaleType:h,orient:g,legendType:m,direction:$p({legend:o,legendType:m,orient:g,legendConfig:c})};for(const _ of Dp){if("gradient"===m&&_.startsWith("symbol")||"symbol"===m&&_.startsWith("gradient"))continue;const n=_ in Bp?Bp[_](y):o[_];if(void 0!==n){const r=Zp(n,_,o,t.fieldDef(e));(r||void 0===u.legend[_])&&l.set(_,n,r)}}const v=null!==(r=null===o||void 0===o?void 0:o.encoding)&&void 0!==r?r:{},b=l.get("selections"),x={},w={fieldOrDatumDef:d,model:t,channel:e,legendCmpt:l,legendType:m};for(const _ of["labels","legend","title","symbols","gradient","entries"]){const e=Mp(null!==(i=v[_])&&void 0!==i?i:{},t),n=_ in jp?jp[_](e,w):e;void 0===n||ee(n)||(x[_]=Object.assign(Object.assign(Object.assign({},(null===b||void 0===b?void 0:b.length)&&da(d)?{name:`${se(d.field)}_legend_${_}`}:{}),(null===b||void 0===b?void 0:b.length)?{interactive:!!b}:{}),{update:n}))}return ee(x)||l.set("encode",x,!!(null===o||void 0===o?void 0:o.encoding)),l}function qp(t,e){var n,r,i,o;if(!t)return e.clone();const s=t.getWithExplicit("orient"),a=e.getWithExplicit("orient");if(s.explicit&&a.explicit&&s.value!==a.value)return;let u=!1;for(const c of Dp){const n=kl(t.getWithExplicit(c),e.getWithExplicit(c),c,"legend",((t,e)=>{switch(c){case"symbolType":return Gp(t,e);case"title":return ri(t,e);case"type":return u=!0,Cl("symbol")}return Pl(t,e,c,"legend")}));t.setWithExplicit(c,n)}return u&&((null===(r=null===(n=t.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&ue(t.implicit,["encode","gradient"]),(null===(o=null===(i=t.explicit)||void 0===i?void 0:i.encode)||void 0===o?void 0:o.gradient)&&ue(t.explicit,["encode","gradient"])),t}function Gp(t,e){return"circle"===e.value?e:t}var Hp=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Xp(t){const e=t.component.legends,n={};for(const r of ne(e)){const i=t.getScaleComponent(r),o=$t(i.get("domains"));if(n[o])for(const t of n[o]){qp(t,e[r])||n[o].push(e[r])}else n[o]=[e[r].clone()]}return re(n).flat().map((e=>function(t,e){var n,r,i;const o=t.combine(),{disable:s,labelExpr:a,selections:u}=o,c=Hp(o,["disable","labelExpr","selections"]);if(s)return;!1===e.aria&&void 0==c.aria&&(c.aria=!1);if(null===(n=c.encode)||void 0===n?void 0:n.symbols){const t=c.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||c.stroke||(t.stroke={value:"transparent"});for(const e of Uu)c[e]&&delete t[e]}c.title||delete c.title;if(void 0!==a){let t=a;(null===(i=null===(r=c.encode)||void 0===r?void 0:r.labels)||void 0===i?void 0:i.update)&&Rr(c.encode.labels.update.text)&&(t=pe(a,"datum.label",c.encode.labels.update.text.signal)),function(t,e,n,r){var i,o,s,a,u;null!==(i=t.encode)&&void 0!==i||(t.encode={}),null!==(o=(a=t.encode)[e])&&void 0!==o||(a[e]={}),null!==(s=(u=t.encode[e]).update)&&void 0!==s||(u.update={}),t.encode[e].update[n]=r}(c,"labels","text",{signal:t})}return c}(e,t.config))).filter((t=>void 0!==t))}function Yp(t){return Cm(t)||Sm(t)?function(t){return t.children.reduce(((t,e)=>t.concat(e.assembleProjections())),Kp(t))}(t):Kp(t)}function Kp(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:`[${e.size.map((t=>t.signal)).join(", ")}]`},o=e.data.reduce(((e,n)=>{const r=Rr(n)?n.signal:`data('${t.lookupDataSource(n)}')`;return Zt(e,r)||e.push(r),e}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]}},n)]}return[Object.assign(Object.assign({name:r},{translate:{signal:"[width / 2, height / 2]"}}),n)]}const Jp=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class Qp extends Ol{constructor(t,e,n,r){super(Object.assign({},e),{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function tg(t){t.component.projection=Am(t)?function(t){var e;if(t.hasProjection){const n=Dr(t.specifiedProjection),r=!(n&&(null!=n.scale||null!=n.translate)),i=r?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,o=r?function(t){const e=[],{encoding:n}=t;for(const r of[[Ne,Ie],[ze,Be]])(Ra(n[r[0]])||Ra(n[r[1]]))&&e.push({signal:t.getName(`geojson_${e.length}`)});t.channelHasField(Ze)&&t.typedFieldDef(Ze).type===vo&&e.push({signal:t.getName(`geojson_${e.length}`)});0===e.length&&e.push(t.requestDataName(Bl.Main));return e}(t):void 0,s=new Qp(t.projectionName(!0),Object.assign(Object.assign({},null!==(e=Dr(t.config.projection))&&void 0!==e?e:{}),null!==n&&void 0!==n?n:{}),i,o);return s.get("type")||s.set("type","equalEarth",!1),s}return}(t):function(t){if(0===t.children.length)return;let e;for(const r of t.children)tg(r);const n=qt(t.children,(t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=qt(Jp,(n=>!xt(t.explicit,n)&&!xt(e.explicit,n)||!!(xt(t.explicit,n)&&xt(e.explicit,n)&&It(t.get(n),e.get(n)))));if(It(t.size,e.size)){if(n)return t;if(It(t.explicit,{}))return e;if(It(e.explicit,{}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0}));if(e&&n){const n=t.projectionName(!0),r=new Qp(n,e.specifiedProjection,e.size,Nt(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}return}(t)}var eg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function ng(t,e){return`${Or(t)}_${e}`}function rg(t,e,n){var r;const i=ng(null!==(r=za(n,void 0))&&void 0!==r?r:{},e);return t.getName(`${i}_bins`)}function ig(t,e,n){let r,i;r=function(t){return"as"in t}(t)?Et(t.as)?[t.as,`${t.as}_end`]:[t.as[0],t.as[1]]:[Sa(t,{forAs:!0}),Sa(t,{binSuffix:"end",forAs:!0})];const o=Object.assign({},za(e,void 0)),s=ng(o,t.field),{signal:a,extentSignal:u}=function(t,e){return{signal:t.getName(`${e}_bins`),extentSignal:t.getName(`${e}_extent`)}}(n,s);if(Pr(o.extent)){const t=o.extent;i=Wd(n,t.param,t),delete o.extent}return{key:s,binComponent:Object.assign(Object.assign(Object.assign({bin:o,field:t.field,as:[r]},a?{signal:a}:{}),u?{extentSignal:u}:{}),i?{span:i}:{})}}class og extends ef{constructor(t,e){super(t),this.bins=e}clone(){return new og(null,Nt(this.bins))}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{if(ba(n)&&Sr(n.bin)){const{key:i,binComponent:o}=ig(n,n.bin,e);t[i]=Object.assign(Object.assign(Object.assign({},o),t[i]),function(t,e,n,r){var i,o;if(Wa(e,n)){const s=Am(t)&&null!==(o=null!==(i=t.axis(n))&&void 0!==i?i:t.legend(n))&&void 0!==o?o:{},a=Sa(e,{expr:"datum"}),u=Sa(e,{expr:"datum",binSuffix:"end"});return{formulaAs:Sa(e,{binSuffix:"range",forAs:!0}),formula:Hs(a,u,s.format,s.formatType,r)}}return{}}(e,n,r,e.config))}return t}),{});return ee(n)?null:new og(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=ig(e,e.bin,n);return new og(t,{[r]:i})}merge(t,e){for(const n of ne(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=Xt([...this.bins[n].as,...t.bins[n].as],Ut)):this.bins[n]=t.bins[n];for(const n of t.children)t.removeChild(n),n.parent=this;t.remove()}producedFields(){return new Set(re(this.bins).map((t=>t.as)).flat(2))}dependentFields(){return new Set(re(this.bins).map((t=>t.field)))}hash(){return`Bin ${Ut(this.bins)}`}assemble(){return re(this.bins).flatMap((t=>{const e=[],[n,...r]=t.as,i=t.bin,{extent:o}=i,s=eg(i,["extent"]),a=Object.assign(Object.assign(Object.assign({type:"bin",field:de(t.field),as:n,signal:t.signal},Pr(o)?{extent:null}:{extent:o}),t.span?{span:{signal:`span(${t.span})`}}:{}),s);!o&&t.extentSignal&&(e.push({type:"extent",field:de(t.field),signal:t.extentSignal}),a.extent={signal:t.extentSignal}),e.push(a);for(const u of r)for(let t=0;t<2;t++)e.push({type:"formula",expr:Sa({field:n[t]},{expr:"datum"}),as:u[t]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e}))}}function sg(t,e,n,r){var i;const o=Am(r)?r.encoding[kn(e)]:void 0;if(ba(n)&&Am(r)&&ca(n,o,r.markDef,r.config))t.add(Sa(n,{})),t.add(Sa(n,{suffix:"end"})),n.bin&&Wa(n,e)&&t.add(Sa(n,{binSuffix:"range"}));else if(e in cn){const n=function(t){switch(t){case Ie:return"y";case Be:return"y2";case Ne:return"x";case ze:return"x2"}}(e);t.add(r.getName(n))}else t.add(Sa(n));return wa(n)&&function(t){return(0,W.isObject)(t)&&"field"in t}(null===(i=n.scale)||void 0===i?void 0:i.range)&&t.add(n.scale.range.field),t}class ag extends ef{constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}clone(){return new ag(null,new Set(this.dimensions),Nt(this.measures))}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef((t=>{t.aggregate&&(n=!0)}));const r={},i=new Set;return n?(e.forEachFieldDef(((t,n)=>{var o,s,a,u;const{aggregate:c,field:l}=t;if(c)if("count"===c)null!==(o=r["*"])&&void 0!==o||(r["*"]={}),r["*"].count=new Set([Sa(t,{forAs:!0})]);else{if(vr(c)||br(c)){const t=vr(c)?"argmin":"argmax",e=c[t];null!==(s=r[e])&&void 0!==s||(r[e]={}),r[e][t]=new Set([Sa({op:t,field:e},{forAs:!0})])}else null!==(a=r[l])&&void 0!==a||(r[l]={}),r[l][c]=new Set([Sa(t,{forAs:!0})]);lr(n)&&"unaggregated"===e.scaleDomain(n)&&(null!==(u=r[l])&&void 0!==u||(r[l]={}),r[l].min=new Set([Sa({field:l,aggregate:"min"},{forAs:!0})]),r[l].max=new Set([Sa({field:l,aggregate:"max"},{forAs:!0})]))}else sg(i,n,t,e)})),i.size+ne(r).length===0?null:new ag(t,i,r)):null}static makeFromTransform(t,e){var n,r,i;const o=new Set,s={};for(const a of e.aggregate){const{op:t,field:e,as:i}=a;t&&("count"===t?(null!==(n=s["*"])&&void 0!==n||(s["*"]={}),s["*"].count=new Set([i||Sa(a,{forAs:!0})])):(null!==(r=s[e])&&void 0!==r||(s[e]={}),s[e][t]=new Set([i||Sa(a,{forAs:!0})])))}for(const a of null!==(i=e.groupby)&&void 0!==i?i:[])o.add(a);return o.size+ne(s).length===0?null:new ag(t,o,s)}merge(t){return Kt(this.dimensions,t.dimensions)?(function(t,e){var n;for(const r of ne(e)){const i=e[r];for(const e of ne(i))r in t?t[r][e]=new Set([...null!==(n=t[r][e])&&void 0!==n?n:[],...i[e]]):t[r]={[e]:i[e]}}}(this.measures,t.measures),!0):(function(...t){ji.debug(...t)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...ne(this.measures)])}producedFields(){const t=new Set;for(const e of ne(this.measures))for(const n of ne(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add(`${n}_${e}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${Ut({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],e=[],n=[];for(const r of ne(this.measures))for(const i of ne(this.measures[r]))for(const o of this.measures[r][i])n.push(o),t.push(i),e.push("*"===r?null:de(r));return{type:"aggregate",groupby:[...this.dimensions].map(de),ops:t,fields:e,as:n}}}class ug extends ef{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const i of pn){const t=e.facet[i];if(t){const{bin:n,sort:r}=t;this[i]=Object.assign({name:e.getName(`${i}_domain`),fields:[Sa(t),...Sr(n)?[Sa(t,{binSuffix:"end"})]:[]]},Qs(r)?{sortField:r}:ft(r)?{sortIndexField:ap(t,i)}:{})}}this.childModel=e.child}hash(){let t="Facet";for(const e of pn)this[e]&&(t+=` ${e.charAt(0)}:${Ut(this[e])}`);return t}get fields(){var t;const e=[];for(const n of pn)(null===(t=this[n])||void 0===t?void 0:t.fields)&&e.push(...this[n].fields);return e}dependentFields(){const t=new Set(this.fields);for(const e of pn)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of Gn){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(Uo(r)&&Ir(i)){const n=em(nm(this.childModel,e));n?t[e]=n:Ri(ci(e))}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x",facet:void 0}[t],i=[],o=[],s=[];r&&n&&n[r]&&(e?(i.push(`distinct_${n[r]}`),o.push("max")):(i.push(n[r]),o.push("distinct")),s.push(`distinct_${n[r]}`));const{sortField:a,sortIndexField:u}=this[t];if(a){const{op:t=Xs,field:e}=a;i.push(e),o.push(t),s.push(Sa(a,{forAs:!0}))}else u&&(i.push(u),o.push("max"),s.push(u));return{name:this[t].name,source:null!==e&&void 0!==e?e:this.data,transform:[Object.assign({type:"aggregate",groupby:this[t].fields},i.length?{fields:i,ops:o,as:s}:{})]}}assembleFacetHeaderData(t){var e,n;const{columns:r}=this.model.layout,{layoutHeaders:i}=this.model.component,o=[],s={};for(const c of fp){for(const t of hp){const r=null!==(e=i[c]&&i[c][t])&&void 0!==e?e:[];for(const t of r)if((null===(n=t.axes)||void 0===n?void 0:n.length)>0){s[c]=!0;break}}if(s[c]){const t=`length(data("${this.facet.name}"))`,e="row"===c?r?{signal:`ceil(${t} / ${r})`}:1:r?{signal:`min(${t}, ${r})`}:{signal:t};o.push({name:`${this.facet.name}_${c}`,transform:[{type:"sequence",start:0,stop:e}]})}}const{row:a,column:u}=s;return(a||u)&&o.unshift(this.assembleRowColumnHeaderData("facet",null,t)),o}assemble(){var t,e;const n=[];let r=null;const i=this.getChildIndependentFieldsWithStep(),{column:o,row:s,facet:a}=this;if(o&&s&&(i.x||i.y)){r=`cross_${this.column.name}_${this.row.name}`;const o=[].concat(null!==(t=i.x)&&void 0!==t?t:[],null!==(e=i.y)&&void 0!==e?e:[]),s=o.map((()=>"distinct"));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:o,ops:s}]})}for(const u of[Ce,Se])this[u]&&n.push(this.assembleRowColumnHeaderData(u,r,i));if(a){const t=this.assembleFacetHeaderData(i);t&&n.push(...t)}return n}}function cg(t){return"'"===t[0]&&"'"===t[t.length-1]||'"'===t[0]&&'"'===t[t.length-1]?t.slice(1,-1):t}function lg(t){const e={};return Lt(t.filter,(t=>{var n;if(ao(t)){let r=null;to(t)?r=Zr(t.equal):no(t)?r=Zr(t.lte):eo(t)?r=Zr(t.lt):ro(t)?r=Zr(t.gt):io(t)?r=Zr(t.gte):oo(t)?r=t.range[0]:so(t)&&(r=(null!==(n=t.oneOf)&&void 0!==n?n:t.in)[0]),r&&(Ii(r)?e[t.field]="date":_t(r)?e[t.field]="number":Et(r)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}})),e}function fg(t){const e={};function n(t){var n;Ua(t)?e[t.field]="date":"quantitative"===t.type&&(Et(n=t.aggregate)&&Zt(["min","max"],n))?e[t.field]="number":me(t.field)>1?t.field in e||(e[t.field]="flatten"):wa(t)&&Qs(t.sort)&&me(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((Am(t)||Om(t))&&t.forEachFieldDef(((e,r)=>{if(ba(e))n(e);else{const i=Mn(r),o=t.fieldDef(i);n(Object.assign(Object.assign({},e),{type:o.type}))}})),Am(t)){const{mark:n,markDef:r,encoding:i}=t;if(bs(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];da(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}class hg extends ef{constructor(t,e){super(t),this._parse=e}clone(){return new hg(null,Nt(this._parse))}hash(){return`Parse ${Ut(this._parse)}`}static makeExplicit(t,e,n){var r;let i={};const o=e.data;return!Ll(o)&&(null===(r=null===o||void 0===o?void 0:o.format)||void 0===r?void 0:r.parse)&&(i=o.format.parse),this.makeWithAncestors(t,i,{},n)}static makeWithAncestors(t,e,n,r){for(const s of ne(n)){const t=r.getWithExplicit(s);void 0!==t.value&&(t.explicit||t.value===n[s]||"derived"===t.value||"flatten"===n[s]?delete n[s]:Ri(gi(s,n[s],t.value)))}for(const s of ne(e)){const t=r.get(s);void 0!==t&&(t===e[s]?delete e[s]:Ri(gi(s,e[s],t)))}const i=new Ol(e,n);r.copyAll(i);const o={};for(const s of ne(i.combine())){const t=i.get(s);null!==t&&(o[s]=t)}return 0===ne(o).length||r.parseNothing?null:new hg(t,o)}get parse(){return this._parse}merge(t){this._parse=Object.assign(Object.assign({},this._parse),t.parse),t.remove()}assembleFormatParse(){const t={};for(const e of ne(this._parse)){const n=this._parse[e];1===me(e)&&(t[e]=n)}return t}producedFields(){return new Set(ne(this._parse))}dependentFields(){return new Set(ne(this._parse))}assembleTransforms(t=!1){return ne(this._parse).filter((e=>!t||me(e)>1)).map((t=>{const e=function(t,e){const n=le(t);if("number"===e)return`toNumber(${n})`;if("boolean"===e)return`toBoolean(${n})`;if("string"===e)return`toString(${n})`;if("date"===e)return`toDate(${n})`;if("flatten"===e)return n;if(e.startsWith("date:"))return`timeParse(${n},'${cg(e.slice(5,e.length))}')`;if(e.startsWith("utc:"))return`utcParse(${n},'${cg(e.slice(4,e.length))}')`;return Ri(`Unrecognized parse "${e}".`),null}(t,this._parse[t]);if(!e)return null;return{type:"formula",expr:e,as:ge(t)}})).filter((t=>null!==t))}}class dg extends ef{clone(){return new dg(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Zu])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Zu}}}class pg extends ef{constructor(t,e){super(t),this.params=e}clone(){return new pg(null,this.params)}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Ut(this.params)}`}assemble(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}class gg extends ef{constructor(t,e){super(t),this.params=e}clone(){return new gg(null,this.params)}dependentFields(){return new Set}producedFields(){var t;return new Set([null!==(t=this.params.as)&&void 0!==t?t:"data"])}hash(){return`Hash ${Ut(this.params)}`}assemble(){return Object.assign({type:"sequence"},this.params)}}class mg extends ef{constructor(t){let e;if(super(null),null!==t&&void 0!==t||(t={name:"source"}),Ll(t)||(e=t.format?Object.assign({},zt(t.format,["parse"])):{}),Fl(t))this._data={values:t.values};else if(Dl(t)){if(this._data={url:t.url},!e.type){let n=/(?:\.([^.]+))?$/.exec(t.url)[1];Zt(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.type=n}}else Il(t)?this._data={values:[{type:"Sphere"}]}:(jl(t)||Ll(t))&&(this._data={});this._generator=Ll(t),t.name&&(this._name=t.name),e&&!ee(e)&&(this._data.format=e)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}var yg,vg=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n},bg=function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)};function xg(t){return t instanceof mg||t instanceof pg||t instanceof gg}class wg{constructor(){yg.set(this,void 0),vg(this,yg,!1,"f")}setModified(){vg(this,yg,!0,"f")}get modifiedFlag(){return bg(this,yg,"f")}}yg=new WeakMap;class _g extends wg{getNodeDepths(t,e,n){n.set(t,e);for(const r of t.children)this.getNodeDepths(r,e+1,n);return n}optimize(t){const e=[...this.getNodeDepths(t,0,new Map).entries()].sort(((t,e)=>e[1]-t[1]));for(const n of e)this.run(n[0]);return this.modifiedFlag}}class Eg extends wg{optimize(t){this.run(t);for(const e of t.children)this.optimize(e);return this.modifiedFlag}}class Ag extends Eg{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map((t=>t.hash())),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const r of ne(n))n[r].length>1&&(this.setModified(),this.mergeNodes(t,n[r]))}}class Og extends Eg{constructor(t){super(),this.requiresSelectionId=t&&dh(t)}run(t){t instanceof dg&&(this.requiresSelectionId&&(xg(t.parent)||t.parent instanceof ag||t.parent instanceof hg)||(this.setModified(),t.remove()))}}class Sg extends wg{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,e){let n=new Set;t instanceof of&&(n=t.producedFields(),Jt(n,e)&&(this.setModified(),t.removeFormulas(e),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...e,...n]))}}class Cg extends Eg{constructor(){super()}run(t){t instanceof nf&&!t.isRequired()&&(this.setModified(),t.remove())}}class Mg extends _g{run(t){if(!xg(t)&&!(t.numChildren()>1))for(const e of t.children)if(e instanceof hg)if(t instanceof hg)this.setModified(),t.merge(e);else{if(te(t.producedFields(),e.dependentFields()))continue;this.setModified(),e.swapWithParent()}}}class Pg extends _g{run(t){const e=[...t.children],n=t.children.filter((t=>t instanceof hg));if(t.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const t of n){const e=t.parse;for(const t of ne(e))t in r?r[t]!==e[t]&&i.add(t):r[t]=e[t]}for(const t of i)delete r[t];if(!ee(r)){this.setModified();const n=new hg(t,r);for(const i of e){if(i instanceof hg)for(const t of ne(r))delete i.parse[t];t.removeChild(i),i.parent=n,i instanceof hg&&0===ne(i.parse).length&&i.remove()}}}}}class kg extends _g{run(t){t instanceof nf||t.numChildren()>0||t instanceof ug||t instanceof mg||(this.setModified(),t.remove())}}class Tg extends _g{run(t){const e=t.children.filter((t=>t instanceof of)),n=e.pop();for(const r of e)this.setModified(),n.merge(r)}}class Dg extends _g{run(t){const e=t.children.filter((t=>t instanceof ag)),n={};for(const r of e){const t=Ut(r.groupBy);t in n||(n[t]=[]),n[t].push(r)}for(const r of ne(n)){const e=n[r];if(e.length>1){const n=e.pop();for(const r of e)n.merge(r)&&(t.removeChild(r),r.parent=n,r.remove(),this.setModified())}}}}class Fg extends _g{constructor(t){super(),this.model=t}run(t){const e=!(xg(t)||t instanceof Vd||t instanceof hg||t instanceof dg),n=[],r=[];for(const i of t.children)i instanceof og&&(e&&!te(t.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const e=n.pop();for(const t of n)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof og?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(r.length>1){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified()}}}class jg extends _g{run(t){const e=[...t.children];if(!Wt(e,(t=>t instanceof nf))||t.numChildren()<=1)return;const n=[];let r;for(const i of e)if(i instanceof nf){let e=i;for(;1===e.numChildren();){const[t]=e.children;if(!(t instanceof nf))break;e=t}n.push(...e.children),r?(t.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=e,this.setModified()):r=e}else n.push(i);if(n.length){this.setModified();for(const t of n)t.parent.removeChild(t),t.parent=r}}}class Lg extends ef{constructor(t,e){super(t),this.transform=e}clone(){return new Lg(null,Nt(this.transform))}addDimensions(t){this.transform.groupby=Xt(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:Sa(t)}hash(){return`JoinAggregateTransform ${Ut(this.transform)}`}assemble(){const t=[],e=[],n=[];for(const i of this.transform.joinaggregate)e.push(i.op),n.push(this.getDefaultName(i)),t.push(void 0===i.field?null:i.field);const r=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:e,fields:t},void 0!==r?{groupby:r}:{})}}class Rg extends ef{constructor(t,e){super(t),this._stack=e}clone(){return new Rg(null,Nt(this._stack))}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:o="zero"}=e,s=[],a=[];if(void 0!==e.sort)for(const l of e.sort)s.push(l.field),a.push(ye(l.order,"ascending"));const u={field:s,order:a};let c;return c=function(t){return ft(t)&&t.every((t=>Et(t)))&&t.length>1}(i)?i:Et(i)?[i,`${i}_end`]:[`${e.stack}_start`,`${e.stack}_end`],new Rg(t,{stackField:n,groupby:r,offset:o,sort:u,facetby:[],as:c})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannel:i,fieldChannel:o,offset:s,impute:a}=n;let u;if(i){u=La(r[i])}const c=function(t){return t.stack.stackBy.reduce(((t,e)=>{const n=Sa(e.fieldDef);return n&&t.push(n),t}),[])}(e),l=e.encoding.order;let f;return f=ft(l)||da(l)?ti(l):c.reduce(((t,e)=>(t.field.push(e),t.order.push("y"===o?"descending":"ascending"),t)),{field:[],order:[]}),new Rg(t,{dimensionFieldDef:u,stackField:e.vgField(o),facetby:[],stackby:c,sort:f,offset:s,impute:a,as:[e.vgField(o,{suffix:"start",forAs:!0}),e.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Ut(this._stack)}`}getGroupbyFields(){const{dimensionFieldDef:t,impute:e,groupby:n}=this._stack;return t?t.bin?e?[Sa(t,{binSuffix:"mid"})]:[Sa(t,{}),Sa(t,{binSuffix:"end"})]:[Sa(t)]:null!==n&&void 0!==n?n:[]}assemble(){const t=[],{facetby:e,dimensionFieldDef:n,stackField:r,stackby:i,sort:o,offset:s,impute:a,as:u}=this._stack;if(a&&n){const{bandPosition:o=.5,bin:s}=n;s&&t.push({type:"formula",expr:`${o}*`+Sa(n,{expr:"datum"})+`+${1-o}*`+Sa(n,{expr:"datum",binSuffix:"end"}),as:Sa(n,{binSuffix:"mid",forAs:!0})}),t.push({type:"impute",field:r,groupby:[...i,...e],key:Sa(n,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:o,as:u,offset:s}),t}}class Ig extends ef{constructor(t,e){super(t),this.transform=e}clone(){return new Ig(null,Nt(this.transform))}addDimensions(t){this.transform.groupby=Xt(this.transform.groupby.concat(t),(t=>t))}dependentFields(){var t,e;const n=new Set;return(null!==(t=this.transform.groupby)&&void 0!==t?t:[]).forEach(n.add,n),(null!==(e=this.transform.sort)&&void 0!==e?e:[]).forEach((t=>n.add(t.field))),this.transform.window.map((t=>t.field)).filter((t=>void 0!==t)).forEach(n.add,n),n}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){var e;return null!==(e=t.as)&&void 0!==e?e:Sa(t)}hash(){return`WindowTransform ${Ut(this.transform)}`}assemble(){var t;const e=[],n=[],r=[],i=[];for(const f of this.transform.window)n.push(f.op),r.push(this.getDefaultName(f)),i.push(void 0===f.param?null:f.param),e.push(void 0===f.field?null:f.field);const o=this.transform.frame,s=this.transform.groupby;if(o&&null===o[0]&&null===o[1]&&n.every((t=>xr(t))))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:e},void 0!==s?{groupby:s}:{});const a=[],u=[];if(void 0!==this.transform.sort)for(const f of this.transform.sort)a.push(f.field),u.push(null!==(t=f.order)&&void 0!==t?t:"ascending");const c={field:a,order:u},l=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:i,as:r,ops:n,fields:e,sort:c},void 0!==l?{ignorePeers:l}:{}),void 0!==s?{groupby:s}:{}),void 0!==o?{frame:o}:{})}}function Ng(t){if(t instanceof ug)if(1!==t.numChildren()||t.children[0]instanceof nf){const n=t.model.component.data.main;Bg(n);const r=(e=t,function t(n){if(!(n instanceof ug)){const r=n.clone();if(r instanceof nf){const t=zg+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof ag||r instanceof Rg||r instanceof Ig||r instanceof Lg)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof ag||e instanceof Rg||e instanceof Ig||e instanceof Lg)&&e.addDimensions(t.fields),e.swapWithParent(),Ng(t)}else t.children.map(Ng);var e}function Bg(t){if(t instanceof nf&&t.type===Bl.Main&&1===t.numChildren()){const e=t.children[0];e instanceof ug||(e.swapWithParent(),Bg(t))}}const zg="scale_";function $g(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return!1;if(!$g(e.children))return!1}return!0}function Ug(t,e){let n=!1;for(const r of e)n=t.optimize(r)||n;return n}function Vg(t,e,n){let r=t.sources,i=!1;return i=Ug(new Cg,r)||i,i=Ug(new Og(e),r)||i,r=r.filter((t=>t.numChildren()>0)),i=Ug(new kg,r)||i,r=r.filter((t=>t.numChildren()>0)),n||(i=Ug(new Mg,r)||i,i=Ug(new Fg(e),r)||i,i=Ug(new Sg,r)||i,i=Ug(new Pg,r)||i,i=Ug(new Dg,r)||i,i=Ug(new Tg,r)||i,i=Ug(new Ag,r)||i,i=Ug(new jg,r)||i),t.sources=r,i}class Zg{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new Zg((()=>t(e)))}}var Wg=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function qg(t){Am(t)?function(t){const e=t.component.scales;for(const n of ne(e)){const r=Gg(t,n);if(e[n].setWithExplicit("domains",r),Kg(t,n),t.component.data.isFaceted){let e=t;for(;!Om(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)Nr(t)&&(t.data=zg+t.data.replace(zg,""))}}}(t):function(t){for(const n of t.children)qg(n);const e=t.component.scales;for(const n of ne(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):kl(r,t.getWithExplicit("domains"),"domains","scale",Qg);const e=t.get("selectionExtent");i&&e&&i.param!==e.param&&Ri(di),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function Gg(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=Jg(e,n);if(!t)return void Ri(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=Jg(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]=Object.assign(Object.assign({},t.specifiedScales[e]),{domain:i})),"x"===e&&Ra(r.x2)?Ra(r.x)?kl(Xg(n,i,t,"x"),Xg(n,i,t,"x2"),"domain","scale",Qg):Xg(n,i,t,"x2"):"y"===e&&Ra(r.y2)?Ra(r.y)?kl(Xg(n,i,t,"y"),Xg(n,i,t,"y2"),"domain","scale",Qg):Xg(n,i,t,"y2"):Xg(n,i,t,e)}function Hg(t,e,n){var r;const i=null===(r=Qi(n))||void 0===r?void 0:r.unit;return"temporal"===e||i?function(t,e,n){return t.map((t=>({signal:`{data: ${Va(t,{timeUnit:n,type:e})}}`})))}(t,e,i):[t]}function Xg(t,e,n,r){const{encoding:i}=n,o=Ra(i[r]),{type:s}=o,a=o.timeUnit;if(function(t){return t&&t.unionWith}(e)){const i=Xg(t,void 0,n,r),o=Hg(e.unionWith,s,a);return Sl([...i.value,...o])}if(Rr(e))return Sl([e]);if(e&&"unaggregated"!==e&&!qo(e))return Sl(Hg(e,s,a));const u=n.stack;if(u&&r===u.fieldChannel){if("normalize"===u.offset)return Cl([[0,1]]);const t=n.requestDataName(Bl.Main);return Cl([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const c=lr(r)&&da(o)?function(t,e,n){if(!Uo(n))return;const r=t.fieldDef(e),i=r.sort;if(ta(i))return{op:"min",field:ap(r,e),order:"ascending"};const{stack:o}=t,s=o?[...o.groupbyField?[o.groupbyField]:[],...o.stackBy.map((t=>t.fieldDef.field))]:void 0;if(Qs(i)){return Yg(i,o&&!Zt(s,i.field))}if(Js(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:a,field:u}=r,c=o&&!Zt(s,u);if(vr(a)||br(a))return Yg({field:Sa(r),order:n},c);if(xr(a)||!a)return Yg({op:a,field:u,order:n},c)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(Zt(["ascending",void 0],i))return!0}return}(n,r,t):void 0;if(ga(o)){return Cl(Hg([o.datum],s,a))}const l=o;if("unaggregated"===e){const t=n.requestDataName(Bl.Main),{field:e}=o;return Cl([{data:t,field:Sa({field:e,aggregate:"min"})},{data:t,field:Sa({field:e,aggregate:"max"})}])}if(Sr(l.bin)){if(Uo(t))return Cl("bin-ordinal"===t?[]:[{data:oe(c)?n.requestDataName(Bl.Main):n.requestDataName(Bl.Raw),field:n.vgField(r,Wa(l,r)?{binSuffix:"range"}:{}),sort:!0!==c&&ht(c)?c:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=l;if(Sr(t)){const e=rg(n,l.field,t);return Cl([new Zg((()=>{const t=n.getSignalName(e);return`[${t}.start, ${t}.stop]`}))])}return Cl([{data:n.requestDataName(Bl.Main),field:n.vgField(r,{})}])}}if(l.timeUnit&&Zt(["time","utc"],t)&&ca(l,Am(n)?n.encoding[kn(r)]:void 0,n.markDef,n.config)){const t=n.requestDataName(Bl.Main);return Cl([{data:t,field:n.vgField(r)},{data:t,field:n.vgField(r,{suffix:"end"})}])}return Cl(c?[{data:oe(c)?n.requestDataName(Bl.Main):n.requestDataName(Bl.Raw),field:n.vgField(r),sort:c}]:[{data:n.requestDataName(Bl.Main),field:n.vgField(r)}])}function Yg(t,e){const{op:n,field:r,order:i}=t;return Object.assign(Object.assign({op:null!==n&&void 0!==n?n:e?"sum":Xs},r?{field:de(r)}:{}),i?{order:i}:{})}function Kg(t,e){var n;const r=t.component.scales[e],i=t.specifiedScales[e].domain,o=null===(n=t.fieldDef(e))||void 0===n?void 0:n.bin,s=qo(i)&&i,a=Mr(o)&&Pr(o.extent)&&o.extent;(s||a)&&r.set("selectionExtent",null!==s&&void 0!==s?s:a,!0)}function Jg(t,e){const{aggregate:n,type:r}=t;return n?Et(n)&&!Ar[n]?{valid:!1,reason:Oi(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:Si(t)}:{valid:!0}:{valid:!1,reason:Ai(t)}}function Qg(t,e,n,r){return t.explicit&&e.explicit&&Ri(function(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${$t(n)} and ${$t(r)}). Using the union of the two domains.`}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function tm(t){const e=Xt(t.map((t=>{if(Nr(t)){const{sort:e}=t;return Wg(t,["sort"])}return t})),Ut),n=Xt(t.map((t=>{if(Nr(t)){const e=t.sort;return void 0===e||oe(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}})).filter((t=>void 0!==t)),Ut);if(0===e.length)return;if(1===e.length){const e=t[0];if(Nr(e)&&n.length>0){let t=n[0];if(n.length>1)Ri(Pi),t=!0;else if(ht(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return Object.assign(Object.assign({},e),{sort:t})}return e}const r=Xt(n.map((t=>oe(t)||!("op"in t)||Et(t.op)&&t.op in yr?t:(Ri(function(t){return`Dropping sort property ${$t(t)} as unioned domains only support boolean or op "count", "min", and "max".`}(t)),!0))),Ut);let i;1===r.length?i=r[0]:r.length>1&&(Ri(Pi),i=!0);const o=Xt(t.map((t=>Nr(t)?t.data:null)),(t=>t));if(1===o.length&&null!==o[0]){return Object.assign({data:o[0],fields:e.map((t=>t.field))},i?{sort:i}:{})}return Object.assign({fields:e},i?{sort:i}:{})}function em(t){if(Nr(t)&&Et(t.field))return t.field;if(function(t){return!ft(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(Nr(n)&&Et(n.field))if(e){if(e!==n.field)return Ri("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return Ri("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(t){return!ft(t)&&"fields"in t&&"data"in t}(t)){Ri("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const e=t.fields[0];return Et(e)?e:void 0}}function nm(t,e){return tm(t.component.scales[e].get("domains").map((e=>(Nr(e)&&(e.data=t.lookupDataSource(e.data)),e))))}var rm=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function im(t){return Cm(t)||Sm(t)?t.children.reduce(((t,e)=>t.concat(im(e))),om(t)):om(t)}function om(t){return ne(t.component.scales).reduce(((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:u,range:c,reverse:l}=i,f=rm(i,["name","type","selectionExtent","domains","range","reverse"]),h=function(t,e,n,r){if(Hn(n)){if(Ir(t))return{step:{signal:`${e}_step`}}}else if(ht(t)&&Nr(t))return Object.assign(Object.assign({},t),{data:r.lookupDataSource(t.data)});return t}(i.range,o,n,t),d=nm(t,n),p=a?function(t,e,n,r){const i=Wd(t,e.param,e);return{signal:Vo(n.get("type"))&&ft(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}(t,a,r,d):null;return e.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:o,type:s},d?{domain:d}:{}),p?{domainRaw:p}:{}),{range:h}),void 0!==l?{reverse:l}:{}),f)),e}),[])}class sm extends Ol{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Wt(this.get("domains"),(t=>ft(t)&&2===t.length&&t[0]<=0&&t[1]>=0))}}const am=["range","scheme"];function um(t){return"x"===t?"width":"y"===t?"height":void 0}function cm(t,e){const n=t.fieldDef(e);if(null===n||void 0===n?void 0:n.bin){const{bin:r,field:i}=n,o=um(e),s=t.getName(o);if(ht(r)&&r.binned&&void 0!==r.step)return new Zg((()=>{const n=t.scaleName(e),i=`(domain("${n}")[1] - domain("${n}")[0]) / ${r.step}`;return`${t.getSignalName(s)} / (${i})`}));if(Sr(r)){const e=rg(t,i,r);return new Zg((()=>{const n=t.getSignalName(e),r=`(${n}.stop - ${n}.start) / ${n}.step`;return`${t.getSignalName(s)} / (${r})`}))}}}function lm(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const u of am)if(void 0!==n[u]){const r=ns(i,u),o=rs(t,u);if(r)if(o)Ri(o);else switch(u){case"range":{const r=n.range;if(ft(r)){if(Hn(t))return Sl(r.map((t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return Zg.fromName(r,n)}return t})))}else if(ht(r))return Sl({data:e.requestDataName(Bl.Main),field:r.field,sort:{op:"min",field:e.vgField(t)}});return Sl(r)}case"scheme":return Sl(fm(n[u]))}else Ri(Ci(i,u,t))}if(t===Pe||t===ke){const e=t===Pe?"width":"height",n=r[e];if(tc(n)){if(Uo(i))return Sl({step:n.step});Ri(Mi(e))}}const{rangeMin:o,rangeMax:s}=n,a=function(t,e){const{size:n,config:r,mark:i,encoding:o}=e,s=e.getSignalName.bind(e),{type:a}=Ra(o[t]),u=e.getScaleComponent(t).get("type"),{domain:c,domainMid:l}=e.specifiedScales[t];switch(t){case Pe:case ke:{if(Zt(["point","band"],u))if(t!==Pe||n.width){if(t===ke&&!n.height){const t=sc(r.view,"height");if(tc(t))return t}}else{const t=sc(r.view,"width");if(tc(t))return t}const i=um(t),o=e.getName(i);return t===ke&&Vo(u)?[Zg.fromName(s,o),0]:[0,Zg.fromName(s,o)]}case We:{const o=hm(i,e.component.scales[t].get("zero"),r),s=function(t,e,n,r){const i={x:cm(n,"x"),y:cm(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=pm(e,i,r.view);return _t(t)?t-1:new Zg((()=>`${t.signal} - 1`))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=pm(e,i,r.view);return _t(t)?Math.pow(dm*t,2):new Zg((()=>`pow(0.95 * ${t.signal}, 2)`))}}throw new Error(xi("size",t))}(i,n,e,r);return Wo(u)?function(t,e,n){const r=()=>{const r=Hr(e),i=Hr(t),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return Rr(e)?new Zg(r):{signal:r()}}(o,s,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&ft(n)?n.length+1:(Ri(function(t){return`Domain for ${t} is required for threshold scale.`}(r)),3)}}(u,r,c,t)):[o,s]}case Le:return[0,2*Math.PI];case qe:return[0,360];case Fe:return[0,new Zg((()=>`min(${e.getSignalName("width")},${e.getSignalName("height")})/2`))];case Ye:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Ke:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case Ze:return"symbol";case $e:case Ue:case Ve:return"ordinal"===u?"nominal"===a?"category":"ordinal":void 0!==l?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case Ge:case He:case Xe:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error(`Scale range undefined for channel ${t}`)}(t,e);return(void 0!==o||void 0!==s)&&ns(i,"rangeMin")&&ft(a)&&2===a.length?Sl([null!==o&&void 0!==o?o:a[0],null!==s&&void 0!==s?s:a[1]]):Cl(a)}function fm(t){return function(t){return!Et(t)&&!!t.name}(t)?Object.assign({scheme:t.name},zt(t,["name"])):{scheme:t}}function hm(t,e,n){if(e)return Rr(e)?{signal:`${e.signal} ? 0 : ${hm(t,!1,n)}`}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(xi("size",t))}const dm=.95;function pm(t,e,n){const r=tc(t.width)?t.width.step:oc(n,"width"),i=tc(t.height)?t.height.step:oc(n,"height");return e.x||e.y?new Zg((()=>`min(${[e.x?e.x.signal:r,e.y?e.y.signal:i].join(", ")})`)):Math.min(r,i)}function gm(t,e){Am(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=t;for(const a of ne(n)){const u=s[a],c=n[a],l=t.getScaleComponent(a),f=Ra(i[a]),h=u[e],d=l.get("type"),p=l.get("padding"),g=l.get("paddingInner"),m=ns(d,e),y=rs(a,e);if(void 0!==h&&(m?y&&Ri(y):Ri(Ci(d,e,a))),m&&void 0===y)if(void 0!==h){const t=f.timeUnit,n=f.type;switch(e){case"domainMax":case"domainMin":Ii(u[e])||"temporal"===n||t?c.set(e,{signal:Va(u[e],{type:n,timeUnit:t})},!0):c.set(e,u[e],!0);break;default:c.copyKeyFromObject(e,u)}}else{const n=e in mm?mm[e]({model:t,channel:a,fieldOrDatumDef:f,scaleType:d,scalePadding:p,scalePaddingInner:g,domain:u.domain,markDef:o,config:r}):r.scale[e];void 0!==n&&c.set(e,n,!1)}}}(t,e):vm(t,e)}const mm={bins:({model:t,fieldOrDatumDef:e})=>da(e)?function(t,e){const n=e.bin;if(Sr(n)){const r=rg(t,e.field,n);return new Zg((()=>t.getSignalName(r)))}if(Cr(n)&&Mr(n)&&void 0!==n.step)return{step:n.step};return}(t,e):void 0,interpolate:({channel:t,fieldOrDatumDef:e})=>function(t,e){if(Zt([$e,Ue,Ve],t)&&"nominal"!==e)return"hcl";return}(t,e.type),nice:({scaleType:t,channel:e,domain:n,fieldOrDatumDef:r})=>function(t,e,n,r){var i;if((null===(i=La(r))||void 0===i?void 0:i.bin)||ft(n)||Zt([Oo,So],t))return;return e in qn||void 0}(t,e,n,r),padding:({channel:t,scaleType:e,fieldOrDatumDef:n,markDef:r,config:i})=>function(t,e,n,r,i,o){if(t in qn){if(Zo(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:s}=i;if("bar"===e&&(!da(r)||!r.bin&&!r.timeUnit)&&("vertical"===s&&"x"===t||"horizontal"===s&&"y"===t))return o.continuousBandSize}if(e===ko)return n.pointPadding}return}(t,e,i.scale,n,r,i.bar),paddingInner:({scalePadding:t,channel:e,markDef:n,config:r})=>function(t,e,n,r){if(void 0!==t)return;if(e in qn){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:i}=r;return ye(t,"bar"===n?e:i)}return}(t,e,n.type,r.scale),paddingOuter:({scalePadding:t,channel:e,scaleType:n,markDef:r,scalePaddingInner:i,config:o})=>function(t,e,n,r,i,o){if(void 0!==t)return;if(e in qn&&n===To){const{bandPaddingOuter:t}=o;return ye(t,Rr(i)?{signal:`${i.signal}/2`}:i/2)}return}(t,e,n,r.type,i,o.scale),reverse:({fieldOrDatumDef:t,scaleType:e,channel:n,config:r})=>function(t,e,n,r){if("x"===n&&void 0!==r.xReverse)return Vo(t)&&"descending"===e?Rr(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse;if(Vo(t)&&"descending"===e)return!0;return}(e,da(t)?t.sort:void 0,n,r.scale),zero:({channel:t,fieldOrDatumDef:e,domain:n,markDef:r,scaleType:i})=>function(t,e,n,r,i){if(n&&"unaggregated"!==n&&Vo(i)){if(ft(n)){const t=n[0],e=n[n.length-1];if(t<=0&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!Wo(i))return!0;if((!da(e)||!e.bin)&&Zt([...Gn,...Yn],t)){const{orient:e,type:n}=r;return!Zt(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t)}return!1}(t,e,n,r,i)};function ym(t){Am(t)?function(t){const e=t.component.scales;for(const n of cr){const r=e[n];if(!r)continue;const i=lm(n,t);r.setWithExplicit("range",i)}}(t):vm(t,"range")}function vm(t,e){const n=t.component.scales;for(const r of t.children)"range"===e?ym(r):gm(r,e);for(const r of ne(n)){let i;for(const n of t.children){const t=n.component.scales[r];if(t){i=kl(i,t.getWithExplicit(e),e,"scale",Ml(((t,n)=>{switch(e){case"range":return t.step&&n.step?t.step-n.step:0}return 0})))}}n[r].setWithExplicit(e,i)}}function bm(t,e,n,r){const i=function(t,e,n){var r;switch(e.type){case"nominal":case"ordinal":if(hn(t)||"discrete"===gr(t))return"shape"===t&&"ordinal"===e.type&&Ri(Ei(t,"ordinal")),"ordinal";if(t in qn){if(Zt(["rect","bar","image","rule"],n.type))return"band"}else if("arc"===n.type&&t in Xn)return"band";return Ss(n[Tn(t)])||_a(e)&&(null===(r=e.axis)||void 0===r?void 0:r.tickBand)?"band":"point";case"temporal":return hn(t)?"time":"discrete"===gr(t)?(Ri(Ei(t,"temporal")),"ordinal"):da(e)&&e.timeUnit&&Qi(e.timeUnit).utc?"utc":"time";case"quantitative":return hn(t)?da(e)&&Sr(e.bin)?"bin-ordinal":"linear":"discrete"===gr(t)?(Ri(Ei(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(yi(e.type))}(e,n,r),{type:o}=t;return lr(e)?void 0!==o?function(t,e){if(!lr(t))return!1;switch(t){case Pe:case ke:case Le:case Fe:return Zo(e)||Zt(["band","point"],e);case We:case Ye:case Ge:case He:case Xe:case qe:return Zo(e)||Wo(e)||Zt(["band","point","ordinal"],e);case $e:case Ue:case Ve:return"band"!==e;case Ke:case Ze:return"ordinal"===e||Wo(e)}}(e,o)?da(n)&&(s=o,a=n.type,!(Zt([go,yo],a)?void 0===s||Uo(s):a===mo?Zt([Oo,So,void 0],s):a!==po||Zt([wo,_o,Eo,Ao,Co,Mo,Po,xo,void 0],s)))?(Ri(function(t,e){return`FieldDef does not work with "${t}" scale. We are using "${e}" scale instead.`}(o,i)),i):o:(Ri(function(t,e,n){return`Channel "${t}" does not work with "${e}" scale. We are using "${n}" scale instead.`}(e,o,i)),i):i:null;var s,a}function xm(t){Am(t)?t.component.scales=function(t){const{encoding:e,mark:n,markDef:r}=t;return cr.reduce(((i,o)=>{const s=Ra(e[o]);if(s&&n===vs&&o===Ze&&s.type===vo)return i;let a=s&&s.scale;if(s&&null!==a&&!1!==a){null!==a&&void 0!==a||(a={});const e=bm(a,o,s,r);i[o]=new sm(t.scaleName(`${o}`,!0),{value:e,explicit:a.type===e})}return i}),{})}(t):t.component.scales=function(t){var e,n;const r=t.component.scales={},i={},o=t.component.resolve;for(const s of t.children){xm(s);for(const r of ne(s.component.scales))if(null!==(e=(n=o.scale)[r])&&void 0!==e||(n[r]=Pp(r,t)),"shared"===o.scale[r]){const t=i[r],e=s.component.scales[r].getWithExplicit("type");t?Fo(t.value,e.value)?i[r]=kl(t,e,"type","scale",wm):(o.scale[r]="independent",delete i[r]):i[r]=e}}for(const s of ne(i)){const e=t.scaleName(s,!0),n=i[s];r[s]=new sm(e,n);for(const r of t.children){const t=r.component.scales[s];t&&(r.renameScale(t.get("name"),e),t.merged=!0)}}return r}(t)}const wm=Ml(((t,e)=>Lo(t)-Lo(e)));var _m=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Em{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Am(t){return"unit"===(null===t||void 0===t?void 0:t.type)}function Om(t){return"facet"===(null===t||void 0===t?void 0:t.type)}function Sm(t){return"concat"===(null===t||void 0===t?void 0:t.type)}function Cm(t){return"layer"===(null===t||void 0===t?void 0:t.type)}class Mm{constructor(t,e,n,r,i,o,s){var a,u;this.type=e,this.parent=n,this.config=i,this.correctDataNames=t=>{var e,n,r;return(null===(e=t.from)||void 0===e?void 0:e.data)&&(t.from.data=this.lookupDataSource(t.from.data)),(null===(r=null===(n=t.from)||void 0===n?void 0:n.facet)||void 0===r?void 0:r.data)&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t},this.parent=n,this.config=i,this.view=Dr(s),this.name=null!==(a=t.name)&&void 0!==a?a:r,this.title=Lr(t.title)?{text:t.title}:t.title?Dr(t.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new Em,this.projectionNameMap=n?n.projectionNameMap:new Em,this.signalNameMap=n?n.signalNameMap:new Em,this.data=t.data,this.description=t.description,this.transforms=(null!==(u=t.transform)&&void 0!==u?u:[]).map((t=>Gc(t)?{filter:Rt(t.filter,fo)}:t)),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){var r,i;const o=n[e],s={},{spacing:a,columns:u}=o;void 0!==a&&(s.spacing=a),void 0!==u&&(ra(t)&&!ea(t.facet)||Ku(t))&&(s.columns=u),Ju(t)&&(s.columns=1);for(const c of nc)if(void 0!==t[c])if("spacing"===c){const e=t[c];s[c]=_t(e)?e:{row:null!==(r=e.row)&&void 0!==r?r:a,column:null!==(i=e.column)&&void 0!==i?i:a}}else s[c]=t[c];return s}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:ra(t)||n&&n.component.data.isFaceted&&void 0===t.data},layoutSize:new Ol,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},o?Nt(o):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t,{ignoreRange:e}={}){xm(t),qg(t);for(const n of es)gm(t,n);e||ym(t)}(this)}parseProjection(){tg(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){Vp(this)}assembleEncodeFromView(t){const{style:e}=t,n=_m(t,["style"]),r={};for(const i of ne(n)){const t=n[i];void 0!==t&&(r[i]=qr(t))}return r}assembleGroupEncodeEntry(t){let e={};return this.view&&(e=this.assembleEncodeFromView(this.view)),t||(this.description&&(e.description=qr(this.description)),"unit"!==this.type&&"layer"!==this.type)?ee(e)?void 0:e:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!==e&&void 0!==e?e:{})}assembleLayout(){if(!this.layout)return;const t=this.layout,{spacing:e}=t,n=_m(t,["spacing"]),{component:r,config:i}=this,o=function(t,e){const n={};for(const r of pn){const i=t[r];if(null===i||void 0===i?void 0:i.facetFieldDef){const{titleAnchor:t,titleOrient:o}=lp(["titleAnchor","titleOrient"],i.facetFieldDef.header,e,r),s=up(r,o),a=wp(t,s);void 0!==a&&(n[s]=a)}}return ee(n)?void 0:n}(r.layoutHeaders,i);return Object.assign(Object.assign(Object.assign({padding:e},this.assembleDefaultLayout()),n),o?{titleBand:o}:{})}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of pn)t[n].title&&e.push(dp(this,n));for(const n of fp)e=e.concat(mp(this,n));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map((t=>Xd(t,"grid",e))),...r.map((t=>Xd(t,"grid",e))),...n.map((t=>Xd(t,"main",e))),...r.map((t=>Xd(t,"main",e)))].filter((t=>t))}(this.component.axes,this.config)}assembleLegends(){return Xp(this)}assembleProjections(){return Yp(this)}assembleTitle(){var t,e,n;const r=null!==(t=this.title)&&void 0!==t?t:{},{encoding:i}=r,o=_m(r,["encoding"]),s=Object.assign(Object.assign(Object.assign({},jr(this.config.title).nonMarkTitleProperties),o),i?{encode:{update:i}}:{});if(s.text)return Zt(["unit","layer"],this.type)?Zt(["middle",void 0],s.anchor)&&(null!==(e=s.frame)&&void 0!==e||(s.frame="group")):null!==(n=s.anchor)&&void 0!==n||(s.anchor="start"),ee(s)?void 0:s}assembleGroup(t=[]){const e={};(t=t.concat(this.assembleSignals())).length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Om(this.parent)?im(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const o=this.assembleLegends();return o.length>0&&(e.legends=o),e}getName(t){return se((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Bl[t].toLowerCase())}requestDataName(t){const e=this.getDataName(t),n=this.component.data.outputNodeRefCounts;return n[e]=(n[e]||0)+1,e}getSizeSignalRef(t){if(Om(this.parent)){const e=Kn(Cp(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(Uo(t)&&Ir(r)){const t=n.get("name"),r=em(nm(this,e));if(r){return{signal:Sp(t,n,Sa({aggregate:"distinct",field:r},{expr:"datum"}))}}return Ri(ci(e)),null}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):On(t)&&lr(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error(`Cannot find a selection named "${e}".`);return n}hasAxisOrientSignalRef(){var t,e;return(null===(t=this.component.axes.x)||void 0===t?void 0:t.some((t=>t.hasOrientSignalRef())))||(null===(e=this.component.axes.y)||void 0===e?void 0:e.some((t=>t.hasOrientSignalRef())))}}class Pm extends Mm{vgField(t,e={}){const n=this.fieldDef(t);if(n)return Sa(n,e)}reduceFieldDef(t,e){return function(t,e,n,r){return t?ne(t).reduce(((n,i)=>{const o=t[i];return ft(o)?o.reduce(((t,n)=>e.call(r,t,n,i)),n):e.call(r,n,o,i)}),n):n}(this.getMapping(),((e,n,r)=>{const i=La(n);return i?t(e,i,r):e}),e)}forEachFieldDef(t,e){uu(this.getMapping(),((e,n)=>{const r=La(e);r&&t(r,n)}),e)}}var km=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Tm extends ef{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Nt(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"value",null!==(i=o[1])&&void 0!==i?i:"density"]}clone(){return new Tm(null,Nt(this.transform))}dependentFields(){var t;return new Set([this.transform.density,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Ut(this.transform)}`}assemble(){const t=this.transform,{density:e}=t,n=km(t,["density"]);return Object.assign({type:"kde",field:e},n)}}class Dm extends ef{constructor(t,e){super(t),this.filter=e}clone(){return new Dm(null,Object.assign({},this.filter))}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==Yr("invalid",i,n))return null;const o=e.reduceFieldDef(((t,n,i)=>{const o=lr(i)&&e.getScaleComponent(i);if(o){Vo(o.get("type"))&&"count"!==n.aggregate&&!bs(r)&&(t[n.field]=n)}return t}),{});return ne(o).length?new Dm(t,o):null}dependentFields(){return new Set(ne(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Ut(this.filter)}`}assemble(){const t=ne(this.filter).reduce(((t,e)=>{const n=this.filter[e],r=Sa(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(t.push(`isValid(${r})`),t.push(`isFinite(+${r})`))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Fm extends ef{constructor(t,e){super(t),this.transform=e,this.transform=Nt(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((t,e)=>{var n;return null!==(n=r[e])&&void 0!==n?n:t}))}clone(){return new Fm(this.parent,Nt(this.transform))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Ut(this.transform)}`}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class jm extends ef{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Nt(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"key",null!==(i=o[1])&&void 0!==i?i:"value"]}clone(){return new jm(null,Nt(this.transform))}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Ut(this.transform)}`}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class Lm extends ef{constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}clone(){return new Lm(null,Nt(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[[Ne,Ie],[ze,Be]]){const i=r.map((t=>{const n=Ra(e.encoding[t]);return da(n)?n.field:ga(n)?{expr:`${n.datum}`}:xa(n)?{expr:`${n.value}`}:void 0}));(i[0]||i[1])&&(t=new Lm(t,i,null,e.getName("geojson_"+n++)))}if(e.channelHasField(Ze)){const r=e.typedFieldDef(Ze);r.type===vo&&(t=new Lm(t,null,r.field,e.getName("geojson_"+n++)))}return t}dependentFields(){var t;const e=(null!==(t=this.fields)&&void 0!==t?t:[]).filter(Et);return new Set([...this.geojson?[this.geojson]:[],...e])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Ut(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})]}}class Rm extends ef{constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}clone(){return new Rm(null,this.projection,Nt(this.fields),Nt(this.as))}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[[Ne,Ie],[ze,Be]]){const r=n.map((t=>{const n=Ra(e.encoding[t]);return da(n)?n.field:ga(n)?{expr:`${n.datum}`}:xa(n)?{expr:`${n.value}`}:void 0})),i=n[0]===ze?"2":"";(r[0]||r[1])&&(t=new Rm(t,e.projectionName(),r,[e.getName(`x${i}`),e.getName(`y${i}`)]))}return t}dependentFields(){return new Set(this.fields.filter(Et))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Ut(this.fields)} ${Ut(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Im extends ef{constructor(t,e){super(t),this.transform=e}clone(){return new Im(null,Nt(this.transform))}dependentFields(){var t;return new Set([this.transform.impute,this.transform.key,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t;return{signal:`sequence(${[e,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,e){return new Im(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(da(r)&&da(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const s=r.impute?i:i.impute?r:void 0,{method:a,value:u,frame:c,keyvals:l}=o.impute,f=cu(e.mark,n);return new Im(t,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:s.field},a?{method:a}:{}),void 0!==u?{value:u}:{}),c?{frame:c}:{}),void 0!==l?{keyvals:l}:{}),f.length?{groupby:f}:{}))}return null}hash(){return`Impute ${Ut(this.transform)}`}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:o,frame:s=[null,null]}=this.transform,a=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:e},n?{keyvals:(u=n,void 0!==(null===u||void 0===u?void 0:u.stop)?this.processSequence(n):n)}:{}),{method:"value"}),i?{groupby:i}:{}),{value:r&&"value"!==r?null:o});var u;if(r&&"value"!==r){return[a,Object.assign({type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:s,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]}return[a]}}var Nm=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Bm extends ef{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Nt(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.loess]}clone(){return new Bm(null,Nt(this.transform))}dependentFields(){var t;return new Set([this.transform.loess,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Ut(this.transform)}`}assemble(){const t=this.transform,{loess:e,on:n}=t,r=Nm(t,["loess","on"]);return Object.assign({type:"loess",x:n,y:e},r)}}class zm extends ef{constructor(t,e,n){super(t),this.transform=e,this.secondary=n}clone(){return new zm(null,Nt(this.transform),this.secondary)}static make(t,e,n,r){const i=e.component.data.sources,{from:o}=n;let s=null;if(function(t){return"data"in t}(o)){let t=ry(o.data,i);t||(t=new mg(o.data),i.push(t));const n=e.getName(`lookup_${r}`);s=new nf(t,n,Bl.Lookup,e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=s}else if(function(t){return"param"in t}(o)){const t=o.param;let r;n=Object.assign({as:t},n);try{r=e.getSelectionComponent(se(t),t)}catch(a){throw new Error(`Lookups can only be performed on selection parameters. "${t}" is a variable parameter.`)}if(s=r.materialized,!s)throw new Error(function(t){return`Cannot define and lookup the "${t}" selection in the same view. Try moving the lookup into a second, layered view?`}(t))}return new zm(t,n,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?yt(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Ut({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t=Object.assign({values:this.transform.from.fields},this.transform.as?{as:yt(this.transform.as)}:{});else{let e=this.transform.as;Et(e)||(Ri('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),e="_lookup"),t={as:[e]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},t),this.transform.default?{default:this.transform.default}:{})}}var $m=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Um extends ef{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Nt(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:"prob",null!==(i=o[1])&&void 0!==i?i:"value"]}clone(){return new Um(null,Nt(this.transform))}dependentFields(){var t;return new Set([this.transform.quantile,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Ut(this.transform)}`}assemble(){const t=this.transform,{quantile:e}=t,n=$m(t,["quantile"]);return Object.assign({type:"quantile",field:e},n)}}var Vm=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};class Zm extends ef{constructor(t,e){var n,r,i;super(t),this.transform=e,this.transform=Nt(e);const o=null!==(n=this.transform.as)&&void 0!==n?n:[void 0,void 0];this.transform.as=[null!==(r=o[0])&&void 0!==r?r:e.on,null!==(i=o[1])&&void 0!==i?i:e.regression]}clone(){return new Zm(null,Nt(this.transform))}dependentFields(){var t;return new Set([this.transform.regression,this.transform.on,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Ut(this.transform)}`}assemble(){const t=this.transform,{regression:e,on:n}=t,r=Vm(t,["regression","on"]);return Object.assign({type:"regression",x:n,y:e},r)}}class Wm extends ef{constructor(t,e){super(t),this.transform=e}clone(){return new Wm(null,Nt(this.transform))}addDimensions(t){var e;this.transform.groupby=Xt((null!==(e=this.transform.groupby)&&void 0!==e?e:[]).concat(t),(t=>t))}producedFields(){}dependentFields(){var t;return new Set([this.transform.pivot,this.transform.value,...null!==(t=this.transform.groupby)&&void 0!==t?t:[]])}hash(){return`PivotTransform ${Ut(this.transform)}`}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:e},void 0!==r?{limit:r}:{}),void 0!==i?{op:i}:{}),void 0!==n?{groupby:n}:{})}}class qm extends ef{constructor(t,e){super(t),this.transform=e}clone(){return new qm(null,Nt(this.transform))}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Ut(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function Gm(t){let e=0;return function n(r,i){var o;if(r instanceof mg&&!r.isGenerator&&!Dl(r.data)){t.push(i);i={name:null,source:i.name,transform:[]}}if(r instanceof hg&&(r.parent instanceof mg&&!i.source?(i.format=Object.assign(Object.assign({},null!==(o=i.format)&&void 0!==o?o:{}),{parse:r.assembleFormatParse()}),i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof ug)return i.name||(i.name="data_"+e++),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source,void t.push(...r.assemble());if((r instanceof pg||r instanceof gg||r instanceof Dm||r instanceof Vd||r instanceof sp||r instanceof Rm||r instanceof ag||r instanceof zm||r instanceof Ig||r instanceof Lg||r instanceof jm||r instanceof Fm||r instanceof Tm||r instanceof Bm||r instanceof Um||r instanceof Zm||r instanceof dg||r instanceof qm||r instanceof Wm)&&i.transform.push(r.assemble()),(r instanceof og||r instanceof of||r instanceof Im||r instanceof Rg||r instanceof Lm)&&i.transform.push(...r.assemble()),r instanceof nf)if(i.source&&0===i.transform.length)r.setSource(i.source);else if(r.parent instanceof nf)r.setSource(i.name);else if(i.name||(i.name="data_"+e++),r.setSource(i.name),1===r.numChildren()){t.push(i);i={name:null,source:i.name,transform:[]}}switch(r.numChildren()){case 0:r instanceof nf&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+e++);let o=i.name;!i.source||i.transform.length>0?t.push(i):o=i.source;for(const t of r.children){n(t,{name:null,source:o,transform:[]})}break}}}}function Hm(t){return"top"===t||"left"===t||Rr(t)?"header":"footer"}function Xm(t,e){var n;const{facet:r,config:i,child:o,component:s}=t;if(t.channelHasField(e)){const a=r[e],u=cp("title",null,i,e);let c=Ta(a,i,{allowDisabling:!0,includeDefault:void 0===u||!!u});o.component.layoutHeaders[e].title&&(c=ft(c)?c.join(", "):c,c+=` / ${o.component.layoutHeaders[e].title}`,o.component.layoutHeaders[e].title=null);const l=cp("labelOrient",a.header,i,e),f=null!==a.header&&ye(null===(n=a.header)||void 0===n?void 0:n.labels,i.header.labels,!0),h=Zt(["bottom","right"],l)?"footer":"header";s.layoutHeaders[e]={title:null!==a.header?c:null,facetFieldDef:a,[h]:"facet"===e?[]:[Ym(t,e,f)]}}}function Ym(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function Km(t,e){var n;const{child:r}=t;if(r.component.axes[e]){const{layoutHeaders:i,resolve:o}=t.component;if(o.axis[e]=kp(o,e),"shared"===o.axis[e]){const o="x"===e?"column":"row",s=i[o];for(const i of r.component.axes[e]){const e=Hm(i.get("orient"));null!==(n=s[e])&&void 0!==n||(s[e]=[Ym(t,o,!1)]);const r=Xd(i,"main",t.config,{header:!0});r&&s[e][0].axes.push(r),i.mainExtracted=!0}}}}function Jm(t){for(const e of t.children)e.parseLayoutSize()}function Qm(t,e){var n;const r=Cp(e),i=Kn(r),o=t.component.resolve,s=t.component.layoutSize;let a;for(const u of t.children){const e=u.component.layoutSize.getWithExplicit(r),s=null!==(n=o.scale[i])&&void 0!==n?n:Pp(i,t);if("independent"===s&&"step"===e.value){a=void 0;break}if(a){if("independent"===s&&a.value!==e.value){a=void 0;break}a=kl(a,e,r,"")}else a=e}if(a){for(const n of t.children)t.renameSignal(n.getName(r),t.getName(e)),n.component.layoutSize.set(r,"merged",!1);s.setWithExplicit(e,a)}else s.setWithExplicit(e,{explicit:!1,value:void 0})}function ty(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(Uo(t)){const t=sc(r.view,e);return Ir(n)||tc(t)?"step":t}return ic(r.view,e)}if(t.hasProjection||"arc"===t.mark)return ic(r.view,e);{const t=sc(r.view,e);return tc(t)?t.step:t}}function ey(t,e,n){return Sa(e,Object.assign({suffix:`by_${Sa(t)}`},null!==n&&void 0!==n?n:{}))}class ny extends Pm{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=Oy(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!ea(t))return{facet:this.initFacetFieldDef(t,"facet")};const e=ne(t),n={};for(const r of e){if(![Se,Ce].includes(r)){Ri(xi(r,"facet"));break}const e=t[r];if(void 0===e.field){Ri(bi(e,r));break}n[r]=this.initFacetFieldDef(e,r)}return n}initFacetFieldDef(t,e){const n=Ba(t,e);return n.header?n.header=Dr(n.header):null===n.header&&(n.header=null),n}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=iy(this),this.child.parseData()}parseLayoutSize(){Jm(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of pn)Xm(t,e);Km(t,"x"),Km(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){var t,e,n;const r={};for(const i of pn)for(const o of hp){const s=this.component.layoutHeaders[i],a=s[o],{facetFieldDef:u}=s;if(u){const e=cp("titleOrient",u.header,this.config,i);if(["right","bottom"].includes(e)){const n=up(i,e);null!==(t=r.titleAnchor)&&void 0!==t||(r.titleAnchor={}),r.titleAnchor[n]="end"}}if(null===a||void 0===a?void 0:a[0]){const t="row"===i?"height":"width",a="header"===o?"headerBand":"footerBand";"facet"===i||this.child.component.layoutSize.get(t)||(null!==(e=r[a])&&void 0!==e||(r[a]={}),r[a][i]=.5),s.title&&(null!==(n=r.offset)&&void 0!==n||(r.offset={}),r.offset["row"===i?"rowTitle":"columnTitle"]=10)}}return r}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),n?{columns:n}:{}),{bounds:"full",align:r})}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof ny)){return{signal:`length(data('${this.getName("column_domain")}'))`}}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof ny?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:Sa(this.facet.column,{prefix:"distinct"})}}}}:{}),super.assembleGroup(t)):super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof ny){if(this.child.channelHasField("column")){const r=Sa(this.child.facet.column);t.push(r),e.push("distinct"),n.push(`distinct_${r}`)}}else for(const r of Gn){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(Uo(o)&&Ir(s)){const i=em(nm(this.child,r));i?(t.push(i),e.push("distinct"),n.push(`distinct_${i}`)):Ri(ci(r))}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:s}=this.getCardinalityAggregateForChild(),a=[];for(const c of pn){const t=this.facet[c];if(t){a.push(Sa(t));const{bin:e,sort:u}=t;if(Sr(e)&&a.push(Sa(t,{binSuffix:"end"})),Qs(u)){const{field:e,op:a=Xs}=u,c=ey(t,u);n&&r?(i.push(c),o.push("max"),s.push(c)):(i.push(e),o.push(a),s.push(c))}else if(ft(u)){const e=ap(t,c);i.push(e),o.push("max"),s.push(e)}}}const u=!!n&&!!r;return Object.assign({name:t,data:e,groupby:a},u||i.length>0?{aggregate:Object.assign(Object.assign({},u?{cross:u}:{}),i.length?{fields:i,ops:o,as:s}:{})}:{})}facetSortFields(t){const{facet:e}=this,n=e[t];return n?Qs(n.sort)?[ey(n,n.sort,{expr:"datum"})]:ft(n.sort)?[ap(n,t,{expr:"datum"})]:[Sa(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(Qs(t)?t.order:!ft(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){var t;const{facet:e,config:n}=this;if(e.facet)return vp(e.facet,"facet",n);const r={row:["top","bottom"],column:["left","right"]};for(const i of fp)if(e[i]){const o=cp("labelOrient",null===(t=e[i])||void 0===t?void 0:t.header,n,i);if(r[i].includes(o))return vp(e[i],i,n)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=Gm(e);for(const r of t.children)n(r,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},r?{title:r}:{}),i?{style:i}:{}),{from:{facet:this.assembleFacet()},sort:{field:pn.map((t=>this.facetSortFields(t))).flat(),order:pn.map((t=>this.facetSortOrder(t))).flat()}}),e.length>0?{data:e}:{}),n?{encode:{update:n}}:{}),t.assembleGroup(function(t,e){if(t.component.selection&&ne(t.component.selection).length){const n=At(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:ql("mousemove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return tf(e)}(this,[])))]}getMapping(){return this.facet}}function ry(t,e){var n,r,i,o;for(const s of e){const e=s.data;if(t.name&&s.hasName()&&t.name!==s.dataName)continue;const a=null===(n=t.format)||void 0===n?void 0:n.mesh,u=null===(r=e.format)||void 0===r?void 0:r.feature;if(a&&u)continue;const c=null===(i=t.format)||void 0===i?void 0:i.feature;if((c||u)&&c!==u)continue;const l=null===(o=e.format)||void 0===o?void 0:o.mesh;if(!a&&!l||a===l)if(Fl(t)&&Fl(e)){if(It(t.values,e.values))return s}else if(Dl(t)&&Dl(e)){if(t.url===e.url)return s}else if(jl(t)&&t.name===s.dataName)return s}return null}function iy(t){var e,n,r,i,o,s,a,u,c,l;let f=function(t,e){if(t.data||!t.parent){if(null===t.data){const t=new mg({values:[]});return e.push(t),t}const n=ry(t.data,e);if(n)return Ll(t.data)||(n.data.format=Gt({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new mg(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}(t,t.component.data.sources);const{outputNodes:h,outputNodeRefCounts:d}=t.component.data,p=t.data,g=!(p&&(Ll(p)||Dl(p)||Fl(p)))&&t.parent?t.parent.component.data.ancestorParse.clone():new Tl;Ll(p)?(Rl(p)?f=new gg(f,p.sequence):Nl(p)&&(f=new pg(f,p.graticule)),g.parseNothing=!0):null===(null===(e=null===p||void 0===p?void 0:p.format)||void 0===e?void 0:e.parse)&&(g.parseNothing=!0),f=null!==(n=hg.makeExplicit(f,t,g))&&void 0!==n?n:f,f=new dg(f);const m=t.parent&&Cm(t.parent);(Am(t)||Om(t))&&m&&(f=null!==(r=og.makeFromEncoding(f,t))&&void 0!==r?r:f),t.transforms.length>0&&(f=function(t,e,n){var r,i;let o=0;for(const s of e.transforms){let a,u;if(il(s))u=t=new sp(t,s),a="derived";else if(Gc(s)){const i=lg(s);u=t=null!==(r=hg.makeWithAncestors(t,{},i,n))&&void 0!==r?r:t,t=new Vd(t,e,s.filter)}else if(ol(s))u=t=og.makeFromTransform(t,s,e),a="number";else if(al(s))a="date",void 0===n.getWithExplicit(s.field).value&&(t=new hg(t,{[s.field]:a}),n.set(s.field,a,!1)),u=t=of.makeFromTransform(t,s);else if(ul(s))u=t=ag.makeFromTransform(t,s),a="number",dh(e)&&(t=new dg(t));else if(Hc(s))u=t=zm.make(t,e,s,o++),a="derived";else if(el(s))u=t=new Ig(t,s),a="number";else if(nl(s))u=t=new Lg(t,s),a="number";else if(cl(s))u=t=Rg.makeFromTransform(t,s),a="derived";else if(ll(s))u=t=new jm(t,s),a="derived";else if(rl(s))u=t=new Fm(t,s),a="derived";else if(Xc(s))u=t=new Wm(t,s),a="derived";else if(tl(s))t=new qm(t,s);else if(sl(s))u=t=Im.makeFromTransform(t,s),a="derived";else if(Yc(s))u=t=new Tm(t,s),a="derived";else if(Kc(s))u=t=new Um(t,s),a="derived";else if(Jc(s))u=t=new Zm(t,s),a="derived";else{if(!Qc(s)){Ri(`Ignoring an invalid transform: ${$t(s)}.`);continue}u=t=new Bm(t,s),a="derived"}if(u&&void 0!==a)for(const t of null!==(i=u.producedFields())&&void 0!==i?i:[])n.set(t,a,!1)}return t}(f,t,g));const y=function(t){const e={};if(Am(t)&&t.component.selection)for(const n of ne(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&me(t.field)>1&&(e[t.field]="flatten")}return e}(t),v=fg(t);f=null!==(i=hg.makeWithAncestors(f,{},Object.assign(Object.assign({},y),v),g))&&void 0!==i?i:f,Am(t)&&(f=Lm.parseAll(f,t),f=Rm.parseAll(f,t)),(Am(t)||Om(t))&&(m||(f=null!==(o=og.makeFromEncoding(f,t))&&void 0!==o?o:f),f=null!==(s=of.makeFromEncoding(f,t))&&void 0!==s?s:f,f=sp.parseAllForSortIndex(f,t));const b=t.getDataName(Bl.Raw),x=new nf(f,b,Bl.Raw,d);if(h[b]=x,f=x,Am(t)){const e=ag.makeFromEncoding(f,t);e&&(f=e,dh(t)&&(f=new dg(f))),f=null!==(a=Im.makeFromEncoding(f,t))&&void 0!==a?a:f,f=null!==(u=Rg.makeFromEncoding(f,t))&&void 0!==u?u:f}Am(t)&&(f=null!==(c=Dm.make(f,t))&&void 0!==c?c:f);const w=t.getDataName(Bl.Main),_=new nf(f,w,Bl.Main,d);h[w]=_,f=_,Am(t)&&function(t,e){var n;for(const[r,i]of ie(null!==(n=t.component.selection)&&void 0!==n?n:{})){const n=t.getName(`lookup_${r}`);t.component.data.outputNodes[n]=i.materialized=new nf(new Vd(e,t,{param:r}),n,Bl.Lookup,t.component.data.outputNodeRefCounts)}}(t,_);let E=null;if(Om(t)){const e=t.getName("facet");f=null!==(l=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(Qs(i.sort)){const{field:n,op:r=Xs}=i.sort;t=e=new Lg(t,{joinaggregate:[{op:r,field:n,as:ey(i,i.sort,{forAs:!0})}],groupby:[Sa(i)]})}return e}return null}(f,t.facet))&&void 0!==l?l:f,E=new ug(f,t,e,_.getSource()),h[e]=E}return Object.assign(Object.assign({},t.component.data),{outputNodes:h,outputNodeRefCounts:d,raw:x,main:_,facetRoot:E,ancestorParse:g})}class oy extends Mm{constructor(t,e,n,r){var i,o,s,a;super(t,"concat",e,n,r,t.resolve),"shared"!==(null===(o=null===(i=t.resolve)||void 0===i?void 0:i.axis)||void 0===o?void 0:o.x)&&"shared"!==(null===(a=null===(s=t.resolve)||void 0===s?void 0:s.axis)||void 0===a?void 0:a.y)||Ri("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map(((t,e)=>Oy(t,this,this.getName(`concat_${e}`),void 0,r)))}parseData(){this.component.data=iy(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of ne(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return Ju(t)?t.vconcat:Qu(t)?t.hconcat:t.concat}parseLayoutSize(){!function(t){Jm(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";Qm(t,e),Qm(t,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.forEach((t=>t.assembleSignals())),[]}assembleLayoutSignals(){const t=Ep(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleMarks(){return this.children.map((t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:t.getName("group")},e?{title:e}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),t.assembleGroup())}))}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return Object.assign(Object.assign({},null!=t?{columns:t}:{}),{bounds:"full",align:"each"})}}const sy=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},Ya),{labelExpr:1,encode:1}),ay=ne(sy);class uy extends Ol{constructor(t={},e={},n=!1){super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new uy(Nt(this.explicit),Nt(this.implicit),this.mainExtracted)}hasAxisPart(t){return"axis"===t||("grid"===t||"title"===t?!!this.get(t):!(!1===(e=this.get(t))||null===e));var e}hasOrientSignalRef(){return Rr(this.explicit.orient)}}const cy={bottom:"top",top:"bottom",left:"right",right:"left"};function ly(t,e){if(!t)return e.map((t=>t.clone()));{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!==!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(e.explicit&&o.explicit&&e.value!==o.value)return;t[r]=fy(n,i)}}}return t}function fy(t,e){for(const n of ay){const r=kl(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",((t,e)=>{switch(n){case"title":return ri(t,e);case"gridScale":return{explicit:t.explicit,value:ye(t.value,e.value)}}return Pl(t,e,n,"axis")}));t.setWithExplicit(n,r)}return t}function hy(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(Rr(n.labelAngle)?n.labelAngle:Ee(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===op(r,i))return!0}return t===n[e]}const dy=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function py(t,e){var n,r,i;let o=e.axis(t);const s=new uy,a=Ra(e.encoding[t]),{mark:u,config:c}=e,l=(null===o||void 0===o?void 0:o.orient)||(null===(n=c["x"===t?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(r=c.axis)||void 0===r?void 0:r.orient)||function(t){return"x"===t?"bottom":"left"}(t),f=e.getScaleComponent(t).get("type"),h=Jd(t,f,l,e.config),d=void 0!==o?!o:tp("disable",c.style,null===o||void 0===o?void 0:o.style,h).configValue;if(s.set("disable",d,void 0!==o),d)return s;o=o||{};const p=function(t,e,n,r,i){const o=null===e||void 0===e?void 0:e.labelAngle;if(void 0!==o)return Rr(o)?o:Ee(o);{const{configValue:o}=tp("labelAngle",r,null===e||void 0===e?void 0:e.style,i);return void 0!==o?Ee(o):n!==Pe||!Zt([yo,go],t.type)||da(t)&&t.timeUnit?void 0:270}}(a,o,t,c.style,h),g={fieldOrDatumDef:a,axis:o,channel:t,model:e,scaleType:f,orient:l,labelAngle:p,mark:u,config:c};for(const v of ay){const n=v in ep?ep[v](g):Ja(v)?o[v]:void 0,r=void 0!==n,i=hy(n,v,o,e,t);if(r&&i)s.set(v,n,i);else{const{configValue:t,configFrom:e}=Ja(v)&&"values"!==v?tp(v,c.style,o.style,h):{},a=void 0!==t;r&&!a?s.set(v,n,i):("vgAxisConfig"!==e||dy.has(v)&&a||Ga(t)||Rr(t))&&s.set(v,t,!1)}}const m=null!==(i=o.encoding)&&void 0!==i?i:{},y=Ha.reduce(((n,r)=>{var i;if(!s.hasAxisPart(r))return n;const o=Mp(null!==(i=m[r])&&void 0!==i?i:{},e),a="labels"===r?function(t,e,n){var r;const{encoding:i,config:o}=t,s=null!==(r=Ra(i[e]))&&void 0!==r?r:Ra(i[kn(e)]),a=t.axis(e)||{},{format:u,formatType:c}=a;return Ns(c)?Object.assign({text:Us({fieldOrDatumDef:s,field:"datum.value",format:u,formatType:c,config:o})},n):n}(e,t,o):o;return void 0===a||ee(a)||(n[r]={update:a}),n}),{});return ee(y)||s.set("encode",y,!!o.encoding||void 0!==o.labelAngle),s}function gy(t,e,n){const r=Dr(t),i=Yr("orient",r,n);if(r.orient=function(t,e,n){switch(t){case ls:case ms:case ys:case ds:case fs:case us:return}const{x:r,y:i,x2:o,y2:s}=e;switch(t){case as:if(da(r)&&(Cr(r.bin)||da(i)&&i.aggregate&&!r.aggregate))return"vertical";if(da(i)&&(Cr(i.bin)||da(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o&&(da(r)&&r.type===po&&!Sr(r.bin)||ya(r)))return"horizontal";if(!s&&(da(i)&&i.type===po&&!Sr(i.bin)||ya(i)))return"vertical"}case hs:if(o&&(!da(r)||!Cr(r.bin))&&s&&(!da(i)||!Cr(i.bin)))return;case ss:if(s)return da(i)&&Cr(i.bin)?"horizontal":"vertical";if(o)return da(r)&&Cr(r.bin)?"vertical":"horizontal";if(t===hs){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case cs:case ps:{const e=ma(r),o=ma(i);if(n)return n;if(e&&!o)return"tick"!==t?"horizontal":"vertical";if(!e&&o)return"tick"!==t?"vertical":"horizontal";if(e&&o){const e=r,n=i,o=e.type===mo,s=n.type===mo;return o&&!s?"tick"!==t?"vertical":"horizontal":!o&&s?"tick"!==t?"horizontal":"vertical":!e.aggregate&&n.aggregate?"tick"!==t?"vertical":"horizontal":e.aggregate&&!n.aggregate&&"tick"!==t?"horizontal":"vertical"}return}}return"vertical"}(r.type,e,i),void 0!==i&&i!==r.orient&&Ri(`Specified orient "${r.orient}" overridden with "${i}".`),"bar"===r.type&&r.orient){const t=Yr("cornerRadiusEnd",r,n);if(void 0!==t){const n="horizontal"===r.orient&&e.x2||"vertical"===r.orient&&e.y2?["cornerRadius"]:Cs[r.orient];for(const e of n)r[e]=t;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}void 0===Yr("opacity",r,n)&&(r.opacity=function(t,e){if(Zt([ls,ps,ms,ys],t)&&!iu(e))return.7;return}(r.type,e));return void 0===Yr("cursor",r,n)&&(r.cursor=function(t,e,n){if(e.href||t.href||Yr("href",t,n))return"pointer";return t.cursor}(r,e,n)),r}function my(t,e){const{config:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Pf("x",t,{defaultPos:"mid"})),Pf("y",t,{defaultPos:"mid"})),Sf("size",t)),Sf("angle",t)),function(t,e,n){if(n)return{shape:{value:n}};return Sf("shape",t)}(t,0,e))}function yy(t){var e;const{config:n,markDef:r}=t,{orient:i}=r,o="horizontal"===i?"width":"height",s=t.getScaleComponent("horizontal"===i?"x":"y"),a=null!==(e=Yr("size",r,n,{vgChannel:o}))&&void 0!==e?e:n.tick.bandSize;if(void 0!==a)return a;{const t=s?s.get("range"):void 0;if(t&&Ir(t)&&_t(t.step))return 3*t.step/4;return 3*oc(n.view,o)/4}}const vy={arc:{vgMark:"arc",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Pf("x",t,{defaultPos:"mid"})),Pf("y",t,{defaultPos:"mid"})),If(t,"radius","arc")),If(t,"theta","arc"))},area:{vgMark:"area",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),jf("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient})),jf("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient})),Zf(t))},bar:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),If(t,"x","bar")),If(t,"y","bar"))},circle:{vgMark:"symbol",encodeEntry:t=>my(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[Object.assign({type:"geoshape",projection:t.projectionName()},n&&da(n)&&n.type===vo?{field:Sa(n,{expr:"datum"})}:{})]}},image:{vgMark:"image",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),If(t,"x","image")),If(t,"y","image")),xf(t,"url"))},line:{vgMark:"line",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),Pf("x",t,{defaultPos:"mid"})),Pf("y",t,{defaultPos:"mid"})),Sf("size",t,{vgChannel:"strokeWidth"})),Zf(t))},point:{vgMark:"symbol",encodeEntry:t=>my(t)},rect:{vgMark:"rect",encodeEntry:t=>Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),If(t,"x","rect")),If(t,"y","rect"))},rule:{vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),jf("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n})),jf("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n})),Sf("size",t,{vgChannel:"strokeWidth"})):{}}},square:{vgMark:"symbol",encodeEntry:t=>my(t,"square")},text:{vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),Pf("x",t,{defaultPos:"mid"})),Pf("y",t,{defaultPos:"mid"})),xf(t)),Sf("size",t,{vgChannel:"fontSize"})),Sf("angle",t)),Wf("align",function(t,e,n){if(void 0===Yr("align",t,n))return"center";return}(t.markDef,0,e))),Wf("baseline",function(t,e,n){if(void 0===Yr("baseline",t,n))return"middle";return}(t.markDef,0,e))),Pf("radius",t,{defaultPos:null})),Pf("theta",t,{defaultPos:null}))}},tick:{vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),Pf("x",t,{defaultPos:"mid",vgChannel:"xc"})),Pf("y",t,{defaultPos:"mid",vgChannel:"yc"})),Sf("size",t,{defaultValue:yy(t),vgChannel:i})),{[o]:qr(Yr("thickness",n,e))})}},trail:{vgMark:"trail",encodeEntry:t=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Uf(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),Pf("x",t,{defaultPos:"mid"})),Pf("y",t,{defaultPos:"mid"})),Sf("size",t)),Zf(t))}};function by(t){if(Zt([cs,ss,gs],t.mark)){const e=cu(t.mark,t.encoding);if(e.length>0)return function(t,e){return[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:xy+t.requestDataName(Bl.Main),data:t.requestDataName(Bl.Main),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:_y(t,{fromPrefix:xy})}]}(t,e)}else if(t.mark===as){const e=$r.some((e=>Yr(e,t.markDef,t.config)));if(t.stack&&!t.fieldDef("size")&&e)return function(t){const[e]=_y(t,{fromPrefix:wy}),n=t.scaleName(t.stack.fieldChannel),r=(e={})=>t.vgField(t.stack.fieldChannel,e),i=(t,e)=>`${t}(${[r({prefix:"min",suffix:"start",expr:e}),r({prefix:"max",suffix:"start",expr:e}),r({prefix:"min",suffix:"end",expr:e}),r({prefix:"max",suffix:"end",expr:e})].map((t=>`scale('${n}',${t})`)).join(",")})`;let o,s;"x"===t.stack.fieldChannel?(o=Object.assign(Object.assign({},Bt(e.encode.update,["y","yc","y2","height",...$r])),{x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}}),s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},e.encode.update=Object.assign(Object.assign({},zt(e.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(o=Object.assign(Object.assign({},Bt(e.encode.update,["x","xc","x2","width"])),{y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}}),s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},e.encode.update=Object.assign(Object.assign({},zt(e.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));for(const u of $r){const n=Kr(u,t.markDef,t.config);e.encode.update[u]?(o[u]=e.encode.update[u],delete e.encode.update[u]):n&&(o[u]=qr(n)),n&&(e.encode.update[u]={value:0})}const a=[];if(t.stack.groupbyChannel){const e=t.fieldDef(t.stack.groupbyChannel),n=Sa(e);n&&a.push(n),((null===e||void 0===e?void 0:e.bin)||(null===e||void 0===e?void 0:e.timeUnit))&&a.push(Sa(e,{binSuffix:"end"}))}o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(e.encode.update[r])return Object.assign(Object.assign({},n),{[r]:e.encode.update[r]});{const e=Kr(r,t.markDef,t.config);return void 0!==e?Object.assign(Object.assign({},n),{[r]:qr(e)}):n}}),o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0});return[{type:"group",from:{facet:{data:t.requestDataName(Bl.Main),name:wy+t.requestDataName(Bl.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[e]}]}]}(t)}return _y(t)}const xy="faceted_path_";const wy="stack_group_";function _y(t,e={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=t,s=ye(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!!(e&&e.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),a=Xr(r),u=i.key,c=function(t){var e;const{encoding:n,stack:r,mark:i,markDef:o,config:s}=t,a=n.order;if(!(!ft(a)&&xa(a)&&Vt(a.value)||!a&&Vt(Yr("order",o,s)))){if((ft(a)||da(a))&&!r)return ti(a,{expr:"datum"});if(bs(i)){const r="horizontal"===o.orient?"y":"x",i=n[r];if(da(i)){const n=i.sort;return ft(n)?{field:Sa(i,{prefix:r,suffix:"sort_index",expr:"datum"})}:Qs(n)?{field:Sa({aggregate:iu(t.encoding)?n.op:void 0,field:n.field},{expr:"datum"})}:Js(n)?{field:Sa(t.fieldDef(n.encoding),{expr:"datum"}),order:n.order}:null===n?void 0:{field:Sa(i,{binSuffix:(null===(e=t.stack)||void 0===e?void 0:e.impute)?"mid":void 0,expr:"datum"})}}}}}(t),l=function(t){if(!t.component.selection)return null;const e=ne(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=ne(r.component.selection).length,r=r.parent;return n?{interactive:e>0||!!t.encoding.tooltip}:null}(t),f=Yr("aria",r,o),h=vy[n].postEncodingTransform?vy[n].postEncodingTransform(t):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:t.getName("marks"),type:vy[n].vgMark},s?{clip:!0}:{}),a?{style:a}:{}),u?{key:u.field}:{}),c?{sort:c}:{}),l||{}),!1===f?{aria:f}:{}),{from:{data:e.fromPrefix+t.requestDataName(Bl.Main)},encode:{update:vy[n].encodeEntry(t)}}),h?{transform:h}:{})]}class Ey extends Pm{constructor(t,e,n,r={},i){var o;super(t,"unit",e,n,i,void 0,ec(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const s=_s(t.mark)?Object.assign({},t.mark):{type:t.mark},a=s.type;void 0===s.filled&&(s.filled=function(t,e,{graticule:n}){if(n)return!1;const r=Kr("filled",t,e),i=t.type;return ye(r,i!==ls&&i!==cs&&i!==hs)}(s,i,{graticule:t.data&&Nl(t.data)}));const u=this.encoding=su(t.encoding||{},a,s.filled,i);this.markDef=gy(s,u,i),this.size=function({encoding:t,size:e}){for(const n of Gn){const r=Tn(n);tc(e[r])&&ma(t[n])&&(delete e[r],Ri(Mi(r)))}return e}({encoding:u,size:ec(t)?Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{}):r}),this.stack=Mc(a,u),this.specifiedScales=this.initScales(a,u),this.specifiedAxes=this.initAxes(u),this.specifiedLegends=this.initLegends(u),this.specifiedProjection=t.projection,this.selection=(null!==(o=t.params)&&void 0!==o?o:[]).filter((t=>Hu(t)))}get hasProjection(){const{encoding:t}=this,e=this.mark===vs,n=t&&ln.some((e=>va(t[e])));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return cr.reduce(((t,n)=>{var r;const i=Ra(e[n]);return i&&(t[n]=this.initScale(null!==(r=i.scale)&&void 0!==r?r:{})),t}),{})}initScale(t){const{domain:e,range:n}=t,r=Dr(t);return ft(e)&&(r.domain=e.map(Zr)),ft(n)&&(r.range=n.map(Zr)),r}initAxes(t){return Gn.reduce(((e,n)=>{const r=t[n];if(va(r)||n===Pe&&va(t.x2)||n===ke&&va(t.y2)){const t=va(r)?r.axis:void 0;e[n]=t?this.initAxis(Object.assign({},t)):t}return e}),{})}initAxis(t){const e=ne(t),n={};for(const r of e){const e=t[r];n[r]=Ga(e)?Vr(e):Zr(e)}return n}initLegends(t){return ar.reduce(((e,n)=>{const r=Ra(t[n]);if(r&&function(t){switch(t){case $e:case Ue:case Ve:case We:case Ze:case Ge:case Ye:case Ke:return!0;case He:case Xe:case qe:return!1}}(n)){const t=r.legend;e[n]=t?Dr(t):t}return e}),{})}parseData(){this.component.data=iy(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of Gn){const i=Tn(r);if(e[i]){const t=e[i];n.layoutSize.set(i,tc(t)?"step":t,!0)}else{const e=ty(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){var n;const r={},i=t.config.selection;if(!e||!e.length)return r;for(const o of e){const e=se(o.name),s=o.select,a=Et(s)?s:s.type,u=ht(s)?Nt(s):{type:a},c=i[a];for(const t in c)"fields"!==t&&"encodings"!==t&&("mark"===t&&(u[t]=Object.assign(Object.assign({},c[t]),u[t])),void 0!==u[t]&&!0!==u[t]||(u[t]=null!==(n=c[t])&&void 0!==n?n:u[t]));const l=r[e]=Object.assign(Object.assign({},u),{name:e,type:a,init:o.value,bind:o.bind,events:Et(u.on)?ql(u.on,"scope"):yt(Nt(u.on))});for(const n of fh)n.defined(l)&&n.parse&&n.parse(t,l,o)}return r}(this,this.selection)}parseMarkGroup(){this.component.mark=by(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,Gn.reduce(((e,n)=>(t.component.scales[n]&&(e[n]=[py(n,t)]),e)),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){var n;let r=!1;for(const i of re(null!==(n=t.component.selection)&&void 0!==n?n:{})){const n=i.name,o=At(n+ah);if(0===e.filter((t=>t.name===n)).length){const t="global"===i.resolve?"union":i.resolve,n="point"===i.type?", true, true)":")";e.push({name:i.name,update:`${lh}(${o}, ${At(t)}${n}`})}r=!0;for(const r of fh)r.defined(i)&&r.topLevelSignals&&(e=r.topLevelSignals(t,i,e))}r&&0===e.filter((t=>"unit"===t.name)).length&&e.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]});return tf(e)}(this,t)}assembleSignals(){return[...Yd(this),...Jl(this,[])]}assembleSelectionData(t){return function(t,e){var n;const r=[...e];for(const i of re(null!==(n=t.component.selection)&&void 0!==n?n:{})){const e={name:i.name+ah};if(i.init){const n=i.project.items.map((t=>{const{signals:e}=t;return Yl(t,["signals"])}));e.values=i.init.map((e=>({unit:hh(t,{escape:!1}),fields:n,values:Kl(e,!1)})))}r.filter((t=>t.name===i.name+ah)).length||r.push(e)}return r}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return Ep(this)}assembleMarks(){var t;let e=null!==(t=this.component.mark)&&void 0!==t?t:[];return this.parent&&Cm(this.parent)||(e=Ql(this,e)),e.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":void 0}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return ru(this.encoding,t)}fieldDef(t){return La(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return ba(e)?e:null}}class Ay extends Mm{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const o=Object.assign(Object.assign(Object.assign({},r),t.width?{width:t.width}:{}),t.height?{height:t.height}:{});this.children=t.layer.map(((t,e)=>{if(xc(t))return new Ay(t,this,this.getName(`layer_${e}`),o,i);if(tu(t))return new Ey(t,this,this.getName(`layer_${e}`),o,i);throw new Error(ii(t))}))}parseData(){this.component.data=iy(this);for(const t of this.children)t.parseData()}parseLayoutSize(){var t;Jm(t=this),Qm(t,"width"),Qm(t,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of ne(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){var e;const{axes:n,resolve:r}=t.component,i={top:0,bottom:0,right:0,left:0};for(const o of t.children){o.parseAxesAndHeaders();for(const e of ne(o.component.axes))r.axis[e]=kp(t.component.resolve,e),"shared"===r.axis[e]&&(n[e]=ly(n[e],o.component.axes[e]),n[e]||(r.axis[e]="independent",delete n[e]))}for(const o of Gn){for(const s of t.children)if(s.component.axes[o]){if("independent"===r.axis[o]){n[o]=(null!==(e=n[o])&&void 0!==e?e:[]).concat(s.component.axes[o]);for(const t of s.component.axes[o]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!Rr(e)){if(i[e]>0&&!n){const n=cy[e];i[e]>i[n]&&t.set("orient",n,!1)}i[e]++}}}delete s.component.axes[o]}if("independent"===r.axis[o]&&n[o]&&n[o].length>1)for(const t of n[o])t.get("grid")&&!t.explicit.grid&&(t.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleSignals())),Yd(this))}assembleLayoutSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleLayoutSignals())),Ep(this))}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleGroupStyle(){const t=new Set;for(const n of this.children)for(const e of yt(n.assembleGroupStyle()))t.add(e);const e=Array.from(t);return e.length>1?e:1===e.length?e[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)Am(n)&&(e=Ql(n,e));return e}(this,this.children.flatMap((t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce(((t,e)=>t.concat(e.assembleLegends())),Xp(this))}}function Oy(t,e,n,r,i){if(ra(t))return new ny(t,e,n,i);if(xc(t))return new Ay(t,e,n,r,i);if(tu(t))return new Ey(t,e,n,r,i);if(function(t){return Ju(t)||Qu(t)||Ku(t)}(t))return new oy(t,e,n,i);throw new Error(ii(t))}var Sy=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n};function Cy(t,e={}){var n;e.logger&&(n=e.logger,ji=n),e.fieldTitle&&ka(e.fieldTitle);try{const n=pc(pt(e.config,t.config)),r=vl(t,n),i=Oy(r,null,"",void 0,n);i.parse(),function(t,e){$g(t.sources);let n=0,r=0;for(let i=0;i<5&&Vg(t,e,!0);i++)n++;t.sources.map(Ng);for(let i=0;i<5&&Vg(t,e,!1);i++)r++;$g(t.sources),5===Math.max(n,r)&&Ri("Maximum optimization runs(5) reached.")}(i.component.data,i);return{spec:function(t,e,n={},r){const i=t.config?vc(t.config):void 0,o=[].concat(t.assembleSelectionData([]),function(t,e){var n,r;const i=[],o=Gm(i);let s=0;for(const u of t.sources){u.hasName()||(u.dataName="source_"+s++);const t=u.assemble();o(u,t)}for(const u of i)0===u.transform.length&&delete u.transform;let a=0;for(const[u,c]of i.entries())0!==(null!==(n=c.transform)&&void 0!==n?n:[]).length||c.source||i.splice(a++,0,i.splice(u,1)[0]);for(const u of i)for(const e of null!==(r=u.transform)&&void 0!==r?r:[])"lookup"===e.type&&(e.from=t.outputNodes[e.from].getSource());for(const u of i)u.name in e&&(u.values=e[u.name]);return i}(t.component.data,n)),s=t.assembleProjections(),a=t.assembleTitle(),u=t.assembleGroupStyle(),c=t.assembleGroupEncodeEntry(!0);let l=t.assembleLayoutSignals();l=l.filter((t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)));const{params:f}=e,h=Sy(e,["params"]);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},t.description?{description:t.description}:{}),h),a?{title:a}:{}),u?{style:u}:{}),c?{encode:{update:c}}:{}),{data:o}),s.length>0?{projections:s}:{}),t.assembleGroup([...l,...t.assembleSelectionTopLevelSignals([]),...Yu(f)])),i?{config:i}:{}),r?{usermeta:r}:{})}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):Et(e)&&(e={type:e});if(i&&o&&(s=e.type,"fit"===s||"fit-x"===s||"fit-y"===s))if("step"===i&&"step"===o)Ri(ui()),e.type="pad";else if("step"===i||"step"===o){const t="step"===i?"width":"height";Ri(ui(Kn(t)));const n="width"===t?"height":"width";e.type=function(t){return t?`fit-${Kn(t)}`:"fit"}(n)}var s;return Object.assign(Object.assign(Object.assign({},1===ne(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e}),Al(n,!1)),Al(t,!0))}(t,r.autosize,n,i),t.datasets,t.usermeta),normalized:r}}finally{e.logger&&Li(),e.fieldTitle&&ka(Ma)}}const My="5.1.1";var Py=function(t){const[e,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e,version:n}};const ky="#fff",Ty={background:"#333",title:{color:ky,subtitleColor:ky},style:{"guide-label":{fill:ky},"guide-title":{fill:ky}},axis:{domainColor:ky,gridColor:"#888",tickColor:ky}},Dy="#4572a7",Fy={background:"#fff",arc:{fill:Dy},area:{fill:Dy},line:{stroke:Dy,strokeWidth:2},path:{stroke:Dy},rect:{fill:Dy},shape:{stroke:Dy},symbol:{fill:Dy,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},jy="#30a2da",Ly="#cbcbcb",Ry="#f0f0f0",Iy="#333",Ny={arc:{fill:jy},area:{fill:jy},axis:{domainColor:Ly,grid:!0,gridColor:Ly,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:Ly,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Ry,group:{fill:Ry},legend:{labelColor:Iy,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Iy,titleFontSize:14,titlePadding:10},line:{stroke:jy,strokeWidth:2},path:{stroke:jy,strokeWidth:.5},rect:{fill:jy},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:jy},bar:{binSpacing:2,fill:jy,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},By="#000",zy={group:{fill:"#e5e5e5"},arc:{fill:By},area:{fill:By},line:{stroke:By},path:{stroke:By},rect:{fill:By},shape:{stroke:By},symbol:{fill:By,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},$y="Benton Gothic, sans-serif",Uy="#82c6df",Vy="Benton Gothic Bold, sans-serif",Zy="normal",Wy={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},qy={background:"#ffffff",title:{anchor:"start",color:"#000000",font:Vy,fontSize:22,fontWeight:"normal"},arc:{fill:Uy},area:{fill:Uy},line:{stroke:Uy,strokeWidth:2},path:{stroke:Uy},rect:{fill:Uy},shape:{stroke:Uy},symbol:{fill:Uy,size:30},axis:{labelFont:$y,labelFontSize:11.5,labelFontWeight:"normal",titleFont:Vy,titleFontSize:13,titleFontWeight:Zy},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:$y,labelFontSize:11.5,symbolType:"square",titleFont:Vy,titleFontSize:13,titleFontWeight:Zy},range:{category:Wy["category-6"],diverging:Wy["fireandice-6"],heatmap:Wy["fire-7"],ordinal:Wy["fire-7"],ramp:Wy["fire-7"]}},Gy="#ab5787",Hy="#979797",Xy={background:"#f9f9f9",arc:{fill:Gy},area:{fill:Gy},line:{stroke:Gy},path:{stroke:Gy},rect:{fill:Gy},shape:{stroke:Gy},symbol:{fill:Gy,size:30},axis:{domainColor:Hy,domainWidth:.5,gridWidth:.2,labelColor:Hy,tickColor:Hy,tickWidth:.2,titleColor:Hy},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},Yy="#3e5c69",Ky={background:"#fff",arc:{fill:Yy},area:{fill:Yy},line:{stroke:Yy},path:{stroke:Yy},rect:{fill:Yy},shape:{stroke:Yy},symbol:{fill:Yy},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},Jy="#1696d2",Qy="#000000",tv="Lato",ev="Lato",nv={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},rv={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:tv},axisX:{domain:!0,domainColor:Qy,domainWidth:1,grid:!1,labelFontSize:12,labelFont:ev,labelAngle:0,tickColor:Qy,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:tv},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:ev,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:tv,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:ev,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:tv,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:nv["six-groups-cat-1"],diverging:nv["diverging-colors"],heatmap:nv["diverging-colors"],ordinal:nv["six-groups-seq"],ramp:nv["shades-blue"]},area:{fill:Jy},rect:{fill:Jy},line:{color:Jy,stroke:Jy,strokeWidth:5},trail:{color:Jy,stroke:Jy,strokeWidth:0,size:1},path:{stroke:Jy,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:Jy,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:Jy,stroke:null}},arc:{fill:Jy},shape:{stroke:Jy},symbol:{fill:Jy,size:30}},iv="#3366CC",ov="#ccc",sv="Arial, sans-serif",av={arc:{fill:iv},area:{fill:iv},path:{stroke:iv},rect:{fill:iv},shape:{stroke:iv},symbol:{stroke:iv},circle:{fill:iv},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:sv,fontSize:12},"guide-title":{font:sv,fontSize:12},"group-title":{font:sv,fontSize:12}},title:{font:sv,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:ov,tickColor:ov,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},uv="2.10.0";var cv=n(8823);function lv(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!==typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}var fv="#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n";const hv="vg-tooltip-element",dv={offsetX:10,offsetY:10,id:hv,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function(t,e,n){if((0,cv.kJ)(t))return`[${t.map((t=>e((0,cv.HD)(t)?t:lv(t,n)))).join(", ")}]`;if((0,cv.Kn)(t)){let r="";const i=t,{title:o,image:s}=i,a=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}(i,["title","image"]);o&&(r+=`<h2>${e(o)}</h2>`),s&&(r+=`<img src="${e(s)}">`);const u=Object.keys(a);if(u.length>0){r+="<table>";for(const t of u){let i=a[t];void 0!==i&&((0,cv.Kn)(i)&&(i=lv(i,n)),r+=`<tr><td class="key">${e(t)}:</td><td class="value">${e(i)}</td></tr>`)}r+="</table>"}return r||"{}"}return e(t)}};class pv{constructor(t){this.options=Object.assign(Object.assign({},dv),t);const e=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return fv.toString().replace(hv,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}}tooltipHandler(t,e,n,r){var i;this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el));if((null!==(i=document.fullscreenElement)&&void 0!==i?i:document.body).appendChild(this.el),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:o,y:s}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let o=t.clientY+r;return o+e.height>window.innerHeight&&(o=+t.clientY-r-e.height),{x:i,y:o}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.setAttribute("style",`top: ${s}px; left: ${o}px`)}}function gv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mv(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(r,i)}function yv(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){mv(o,r,i,s,a,"next",t)}function a(t){mv(o,r,i,s,a,"throw",t)}s(void 0)}))}}var vv,bv=Object.prototype,xv=bv.hasOwnProperty,wv="function"===typeof Symbol?Symbol:{},_v=wv.iterator||"@@iterator",Ev=wv.asyncIterator||"@@asyncIterator",Av=wv.toStringTag||"@@toStringTag";function Ov(t,e,n,r){var i=e&&e.prototype instanceof Dv?e:Dv,o=Object.create(i.prototype),s=new Wv(r||[]);return o._invoke=function(t,e,n){var r=Cv;return function(i,o){if(r===Pv)throw new Error("Generator is already running");if(r===kv){if("throw"===i)throw o;return Gv()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=Uv(s,n);if(a){if(a===Tv)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===Cv)throw r=kv,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=Pv;var u=Sv(t,e,n);if("normal"===u.type){if(r=n.done?kv:Mv,u.arg===Tv)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=kv,n.method="throw",n.arg=u.arg)}}}(t,n,s),o}function Sv(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}var Cv="suspendedStart",Mv="suspendedYield",Pv="executing",kv="completed",Tv={};function Dv(){}function Fv(){}function jv(){}var Lv={};Lv[_v]=function(){return this};var Rv=Object.getPrototypeOf,Iv=Rv&&Rv(Rv(qv([])));Iv&&Iv!==bv&&xv.call(Iv,_v)&&(Lv=Iv);var Nv=jv.prototype=Dv.prototype=Object.create(Lv);function Bv(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function zv(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===Fv||"GeneratorFunction"===(e.displayName||e.name))}function $v(t,e){function n(r,i,o,s){var a=Sv(t[r],t,i);if("throw"!==a.type){var u=a.arg,c=u.value;return c&&"object"===typeof c&&xv.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(a.arg)}var r;this._invoke=function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}}function Uv(t,e){var n=t.iterator[e.method];if(n===vv){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=vv,Uv(t,e),"throw"===e.method))return Tv;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return Tv}var r=Sv(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,Tv;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=vv),e.delegate=null,Tv):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,Tv)}function Vv(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function Zv(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Wv(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(Vv,this),this.reset(!0)}function qv(t){if(t){var e=t[_v];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(xv.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=vv,e.done=!0,e};return r.next=r}}return{next:Gv}}function Gv(){return{value:vv,done:!0}}Fv.prototype=Nv.constructor=jv,jv.constructor=Fv,jv[Av]=Fv.displayName="GeneratorFunction",Bv($v.prototype),$v.prototype[Ev]=function(){return this},Bv(Nv),Nv[Av]="Generator",Nv[_v]=function(){return this},Nv.toString=function(){return"[object Generator]"},Wv.prototype={constructor:Wv,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=vv,this.done=!1,this.delegate=null,this.method="next",this.arg=vv,this.tryEntries.forEach(Zv),!t)for(var e in this)"t"===e.charAt(0)&&xv.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=vv)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return o.type="throw",o.arg=t,e.next=n,r&&(e.method="next",e.arg=vv),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=xv.call(i,"catchLoc"),a=xv.call(i,"finallyLoc");if(s&&a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&xv.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,Tv):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),Tv},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),Zv(n),Tv}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;Zv(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:qv(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=vv),Tv}};var Hv={wrap:Ov,isGeneratorFunction:zv,AsyncIterator:$v,mark:function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,jv):(t.__proto__=jv,Av in t||(t[Av]="GeneratorFunction")),t.prototype=Object.create(Nv),t},awrap:function(t){return{__await:t}},async:function(t,e,n,r,i){void 0===i&&(i=Promise);var o=new $v(Ov(t,e,n,r),i);return zv(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},keys:function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},values:qv};function Xv(t,e,n){var r=t.open(e),i=new URL(e).origin,o=40;t.addEventListener("message",(function e(n){n.source===r&&(o=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){o<=0||(r.postMessage(n,i),setTimeout(t,250),o-=1)}),250)}var Yv,Kv='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper.fit-x {\n    width: 100%; }\n  .vega-embed .chart-wrapper.fit-y {\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function Jv(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var s=o[i];Qv(t,s)}return t}function Qv(t,e){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];(0,W.writeConfig)(t,i,e[i],!0)}}function tb(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function eb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?tb(Object(n),!0).forEach((function(e){gv(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tb(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t});var nb=W,rb=o,ib="undefined"!==typeof window?window:void 0;void 0===rb&&null!==ib&&void 0!==ib&&null!==(Yv=ib.vl)&&void 0!==Yv&&Yv.compile&&(rb=ib.vl);var ob={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},sb={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},ab={vega:"Vega","vega-lite":"Vega-Lite"},ub={vega:nb.version,"vega-lite":rb?rb.version:"not available"},cb={vega:t=>t,"vega-lite":(t,e)=>rb.compile(t,{config:e}).spec},lb='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',fb="chart-wrapper";function hb(t){return"function"===typeof t}function db(t,e,n,r){var i="<html><head>".concat(e,'</head><body><pre><code class="json">'),o="</code></pre>".concat(n,"</body></html>"),s=window.open("");s.document.write(i+t+o),s.document.title="".concat(ab[r]," JSON Source")}function pb(t,e){if(t.$schema){var n,r=Py(t.$schema);if(e&&e!==r.library)console.warn("The given visualization spec is written in ".concat(ab[r.library],", but mode argument sets ").concat(null!==(n=ab[e])&&void 0!==n?n:e,"."));var i=r.library;return(0,Z.satisfies)(ub[i],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(ab[i]," ").concat(r.version,", but the current version of ").concat(ab[i]," is v").concat(ub[i],".")),i}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":null!==e&&void 0!==e?e:"vega"}function gb(t){return(e=t)&&"load"in e?t:nb.loader(t);var e}function mb(t){var e;return null!==(e=t.usermeta&&t.usermeta.embedOptions)&&void 0!==e?e:{}}function yb(){return(yb=yv(Hv.mark((function t(e,n){var r,i,o,s,a,u,c,l,f,h,d=arguments;return Hv.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=d.length>2&&void 0!==d[2]?d[2]:{},!(0,W.isString)(n)){t.next=10;break}return a=gb(o.loader),t.t0=JSON,t.next=6,a.load(n);case 6:t.t1=t.sent,s=t.t0.parse.call(t.t0,t.t1),t.next=11;break;case 10:s=n;case 11:return u=mb(s).loader,a&&!u||(a=gb(null!==(c=o.loader)&&void 0!==c?c:u)),t.next=15,vb(mb(s),a);case 15:return l=t.sent,t.next=18,vb(o,a);case 18:return f=t.sent,h=eb(eb({},Jv(f,l)),{},{config:(0,W.mergeConfig)(null!==(r=f.config)&&void 0!==r?r:{},null!==(i=l.config)&&void 0!==i?i:{})}),t.next=22,wb(e,s,h,a);case 22:return t.abrupt("return",t.sent);case 23:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function vb(t,e){return bb.apply(this,arguments)}function bb(){return(bb=yv(Hv.mark((function t(e,n){var r,i,o;return Hv.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,W.isString)(e.config)){t.next=8;break}return t.t1=JSON,t.next=4,n.load(e.config);case 4:t.t2=t.sent,t.t0=t.t1.parse.call(t.t1,t.t2),t.next=9;break;case 8:t.t0=null!==(r=e.config)&&void 0!==r?r:{};case 9:if(i=t.t0,!(0,W.isString)(e.patch)){t.next=18;break}return t.t4=JSON,t.next=14,n.load(e.patch);case 14:t.t5=t.sent,t.t3=t.t4.parse.call(t.t4,t.t5),t.next=19;break;case 18:t.t3=e.patch;case 19:return o=t.t3,t.abrupt("return",eb(eb(eb({},e),o?{patch:o}:{}),i?{config:i}:{}));case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function xb(t){var e,n=t.getRootNode?t.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(e=document.head)&&void 0!==e?e:document.body}}function wb(t,e){return _b.apply(this,arguments)}function _b(){return(_b=yv(Hv.mark((function t(e,n){var r,i,o,a,u,c,l,f,h,d,p,g,m,y,v,b,x,w,_,E,A,O,S,C,M,k,T,D,F,j,L,R,I,N,B,z,$,U,q,G,H,X,Y,K,J,Q,tt,nt,rt,it=arguments;return Hv.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(rt=function(){z&&document.removeEventListener("click",z),j.finalize()},f=it.length>2&&void 0!==it[2]?it[2]:{},h=it.length>3?it[3]:void 0,d=f.theme?(0,W.mergeConfig)(s[f.theme],null!==(r=f.config)&&void 0!==r?r:{}):f.config,p=(0,W.isBoolean)(f.actions)?f.actions:Jv({},ob,null!==(i=f.actions)&&void 0!==i?i:{}),g=eb(eb({},sb),f.i18n),m=null!==(o=f.renderer)&&void 0!==o?o:"canvas",y=null!==(a=f.logLevel)&&void 0!==a?a:nb.Warn,v=null!==(u=f.downloadFileName)&&void 0!==u?u:"visualization",b="string"===typeof e?document.querySelector(e):e){t.next=12;break}throw new Error("".concat(e," does not exist"));case 12:return!1!==f.defaultStyle&&(x="vega-embed-style",w=xb(b),_=w.root,E=w.rootContainer,_.getElementById(x)||((A=document.createElement("style")).id=x,A.innerText=void 0===f.defaultStyle||!0===f.defaultStyle?Kv.toString():f.defaultStyle,E.appendChild(A))),O=pb(n,f.mode),S=cb[O](n,d),"vega-lite"===O&&S.$schema&&(C=Py(S.$schema),(0,Z.satisfies)(ub.vega,"^".concat(C.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(C.version,", but current version is v").concat(ub.vega,"."))),b.classList.add("vega-embed"),p&&b.classList.add("has-actions"),b.innerHTML="",M=b,p&&((k=document.createElement("div")).classList.add(fb),b.appendChild(k),M=k),(T=f.patch)&&(S=T instanceof Function?T(S):P(S,T,!0,!1).newDocument),f.formatLocale&&nb.formatLocale(f.formatLocale),f.timeFormatLocale&&nb.timeFormatLocale(f.timeFormatLocale),D=f.ast,F=nb.parse(S,"vega-lite"===O?{}:d,{ast:D}),(j=new(f.viewClass||nb.View)(F,eb({loader:h,logLevel:y,renderer:m},D?{expr:null!==(c=null!==(l=nb.expressionInterpreter)&&void 0!==l?l:f.expr)&&void 0!==c?c:et}:{}))).addSignalListener("autosize",((t,e)=>{var n=e.type;"fit-x"==n?(M.classList.add("fit-x"),M.classList.remove("fit-y")):"fit-y"==n?(M.classList.remove("fit-x"),M.classList.add("fit-y")):"fit"==n?M.classList.add("fit-x","fit-y"):M.classList.remove("fit-x","fit-y")})),!1!==f.tooltip&&(L=hb(f.tooltip)?f.tooltip:new pv(!0===f.tooltip?{}:f.tooltip).call,j.tooltip(L)),void 0===(R=f.hover)&&(R="vega"===O),R&&(N=(I="boolean"===typeof R?{}:R).hoverSet,B=I.updateSet,j.hover(N,B)),f&&(null!=f.width&&j.width(f.width),null!=f.height&&j.height(f.height),null!=f.padding&&j.padding(f.padding)),t.next=36,j.initialize(M,f.bind).runAsync();case 36:if(!1!==p){if($=b,!1!==f.defaultStyle&&((U=document.createElement("details")).title=g.CLICK_TO_VIEW_ACTIONS,b.append(U),$=U,(q=document.createElement("summary")).innerHTML=lb,U.append(q),z=t=>{U.contains(t.target)||U.removeAttribute("open")},document.addEventListener("click",z)),G=document.createElement("div"),$.append(G),G.classList.add("vega-actions"),!0===p||!1!==p.export)for(H=function(){var t=Y[X];if(!0===p||!0===p.export||p.export[t]){var e=g["".concat(t.toUpperCase(),"_ACTION")],n=document.createElement("a");n.text=e,n.href="#",n.target="_blank",n.download="".concat(v,".").concat(t),n.addEventListener("mousedown",function(){var e=yv(Hv.mark((function e(n){var r;return Hv.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,j.toImageURL(t,f.scaleFactor);case 3:r=e.sent,this.href=r;case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()),G.append(n)}},X=0,Y=["svg","png"];X<Y.length;X++)H();!0!==p&&!1===p.source||((K=document.createElement("a")).text=g.SOURCE_ACTION,K.href="#",K.addEventListener("click",(function(t){var e,r;db(V()(n),null!==(e=f.sourceHeader)&&void 0!==e?e:"",null!==(r=f.sourceFooter)&&void 0!==r?r:"",O),t.preventDefault()})),G.append(K)),"vega-lite"!==O||!0!==p&&!1===p.compiled||((J=document.createElement("a")).text=g.COMPILED_ACTION,J.href="#",J.addEventListener("click",(function(t){var e,n;db(V()(S),null!==(e=f.sourceHeader)&&void 0!==e?e:"",null!==(n=f.sourceFooter)&&void 0!==n?n:"","vega"),t.preventDefault()})),G.append(J)),!0!==p&&!1===p.editor||(tt=null!==(Q=f.editorUrl)&&void 0!==Q?Q:"https://vega.github.io/editor/",(nt=document.createElement("a")).text=g.EDITOR_ACTION,nt.href="#",nt.addEventListener("click",(function(t){Xv(window,tt,{config:d,mode:O,renderer:m,spec:V()(n)}),t.preventDefault()})),G.append(nt))}return t.abrupt("return",{view:j,spec:n,vgSpec:S,finalize:rt});case 38:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Eb(t,e){Object.keys(e).forEach((n=>{!function(t,e,n){var r;n&&((r=n)&&"[object Function]"==={}.toString.call(r)?n(t.data(e)):t.change(e,nb.changeset().remove((()=>!0)).insert(n)))}(t,n,e[n])}))}function Ab(t){const e=new Set;return t.forEach((t=>{Object.keys(t).forEach((t=>{e.add(t)}))})),e}const Ob=()=>{};function Sb(t,e){const n=Object.keys(e);return n.forEach((n=>{try{t.addSignalListener(n,e[n])}catch(r){console.warn("Cannot add invalid signal listener.",r)}})),n.length>0}function Cb(t,e){const n=Object.keys(e);return n.forEach((n=>{try{t.removeSignalListener(n,e[n])}catch(r){console.warn("Cannot remove invalid signal listener.",r)}})),n.length>0}function Mb(t){const{spec:e,width:n,height:r}=t;return"undefined"!==typeof n&&"undefined"!==typeof r?{...e,width:n,height:r}:"undefined"!==typeof n?{...e,width:n}:"undefined"!==typeof r?{...e,height:r}:e}function Pb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class kb extends c.PureComponent{constructor(...t){super(...t),Pb(this,"containerRef",c.createRef()),Pb(this,"resultPromise",void 0),Pb(this,"handleError",(t=>{const{onError:e=Ob}=this.props;e(t),console.warn(t)})),Pb(this,"modifyView",(t=>{this.resultPromise&&this.resultPromise.then((e=>(e&&t(e.view),!0))).catch(this.handleError)}))}componentDidMount(){this.createView()}componentDidUpdate(t){const e=Ab([this.props,t]);if(e.delete("className"),e.delete("signalListeners"),e.delete("spec"),e.delete("style"),e.delete("width"),e.delete("height"),Array.from(e).some((e=>this.props[e]!==t[e])))this.clearView(),this.createView();else{const e=function(t,e){if(t===e)return!1;const n={width:!1,height:!1,isExpensive:!1},r=Ab([t,e]);return!r.has("width")||"width"in t&&"width"in e&&t.width===e.width||("width"in t&&"number"===typeof t.width?n.width=t.width:n.isExpensive=!0),!r.has("height")||"height"in t&&"height"in e&&t.height===e.height||("height"in t&&"number"===typeof t.height?n.height=t.height:n.isExpensive=!0),r.delete("width"),r.delete("height"),[...r].some((n=>!(n in t)||!(n in e)||!Pt()(t[n],e[n])))&&(n.isExpensive=!0),!(!1===n.width&&!1===n.height&&!n.isExpensive)&&n}(Mb(this.props),Mb(t)),{signalListeners:n}=this.props,{signalListeners:r}=t;if(e)if(e.isExpensive)this.clearView(),this.createView();else{const t=!f(n,r);this.modifyView((i=>{!1!==e.width&&i.width(e.width),!1!==e.height&&i.height(e.height),t&&(r&&Cb(i,r),n&&Sb(i,n)),i.run()}))}else f(n,r)||this.modifyView((t=>{r&&Cb(t,r),n&&Sb(t,n),t.run()}))}}componentWillUnmount(){this.clearView()}createView(){const{spec:t,onNewView:e,signalListeners:n={},width:r,height:i,...o}=this.props;if(this.containerRef.current){const t=Mb(this.props);this.resultPromise=function(t,e){return yb.apply(this,arguments)}(this.containerRef.current,t,o).then((t=>{if(t){const{view:e}=t;Sb(e,n)&&e.run()}return t})).catch(this.handleError),e&&this.modifyView(e)}}clearView(){return this.resultPromise&&this.resultPromise.then((t=>{t&&t.finalize()})).catch(this.handleError),this.resultPromise=void 0,this}render(){const{className:t,style:e}=this.props;return c.createElement("div",{ref:this.containerRef,className:t,style:e})}}function Tb(){return(Tb=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function Db(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Pb(kb,"propTypes",{className:u().string,onError:u().func});class Fb extends c.PureComponent{constructor(...t){super(...t),Db(this,"vegaEmbed",c.createRef()),Db(this,"handleNewView",(t=>{this.update();const{onNewView:e=Ob}=this.props;e(t)}))}componentDidMount(){this.update()}componentDidUpdate(t){f(this.props.data,t.data)||this.update()}update(){const{data:t}=this.props;this.vegaEmbed.current&&t&&Object.keys(t).length>0&&this.vegaEmbed.current.modifyView((e=>{Eb(e,t),e.resize().run()}))}render(){const{data:t,...e}=this.props;return c.createElement(kb,Tb({ref:this.vegaEmbed},e,{onNewView:this.handleNewView}))}}Db(Fb,"defaultProps",{data:{}})},7779:function(t,e,n){"use strict";n.d(e,{md:function(){return g},DE:function(){return d},qC:function(){return p},MT:function(){return f}});var r=n(4942);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var a="function"===typeof Symbol&&Symbol.observable||"@@observable",u=function(){return Math.random().toString(36).substring(7).split("").join(".")},c={INIT:"@@redux/INIT"+u(),REPLACE:"@@redux/REPLACE"+u(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+u()}};function l(t){if("object"!==typeof t||null===t)return!1;for(var e=t;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function f(t,e,n){var r;if("function"===typeof e&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error(s(0));if("function"===typeof e&&"undefined"===typeof n&&(n=e,e=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error(s(1));return n(f)(t,e)}if("function"!==typeof t)throw new Error(s(2));var i=t,o=e,u=[],h=u,d=!1;function p(){h===u&&(h=u.slice())}function g(){if(d)throw new Error(s(3));return o}function m(t){if("function"!==typeof t)throw new Error(s(4));if(d)throw new Error(s(5));var e=!0;return p(),h.push(t),function(){if(e){if(d)throw new Error(s(6));e=!1,p();var n=h.indexOf(t);h.splice(n,1),u=null}}}function y(t){if(!l(t))throw new Error(s(7));if("undefined"===typeof t.type)throw new Error(s(8));if(d)throw new Error(s(9));try{d=!0,o=i(o,t)}finally{d=!1}for(var e=u=h,n=0;n<e.length;n++){(0,e[n])()}return t}function v(t){if("function"!==typeof t)throw new Error(s(10));i=t,y({type:c.REPLACE})}function b(){var t,e=m;return(t={subscribe:function(t){if("object"!==typeof t||null===t)throw new Error(s(11));function n(){t.next&&t.next(g())}return n(),{unsubscribe:e(n)}}})[a]=function(){return this},t}return y({type:c.INIT}),(r={dispatch:y,subscribe:m,getState:g,replaceReducer:v})[a]=b,r}function h(t,e){return function(){return e(t.apply(this,arguments))}}function d(t,e){if("function"===typeof t)return h(t,e);if("object"!==typeof t||null===t)throw new Error(s(16));var n={};for(var r in t){var i=t[r];"function"===typeof i&&(n[r]=h(i,e))}return n}function p(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return 0===e.length?function(t){return t}:1===e.length?e[0]:e.reduce((function(t,e){return function(){return t(e.apply(void 0,arguments))}}))}function g(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return function(){var n=t.apply(void 0,arguments),r=function(){throw new Error(s(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=e.map((function(t){return t(i)}));return r=p.apply(void 0,a)(n.dispatch),o(o({},n),{},{dispatch:r})}}}},1163:function(t,e,n){"use strict";n.d(e,{I4:function(){return s},Ye:function(){return o}});var r=n(7294);function i(t,e){var n=(0,r.useState)((function(){return{inputs:e,result:t()}}))[0],i=(0,r.useRef)(!0),o=(0,r.useRef)(n),s=i.current||Boolean(e&&o.current.inputs&&function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e,o.current.inputs))?o.current:{inputs:e,result:t()};return(0,r.useEffect)((function(){i.current=!1,o.current=s}),[s]),s.result}var o=i,s=function(t,e){return i((function(){return t}),e)}},4890:function(t,e,n){const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(t,e){if(e=o(e),t instanceof i){if(t.loose===!!e.loose)return t;t=t.value}c("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===r?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(t){const e=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],n=t.match(e);if(!n)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new l(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(t){if(c("Comparator.test",t,this.options.loose),this.semver===r||t===r)return!0;if("string"===typeof t)try{t=new l(t,this.options)}catch(e){return!1}return u(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof i))throw new TypeError("a Comparator is required");if(e&&"object"===typeof e||(e={loose:!!e,includePrerelease:!1}),""===this.operator)return""===this.value||new f(t.value,e).test(this.value);if(""===t.operator)return""===t.value||new f(this.value,e).test(t.semver);const n=(">="===this.operator||">"===this.operator)&&(">="===t.operator||">"===t.operator),r=("<="===this.operator||"<"===this.operator)&&("<="===t.operator||"<"===t.operator),o=this.semver.version===t.semver.version,s=(">="===this.operator||"<="===this.operator)&&(">="===t.operator||"<="===t.operator),a=u(this.semver,"<",t.semver,e)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),c=u(this.semver,">",t.semver,e)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return n||r||o&&s||a||c}}t.exports=i;const o=n(4167),{re:s,t:a}=n(6152),u=n(1427),c=n(4272),l=n(7800),f=n(1540)},1540:function(t,e,n){class r{constructor(t,e){if(e=o(e),t instanceof r)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new r(t.raw,e);if(t instanceof s)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t,this.set=t.split(/\s*\|\|\s*/).map((t=>this.parseRange(t.trim()))).filter((t=>t.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${t}`);if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter((t=>!p(t[0]))),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&g(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((t=>t.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(t){t=t.trim();const e=`parseRange:${Object.keys(this.options).join(",")}:${t}`,n=i.get(e);if(n)return n;const r=this.options.loose,o=r?c[l.HYPHENRANGELOOSE]:c[l.HYPHENRANGE];t=t.replace(o,C(this.options.includePrerelease)),a("hyphen replace",t),t=t.replace(c[l.COMPARATORTRIM],f),a("comparator trim",t,c[l.COMPARATORTRIM]),t=(t=(t=t.replace(c[l.TILDETRIM],h)).replace(c[l.CARETTRIM],d)).split(/\s+/).join(" ");const u=r?c[l.COMPARATORLOOSE]:c[l.COMPARATOR],g=t.split(" ").map((t=>y(t,this.options))).join(" ").split(/\s+/).map((t=>S(t,this.options))).filter(this.options.loose?t=>!!t.match(u):()=>!0).map((t=>new s(t,this.options))),m=(g.length,new Map);for(const i of g){if(p(i))return[i];m.set(i.value,i)}m.size>1&&m.has("")&&m.delete("");const v=[...m.values()];return i.set(e,v),v}intersects(t,e){if(!(t instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>m(n,e)&&t.set.some((t=>m(t,e)&&n.every((n=>t.every((t=>n.intersects(t,e)))))))))}test(t){if(!t)return!1;if("string"===typeof t)try{t=new u(t,this.options)}catch(e){return!1}for(let n=0;n<this.set.length;n++)if(M(this.set[n],t,this.options))return!0;return!1}}t.exports=r;const i=new(n(9593))({max:1e3}),o=n(4167),s=n(4890),a=n(4272),u=n(7800),{re:c,t:l,comparatorTrimReplace:f,tildeTrimReplace:h,caretTrimReplace:d}=n(6152),p=t=>"<0.0.0-0"===t.value,g=t=>""===t.value,m=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every((t=>i.intersects(t,e))),i=r.pop();return n},y=(t,e)=>(a("comp",t,e),t=w(t,e),a("caret",t),t=b(t,e),a("tildes",t),t=E(t,e),a("xrange",t),t=O(t,e),a("stars",t),t),v=t=>!t||"x"===t.toLowerCase()||"*"===t,b=(t,e)=>t.trim().split(/\s+/).map((t=>x(t,e))).join(" "),x=(t,e)=>{const n=e.loose?c[l.TILDELOOSE]:c[l.TILDE];return t.replace(n,((e,n,r,i,o)=>{let s;return a("tilde",t,e,n,r,i,o),v(n)?s="":v(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:v(i)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(a("replaceTilde pr",o),s=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,a("tilde return",s),s}))},w=(t,e)=>t.trim().split(/\s+/).map((t=>_(t,e))).join(" "),_=(t,e)=>{a("caret",t,e);const n=e.loose?c[l.CARETLOOSE]:c[l.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,((e,n,i,o,s)=>{let u;return a("caret",t,e,n,i,o,s),v(n)?u="":v(i)?u=`>=${n}.0.0${r} <${+n+1}.0.0-0`:v(o)?u="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:s?(a("replaceCaret pr",s),u="0"===n?"0"===i?`>=${n}.${i}.${o}-${s} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${s} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${s} <${+n+1}.0.0-0`):(a("no pr"),u="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),a("caret return",u),u}))},E=(t,e)=>(a("replaceXRanges",t,e),t.split(/\s+/).map((t=>A(t,e))).join(" ")),A=(t,e)=>{t=t.trim();const n=e.loose?c[l.XRANGELOOSE]:c[l.XRANGE];return t.replace(n,((n,r,i,o,s,u)=>{a("xRange",t,n,r,i,o,s,u);const c=v(i),l=c||v(o),f=l||v(s),h=f;return"="===r&&h&&(r=""),u=e.includePrerelease?"-0":"",c?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&h?(l&&(o=0),s=0,">"===r?(r=">=",l?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===r&&(r="<",l?i=+i+1:o=+o+1),"<"===r&&(u="-0"),n=`${r+i}.${o}.${s}${u}`):l?n=`>=${i}.0.0${u} <${+i+1}.0.0-0`:f&&(n=`>=${i}.${o}.0${u} <${i}.${+o+1}.0-0`),a("xRange return",n),n}))},O=(t,e)=>(a("replaceStars",t,e),t.trim().replace(c[l.STAR],"")),S=(t,e)=>(a("replaceGTE0",t,e),t.trim().replace(c[e.includePrerelease?l.GTE0PRE:l.GTE0],"")),C=t=>(e,n,r,i,o,s,a,u,c,l,f,h,d)=>`${n=v(r)?"":v(i)?`>=${r}.0.0${t?"-0":""}`:v(o)?`>=${r}.${i}.0${t?"-0":""}`:s?`>=${n}`:`>=${n}${t?"-0":""}`} ${u=v(c)?"":v(l)?`<${+c+1}.0.0-0`:v(f)?`<${c}.${+l+1}.0-0`:h?`<=${c}.${l}.${f}-${h}`:t?`<${c}.${l}.${+f+1}-0`:`<=${u}`}`.trim(),M=(t,e,n)=>{for(let r=0;r<t.length;r++)if(!t[r].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(a(t[n].semver),t[n].semver!==s.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0}},7800:function(t,e,n){const r=n(4272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(1266),{re:s,t:a}=n(6152),u=n(4167),{compareIdentifiers:c}=n(4126);class l{constructor(t,e){if(e=u(e),t instanceof l){if(t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease)return t;t=t.version}else if("string"!==typeof t)throw new TypeError(`Invalid Version: ${t}`);if(t.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",t,e),this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease;const n=t.trim().match(e.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<o)return e}return t})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(r("SemVer.compare",this.version,this.options,t),!(t instanceof l)){if("string"===typeof t&&t===this.version)return 0;t=new l(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof l||(t=new l(t,this.options)),c(this.major,t.major)||c(this.minor,t.minor)||c(this.patch,t.patch)}comparePre(t){if(t instanceof l||(t=new l(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let e=0;do{const n=this.prerelease[e],i=t.prerelease[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++e)}compareBuild(t){t instanceof l||(t=new l(t,this.options));let e=0;do{const n=this.build[e],i=t.build[e];if(r("prerelease compare",e,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return c(n,i)}while(++e)}inc(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e),this.inc("pre",e);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let t=this.prerelease.length;for(;--t>=0;)"number"===typeof this.prerelease[t]&&(this.prerelease[t]++,t=-2);-1===t&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error(`invalid increment argument: ${t}`)}return this.format(),this.raw=this.version,this}}t.exports=l},3974:function(t,e,n){const r=n(155);t.exports=(t,e)=>{const n=r(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null}},1427:function(t,e,n){const r=n(3641),i=n(7351),o=n(3365),s=n(4457),a=n(2687),u=n(6039);t.exports=(t,e,n,c)=>{switch(e){case"===":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t===n;case"!==":return"object"===typeof t&&(t=t.version),"object"===typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return r(t,n,c);case"!=":return i(t,n,c);case">":return o(t,n,c);case">=":return s(t,n,c);case"<":return a(t,n,c);case"<=":return u(t,n,c);default:throw new TypeError(`Invalid operator: ${e}`)}}},6751:function(t,e,n){const r=n(7800),i=n(155),{re:o,t:s}=n(6152);t.exports=(t,e)=>{if(t instanceof r)return t;if("number"===typeof t&&(t=String(t)),"string"!==typeof t)return null;let n=null;if((e=e||{}).rtl){let e;for(;(e=o[s.COERCERTL].exec(t))&&(!n||n.index+n[0].length!==t.length);)n&&e.index+e[0].length===n.index+n[0].length||(n=e),o[s.COERCERTL].lastIndex=e.index+e[1].length+e[2].length;o[s.COERCERTL].lastIndex=-1}else n=t.match(o[s.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,e)}},2995:function(t,e,n){const r=n(7800);t.exports=(t,e,n)=>{const i=new r(t,n),o=new r(e,n);return i.compare(o)||i.compareBuild(o)}},1844:function(t,e,n){const r=n(6004);t.exports=(t,e)=>r(t,e,!0)},6004:function(t,e,n){const r=n(7800);t.exports=(t,e,n)=>new r(t,n).compare(new r(e,n))},2513:function(t,e,n){const r=n(155),i=n(3641);t.exports=(t,e)=>{if(i(t,e))return null;{const n=r(t),i=r(e),o=n.prerelease.length||i.prerelease.length,s=o?"pre":"",a=o?"prerelease":"";for(const t in n)if(("major"===t||"minor"===t||"patch"===t)&&n[t]!==i[t])return s+t;return a}}},3641:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>0===r(t,e,n)},3365:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>r(t,e,n)>0},4457:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>r(t,e,n)>=0},3866:function(t,e,n){const r=n(7800);t.exports=(t,e,n,i)=>{"string"===typeof n&&(i=n,n=void 0);try{return new r(t,n).inc(e,i).version}catch(o){return null}}},2687:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>r(t,e,n)<0},6039:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>r(t,e,n)<=0},2439:function(t,e,n){const r=n(7800);t.exports=(t,e)=>new r(t,e).major},3332:function(t,e,n){const r=n(7800);t.exports=(t,e)=>new r(t,e).minor},7351:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>0!==r(t,e,n)},155:function(t,e,n){const{MAX_LENGTH:r}=n(1266),{re:i,t:o}=n(6152),s=n(7800),a=n(4167);t.exports=(t,e)=>{if(e=a(e),t instanceof s)return t;if("string"!==typeof t)return null;if(t.length>r)return null;if(!(e.loose?i[o.LOOSE]:i[o.FULL]).test(t))return null;try{return new s(t,e)}catch(n){return null}}},8425:function(t,e,n){const r=n(7800);t.exports=(t,e)=>new r(t,e).patch},1298:function(t,e,n){const r=n(155);t.exports=(t,e)=>{const n=r(t,e);return n&&n.prerelease.length?n.prerelease:null}},2737:function(t,e,n){const r=n(6004);t.exports=(t,e,n)=>r(e,t,n)},1761:function(t,e,n){const r=n(2995);t.exports=(t,e)=>t.sort(((t,n)=>r(n,t,e)))},826:function(t,e,n){const r=n(1540);t.exports=(t,e,n)=>{try{e=new r(e,n)}catch(i){return!1}return e.test(t)}},5626:function(t,e,n){const r=n(2995);t.exports=(t,e)=>t.sort(((t,n)=>r(t,n,e)))},6798:function(t,e,n){const r=n(155);t.exports=(t,e)=>{const n=r(t,e);return n?n.version:null}},2543:function(t,e,n){const r=n(6152);t.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(1266).SEMVER_SPEC_VERSION,SemVer:n(7800),compareIdentifiers:n(4126).compareIdentifiers,rcompareIdentifiers:n(4126).rcompareIdentifiers,parse:n(155),valid:n(6798),clean:n(3974),inc:n(3866),diff:n(2513),major:n(2439),minor:n(3332),patch:n(8425),prerelease:n(1298),compare:n(6004),rcompare:n(2737),compareLoose:n(1844),compareBuild:n(2995),sort:n(5626),rsort:n(1761),gt:n(3365),lt:n(2687),eq:n(3641),neq:n(7351),gte:n(4457),lte:n(6039),cmp:n(1427),coerce:n(6751),Comparator:n(4890),Range:n(1540),satisfies:n(826),toComparators:n(434),maxSatisfying:n(4600),minSatisfying:n(142),minVersion:n(734),validRange:n(2617),outside:n(2416),gtr:n(9903),ltr:n(1611),intersects:n(1413),simplifyRange:n(9901),subset:n(2792)}},1266:function(t){const e=Number.MAX_SAFE_INTEGER||9007199254740991;t.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:e,MAX_SAFE_COMPONENT_LENGTH:16}},4272:function(t,e,n){var r=n(4155);const i="object"===typeof r&&r.env&&r.env.NODE_DEBUG&&/\bsemver\b/i.test(r.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};t.exports=i},4126:function(t){const e=/^[0-9]+$/,n=(t,n)=>{const r=e.test(t),i=e.test(n);return r&&i&&(t=+t,n=+n),t===n?0:r&&!i?-1:i&&!r?1:t<n?-1:1};t.exports={compareIdentifiers:n,rcompareIdentifiers:(t,e)=>n(e,t)}},4167:function(t){const e=["includePrerelease","loose","rtl"];t.exports=t=>t?"object"!==typeof t?{loose:!0}:e.filter((e=>t[e])).reduce(((t,e)=>(t[e]=!0,t)),{}):{}},6152:function(t,e,n){const{MAX_SAFE_COMPONENT_LENGTH:r}=n(1266),i=n(4272),o=(e=t.exports={}).re=[],s=e.src=[],a=e.t={};let u=0;const c=(t,e,n)=>{const r=u++;i(r,e),a[t]=r,s[r]=e,o[r]=new RegExp(e,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),c("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),c("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),c("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),c("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),c("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),c("FULL",`^${s[a.FULLPLAIN]}$`),c("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),c("LOOSE",`^${s[a.LOOSEPLAIN]}$`),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),c("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),c("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),c("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),c("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),c("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),c("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),c("COERCERTL",s[a.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",c("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),c("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),c("LONECARET","(?:\\^)"),c("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",c("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),c("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),c("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),c("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),c("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),c("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0.0.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},9903:function(t,e,n){const r=n(2416);t.exports=(t,e,n)=>r(t,e,">",n)},1413:function(t,e,n){const r=n(1540);t.exports=(t,e,n)=>(t=new r(t,n),e=new r(e,n),t.intersects(e))},1611:function(t,e,n){const r=n(2416);t.exports=(t,e,n)=>r(t,e,"<",n)},4600:function(t,e,n){const r=n(7800),i=n(1540);t.exports=(t,e,n)=>{let o=null,s=null,a=null;try{a=new i(e,n)}catch(u){return null}return t.forEach((t=>{a.test(t)&&(o&&-1!==s.compare(t)||(o=t,s=new r(o,n)))})),o}},142:function(t,e,n){const r=n(7800),i=n(1540);t.exports=(t,e,n)=>{let o=null,s=null,a=null;try{a=new i(e,n)}catch(u){return null}return t.forEach((t=>{a.test(t)&&(o&&1!==s.compare(t)||(o=t,s=new r(o,n)))})),o}},734:function(t,e,n){const r=n(7800),i=n(1540),o=n(3365);t.exports=(t,e)=>{t=new i(t,e);let n=new r("0.0.0");if(t.test(n))return n;if(n=new r("0.0.0-0"),t.test(n))return n;n=null;for(let i=0;i<t.set.length;++i){const e=t.set[i];let s=null;e.forEach((t=>{const e=new r(t.semver.version);switch(t.operator){case">":0===e.prerelease.length?e.patch++:e.prerelease.push(0),e.raw=e.format();case"":case">=":s&&!o(e,s)||(s=e);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${t.operator}`)}})),!s||n&&!o(n,s)||(n=s)}return n&&t.test(n)?n:null}},2416:function(t,e,n){const r=n(7800),i=n(4890),{ANY:o}=i,s=n(1540),a=n(826),u=n(3365),c=n(2687),l=n(6039),f=n(4457);t.exports=(t,e,n,h)=>{let d,p,g,m,y;switch(t=new r(t,h),e=new s(e,h),n){case">":d=u,p=l,g=c,m=">",y=">=";break;case"<":d=c,p=f,g=u,m="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(t,e,h))return!1;for(let r=0;r<e.set.length;++r){const n=e.set[r];let s=null,a=null;if(n.forEach((t=>{t.semver===o&&(t=new i(">=0.0.0")),s=s||t,a=a||t,d(t.semver,s.semver,h)?s=t:g(t.semver,a.semver,h)&&(a=t)})),s.operator===m||s.operator===y)return!1;if((!a.operator||a.operator===m)&&p(t,a.semver))return!1;if(a.operator===y&&g(t,a.semver))return!1}return!0}},9901:function(t,e,n){const r=n(826),i=n(6004);t.exports=(t,e,n)=>{const o=[];let s=null,a=null;const u=t.sort(((t,e)=>i(t,e,n)));for(const i of u){r(i,e,n)?(a=i,s||(s=i)):(a&&o.push([s,a]),a=null,s=null)}s&&o.push([s,null]);const c=[];for(const[r,i]of o)r===i?c.push(r):i||r!==u[0]?i?r===u[0]?c.push(`<=${i}`):c.push(`${r} - ${i}`):c.push(`>=${r}`):c.push("*");const l=c.join(" || "),f="string"===typeof e.raw?e.raw:String(e);return l.length<f.length?l:e}},2792:function(t,e,n){const r=n(1540),i=n(4890),{ANY:o}=i,s=n(826),a=n(6004),u=(t,e,n)=>{if(t===e)return!0;if(1===t.length&&t[0].semver===o){if(1===e.length&&e[0].semver===o)return!0;t=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===e.length&&e[0].semver===o){if(n.includePrerelease)return!0;e=[new i(">=0.0.0")]}const r=new Set;let u,f,h,d,p,g,m;for(const i of t)">"===i.operator||">="===i.operator?u=c(u,i,n):"<"===i.operator||"<="===i.operator?f=l(f,i,n):r.add(i.semver);if(r.size>1)return null;if(u&&f){if(h=a(u.semver,f.semver,n),h>0)return null;if(0===h&&(">="!==u.operator||"<="!==f.operator))return null}for(const i of r){if(u&&!s(i,String(u),n))return null;if(f&&!s(i,String(f),n))return null;for(const t of e)if(!s(i,String(t),n))return!1;return!0}let y=!(!f||n.includePrerelease||!f.semver.prerelease.length)&&f.semver,v=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver;y&&1===y.prerelease.length&&"<"===f.operator&&0===y.prerelease[0]&&(y=!1);for(const i of e){if(m=m||">"===i.operator||">="===i.operator,g=g||"<"===i.operator||"<="===i.operator,u)if(v&&i.semver.prerelease&&i.semver.prerelease.length&&i.semver.major===v.major&&i.semver.minor===v.minor&&i.semver.patch===v.patch&&(v=!1),">"===i.operator||">="===i.operator){if(d=c(u,i,n),d===i&&d!==u)return!1}else if(">="===u.operator&&!s(u.semver,String(i),n))return!1;if(f)if(y&&i.semver.prerelease&&i.semver.prerelease.length&&i.semver.major===y.major&&i.semver.minor===y.minor&&i.semver.patch===y.patch&&(y=!1),"<"===i.operator||"<="===i.operator){if(p=l(f,i,n),p===i&&p!==f)return!1}else if("<="===f.operator&&!s(f.semver,String(i),n))return!1;if(!i.operator&&(f||u)&&0!==h)return!1}return!(u&&g&&!f&&0!==h)&&(!(f&&m&&!u&&0!==h)&&(!v&&!y))},c=(t,e,n)=>{if(!t)return e;const r=a(t.semver,e.semver,n);return r>0?t:r<0||">"===e.operator&&">="===t.operator?e:t},l=(t,e,n)=>{if(!t)return e;const r=a(t.semver,e.semver,n);return r<0?t:r>0||"<"===e.operator&&"<="===t.operator?e:t};t.exports=(t,e,n={})=>{if(t===e)return!0;t=new r(t,n),e=new r(e,n);let i=!1;t:for(const r of t.set){for(const t of e.set){const e=u(r,t,n);if(i=i||null!==e,e)continue t}if(i)return!1}return!0}},434:function(t,e,n){const r=n(1540);t.exports=(t,e)=>new r(t,e).set.map((t=>t.map((t=>t.value)).join(" ").trim().split(" ")))},2617:function(t,e,n){const r=n(1540);t.exports=(t,e)=>{try{return new r(t,e).range||"*"}catch(n){return null}}},8823:function(t,e,n){"use strict";function r(t,e,n){return t.fields=e||[],t.fname=n,t}function i(t){return null==t?null:t.fname}function o(t){return null==t?null:t.fields}function s(t){return 1===t.length?a(t[0]):u(t)}n.d(e,{cG:function(){return E},jj:function(){return x},kI:function(){return _},Hq:function(){return b},uU:function(){return w},ZE:function(){return r},Oj:function(){return o},el:function(){return i},IX:function(){return Y},j2:function(){return tt},l$:function(){return K},qu:function(){return Q},a9:function(){return it},Ds:function(){return ot},vU:function(){return c},l7:function(){return st},We:function(){return at},dI:function(){return ut},k:function(){return y},Xr:function(){return ht},EP:function(){return f},yl:function(){return dt},nr:function(){return lt},id:function(){return h},yR:function(){return d},XW:function(){return pt},u5:function(){return gt},kJ:function(){return O},jn:function(){return mt},J_:function(){return yt},mf:function(){return J},TW:function(){return vt},hj:function(){return bt},Kn:function(){return S},Kj:function(){return xt},HD:function(){return wt},Jy:function(){return _t},t7:function(){return Et},kg:function(){return A},$m:function(){return At},TS:function(){return Ot},fE:function(){return M},kX:function(){return g},vk:function(){return Ct},Dw:function(){return B},mJ:function(){return z},QA:function(){return $},Zw:function(){return U},fj:function(){return T},mS:function(){return H},rx:function(){return St},yP:function(){return Mt},_k:function(){return l},m8:function(){return Pt},sw:function(){return kt},ZU:function(){return Dt},He:function(){return D},Rg:function(){return jt},BB:function(){return Ft},$G:function(){return Lt},yb:function(){return m},N3:function(){return X},FP:function(){return Rt},iL:function(){return P},bM:function(){return p},ay:function(){return Z},dH:function(){return W},mK:function(){return q},bV:function(){return G}});const a=t=>function(e){return e[t]},u=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function c(t){throw Error(t)}function l(t){const e=[],n=t.length;let r,i,o,s=null,a=0,u="";function l(){e.push(u+t.substring(r,i)),u="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)u+=t.substring(r,i),u+=t.substring(++i,++i),r=i;else if(o===s)l(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o||r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&l(),a=r=i+1):"]"===o&&(a||c("Access path missing open bracket: "+t),a>0&&l(),a=0,r=i+1):i>r?l():r=i+1}return a&&c("Access path missing closing bracket: "+t),s&&c("Access path missing closing quote: "+t),i>r&&(i++,l()),e}function f(t,e,n){const i=l(t);return t=1===i.length?i[0]:t,r((n&&n.get||s)(i),[t],e||t)}const h=f("id"),d=r((t=>t),[],"identity"),p=r((()=>0),[],"zero"),g=r((()=>1),[],"one"),m=r((()=>!0),[],"true"),y=r((()=>!1),[],"false");function v(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const b=0,x=1,w=2,_=3,E=4;function A(t,e,n=v){let r=t||b;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=x&&n(e||"error","ERROR",arguments),this},warn(){return r>=w&&n(e||"warn","WARN",arguments),this},info(){return r>=_&&n(e||"log","INFO",arguments),this},debug(){return r>=E&&n(e||"log","DEBUG",arguments),this}}}var O=Array.isArray;function S(t){return t===Object(t)}const C=t=>"__proto__"!==t;function M(...t){return t.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=k(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;P(t,n,e[n],r)}return t}),{})}function P(t,e,n,r){if(!C(e))return;let i,o;if(S(n)&&!O(n))for(i in o=S(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?P(o,i,n[i]):C(i)&&(o[i]=n[i]);else t[e]=n}function k(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function T(t){return t[t.length-1]}function D(t){return null==t||""===t?null:+t}const F=t=>e=>t*Math.exp(e),j=t=>e=>Math.log(t*e),L=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),R=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,I=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function N(t,e,n,r){const i=n(t[0]),o=n(T(t)),s=(o-i)*e;return[r(i-s),r(o-s)]}function B(t,e){return N(t,e,D,d)}function z(t,e){var n=Math.sign(t[0]);return N(t,e,j(n),F(n))}function $(t,e,n){return N(t,e,I(n),I(1/n))}function U(t,e,n){return N(t,e,L(n),R(n))}function V(t,e,n,r,i){const o=r(t[0]),s=r(T(t)),a=null!=e?r(e):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function Z(t,e,n){return V(t,e,n,D,d)}function W(t,e,n){const r=Math.sign(t[0]);return V(t,e,n,j(r),F(r))}function q(t,e,n,r){return V(t,e,n,I(r),I(1/r))}function G(t,e,n,r){return V(t,e,n,L(r),R(r))}function H(t){return 1+~~(new Date(t).getMonth()/3)}function X(t){return 1+~~(new Date(t).getUTCMonth()/3)}function Y(t){return null!=t?O(t)?t:[t]:[]}function K(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function J(t){return"function"===typeof t}function Q(t,e,n){n=n||{},e=Y(e)||[];const i=[],s=[],a={},u=n.comparator||et;return Y(t).forEach(((t,r)=>{null!=t&&(i.push("descending"===e[r]?-1:1),s.push(t=J(t)?t:f(t,null,n)),(o(t)||[]).forEach((t=>a[t]=1)))})),0===s.length?null:r(u(s,i),Object.keys(a))}const tt=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),et=(t,e)=>1===t.length?nt(t[0],e[0]):rt(t,e,t.length),nt=(t,e)=>function(n,r){return tt(t(n),t(r))*e},rt=(t,e,n)=>(e.push(0),function(r,i){let o,s=0,a=-1;for(;0===s&&++a<n;)o=t[a],s=tt(o(r),o(i));return s*e[a]});function it(t){return J(t)?t:()=>t}function ot(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function st(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function at(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!==r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!==r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function ut(t,e){const n=t.length;let r,i,o,s,a,u=-1;if(null==e){for(;++u<n;)if(i=t[u],null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(s=a=u;++u<n;)i=t[u],null!=i&&(r>i&&(r=i,s=u),o<i&&(o=i,a=u))}else{for(;++u<n;)if(i=e(t[u],u,t),null!=i&&i>=i){r=o=i;break}if(u===n)return[-1,-1];for(s=a=u;++u<n;)i=e(t[u],u,t),null!=i&&(r>i&&(r=i,s=u),o<i&&(o=i,a=u))}return[s,a]}const ct=Object.prototype.hasOwnProperty;function lt(t,e){return ct.call(t,e)}const ft={};function ht(t){let e,n={};function r(t){return lt(n,t)&&n[t]!==ft}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===ft&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=ft),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===ft||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function dt(t,e,n,r,i,o){if(!n&&0!==n)return o;const s=+n;let a,u=t[0],c=T(t);c<u&&(a=u,u=c,c=a),a=Math.abs(e-u);const l=Math.abs(c-e);return a<l&&a<=s?r:l<=s?i:o}function pt(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),st(r,n)}function gt(t,e,n,r){let i,o=e[0],s=e[e.length-1];return o>s&&(i=o,o=s,s=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=s:t<s)}function mt(t){return"boolean"===typeof t}function yt(t){return"[object Date]"===Object.prototype.toString.call(t)}function vt(t){return t&&J(t[Symbol.iterator])}function bt(t){return"number"===typeof t}function xt(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function wt(t){return"string"===typeof t}function _t(t,e,n){t&&(t=e?Y(t).map((t=>t.replace(/\\(.)/g,"$1"))):Y(t));const i=t&&t.length,o=n&&n.get||s,a=t=>o(e?[t]:l(t));let u;if(i)if(1===i){const e=a(t[0]);u=function(t){return""+e(t)}}else{const e=t.map(a);u=function(t){let n=""+e[0](t),r=0;for(;++r<i;)n+="|"+e[r](t);return n}}else u=function(){return""};return r(u,t,"key")}function Et(t,e){const n=t[0],r=T(t),i=+e;return i?1===i?r:n+i*(r-n):n}function At(t){let e,n,r;t=+t||1e4;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>lt(e,t)||lt(n,t),get:t=>lt(e,t)?e[t]:lt(n,t)?o(t,n[t]):void 0,set:(t,n)=>lt(e,t)?e[t]=n:o(t,n)}}function Ot(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const s=r||new e.constructor(i+o);let a=0,u=0,c=0;for(;a<i&&u<o;++c)s[c]=t(e[a],n[u])>0?n[u++]:e[a++];for(;a<i;++a,++c)s[c]=e[a];for(;u<o;++u,++c)s[c]=n[u];return s}function St(t,e){let n="";for(;--e>=0;)n+=t;return n}function Ct(t,e,n,r){const i=n||" ",o=t+"",s=e-o.length;return s<=0?o:"left"===r?St(i,s)+o:"center"===r?St(i,~~(s/2))+o+St(i,Math.ceil(s/2)):o+St(i,s)}function Mt(t){return t&&T(t)-t[0]||0}function Pt(t){return O(t)?"["+t.map(Pt)+"]":S(t)||wt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function kt(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t)&&!!t}const Tt=t=>bt(t)||yt(t)?t:Date.parse(t);function Dt(t,e){return e=e||Tt,null==t||""===t?null:e(t)}function Ft(t){return null==t||""===t?null:t+""}function jt(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function Lt(t,e,n,r){const i=null!=r?r:"\u2026",o=t+"",s=o.length,a=Math.max(0,e-i.length);return s<=e?o:"left"===n?i+o.slice(s-a):"center"===n?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function Rt(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}},5277:function(t,e,n){"use strict";n.r(e),n.d(e,{Bounds:function(){return op},CanvasHandler:function(){return Lm},CanvasRenderer:function(){return zm},DATE:function(){return Kt},DAY:function(){return Jt},DAYOFYEAR:function(){return Qt},Dataflow:function(){return to},Debug:function(){return g.cG},Error:function(){return g.jj},EventStream:function(){return Bi},Gradient:function(){return hd},GroupItem:function(){return ap},HOURS:function(){return te},Handler:function(){return mm},Info:function(){return g.kI},Item:function(){return sp},MILLISECONDS:function(){return re},MINUTES:function(){return ee},MONTH:function(){return Xt},Marks:function(){return tm},MultiPulse:function(){return Xi},None:function(){return g.Hq},Operator:function(){return Ri},Parameters:function(){return Fi},Pulse:function(){return Wi},QUARTER:function(){return Ht},RenderType:function(){return Py},Renderer:function(){return vm},ResourceLoader:function(){return up},SECONDS:function(){return ne},SVGHandler:function(){return Um},SVGRenderer:function(){return hy},SVGStringRenderer:function(){return Sy},Scenegraph:function(){return um},TIME_UNITS:function(){return ie},Transform:function(){return no},View:function(){return pT},WEEK:function(){return Yt},Warn:function(){return g.uU},YEAR:function(){return Gt},accessor:function(){return g.ZE},accessorFields:function(){return g.Oj},accessorName:function(){return g.el},array:function(){return g.IX},ascending:function(){return g.j2},bandwidthNRD:function(){return bo},bin:function(){return xo},bootstrapCI:function(){return Eo},boundClip:function(){return Iy},boundContext:function(){return Pp},boundItem:function(){return em},boundMark:function(){return rm},boundStroke:function(){return fp},changeset:function(){return Ti},clampRange:function(){return g.l$},codegenExpression:function(){return dM},compare:function(){return g.qu},constant:function(){return g.a9},cumulativeLogNormal:function(){return No},cumulativeNormal:function(){return Do},cumulativeUniform:function(){return Zo},dayofyear:function(){return fe},debounce:function(){return g.Ds},defaultLocale:function(){return Vr},definition:function(){return io},densityLogNormal:function(){return Io},densityNormal:function(){return To},densityUniform:function(){return Vo},domChild:function(){return hm},domClear:function(){return dm},domCreate:function(){return lm},domFind:function(){return fm},dotbin:function(){return Ao},error:function(){return g.vU},expressionFunction:function(){return dk},extend:function(){return g.l7},extent:function(){return g.We},extentIndex:function(){return g.dI},falsy:function(){return g.k},fastmap:function(){return g.Xr},field:function(){return g.EP},flush:function(){return g.yl},font:function(){return Hg},fontFamily:function(){return Gg},fontSize:function(){return Ug},format:function(){return di},formatLocale:function(){return Lr},formats:function(){return pi},hasOwnProperty:function(){return g.nr},id:function(){return g.id},identity:function(){return g.yR},inferType:function(){return si},inferTypes:function(){return ai},ingest:function(){return Oi},inherits:function(){return g.XW},inrange:function(){return g.u5},interpolate:function(){return Rh},interpolateColors:function(){return Fh},interpolateRange:function(){return Dh},intersect:function(){return Dy},intersectBoxLine:function(){return zp},intersectPath:function(){return Rp},intersectPoint:function(){return Ip},intersectRule:function(){return Bp},isArray:function(){return g.kJ},isBoolean:function(){return g.jn},isDate:function(){return g.J_},isFunction:function(){return g.mf},isIterable:function(){return g.TW},isNumber:function(){return g.hj},isObject:function(){return g.Kn},isRegExp:function(){return g.Kj},isString:function(){return g.HD},isTuple:function(){return _i},key:function(){return g.Jy},lerp:function(){return g.t7},lineHeight:function(){return Vg},loader:function(){return yi},locale:function(){return Ur},logger:function(){return g.kg},lruCache:function(){return g.$m},markup:function(){return oy},merge:function(){return g.TS},mergeConfig:function(){return g.fE},multiLineOffset:function(){return Wg},one:function(){return g.kX},pad:function(){return g.vk},panLinear:function(){return g.Dw},panLog:function(){return g.mJ},panPow:function(){return g.QA},panSymlog:function(){return g.Zw},parse:function(){return yL},parseExpression:function(){return lM},parseSelector:function(){return OT},pathCurves:function(){return pd},pathEqual:function(){return By},pathParse:function(){return yd},pathRectangle:function(){return $d},pathRender:function(){return Md},pathSymbols:function(){return Dd},pathTrail:function(){return Ud},peek:function(){return g.fj},point:function(){return gm},projection:function(){return j_},quantileLogNormal:function(){return Bo},quantileNormal:function(){return Fo},quantileUniform:function(){return Wo},quantiles:function(){return yo},quantizeInterpolator:function(){return jh},quarter:function(){return g.mS},quartiles:function(){return vo},random:function(){return wo},randomInteger:function(){return So},randomKDE:function(){return Lo},randomLCG:function(){return Oo},randomLogNormal:function(){return zo},randomMixture:function(){return $o},randomNormal:function(){return jo},randomUniform:function(){return qo},read:function(){return mi},regressionExp:function(){return Qo},regressionLinear:function(){return Ko},regressionLoess:function(){return is},regressionLog:function(){return Jo},regressionPoly:function(){return ns},regressionPow:function(){return ts},regressionQuad:function(){return es},renderModule:function(){return Ty},repeat:function(){return g.rx},resetDefaultLocale:function(){return Zr},resetSVGClipId:function(){return rp},resetSVGDefIds:function(){return zy},responseType:function(){return gi},runtimeContext:function(){return Ek},sampleCurve:function(){return us},sampleLogNormal:function(){return Ro},sampleNormal:function(){return ko},sampleUniform:function(){return Uo},scale:function(){return _h},sceneEqual:function(){return Ny},sceneFromJSON:function(){return sm},scenePickVisit:function(){return Kp},sceneToJSON:function(){return om},sceneVisit:function(){return Yp},sceneZOrder:function(){return Xp},scheme:function(){return zh},serializeXML:function(){return sy},setRandom:function(){return _o},span:function(){return g.yP},splitAccessPath:function(){return g._k},stringValue:function(){return g.m8},textMetrics:function(){return Rg},timeBin:function(){return en},timeFloor:function(){return Ce},timeFormatLocale:function(){return zr},timeInterval:function(){return Fe},timeOffset:function(){return Re},timeSequence:function(){return Be},timeUnitSpecifier:function(){return ue},timeUnits:function(){return se},toBoolean:function(){return g.sw},toDate:function(){return g.ZU},toNumber:function(){return g.He},toSet:function(){return g.Rg},toString:function(){return g.BB},transform:function(){return oo},transforms:function(){return ro},truncate:function(){return g.$G},truthy:function(){return g.yb},tupleid:function(){return Ei},typeParsers:function(){return ri},utcFloor:function(){return ke},utcInterval:function(){return je},utcOffset:function(){return Ie},utcSequence:function(){return ze},utcdayofyear:function(){return ye},utcquarter:function(){return g.N3},utcweek:function(){return ve},version:function(){return bL},visitArray:function(){return g.FP},week:function(){return he},writeConfig:function(){return g.iL},zero:function(){return g.bM},zoomLinear:function(){return g.ay},zoomLog:function(){return g.dH},zoomPow:function(){return g.mK},zoomSymlog:function(){return g.bV}});var r={};n.r(r),n.d(r,{aggregate:function(){return Ss},bin:function(){return Cs},collect:function(){return Ps},compare:function(){return ks},countpattern:function(){return Ds},cross:function(){return Fs},density:function(){return Is},dotbin:function(){return Us},expression:function(){return Vs},extent:function(){return Ws},facet:function(){return Gs},field:function(){return Hs},filter:function(){return Ys},flatten:function(){return Ks},fold:function(){return Js},formula:function(){return Qs},generate:function(){return ta},impute:function(){return ra},joinaggregate:function(){return ia},kde:function(){return oa},key:function(){return sa},load:function(){return ua},lookup:function(){return la},multiextent:function(){return fa},multivalues:function(){return da},params:function(){return ga},pivot:function(){return ma},prefacet:function(){return ya},project:function(){return va},proxy:function(){return ba},quantile:function(){return xa},relay:function(){return wa},sample:function(){return _a},sequence:function(){return Ea},sieve:function(){return Aa},subflow:function(){return qs},timeunit:function(){return Oa},tupleindex:function(){return Ca},values:function(){return Ma},window:function(){return Fa}});var i={};n.r(i),n.d(i,{interpolate:function(){return sl},interpolateArray:function(){return Jc},interpolateBasis:function(){return Bc},interpolateBasisClosed:function(){return zc},interpolateCubehelix:function(){return Zf},interpolateCubehelixLong:function(){return Wf},interpolateDate:function(){return tl},interpolateDiscrete:function(){return Xl},interpolateHcl:function(){return kf},interpolateHclLong:function(){return Tf},interpolateHsl:function(){return uf},interpolateHslLong:function(){return cf},interpolateHue:function(){return Yl},interpolateLab:function(){return Mf},interpolateNumber:function(){return el},interpolateNumberArray:function(){return Yc},interpolateObject:function(){return nl},interpolateRgb:function(){return qc},interpolateRgbBasis:function(){return Hc},interpolateRgbBasisClosed:function(){return Xc},interpolateRound:function(){return al},interpolateString:function(){return ol},interpolateTransformCss:function(){return nf},interpolateTransformSvg:function(){return rf},interpolateZoom:function(){return sf},piecewise:function(){return ql},quantize:function(){return qf}});var o={};n.r(o),n.d(o,{bound:function(){return mv},identifier:function(){return bv},mark:function(){return xv},overlap:function(){return wv},render:function(){return Mv},viewlayout:function(){return Yv}});var s={};n.r(s),n.d(s,{axisticks:function(){return Jv},datajoin:function(){return Qv},encode:function(){return eb},legendentries:function(){return nb},linkpath:function(){return ab},pie:function(){return hb},scale:function(){return gb},sortitems:function(){return bb},stack:function(){return Ab}});var a={};n.r(a),n.d(a,{contour:function(){return rE},geojson:function(){return sE},geopath:function(){return aE},geopoint:function(){return uE},geoshape:function(){return cE},graticule:function(){return lE},heatmap:function(){return fE},isocontour:function(){return G_},kde2d:function(){return tE},projection:function(){return dE}});var u={};n.r(u),n.d(u,{force:function(){return cA}});var c={};n.r(c),n.d(c,{nest:function(){return lO},pack:function(){return mO},partition:function(){return vO},stratify:function(){return bO},tree:function(){return _O},treelinks:function(){return EO},treemap:function(){return SO}});var l={};n.r(l),n.d(l,{label:function(){return XO}});var f={};n.r(f),n.d(f,{loess:function(){return KO},regression:function(){return QO}});var h={};n.r(h),n.d(h,{voronoi:function(){return _S}});var d={};n.r(d),n.d(d,{wordcloud:function(){return IS}});var p={};n.r(p),n.d(p,{crossfilter:function(){return ZS},resolvefilter:function(){return WS}});var g=n(8823),m={},y={};function v(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function b(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function x(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function w(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":function(t){return t<0?"-"+x(-t,6):t>9999?"+"+x(t,6):x(t,4)}(t.getUTCFullYear())+"-"+x(t.getUTCMonth()+1,2)+"-"+x(t.getUTCDate(),2)+(i?"T"+x(e,2)+":"+x(n,2)+":"+x(r,2)+"."+x(i,3)+"Z":r?"T"+x(e,2)+":"+x(n,2)+":"+x(r,2)+"Z":n||e?"T"+x(e,2)+":"+x(n,2)+"Z":"")}function _(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,s=0,a=0,u=o<=0,c=!1;function l(){if(u)return y;if(c)return c=!1,m;var e,r,i=s;if(34===t.charCodeAt(i)){for(;s++<o&&34!==t.charCodeAt(s)||34===t.charCodeAt(++s););return(e=s)>=o?u=!0:10===(r=t.charCodeAt(s++))?c=!0:13===r&&(c=!0,10===t.charCodeAt(s)&&++s),t.slice(i+1,e-1).replace(/""/g,'"')}for(;s<o;){if(10===(r=t.charCodeAt(e=s++)))c=!0;else if(13===r)c=!0,10===t.charCodeAt(s)&&++s;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,o)}for(10===t.charCodeAt(o-1)&&--o,13===t.charCodeAt(o-1)&&--o;(r=l())!==y;){for(var f=[];r!==m&&r!==y;)f.push(r),r=l();e&&null==(f=e(f,a++))||i.push(f)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return s(e[t])})).join(t)}))}function o(e){return e.map(s).join(t)}function s(t){return null==t?"":t instanceof Date?w(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=v(t);return function(r,i){return e(n(r),i,t)}}(t,e):v(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=b(e)),[n.map(s).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=b(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:s}}function E(t){return t}function A(t,e){return"string"===typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return O(t,e)}))}:O(t,e)}function O(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=S(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function S(t,e){var n=function(t){if(null==t)return E;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0);var u=2,c=t.length,l=new Array(c);for(l[0]=(e+=t[0])*r+o,l[1]=(n+=t[1])*i+s;u<c;)l[u]=t[u],++u;return l}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,s=i.length;o<s;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,s)}function o(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function u(t){return t.map(a)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=u(e.arcs);break;case"MultiPolygon":n=e.arcs.map(u);break;default:return null}return{type:r,coordinates:n}}(e)}function C(t,e){var n={},r={},i={},o=[],s=-1;function a(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++s],e[s]=n,e[r]=i)})),e.forEach((function(e){var n,o,s=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1];return e<0?[n,i]:[i,n]}(e),a=s[0],u=s[1];if(n=i[a])if(delete i[n.end],n.push(e),n.end=u,o=r[u]){delete r[o.start];var c=o===n?n:n.concat(o);r[c.start=n.start]=i[c.end=o.end]=c}else r[n.start]=i[n.end]=n;else if(n=r[u])if(delete r[n.start],n.unshift(e),n.start=a,o=i[a]){delete i[o.end];var l=o===n?n:o.concat(n);r[l.start=o.start]=i[l.end=n.end]=l}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=a]=i[n.end=u]=n})),a(i,r),a(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}function M(t){return S(t,P.apply(this,arguments))}function P(t,e,n){var r,i,o;if(arguments.length>1)r=k(t,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:C(t,r)}}function k(t,e,n){var r,i=[],o=[];function s(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function a(t){t.forEach(s)}function u(t){t.forEach(a)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":a(e.arcs);break;case"MultiLineString":case"Polygon":u(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(u)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}var T,D=n(7614),F=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function j(t){if(!(e=F.exec(t)))throw new Error("invalid format: "+t);var e;return new L({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function L(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function R(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function I(t){return(t=R(Math.abs(t)))?t[1]:NaN}function N(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(I(e)/3)))-I(Math.abs(t)))}function B(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,I(e)-I(t))+1}function z(t){return Math.max(0,-I(Math.abs(t)))}function $(t,e){var n=R(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}j.prototype=L.prototype,L.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var U={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>$(100*t,e),r:$,s:function(t,e){var n=R(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(T=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+R(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function V(t){return t}var Z,W,q,G=Array.prototype.map,H=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function X(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?V:(e=G.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],s=0,a=e[0],u=0;i>0&&a>0&&(u+a+1>r&&(a=Math.max(1,r-u)),o.push(t.substring(i-=a,i+a)),!((u+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?V:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(G.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"\u2212":t.minus+"",l=void 0===t.nan?"NaN":t.nan+"";function f(t){var e=(t=j(t)).fill,n=t.align,f=t.sign,h=t.symbol,d=t.zero,p=t.width,g=t.comma,m=t.precision,y=t.trim,v=t.type;"n"===v?(g=!0,v="g"):U[v]||(void 0===m&&(m=12),y=!0,v="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var b="$"===h?i:"#"===h&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===h?o:/[%p]/.test(v)?u:"",w=U[v],_=/[defgprs%]/.test(v);function E(t){var i,o,u,h=b,E=x;if("c"===v)E=w(t)+E,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?l:w(Math.abs(t),m),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),A&&0===+t&&"+"!==f&&(A=!1),h=(A?"("===f?f:c:"-"===f||"("===f?"":f)+h,E=("s"===v?H[8+T/3]:"")+E+(A&&"("===f?")":""),_)for(i=-1,o=t.length;++i<o;)if(48>(u=t.charCodeAt(i))||u>57){E=(46===u?s+t.slice(i+1):t.slice(i))+E,t=t.slice(0,i);break}}g&&!d&&(t=r(t,1/0));var O=h.length+t.length+E.length,S=O<p?new Array(p-O+1).join(e):"";switch(g&&d&&(t=r(S+t,S.length?p-E.length:1/0),S=""),n){case"<":t=h+t+E+S;break;case"=":t=h+S+t+E;break;case"^":t=S.slice(0,O=S.length>>1)+h+t+E+S.slice(O);break;default:t=S+h+t+E}return a(t)}return m=void 0===m?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),E.toString=function(){return t+""},E}return{format:f,formatPrefix:function(t,e){var n=f(((t=j(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(I(e)/3))),i=Math.pow(10,-r),o=H[8+r/3];return function(t){return n(i*t)+o}}}}!function(t){Z=X(t),W=Z.format,q=Z.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});var Y=new Date,K=new Date;function J(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var s,a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r)||!(o>0))return a;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<r);return a},i.filter=function(n){return J((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return Y.setTime(+e),K.setTime(+r),t(Y),t(K),Math.floor(n(Y,K))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t===0}:function(e){return i.count(0,e)%t===0}):i:null}),i}const Q=1e3,tt=6e4,et=36e5,nt=864e5,rt=6048e5,it=2592e6,ot=31536e6;var st=J((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*tt)/nt),(t=>t.getDate()-1)),at=st;st.range;function ut(t){return J((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*tt)/rt}))}var ct=ut(0),lt=ut(1),ft=ut(2),ht=ut(3),dt=ut(4),pt=ut(5),gt=ut(6),mt=(ct.range,lt.range,ft.range,ht.range,dt.range,pt.range,gt.range,J((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/nt}),(function(t){return t.getUTCDate()-1}))),yt=mt;mt.range;function vt(t){return J((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/rt}))}var bt=vt(0),xt=vt(1),wt=vt(2),_t=vt(3),Et=vt(4),At=vt(5),Ot=vt(6),St=(bt.range,xt.range,wt.range,_t.range,Et.range,At.range,Ot.range,J((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()})));St.every=function(t){return isFinite(t=Math.floor(t))&&t>0?J((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var Ct=St,Mt=(St.range,J((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()}))),Pt=Mt,kt=(Mt.range,J((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Q-t.getMinutes()*tt)}),(function(t,e){t.setTime(+t+e*et)}),(function(t,e){return(e-t)/et}),(function(t){return t.getHours()}))),Tt=kt,Dt=(kt.range,J((function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Q)}),(function(t,e){t.setTime(+t+e*tt)}),(function(t,e){return(e-t)/tt}),(function(t){return t.getMinutes()}))),Ft=Dt,jt=(Dt.range,J((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+e*Q)}),(function(t,e){return(e-t)/Q}),(function(t){return t.getUTCSeconds()}))),Lt=jt,Rt=(jt.range,J((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t})));Rt.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?J((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):Rt:null};var It=Rt,Nt=(Rt.range,J((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()})));Nt.every=function(t){return isFinite(t=Math.floor(t))&&t>0?J((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var Bt=Nt,zt=(Nt.range,J((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()}))),$t=zt,Ut=(zt.range,J((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+e*et)}),(function(t,e){return(e-t)/et}),(function(t){return t.getUTCHours()}))),Vt=Ut,Zt=(Ut.range,J((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+e*tt)}),(function(t,e){return(e-t)/tt}),(function(t){return t.getUTCMinutes()}))),Wt=Zt,qt=(Zt.range,n(9173));const Gt="year",Ht="quarter",Xt="month",Yt="week",Kt="date",Jt="day",Qt="dayofyear",te="hours",ee="minutes",ne="seconds",re="milliseconds",ie=[Gt,Ht,Xt,Yt,Kt,Jt,Qt,te,ee,ne,re],oe=ie.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function se(t){const e=(0,g.IX)(t).slice(),n={};e.length||(0,g.vU)("Missing time unit."),e.forEach((t=>{(0,g.nr)(oe,t)?n[t]=1:(0,g.vU)("Invalid time unit: ".concat(t,"."))}));return(n[Yt]||n[Jt]?1:0)+(n[Ht]||n[Xt]||n[Kt]?1:0)+(n[Qt]?1:0)>1&&(0,g.vU)("Incompatible time units: ".concat(t)),e.sort(((t,e)=>oe[t]-oe[e])),e}const ae={[Gt]:"%Y ",[Ht]:"Q%q ",[Xt]:"%b ",[Kt]:"%d ",[Yt]:"W%U ",[Jt]:"%a ",[Qt]:"%j ",[te]:"%H:00",[ee]:"00:%M",[ne]:":%S",[re]:".%L",["".concat(Gt,"-").concat(Xt)]:"%Y-%m ",["".concat(Gt,"-").concat(Xt,"-").concat(Kt)]:"%Y-%m-%d ",["".concat(te,"-").concat(ee)]:"%H:%M"};function ue(t,e){const n=(0,g.l7)({},ae,e),r=se(t),i=r.length;let o,s,a="",u=0;for(u=0;u<i;)for(o=r.length;o>u;--o)if(s=r.slice(u,o).join("-"),null!=n[s]){a+=n[s],u=o;break}return a.trim()}const ce=new Date;function le(t){return ce.setFullYear(t),ce.setMonth(0),ce.setDate(1),ce.setHours(0,0,0,0),ce}function fe(t){return de(new Date(t))}function he(t){return pe(new Date(t))}function de(t){return at.count(le(t.getFullYear())-1,t)}function pe(t){return ct.count(le(t.getFullYear())-1,t)}function ge(t){return le(t).getDay()}function me(t,e,n,r,i,o,s){if(0<=t&&t<100){const a=new Date(-1,e,n,r,i,o,s);return a.setFullYear(t),a}return new Date(t,e,n,r,i,o,s)}function ye(t){return be(new Date(t))}function ve(t){return xe(new Date(t))}function be(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return yt.count(e-1,t)}function xe(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return bt.count(e-1,t)}function we(t){return ce.setTime(Date.UTC(t,0,1)),ce.getUTCDay()}function _e(t,e,n,r,i,o,s){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,s));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,s))}function Ee(t,e,n,r,i){const o=e||1,s=(0,g.fj)(t),a=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===s&&o,e),u=new Date,c=(0,g.Rg)(t),l=c[Gt]?a(Gt):(0,g.a9)(2012),f=c[Xt]?a(Xt):c[Ht]?a(Ht):g.bM,h=c[Yt]&&c[Jt]?a(Jt,1,Yt+Jt):c[Yt]?a(Yt,1):c[Jt]?a(Jt,1):c[Kt]?a(Kt,1):c[Qt]?a(Qt,1):g.kX,d=c[te]?a(te):g.bM,p=c[ee]?a(ee):g.bM,m=c[ne]?a(ne):g.bM,y=c[re]?a(re):g.bM;return function(t){u.setTime(+t);const e=l(u);return i(e,f(u),h(u,e),d(u),p(u),m(u),y(u))}}function Ae(t,e,n){return e+7*t-(n+6)%7}const Oe={[Gt]:t=>t.getFullYear(),[Ht]:t=>Math.floor(t.getMonth()/3),[Xt]:t=>t.getMonth(),[Kt]:t=>t.getDate(),[te]:t=>t.getHours(),[ee]:t=>t.getMinutes(),[ne]:t=>t.getSeconds(),[re]:t=>t.getMilliseconds(),[Qt]:t=>de(t),[Yt]:t=>pe(t),[Yt+Jt]:(t,e)=>Ae(pe(t),t.getDay(),ge(e)),[Jt]:(t,e)=>Ae(1,t.getDay(),ge(e))},Se={[Ht]:t=>3*t,[Yt]:(t,e)=>Ae(t,0,ge(e))};function Ce(t,e){return Ee(t,e||1,Oe,Se,me)}const Me={[Gt]:t=>t.getUTCFullYear(),[Ht]:t=>Math.floor(t.getUTCMonth()/3),[Xt]:t=>t.getUTCMonth(),[Kt]:t=>t.getUTCDate(),[te]:t=>t.getUTCHours(),[ee]:t=>t.getUTCMinutes(),[ne]:t=>t.getUTCSeconds(),[re]:t=>t.getUTCMilliseconds(),[Qt]:t=>be(t),[Yt]:t=>xe(t),[Jt]:(t,e)=>Ae(1,t.getUTCDay(),we(e)),[Yt+Jt]:(t,e)=>Ae(xe(t),t.getUTCDay(),we(e))},Pe={[Ht]:t=>3*t,[Yt]:(t,e)=>Ae(t,0,we(e))};function ke(t,e){return Ee(t,e||1,Me,Pe,_e)}const Te={[Gt]:Ct,[Ht]:Pt.every(3),[Xt]:Pt,[Yt]:ct,[Kt]:at,[Jt]:at,[Qt]:at,[te]:Tt,[ee]:Ft,[ne]:Lt,[re]:It},De={[Gt]:Bt,[Ht]:$t.every(3),[Xt]:$t,[Yt]:bt,[Kt]:yt,[Jt]:yt,[Qt]:yt,[te]:Vt,[ee]:Wt,[ne]:Lt,[re]:It};function Fe(t){return Te[t]}function je(t){return De[t]}function Le(t,e,n){return t?t.offset(e,n):void 0}function Re(t,e,n){return Le(Fe(t),e,n)}function Ie(t,e,n){return Le(je(t),e,n)}function Ne(t,e,n,r){return t?t.range(e,n,r):void 0}function Be(t,e,n,r){return Ne(Fe(t),e,n,r)}function ze(t,e,n,r){return Ne(je(t),e,n,r)}const $e=1e3,Ue=6e4,Ve=36e5,Ze=864e5,We=2592e6,qe=31536e6,Ge=[Gt,Xt,Kt,te,ee,ne,re],He=Ge.slice(0,-1),Xe=He.slice(0,-1),Ye=Xe.slice(0,-1),Ke=Ye.slice(0,-1),Je=[Gt,Xt],Qe=[Gt],tn=[[He,1,$e],[He,5,5e3],[He,15,15e3],[He,30,3e4],[Xe,1,Ue],[Xe,5,3e5],[Xe,15,9e5],[Xe,30,18e5],[Ye,1,Ve],[Ye,3,108e5],[Ye,6,216e5],[Ye,12,432e5],[Ke,1,Ze],[[Gt,Yt],1,6048e5],[Je,1,We],[Je,3,7776e6],[Qe,1,qe]];function en(t){const e=t.extent,n=t.maxbins||40,r=Math.abs((0,g.yP)(e))/n;let i,o,s=(0,qt.Z)((t=>t[2])).right(tn,r);return s===tn.length?(i=Qe,o=(0,D.ly)(e[0]/qe,e[1]/qe,n)):s?(s=tn[r/tn[s-1][2]<tn[s][2]/r?s-1:s],i=s[0],o=s[1]):(i=Ge,o=Math.max((0,D.ly)(e[0],e[1],n),1)),{units:i,step:o}}function nn(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function rn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function on(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function sn(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,s=t.shortDays,a=t.months,u=t.shortMonths,c=vn(i),l=bn(i),f=vn(o),h=bn(o),d=vn(s),p=bn(s),g=vn(a),m=bn(a),y=vn(u),v=bn(u),b={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:zn,e:zn,f:Wn,g:nr,G:ir,H:$n,I:Un,j:Vn,L:Zn,m:qn,M:Gn,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Cr,s:Mr,S:Hn,u:Xn,U:Yn,V:Jn,w:Qn,W:tr,x:null,X:null,y:er,Y:rr,Z:or,"%":Sr},x={a:function(t){return s[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:sr,e:sr,f:fr,g:_r,G:Ar,H:ar,I:ur,j:cr,L:lr,m:hr,M:dr,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Cr,s:Mr,S:pr,u:gr,U:mr,V:vr,w:br,W:xr,x:null,X:null,y:wr,Y:Er,Z:Or,"%":Sr},w={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.w=h.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=v.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=g.exec(e.slice(n));return r?(t.m=m.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return A(t,e,n,r)},d:kn,e:kn,f:Rn,g:Sn,G:On,H:Dn,I:Dn,j:Tn,L:Ln,m:Pn,M:Fn,p:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.p=l.get(r[0].toLowerCase()),n+r[0].length):-1},q:Mn,Q:Nn,s:Bn,S:jn,u:wn,U:_n,V:En,w:xn,W:An,x:function(t,e,r){return A(t,n,e,r)},X:function(t,e,n){return A(t,r,e,n)},y:Sn,Y:On,Z:Cn,"%":In};function _(t,e){return function(n){var r,i,o,s=[],a=-1,u=0,c=t.length;for(n instanceof Date||(n=new Date(+n));++a<c;)37===t.charCodeAt(a)&&(s.push(t.slice(u,a)),null!=(i=hn[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),s.push(r),u=a+1);return s.push(t.slice(u,a)),s.join("")}}function E(t,e){return function(n){var r,i,o=on(1900,void 0,1);if(A(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=rn(on(o.y,0,1))).getUTCDay(),r=i>4||0===i?xt.ceil(r):xt(r),r=yt.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=nn(on(o.y,0,1))).getDay(),r=i>4||0===i?lt.ceil(r):lt(r),r=at.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?rn(on(o.y,0,1)).getUTCDay():nn(on(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,rn(o)):nn(o)}}function A(t,e,n,r){for(var i,o,s=0,a=e.length,u=n.length;s<a;){if(r>=u)return-1;if(37===(i=e.charCodeAt(s++))){if(i=e.charAt(s++),!(o=w[i in hn?e.charAt(s++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=_(n,b),b.X=_(r,b),b.c=_(e,b),x.x=_(n,x),x.X=_(r,x),x.c=_(e,x),{format:function(t){var e=_(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=E(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=_(t+="",x);return e.toString=function(){return t},e},utcParse:function(t){var e=E(t+="",!0);return e.toString=function(){return t},e}}}var an,un,cn,ln,fn,hn={"-":"",_:" ",0:"0"},dn=/^\s*\d+/,pn=/^%/,gn=/[\\^$*+?|[\]().{}]/g;function mn(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function yn(t){return t.replace(gn,"\\$&")}function vn(t){return new RegExp("^(?:"+t.map(yn).join("|")+")","i")}function bn(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function xn(t,e,n){var r=dn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function wn(t,e,n){var r=dn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function _n(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function En(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function An(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function On(t,e,n){var r=dn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Sn(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Cn(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Mn(t,e,n){var r=dn.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Pn(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function kn(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Tn(t,e,n){var r=dn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Dn(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Fn(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function jn(t,e,n){var r=dn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Ln(t,e,n){var r=dn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Rn(t,e,n){var r=dn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function In(t,e,n){var r=pn.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Nn(t,e,n){var r=dn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Bn(t,e,n){var r=dn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function zn(t,e){return mn(t.getDate(),e,2)}function $n(t,e){return mn(t.getHours(),e,2)}function Un(t,e){return mn(t.getHours()%12||12,e,2)}function Vn(t,e){return mn(1+at.count(Ct(t),t),e,3)}function Zn(t,e){return mn(t.getMilliseconds(),e,3)}function Wn(t,e){return Zn(t,e)+"000"}function qn(t,e){return mn(t.getMonth()+1,e,2)}function Gn(t,e){return mn(t.getMinutes(),e,2)}function Hn(t,e){return mn(t.getSeconds(),e,2)}function Xn(t){var e=t.getDay();return 0===e?7:e}function Yn(t,e){return mn(ct.count(Ct(t)-1,t),e,2)}function Kn(t){var e=t.getDay();return e>=4||0===e?dt(t):dt.ceil(t)}function Jn(t,e){return t=Kn(t),mn(dt.count(Ct(t),t)+(4===Ct(t).getDay()),e,2)}function Qn(t){return t.getDay()}function tr(t,e){return mn(lt.count(Ct(t)-1,t),e,2)}function er(t,e){return mn(t.getFullYear()%100,e,2)}function nr(t,e){return mn((t=Kn(t)).getFullYear()%100,e,2)}function rr(t,e){return mn(t.getFullYear()%1e4,e,4)}function ir(t,e){var n=t.getDay();return mn((t=n>=4||0===n?dt(t):dt.ceil(t)).getFullYear()%1e4,e,4)}function or(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+mn(e/60|0,"0",2)+mn(e%60,"0",2)}function sr(t,e){return mn(t.getUTCDate(),e,2)}function ar(t,e){return mn(t.getUTCHours(),e,2)}function ur(t,e){return mn(t.getUTCHours()%12||12,e,2)}function cr(t,e){return mn(1+yt.count(Bt(t),t),e,3)}function lr(t,e){return mn(t.getUTCMilliseconds(),e,3)}function fr(t,e){return lr(t,e)+"000"}function hr(t,e){return mn(t.getUTCMonth()+1,e,2)}function dr(t,e){return mn(t.getUTCMinutes(),e,2)}function pr(t,e){return mn(t.getUTCSeconds(),e,2)}function gr(t){var e=t.getUTCDay();return 0===e?7:e}function mr(t,e){return mn(bt.count(Bt(t)-1,t),e,2)}function yr(t){var e=t.getUTCDay();return e>=4||0===e?Et(t):Et.ceil(t)}function vr(t,e){return t=yr(t),mn(Et.count(Bt(t),t)+(4===Bt(t).getUTCDay()),e,2)}function br(t){return t.getUTCDay()}function xr(t,e){return mn(xt.count(Bt(t)-1,t),e,2)}function wr(t,e){return mn(t.getUTCFullYear()%100,e,2)}function _r(t,e){return mn((t=yr(t)).getUTCFullYear()%100,e,2)}function Er(t,e){return mn(t.getUTCFullYear()%1e4,e,4)}function Ar(t,e){var n=t.getUTCDay();return mn((t=n>=4||0===n?Et(t):Et.ceil(t)).getUTCFullYear()%1e4,e,4)}function Or(){return"+0000"}function Sr(){return"%"}function Cr(t){return+t}function Mr(t){return Math.floor(+t/1e3)}function Pr(t){const e={};return n=>e[n]||(e[n]=t(n))}function kr(t){const e=Pr(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=j(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return r=e(n),i=e(".1f")(1)[1],t=>{const e=r(t),n=e.indexOf(i);if(n<0)return e;let o=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(e,n);const s=o<e.length?e.slice(o):"";for(;--o>n;)if("0"!==e[o]){++o;break}return e.slice(0,o)+s}}return e(n);var r,i},formatSpan(t,r,i,o){o=j(null==o?",f":o);const s=(0,D.ly)(t,r,i),a=Math.max(Math.abs(t),Math.abs(r));let u;if(null==o.precision)switch(o.type){case"s":return isNaN(u=N(s,a))||(o.precision=u),n(o,a);case"":case"e":case"g":case"p":case"r":isNaN(u=B(s,a))||(o.precision=u-("e"===o.type));break;case"f":case"%":isNaN(u=z(s))||(o.precision=u-2*("%"===o.type))}return e(o)}}}let Tr,Dr;function Fr(){return Tr=kr({format:W,formatPrefix:q})}function jr(t){return kr(X(t))}function Lr(t){return arguments.length?Tr=jr(t):Tr}function Rr(t,e,n){n=n||{},(0,g.Kn)(n)||(0,g.vU)("Invalid time multi-format specifier: ".concat(n));const r=e(ne),i=e(ee),o=e(te),s=e(Kt),a=e(Yt),u=e(Xt),c=e(Ht),l=e(Gt),f=t(n[re]||".%L"),h=t(n[ne]||":%S"),d=t(n[ee]||"%I:%M"),p=t(n[te]||"%I %p"),m=t(n[Kt]||n[Jt]||"%a %d"),y=t(n[Yt]||"%b %d"),v=t(n[Xt]||"%B"),b=t(n[Ht]||"%B"),x=t(n[Gt]||"%Y");return t=>(r(t)<t?f:i(t)<t?h:o(t)<t?d:s(t)<t?p:u(t)<t?a(t)<t?m:y:l(t)<t?c(t)<t?v:b:x)(t)}function Ir(t){const e=Pr(t.format),n=Pr(t.utcFormat);return{timeFormat:t=>(0,g.HD)(t)?e(t):Rr(e,Fe,t),utcFormat:t=>(0,g.HD)(t)?n(t):Rr(n,je,t),timeParse:Pr(t.parse),utcParse:Pr(t.utcParse)}}function Nr(){return Dr=Ir({format:un,parse:cn,utcFormat:ln,utcParse:fn})}function Br(t){return Ir(sn(t))}function zr(t){return arguments.length?Dr=Br(t):Dr}!function(t){an=sn(t),un=an.format,cn=an.parse,ln=an.utcFormat,fn=an.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Fr(),Nr();const $r=(t,e)=>(0,g.l7)({},t,e);function Ur(t,e){const n=t?jr(t):Lr(),r=e?Br(e):zr();return $r(n,r)}function Vr(t,e){const n=arguments.length;return n&&2!==n&&(0,g.vU)("defaultLocale expects either zero or two arguments."),n?$r(Lr(t),zr(e)):$r(Lr(),zr())}function Zr(){return Fr(),Nr(),Vr()}var Wr=n(8764).Buffer;const qr=/^(data:|([A-Za-z]+:)?\/\/)/,Gr=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Hr=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Xr="file://";async function Yr(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function Kr(t,e){e=(0,g.l7)({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,s;const a=Gr.test(t.replace(Hr,""));null!=t&&"string"===typeof t&&a||(0,g.vU)("Sanitize failure, invalid URI: "+(0,g.m8)(t));const u=qr.test(t);return(s=e.baseURL)&&!u&&(t.startsWith("/")||s.endsWith("/")||(t="/"+t),t=s+t),o=(i=t.startsWith(Xr))||"file"===e.mode||"http"!==e.mode&&!u&&n,i?t=t.slice(Xr.length):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function Jr(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):Qr}async function Qr(){(0,g.vU)("No file system access.")}function ti(t){return t?async function(e,n){const r=(0,g.l7)({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?(0,g.mf)(o[i])?o[i]():o.text():(0,g.vU)(o.status+""+o.statusText)}:ei}async function ei(){(0,g.vU)("No HTTP fetch method available.")}const ni=t=>!Number.isNaN(+t)&&!(t instanceof Date),ri={boolean:g.sw,integer:g.He,number:g.He,date:g.ZU,string:g.BB,unknown:g.yR},ii=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>ni(t)&&Number.isInteger(+t),ni,t=>!Number.isNaN(Date.parse(t))],oi=["boolean","integer","number","date"];function si(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=ii.length,i=ii.map(((t,e)=>e+1));for(let s,a,u=0,c=0;u<n;++u)for(a=e?t[u][e]:t[u],s=0;s<r;++s)if(i[s]&&(null!=(o=a)&&o===o)&&!ii[s](a)&&(i[s]=0,++c,c===ii.length))return"string";var o;return oi[i.reduce(((t,e)=>0===t?e:t),0)-1]}function ai(t,e){return e.reduce(((e,n)=>(e[n]=si(t,n),e)),{})}function ui(t){const e=function(e,n){const r={delimiter:t};return ci(e,n?(0,g.l7)(n,r):r)};return e.responseType="text",e}function ci(t,e){return e.header&&(t=e.header.map(g.m8).join(e.delimiter)+"\n"+t),_(e.delimiter).parse(t+"")}function li(t,e){const n=e&&e.property?(0,g.EP)(e.property):g.yR;return!(0,g.Kn)(t)||(r=t,"function"===typeof Wr&&(0,g.mf)(Wr.isBuffer)&&Wr.isBuffer(r))?n(JSON.parse(t)):function(t,e){!(0,g.kJ)(t)&&(0,g.TW)(t)&&(t=[...t]);return e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}ci.responseType="text",li.responseType="json";const fi={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function hi(t,e){let n,r,i,o;return t=li(t,e),e&&e.feature?(n=A,i=e.feature):e&&e.mesh?(n=M,i=e.mesh,o=fi[e.filter]):(0,g.vU)("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):(0,g.vU)("Invalid TopoJSON object: "+i),r&&r.features||[r]}hi.responseType="json";const di={dsv:ci,csv:ui(","),tsv:ui("\t"),json:li,topojson:hi};function pi(t,e){return arguments.length>1?(di[t]=e,this):(0,g.nr)(di,t)?di[t]:null}function gi(t){const e=pi(t);return e&&e.responseType||"text"}function mi(t,e,n,r){const i=pi((e=e||{}).type||"json");return i||(0,g.vU)("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=zr();n=n||i.timeParse,r=r||i.utcParse;let o,s,a,u,c,l,f=t.columns||Object.keys(t[0]);"auto"===e&&(e=ai(t,f));f=Object.keys(e);const h=f.map((t=>{const i=e[t];let o,s;if(i&&(i.startsWith("date:")||i.startsWith("utc:"))){o=i.split(/:(.+)?/,2),s=o[1],("'"===s[0]&&"'"===s[s.length-1]||'"'===s[0]&&'"'===s[s.length-1])&&(s=s.slice(1,-1));return("utc"===o[0]?r:n)(s)}if(!ri[i])throw Error("Illegal format pattern: "+t+":"+i);return ri[i]}));for(a=0,c=t.length,l=f.length;a<c;++a)for(o=t[a],u=0;u<l;++u)s=f[u],o[s]=h[u](o[s])}(t,e.parse,n,r),(0,g.nr)(t,"columns")&&delete t.columns,t}const yi=function(t,e){return n=>({options:n||{},sanitize:Kr,load:Yr,fileAccess:!!e,file:Jr(e),http:ti(t)})}("undefined"!==typeof fetch&&fetch,null);function vi(t){const e=t||g.yR,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function bi(t,e){try{await e(t)}catch(n){t.error(n)}}const xi=Symbol("vega_id");let wi=1;function _i(t){return!(!t||!Ei(t))}function Ei(t){return t[xi]}function Ai(t,e){return t[xi]=e,t}function Oi(t){const e=t===Object(t)?t:{data:t};return Ei(e)?e:Ai(e,wi++)}function Si(t){return Ci(t,Oi({}))}function Ci(t,e){for(const n in t)e[n]=t[n];return e}function Mi(t,e){return Ai(e,Ei(t))}function Pi(t,e){return t?e?(n,r)=>t(n,r)||Ei(e(n))-Ei(e(r)):(e,n)=>t(e,n)||Ei(e)-Ei(n):null}function ki(t){return t&&t.constructor===Ti}function Ti(){const t=[],e=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:Ti,insert(e){const n=(0,g.IX)(e),r=n.length;for(let i=0;i<r;++i)t.push(n[i]);return this},remove(t){const n=(0,g.mf)(t)?r:e,i=(0,g.IX)(t),o=i.length;for(let e=0;e<o;++e)n.push(i[e]);return this},modify(t,e,r){const o={field:e,value:(0,g.a9)(r)};return(0,g.mf)(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return(0,g.mf)(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return s=!0,this},pulse(a,u){const c={},l={};let f,h,d,p,g,m;for(f=0,h=u.length;f<h;++f)c[Ei(u[f])]=1;for(f=0,h=e.length;f<h;++f)g=e[f],c[Ei(g)]=-1;for(f=0,h=r.length;f<h;++f)p=r[f],u.forEach((t=>{p(t)&&(c[Ei(t)]=-1)}));for(f=0,h=t.length;f<h;++f)g=t[f],m=Ei(g),c[m]?c[m]=1:a.add.push(Oi(t[f]));for(f=0,h=u.length;f<h;++f)g=u[f],c[Ei(g)]<0&&a.rem.push(g);function y(t,e,n){n?t[e]=n(t):a.encode=e,s||(l[Ei(t)]=t)}for(f=0,h=n.length;f<h;++f)d=n[f],g=d.tuple,p=d.field,m=c[Ei(g)],m>0&&(y(g,p,d.value),a.modifies(p));for(f=0,h=i.length;f<h;++f)d=i[f],p=d.filter,u.forEach((t=>{p(t)&&c[Ei(t)]>0&&y(t,d.field,d.value)})),a.modifies(d.field);if(s)a.mod=e.length||r.length?u.filter((t=>c[Ei(t)]>0)):u.slice();else for(m in l)a.mod.push(l[m]);return(o||null==o&&(e.length||r.length))&&a.clean(!0),a}}}const Di="_:mod:_";function Fi(){Object.defineProperty(this,Di,{writable:!0,value:{}})}Fi.prototype={set(t,e,n,r){const i=this,o=i[t],s=i[Di];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,s[e+":"+t]=-1,s[t]=-1):(o!==n||r)&&(i[t]=n,s[t]=(0,g.kJ)(n)?1+n.length:-1),i},modified(t,e){const n=this[Di];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if((0,g.kJ)(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Di]={},this}};let ji=0;const Li=new Fi;function Ri(t,e,n,r){this.id=++ji,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function Ii(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}Ri.prototype={targets(){return this._targets||(this._targets=vi(g.id))},set(t){return this.value!==t?(this.value=t,1):0},skip:Ii(1),modified:Ii(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new Fi,i=this._argops=this._argops||[],o=[];let s,a,u,c;const l=(t,n,s)=>{s instanceof Ri?(s!==this&&(e&&s.targets().add(this),o.push(s)),i.push({op:s,name:t,index:n})):r.set(t,n,s)};for(s in t)if(a=t[s],"pulse"===s)(0,g.IX)(a).forEach((t=>{t instanceof Ri?t!==this&&(t.targets().add(this),o.push(t)):(0,g.vU)("Pulse parameters must be operator instances.")})),this.source=a;else if((0,g.kJ)(a))for(r.set(s,-1,Array(u=a.length)),c=0;c<u;++c)l(s,c,a[c]);else l(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||Li,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let Ni=0;function Bi(t,e,n){this.id=++Ni,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function zi(t,e,n){return new Bi(t,e,n)}Bi.prototype={_filter:g.yb,_apply:g.yR,targets(){return this._targets||(this._targets=vi(g.id))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=zi(t);return this.targets().add(e),e},apply(t){const e=zi(null,t);return this.targets().add(e),e},merge(){const t=zi();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=zi();return this.targets().add(zi(null,null,(0,g.Ds)(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(zi(null,null,(()=>n=!0))),e.targets().add(zi(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=g.yb,this._targets=null}};const $i={skip:!0};function Ui(t,e,n,r,i,o){const s=(0,g.l7)({},o,$i);let a,u;(0,g.mf)(n)||(n=(0,g.a9)(n)),void 0===r?a=e=>t.touch(n(e)):(0,g.mf)(r)?(u=new Ri(null,r,i,!1),a=e=>{u.evaluate(e);const r=n(e),i=u.value;ki(i)?t.pulse(r,i,o):t.update(r,i,s)}):a=e=>t.update(n(e),r,s),e.apply(a)}function Vi(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const s=o||{},a=new Ri(null,function(t,e){return e=(0,g.mf)(e)?e:(0,g.a9)(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);a.modified(s.force),a.rank=e.rank,e.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),t.connect(n,[a]))}}const Zi={};function Wi(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function qi(t,e){const n=[];return(0,g.FP)(t,e,(t=>n.push(t))),n}function Gi(t,e){const n={};return t.visit(e,(t=>{n[Ei(t)]=1})),t=>n[Ei(t)]?null:t}function Hi(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function Xi(t,e,n,r){const i=this,o=n.length;let s=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(let a=0;a<o;++a){const t=n[a];if(t.stamp===e){if(t.fields){const e=i.fields||(i.fields={});for(const n in t.fields)e[n]=1}t.changed(i.ADD)&&(s|=i.ADD),t.changed(i.REM)&&(s|=i.REM),t.changed(i.MOD)&&(s|=i.MOD)}}this.changes=s}function Yi(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}Wi.prototype={StopPropagation:Zi,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new Wi(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Wi(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,Gi(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return(0,g.kJ)(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?(0,g.kJ)(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=Hi(n.addF,e)),2&t&&(n.remF=Hi(n.remF,e)),4&t&&(n.modF=Hi(n.modF,e)),16&t&&(n.srcF=Hi(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=qi(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=qi(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=qi(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return(0,g.FP)(n.source,n.srcF,r),n;1&t&&(0,g.FP)(n.add,n.addF,r),2&t&&(0,g.FP)(n.rem,n.remF,r),4&t&&(0,g.FP)(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||(t?(0,g.FP)(i,Gi(n,5),r):(0,g.FP)(i,n.srcF,r))}return n}},(0,g.XW)(Xi,Wi,{fork(t){const e=new Wi(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?(0,g.kJ)(t)?t.some((t=>n[t])):n[t]:0},filter(){(0,g.vU)("MultiPulse does not support filtering.")},materialize(){(0,g.vU)("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const Ki={skip:!1,force:!1};function Ji(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Qi(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,o=t[e];let s,a=1+(e<<1);for(;a<i;)s=a+1,s<i&&n(t[a],t[s])>=0&&(a=s),t[e]=t[a],a=1+((e=a)<<1);t[e]=o,Qi(t,r,e,n)}(e,0,t)):r=n,r}}}function Qi(t,e,n,r){let i,o;const s=t[n];for(;n>e&&(o=n-1>>1,i=t[o],r(s,i)<0);)t[n]=i,n=o;return t[n]=s}function to(){this.logger((0,g.kg)()),this.logLevel(g.jj),this._clock=0,this._rank=0,this._locale=Vr();try{this._loader=yi()}catch(t){}this._touched=vi(g.id),this._input={},this._pulse=null,this._heap=Ji(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function eo(t){return function(){return this._log[t].apply(this,arguments)}}function no(t,e){Ri.call(this,t,null,e)}to.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:eo("error"),warn:eo("warn"),info:eo("info"),debug:eo("debug"),logLevel:eo("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof Ri?i=t:t&&t.prototype instanceof Ri?i=new t:(0,g.mf)(t)?i=new Ri(null,t):(o=0,i=new Ri(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&(0,g.vU)("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||Ki);const r=new Wi(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||Ki;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||Ki;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:Ti,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return mi(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0===--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(g.yb).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:gi(e&&e.type)});try{r=n.parse(r,e)}catch(o){i=-2,n.warn("Data ingestion failed",t,o)}}catch(o){i=-1,n.warn("Loading failed",t,o)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,o=zi(n,r),s=function(t){t.dataflow=i;try{o.receive(t)}catch(e){i.error(e)}finally{i.run()}};let a;a="string"===typeof t&&"undefined"!==typeof document?document.querySelectorAll(t):(0,g.IX)(t);const u=a.length;for(let c=0;c<u;++c)a[c].addEventListener(e,s);return o},on:function(t,e,n,r,i){return(t instanceof Ri?Vi:Ui)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return Yi(r);if(r._pending&&await r._pending,e&&await bi(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new Wi(r,o,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=vi(g.id);let s,a,u,c=0;try{for(;r._heap.size()>0;)s=r._heap.pop(),s.rank===s.qrank?(a=s.run(r._getPulse(s,t)),a.then?a=await a:a.async&&(i.push(a.async),a=Zi),a!==Zi&&s._targets&&s._targets.forEach((t=>r._enqueue(t))),++c):r._enqueue(s,!0)}catch(l){r._heap.clear(),u=l}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${c} operators`),u&&(r._postrun=[],r.error(u)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await bi(r,t[e].callback)}return n&&await bi(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(l){r.error(l)}}))})))),r},run:function(t,e,n){return this._pulse?Yi(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&(0,g.kJ)(n)?new Xi(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){if(e&&e.stamp===t.stamp)return e;t=t.fork(),e&&e!==Zi&&(t.source=e.source);return t}(this._pulse,n&&n.pulse)}},(0,g.XW)(no,Ri,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const ro={};function io(t){const e=oo(t);return e&&e.Definition||null}function oo(t){return t=t&&t.toLowerCase(),(0,g.nr)(ro,t)?ro[t]:null}var so=n(1077);function ao(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function uo(t,e){let n;if(void 0===e)for(const r of t)null!=r&&(n>r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function co(t,e,n=0,r=t.length-1,i=so.Z){for(;r>n;){if(r-n>600){const o=r-n+1,s=e-n+1,a=Math.log(o),u=.5*Math.exp(2*a/3),c=.5*Math.sqrt(a*u*(o-u)/o)*(s-o/2<0?-1:1);co(t,e,Math.max(n,Math.floor(e-s*u/o+c)),Math.min(r,Math.floor(e+(o-s)*u/o+c)),i)}const o=t[e];let s=n,a=r;for(lo(t,n,e),i(t[r],o)>0&&lo(t,n,r);s<a;){for(lo(t,s,a),++s,--a;i(t[s],o)<0;)++s;for(;i(t[a],o)>0;)--a}0===i(t[n],o)?lo(t,n,a):(++a,lo(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function lo(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var fo=n(2921);function ho(t,e,n){if(r=(t=Float64Array.from((0,fo.K)(t,n))).length){if((e=+e)<=0||r<2)return uo(t);if(e>=1)return ao(t);var r,i=(r-1)*e,o=Math.floor(i),s=ao(co(t,o).subarray(0,o+1));return s+(uo(t.subarray(o+1))-s)*(i-o)}}function po(t,e,n=fo.Z){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t);return s+(+n(t[o+1],o+1,t)-s)*(i-o)}}function go(t,e){return ho(t,.5,e)}function*mo(t,e){if(null==e)for(let n of t)null!=n&&""!==n&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function yo(t,e,n){const r=Float64Array.from(mo(t,n));return r.sort(so.Z),e.map((t=>po(r,t)))}function vo(t,e){return yo(t,[.25,.5,.75],e)}function bo(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let s of t)null!=s&&(s=+s)>=s&&(n=s-i,i+=n/++r,o+=n*(s-i));else{let s=-1;for(let a of t)null!=(a=e(a,++s,t))&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=vo(t,e),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function xo(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,s,a,u,c,l,f=t.extent[0],h=t.extent[1];const d=t.span||h-f||Math.abs(f)||1;if(t.step)o=t.step;else if(t.steps){for(u=d/e,c=0,l=t.steps.length;c<l&&t.steps[c]<u;++c);o=t.steps[Math.max(0,c-1)]}else{for(s=Math.ceil(Math.log(e)/r),a=t.minstep||0,o=Math.max(a,Math.pow(n,Math.round(Math.log(d)/r)-s));Math.ceil(d/o)>e;)o*=n;for(c=0,l=i.length;c<l;++c)u=o/i[c],u>=a&&d/u<=e&&(o=u)}u=Math.log(o);const p=u>=0?0:1+~~(-u/r),g=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(u=Math.floor(f/o+g)*o,f=f<u?u-o:u,h=Math.ceil(h/o)*o),{start:f,stop:h===f?f+o:h,step:o}}var wo=Math.random;function _o(t){wo=t}function Eo(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(mo(t,r)),o=i.length,s=e;let a,u,c,l;for(c=0,l=Array(s);c<s;++c){for(a=0,u=0;u<o;++u)a+=i[~~(wo()*o)];l[c]=a/o}return l.sort(so.Z),[ho(l,n/2),ho(l,1-n/2)]}function Ao(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let s,a=0,u=1,c=r(t[0]),l=c,f=c+e;for(;u<i;++u){if(s=r(t[u]),s>=f){for(l=(c+l)/2;a<u;++a)o[a]=l;f=s+e,c=s}l=s}for(l=(c+l)/2;a<u;++a)o[a]=l;return n?function(t,e){const n=t.length;let r,i,o=0,s=1;for(;t[o]===t[s];)++s;for(;s<n;){for(r=s+1;t[s]===t[r];)++r;if(t[s]-t[s-1]<e){for(i=s+(o+r-s-s>>1);i<s;)t[i++]=t[s];for(;i>s;)t[i--]=t[o]}o=s,s=r}return t}(o,e+e/4):o}function Oo(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function So(t,e){let n,r,i;null==e&&(e=t,t=0);const o={min(t){return arguments.length?(n=t||0,i=r-n,o):n},max(t){return arguments.length?(r=t||0,i=r-n,o):r},sample:()=>n+Math.floor(i*wo()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return o.min(t).max(e)}const Co=Math.sqrt(2*Math.PI),Mo=Math.SQRT2;let Po=NaN;function ko(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(Po===Po)i=Po,Po=NaN;else{do{i=2*wo()-1,o=2*wo()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,Po=o*r}return t+i*e}function To(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*Co)}function Do(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function Fo(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*Mo*function(t){let e,n=-Math.log((1-t)*(1+t));n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0;return e*t}(2*t-1)}function jo(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>ko(n,r),pdf:t=>To(t,n,r),cdf:t=>Do(t,n,r),icdf:t=>Fo(t,n,r)};return i.mean(t).stdev(e)}function Lo(t,e){const n=jo();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=bo(t)),i):e},sample:()=>t[~~(wo()*r)]+e*n.sample(),pdf(i){let o=0,s=0;for(;s<r;++s)o+=n.pdf((i-t[s])/e);return o/e/r},cdf(i){let o=0,s=0;for(;s<r;++s)o+=n.cdf((i-t[s])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function Ro(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+ko()*e)}function Io(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*Co*t)}function No(t,e,n){return Do(Math.log(t),e,n)}function Bo(t,e,n){return Math.exp(Fo(t,e,n))}function zo(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Ro(n,r),pdf:t=>Io(t,n,r),cdf:t=>No(t,n,r),icdf:t=>Bo(t,n,r)};return i.mean(t).stdev(e)}function $o(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=wo();let i=t[r-1],o=n[0],s=0;for(;s<r-1;o+=n[++s])if(e<o){i=t[s];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)}function Uo(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*wo()}function Vo(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function Zo(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function Wo(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function qo(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>Uo(n,r),pdf:t=>Vo(t,n,r),cdf:t=>Zo(t,n,r),icdf:t=>Wo(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function Go(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]}function Ho(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,o=new Float64Array(i),s=new Float64Array(i);let a,u,c,l=0,f=0,h=0;for(c of t)o[l]=a=+e(c),s[l]=u=+n(c),++l,f+=(a-f)/l,h+=(u-h)/l;for(l=0;l<i;++l)o[l]-=f,s[l]-=h;return[o,s,f,h]}function Xo(t,e,n,r){let i,o,s=-1;for(const a of t)i=e(a),o=n(a),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++s)}function Yo(t,e,n,r,i){let o=0,s=0;return Xo(t,e,n,((t,e)=>{const n=e-i(t),a=e-r;o+=n*n,s+=a*a})),1-o/s}function Ko(t,e,n){let r=0,i=0,o=0,s=0,a=0;Xo(t,e,n,((t,e)=>{++a,r+=(t-r)/a,i+=(e-i)/a,o+=(t*e-o)/a,s+=(t*t-s)/a}));const u=Go(r,i,o,s),c=t=>u[0]+u[1]*t;return{coef:u,predict:c,rSquared:Yo(t,e,n,i,c)}}function Jo(t,e,n){let r=0,i=0,o=0,s=0,a=0;Xo(t,e,n,((t,e)=>{++a,t=Math.log(t),r+=(t-r)/a,i+=(e-i)/a,o+=(t*e-o)/a,s+=(t*t-s)/a}));const u=Go(r,i,o,s),c=t=>u[0]+u[1]*Math.log(t);return{coef:u,predict:c,rSquared:Yo(t,e,n,i,c)}}function Qo(t,e,n){const[r,i,o,s]=Ho(t,e,n);let a,u,c,l=0,f=0,h=0,d=0,p=0;Xo(t,e,n,((t,e)=>{a=r[p++],u=Math.log(e),c=a*e,l+=(e*u-l)/p,f+=(c-f)/p,h+=(c*u-h)/p,d+=(a*c-d)/p}));const[g,m]=Go(f/s,l/s,h/s,d/s),y=t=>Math.exp(g+m*(t-o));return{coef:[Math.exp(g-m*o),m],predict:y,rSquared:Yo(t,e,n,s,y)}}function ts(t,e,n){let r=0,i=0,o=0,s=0,a=0,u=0;Xo(t,e,n,((t,e)=>{const n=Math.log(t),c=Math.log(e);++u,r+=(n-r)/u,i+=(c-i)/u,o+=(n*c-o)/u,s+=(n*n-s)/u,a+=(e-a)/u}));const c=Go(r,i,o,s),l=t=>c[0]*Math.pow(t,c[1]);return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:Yo(t,e,n,a,l)}}function es(t,e,n){const[r,i,o,s]=Ho(t,e,n),a=r.length;let u,c,l,f,h=0,d=0,p=0,g=0,m=0;for(u=0;u<a;)c=r[u],l=i[u++],f=c*c,h+=(f-h)/u,d+=(f*c-d)/u,p+=(f*f-p)/u,g+=(c*l-g)/u,m+=(f*l-m)/u;const y=p-h*h,v=h*y-d*d,b=(m*h-g*d)/v,x=(g*y-m*d)/v,w=-b*h,_=t=>b*(t-=o)*t+x*t+w+s;return{coef:[w-x*o+b*o*o+s,x-2*b*o,b],predict:_,rSquared:Yo(t,e,n,s,_)}}function ns(t,e,n,r){if(1===r)return Ko(t,e,n);if(2===r)return es(t,e,n);const[i,o,s,a]=Ho(t,e,n),u=i.length,c=[],l=[],f=r+1;let h,d,p,g,m;for(h=0;h<f;++h){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],h)*o[p];for(c.push(g),m=new Float64Array(f),d=0;d<f;++d){for(p=0,g=0;p<u;++p)g+=Math.pow(i[p],h+d);m[d]=g}l.push(m)}l.push(c);const y=function(t){const e=t.length-1,n=[];let r,i,o,s,a;for(r=0;r<e;++r){for(s=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][s])&&(s=i);for(o=r;o<e+1;++o)a=t[o][r],t[o][r]=t[o][s],t[o][s]=a;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(a=0,o=i+1;o<e;++o)a+=t[o][i]*n[o];n[i]=(t[e][i]-a)/t[i][i]}return n}(l),v=t=>{t-=s;let e=a+y[0]+y[1]*t+y[2]*t*t;for(h=3;h<f;++h)e+=y[h]*Math.pow(t,h);return e};return{coef:rs(f,y,-s,a),predict:v,rSquared:Yo(t,e,n,a,v)}}function rs(t,e,n,r){const i=Array(t);let o,s,a,u;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(a=e[o],u=1,i[o]+=a,s=1;s<=o;++s)u*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*u;return i[0]+=r,i}function is(t,e,n,r){const[i,o,s,a]=Ho(t,e,n,!0),u=i.length,c=Math.max(2,~~(r*u)),l=new Float64Array(u),f=new Float64Array(u),h=new Float64Array(u).fill(1);for(let d=-1;++d<=2;){const t=[0,c-1];for(let n=0;n<u;++n){const e=i[n],r=t[0],s=t[1],a=e-i[r]>i[s]-e?r:s;let u=0,c=0,d=0,p=0,g=0;const m=1/Math.abs(i[a]-e||1);for(let t=r;t<=s;++t){const n=i[t],r=o[t],s=os(Math.abs(e-n)*m)*h[t],a=n*s;u+=s,c+=a,d+=r*s,p+=r*a,g+=n*a}const[y,v]=Go(c/u,d/u,p/u,g/u);l[n]=y+v*e,f[n]=Math.abs(o[n]-l[n]),ss(i,n+1,t)}if(2===d)break;const e=go(f);if(Math.abs(e)<1e-12)break;for(let n,r,i=0;i<u;++i)n=f[i]/(6*e),h[i]=n>=1?1e-12:(r=1-n*n)*r}return function(t,e,n,r){const i=t.length,o=[];let s,a=0,u=0,c=[];for(;a<i;++a)s=t[a]+n,c[0]===s?c[1]+=(e[a]-c[1])/++u:(u=0,c[1]+=r,c=[s,e[a]],o.push(c));return c[1]+=r,o}(i,l,s,a)}function os(t){return(t=1-t*t*t)*t*t}function ss(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const as=.5*Math.PI/180;function us(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],s=e[1],a=s-o,u=a/r,c=[i(o)],l=[];if(n===r){for(let t=1;t<r;++t)c.push(i(o+t/n*a));return c.push(i(s)),c}l.push(i(s));for(let g=n;--g>0;)l.push(i(o+g/n*a));let f=c[0],h=l[l.length-1];const d=1/a,p=function(t,e){let n=t,r=t;const i=e.length;for(let o=0;o<i;++o){const t=e[o][1];t<n&&(n=t),t>r&&(r=t)}return 1/(r-n)}(f[1],l);for(;h;){const t=i((f[0]+h[0])/2);t[0]-f[0]>=u&&cs(f,t,h,d,p)>as?l.push(t):(f=h,c.push(h),l.pop()),h=l[l.length-1]}return c}function cs(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),s=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-s)}function ls(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function fs(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function hs(t,e,n){return n||t+(e?"_"+e:"")}const ds=()=>{},ps={init:ds,add:ds,rem:ds,idx:0},gs={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},ms=Object.keys(gs);function ys(t,e){return gs[t](e)}function vs(t,e){return t.idx-e.idx}function bs(){this.valid=0,this.missing=0,this._ops.forEach((t=>t.init(this)))}function xs(t,e){null!=t&&""!==t?t===t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function ws(t,e){null!=t&&""!==t?t===t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function _s(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function Es(t,e){const n=e||g.yR,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=gs[t]())}))};return t.forEach(n),Object.values(e).sort(vs)}(t),i=t.slice().sort(vs);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=bs,o.prototype.add=xs,o.prototype.rem=ws,o.prototype.set=_s,o.prototype.get=n,o.fields=t.map((t=>t.out)),o}function As(t){this._key=t?(0,g.EP)(t):Ei,this.reset()}ms.forEach((t=>{gs[t]=function(t,e){return n=>(0,g.l7)({name:t,out:n||t},ps,e)}(t,gs[t])}));const Os=As.prototype;function Ss(t){no.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Os.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Os.add=function(t){this._add.push(t)},Os.rem=function(t){this._rem.push(t)},Os.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),s={};let a,u,c;for(a=0;a<i;++a)s[n(e[a])]=1;for(a=0,u=0;a<r;++a)s[n(c=t[a])]?s[n(c)]=0:o[u++]=c;return this._rem=[],this._add=o},Os.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;for(;--i>=0;)r=t(e[i])+"",(0,g.nr)(n,r)||(n[r]=1,++o);return o},Os.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=(0,g.dI)(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Os.argmin=function(t){return this.extent(t)[0]||{}},Os.argmax=function(t){return this.extent(t)[1]||{}},Os.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},Os.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},Os.quartile=function(t){return this._get===t&&this._q||(this._q=vo(this.values(),t),this._get=t),this._q},Os.q1=function(t){return this.quartile(t)[0]},Os.q2=function(t){return this.quartile(t)[1]},Os.q3=function(t){return this.quartile(t)[2]},Os.ci=function(t){return this._get===t&&this._ci||(this._ci=Eo(this.values(),1e3,.05,t),this._get=t),this._ci},Os.ci0=function(t){return this.ci(t)[0]},Os.ci1=function(t){return this.ci(t)[1]},Ss.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ms},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},(0,g.XW)(Ss,no,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function o(t){let e,o,s,a;for(e in t)for(s=t[e].tuple,o=0;o<i;++o)r[o][a=s[n[o]]]=a}o(t._prev),o(e),function o(s,a,u){const c=n[u],l=r[u++];for(const n in l){const r=s?s+"|"+n:n;a[c]=l[n],u<i?o(r,a,u):e[r]||t.cell(r,a)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=(0,g.IX)((0,g.Oj)(t)),i=n.length;let o,s=0;for(;s<i;++s)r[o=n[s]]||(r[o]=1,e.push(o))}this._dims=(0,g.IX)(t.groupby),this._dnames=this._dims.map((t=>{const e=(0,g.el)(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:fs(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],s=t.ops||["count"],a=t.as||[],u=o.length,c={};let l,f,h,d,p,m;for(u!==s.length&&(0,g.vU)("Unmatched number of fields and aggregate ops."),m=0;m<u;++m)l=o[m],f=s[m],null==l&&"count"!==f&&(0,g.vU)("Null aggregate field specified."),d=(0,g.el)(l),p=hs(f,d,a[m]),n.push(p),"count"!==f?(h=c[d],h||(i(l),h=c[d]=[],h.field=l,this._measures.push(h)),"count"!==f&&(this._countOnly=!1),h.push(ys(f,p))):this._counts.push(p);return this._measures=this._measures.map((t=>Es(t,t.field))),{}},cellkey:fs(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new As),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let s=0;s<i;++s)o[n[s]]=r[s](t);return e?Mi(e.tuple,o):Oi(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,o=r.length;i<o;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,s=t.rem,a=t.mod;let u,c,l,f;if(r)for(c in r)u=r[c],i&&!u.num||s.push(u.tuple);for(l=0,f=this._alen;l<f;++l)o.push(this.celltuple(e[l])),e[l]=null;for(l=0,f=this._mlen;l<f;++l)u=n[l],(0===u.num&&i?s:a).push(this.celltuple(u)),n[l]=null;return this._alen=this._mlen=0,this._prev=null,t}});function Cs(t){no.call(this,null,t)}function Ms(t,e,n){const r=t;let i=e||[],o=n||[],s={},a=0;return{add:t=>o.push(t),remove:t=>s[r(t)]=++a,size:()=>i.length,data:(t,e)=>(a&&(i=i.filter((t=>!s[r(t)])),s={},a=0),e&&t&&i.sort(t),o.length&&(i=t?(0,g.TS)(t,i,o.sort(t)):i.concat(o),o=[]),i)}}function Ps(t){no.call(this,[],t)}function ks(t){Ri.call(this,null,Ts,t)}function Ts(t){return this.value&&!t.modified()?this.value:(0,g.qu)(t.fields,t.orders)}function Ds(t){no.call(this,null,t)}function Fs(t){no.call(this,null,t)}Cs.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},(0,g.XW)(Cs,no,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,s=t.as||["bin0","bin1"],a=s[0],u=s[1];let c;return c=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified((0,g.Oj)(t.field))?e.ADD_MOD:e.ADD,e.visit(c,n?t=>{const e=r(t);t[a]=e,t[u]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[a]=r(t)),e.modifies(n?s:a)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=xo(t),r=n.step;let i,o,s=n.start,a=s+Math.ceil((n.stop-s)/r)*r;null!=(i=t.anchor)&&(o=i-(s+r*Math.floor((i-s)/r)),s+=o,a+=o);const u=function(t){let n=(0,g.He)(e(t));return null==n?null:n<s?-1/0:n>a?1/0:(n=Math.max(s,Math.min(n,a-r)),s+r*Math.floor(1e-14+(n-s)/r))};return u.start=s,u.stop=n.stop,u.step=r,this.value=(0,g.ZE)(u,(0,g.Oj)(e),t.name||"bin_"+(0,g.el)(e))}}),Ps.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},(0,g.XW)(Ps,no,{transform(t,e){const n=e.fork(e.ALL),r=Ms(Ei,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(Pi(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),(0,g.XW)(ks,Ri),Ds.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},(0,g.XW)(Ds,no,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(a(n),t.case,o)||[],u=0,c=i.length;u<c;++u)s.test(r=i[u])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,s=this._stop,a=t.field,u=t.as||["text","count"],c=n((t=>i[t]=1+(i[t]||0))),l=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,c):(e.visit(e.ADD,c),e.visit(e.REM,l)),this._finish(e,u)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],s=t.fork(t.NO_SOURCE|t.NO_FIELDS);let a,u,c;for(a in n)u=r[a],c=n[a]||0,!u&&c?(r[a]=u=Oi({}),u[i]=a,u[o]=c,s.add.push(u)):0===c?(u&&s.rem.push(u),n[a]=null,r[a]=null):u[o]!==c&&(u[o]=c,s.mod.push(u));return s.modifies(e)}}),Fs.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},(0,g.XW)(Fs,no,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],s=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,s=[],a={},u=t.length,c=0;c<u;++c)for(a[e]=o=t[c],i=0;i<u;++i)a[n]=t[i],r(a)&&(s.push(Oi(a)),(a={})[e]=o);return s}(a,i,o,t.filter||g.yb)):n.mod=a,n.source=this.value,n.modifies(r)}});const js={kde:Lo,mixture:$o,normal:jo,lognormal:zo,uniform:qo},Ls="function";function Rs(t,e){const n=t.function;(0,g.nr)(js,n)||(0,g.vU)("Unknown distribution function: "+n);const r=js[n]();for(const i in t)"field"===i?r.data((t.from||e()).map(t[i])):"distributions"===i?r[i](t[i].map((t=>Rs(t,e)))):typeof r[i]===Ls&&r[i](t[i]);return r}function Is(t){no.call(this,null,t)}const Ns=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Bs={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Ns},{name:"weights",type:"number",array:!0}]};function zs(t,e){return t?t.map(((t,n)=>e[n]||(0,g.el)(t))):null}function $s(t,e,n){const r=[],i=t=>t(u);let o,s,a,u,c,l;if(null==e)r.push(t.map(n));else for(o={},s=0,a=t.length;s<a;++s)u=t[s],c=e.map(i),l=o[c],l||(o[c]=l=[],l.dims=c,r.push(l)),l.push(n(u));return r}Is.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Ns.concat(Bs)},{name:"as",type:"string",array:!0,default:["value","density"]}]},(0,g.XW)(Is,no,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=Rs(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let s=t.method||"pdf";"pdf"!==s&&"cdf"!==s&&(0,g.vU)("Invalid density method: "+s),t.extent||r.data||(0,g.vU)("Missing density extent parameter."),s=r[s];const a=t.as||["value","density"],u=us(s,t.extent||(0,g.We)(r.data()),i,o).map((t=>{const e={};return e[a[0]]=t[0],e[a[1]]=t[1],Oi(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}});function Us(t){no.call(this,null,t)}Us.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function Vs(t){Ri.call(this,null,Zs,t),this.modified(!0)}function Zs(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:(0,g.ZE)((n=>e(n,t)),(0,g.Oj)(e),(0,g.el)(e))}function Ws(t){no.call(this,[void 0,void 0],t)}function qs(t,e){Ri.call(this,t),this.parent=e,this.count=0}function Gs(t){no.call(this,{},t),this._keys=(0,g.Xr)();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function Hs(t){Ri.call(this,null,Xs,t)}function Xs(t){return this.value&&!t.modified()?this.value:(0,g.kJ)(t.name)?(0,g.IX)(t.name).map((t=>(0,g.EP)(t))):(0,g.EP)(t.name,t.as)}function Ys(t){no.call(this,(0,g.Xr)(),t)}function Ks(t){no.call(this,[],t)}function Js(t){no.call(this,[],t)}function Qs(t){no.call(this,null,t)}function ta(t){no.call(this,[],t)}(0,g.XW)(Us,no,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=$s(e.source,t.groupby,g.yR),i=t.smooth||!1,o=t.field,s=t.step||((t,e)=>(0,g.yP)((0,g.We)(t,e))/30)(n,o),a=Pi(((t,e)=>o(t)-o(e))),u=t.as||"bin",c=r.length;let l,f=1/0,h=-1/0,d=0;for(;d<c;++d){const t=r[d].sort(a);l=-1;for(const e of Ao(t,s,i,o))e<f&&(f=e),e>h&&(h=e),t[++l][u]=e}return this.value={start:f,stop:h,step:s},e.reflow(!0).modifies(u)}}),(0,g.XW)(Vs,Ri),Ws.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},(0,g.XW)(Ws,no,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],s=n[1];if((i||null==o)&&(o=1/0,s=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=(0,g.He)(r(t));null!=e&&(e<o&&(o=e),e>s&&(s=e))})),!Number.isFinite(o)||!Number.isFinite(s)){let t=(0,g.el)(r);t&&(t=` for field "${t}"`),e.dataflow.warn(`Infinite extent${t}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}}),(0,g.XW)(qs,Ri,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),(0,g.XW)(Gs,no,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,s,a=(0,g.nr)(i,t)&&i[t];return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[t])&&s.tuple,o=n.dataflow,a=new qs(n.fork(n.NO_SOURCE),this),o.add(a).connect(e(o,t,s)),i[t]=a,this.activate(a)),a},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,s=t.modified("key"),a=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=Ei(t),n=o.get(e);void 0!==n&&(o.delete(e),a(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);o.set(Ei(t),e),a(e).add(t)})),s||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=Ei(t),n=o.get(e),i=r(t);n===i?a(i).mod(t):(o.set(e,i),a(n).rem(t),a(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{a(o.get(Ei(t))).mod(t)})),s&&e.visit(e.REFLOW,(t=>{const e=Ei(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),a(n).rem(t),a(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),(0,g.XW)(Hs,Ri),Ys.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},(0,g.XW)(Ys,no,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,s=i.rem,a=i.mod,u=t.expr;let c=!0;function l(e){const n=Ei(e),i=u(e,t),l=r.get(n);i&&l?(r.delete(n),o.push(e)):i||l?c&&i&&!l&&a.push(e):(r.set(n,1),s.push(e))}return e.visit(e.REM,(t=>{const e=Ei(t);r.has(e)?r.delete(e):s.push(t)})),e.visit(e.ADD,(e=>{u(e,t)?o.push(e):r.set(Ei(e),1)})),e.visit(e.MOD,l),t.modified()&&(c=!1,e.visit(e.REFLOW,l)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),Ks.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},(0,g.XW)(Ks,no,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=zs(r,t.as||[]),o=t.index||null,s=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),a=e.reduce(((t,e)=>Math.max(t,e.length)),0);let u,c,l,f=0;for(;f<a;++f){for(c=Si(t),u=0;u<s;++u)c[i[u]]=null==(l=e[u][f])?null:l;o&&(c[o]=f),n.add.push(c)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),Js.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},(0,g.XW)(Js,no,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(g.el),o=t.as||["key","value"],s=o[0],a=o[1],u=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,o=0;o<u;++o)e=Si(t),e[s]=i[o],e[a]=r[o](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(o)}}),Qs.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},(0,g.XW)(Qs,no,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,(e=>e[r]=n(e,t)))}}),(0,g.XW)(ta,no,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,s,a=this.value,u=t.size-a.length;if(u>0){for(i=[];--u>=0;)i.push(s=Oi(r(t))),a.push(s);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=a.slice(0,-u),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,a=a.slice(-u);return n.source=this.value=a,n}});const ea={value:"value",median:go,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let i of t)null!=i&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:uo,max:ao},na=[];function ra(t){no.call(this,[],t)}function ia(t){Ss.call(this,t)}function oa(t){no.call(this,null,t)}function sa(t){Ri.call(this,null,aa,t)}function aa(t){return this.value&&!t.modified()?this.value:(0,g.Jy)(t.fields,t.flat)}function ua(t){no.call(this,[],t),this._pending=null}function ca(t,e,n){n.forEach(Oi);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function la(t){no.call(this,{},t)}function fa(t){Ri.call(this,null,ha,t)}function ha(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,s=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>s&&(s=i[1]);return[o,s]}function da(t){Ri.call(this,null,pa,t)}function pa(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function ga(t){no.call(this,null,t)}function ma(t){Ss.call(this,t)}function ya(t){Gs.call(this,t)}function va(t){no.call(this,null,t)}function ba(t){no.call(this,null,t)}function xa(t){no.call(this,null,t)}ra.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},(0,g.XW)(ra,no,{transform(t,e){var n,r,i,o,s,a,u,c,l,f,h=e.fork(e.ALL),d=function(t){var e,n=t.method||ea.value;if(null!=ea[n])return n===ea.value?(e=void 0!==t.value?t.value:0,()=>e):ea[n];(0,g.vU)("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=(0,g.el)(t.field),y=(0,g.el)(t.key),v=(t.groupby||[]).map(g.el),b=function(t,e,n,r){var i,o,s,a,u,c,l,f,h=t=>t(f),d=[],p=r?r.slice():[],g={},m={};for(p.forEach(((t,e)=>g[t]=e+1)),a=0,l=t.length;a<l;++a)c=n(f=t[a]),u=g[c]||(g[c]=p.push(c)),(s=m[o=(i=e?e.map(h):na)+""])||(s=m[o]=[],d.push(s),s.values=i),s[u-1]=f;return d.domain=p,d}(e.source,t.groupby,t.key,t.keyvals),x=[],w=this.value,_=b.domain.length;for(s=0,c=b.length;s<c;++s)for(i=(n=b[s]).values,r=NaN,u=0;u<_;++u)if(null==n[u]){for(o=b.domain[u],f={_impute:!0},a=0,l=i.length;a<l;++a)f[v[a]]=i[a];f[y]=o,f[m]=Number.isNaN(r)?r=d(n,p):r,x.push(Oi(f))}return x.length&&(h.add=h.materialize(h.ADD).add.concat(x)),w.length&&(h.rem=h.materialize(h.REM).rem.concat(w)),this.value=x,h}}),ia.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:ms},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},(0,g.XW)(ia,Ss,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{(0,g.l7)(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),oa.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},(0,g.XW)(oa,no,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=$s(r,t.groupby,t.field),o=(t.groupby||[]).map(g.el),s=t.bandwidth,a=t.cumulative?"cdf":"pdf",u=t.as||["value","density"],c=[];let l=t.extent,f=t.steps||t.minsteps||25,h=t.steps||t.maxsteps||200;"pdf"!==a&&"cdf"!==a&&(0,g.vU)("Invalid density method: "+a),"shared"===t.resolve&&(l||(l=(0,g.We)(r,t.field)),f=h=t.steps||h),i.forEach((e=>{const n=Lo(e,s)[a],r=t.counts?e.length:1;us(n,l||(0,g.We)(e),f,h).forEach((t=>{const n={};for(let r=0;r<o.length;++r)n[o[r]]=e.dims[r];n[u[0]]=t[0],n[u[1]]=t[1]*r,c.push(Oi(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}}),(0,g.XW)(sa,Ri),(0,g.XW)(ua,no,{transform(t,e){const n=e.dataflow;if(this._pending)return ca(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return ca(this,e,n.parse(t.values,t.format));if(t.async){return{async:n.request(t.url,t.format).then((t=>(this._pending=(0,g.IX)(t.data),t=>t.touch(this))))}}return n.request(t.url,t.format).then((t=>ca(this,e,(0,g.IX)(t.data))))}}),la.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},(0,g.XW)(la,no,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,s=t.modified(),a=n.length;let u,c,l,f=s?e.SOURCE:e.ADD,h=e,d=t.as;return i?(c=i.length,a>1&&!d&&(0,g.vU)('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==a*c&&(0,g.vU)('The "as" parameter has too few output field names.'),d=d||i.map(g.el),u=function(t){for(var e,s,u=0,l=0;u<a;++u)if(null==(s=r.get(n[u](t))))for(e=0;e<c;++e,++l)t[d[l]]=o;else for(e=0;e<c;++e,++l)t[d[l]]=i[e](s)}):(d||(0,g.vU)("Missing output field names."),u=function(t){for(var e,i=0;i<a;++i)e=r.get(n[i](t)),t[d[i]]=null==e?o:e}),s?h=e.reflow(!0):(l=n.some((t=>e.modified(t.fields))),f|=l?e.MOD:0),e.visit(f,u),h.modifies(d)}}),(0,g.XW)(fa,Ri),(0,g.XW)(da,Ri),(0,g.XW)(ga,no,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),ma.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:ms,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},(0,g.XW)(ma,Ss,{_transform:Ss.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=(0,g.Oj)(n).concat((0,g.Oj)(r)),s=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(g.j2),e?i.slice(0,e):i}(n,t.limit||0,e);e.changed()&&t.set("__pivot__",null,null,!0);return{key:t.key,groupby:t.groupby,ops:s.map((()=>i)),fields:s.map((t=>function(t,e,n,r){return(0,g.ZE)((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,o))),as:s.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),(0,g.XW)(ya,Gs,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(Ei(t),n,e,t);return(t.modified("field")||r&&e.modified((0,g.Oj)(r)))&&(0,g.vU)("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(Oi(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),va.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},(0,g.XW)(va,no,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=zs(t.fields,t.as||[]),o=r?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):Ci;let s;return this.value?s=this.value:(e=e.addAll(),s=this.value={}),e.visit(e.REM,(t=>{const e=Ei(t);n.rem.push(s[e]),s[e]=null})),e.visit(e.ADD,(t=>{const e=o(t,Oi({}));s[Ei(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(o(t,s[Ei(t)]))})),n}}),(0,g.XW)(ba,no,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),xa.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function wa(t){no.call(this,null,t)}function _a(t){no.call(this,[],t),this.count=0}function Ea(t){no.call(this,null,t)}function Aa(t){no.call(this,null,t),this.modified(!0)}function Oa(t){no.call(this,null,t)}(0,g.XW)(xa,no,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=$s(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(g.el),s=[],a=t.step||.01,u=t.probs||ls(a/2,1-1e-14,a),c=u.length;return i.forEach((t=>{const e=yo(t,u);for(let n=0;n<c;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=u[n],i[r[1]]=e[n],s.push(Oi(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}}),(0,g.XW)(wa,no,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=Ei(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=Si(t);r[Ei(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[Ei(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),_a.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},(0,g.XW)(_a,no,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce(((t,e)=>(t[Ei(e)]=1,t)),{});let s=this.value,a=this.count,u=0;function c(t){let e,r;s.length<i?s.push(t):(r=~~((a+1)*wo()),r<s.length&&r>=u&&(e=s[r],o[Ei(e)]&&n.rem.push(e),s[r]=t)),++a}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=Ei(t);o[e]&&(o[e]=-1,n.rem.push(t)),--a})),s=s.filter((t=>-1!==o[Ei(t)]))),(e.rem.length||r)&&s.length<i&&e.source&&(u=a=s.length,e.visit(e.SOURCE,(t=>{o[Ei(t)]||c(t)})),u=-1),r&&s.length>i){const t=s.length-i;for(let e=0;e<t;++e)o[Ei(s[e])]=-1,n.rem.push(s[e]);s=s.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{o[Ei(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,c),(e.add.length||u<0)&&(n.add=s.filter((t=>!o[Ei(t)]))),this.count=a,this.value=n.source=s,n}}),Ea.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},(0,g.XW)(Ea,no,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=ls(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,Oi(e)})),n.add=e.add.concat(this.value),n}}),(0,g.XW)(Aa,no,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const Sa=["unit0","unit1"];function Ca(t){no.call(this,(0,g.Xr)(),t)}function Ma(t){no.call(this,null,t)}Oa.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:ie,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Sa}]},(0,g.XW)(Oa,no,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),s=(i?je:Fe)(o.unit).offset,a=t.as||Sa,u=a[0],c=a[1],l=o.step;let f=o.start||1/0,h=o.stop||-1/0,d=e.ADD;return(t.modified()||e.modified((0,g.Oj)(n)))&&(d=(e=e.reflow(!0)).SOURCE,f=1/0,h=-1/0),e.visit(d,(t=>{const e=n(t);let i,a;null==e?(t[u]=null,r&&(t[c]=null)):(t[u]=i=a=o(e),r&&(t[c]=a=s(i,l)),i<f&&(f=i),a>h&&(h=a))})),o.start=f,o.stop=h,e.modifies(r?a:u)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:en({extent:t.extent||(0,g.We)(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=se(r),s=this.value||{},a=(n?ke:Ce)(o,i);return a.unit=(0,g.fj)(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}}),(0,g.XW)(Ca,no,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let s=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),(0,g.XW)(Ma,no,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(Pi(t.sort)):e.source).map(t.field))}});const Pa={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=Pa.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||(0,g.vU)("ntile num must be greater than zero.");const n=Pa.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||(0,g.vU)("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n){if(null!=t(e[n]))return n}return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};const ka=Object.keys(Pa);function Ta(t){const e=(0,g.IX)(t.ops),n=(0,g.IX)(t.fields),r=(0,g.IX)(t.params),i=(0,g.IX)(t.as),o=this.outputs=[],s=this.windows=[],a={},u={},c=[],l=[];let f=!0;function h(t){(0,g.IX)((0,g.Oj)(t)).forEach((t=>a[t]=1))}h(t.sort),e.forEach(((t,e)=>{const a=n[e],d=(0,g.el)(a),p=hs(t,d,i[e]);if(h(a),o.push(p),(0,g.nr)(Pa,t))s.push(function(t,e,n,r){const i=Pa[t](e,n);return{init:i.init||g.bM,update:function(t,e){e[r]=i.next(t)}}}(t,n[e],r[e],p));else{if(null==a&&"count"!==t&&(0,g.vU)("Null aggregate field specified."),"count"===t)return void c.push(p);f=!1;let e=u[d];e||(e=u[d]=[],e.field=a,l.push(e)),e.push(ys(t,p))}})),(c.length||l.length)&&(this.cell=function(t,e,n){t=t.map((t=>Es(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new t[s](r);if(r.store)var a=r.data=new As;return r.add=function(t){if(r.num+=1,!n){a&&a.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){a&&a.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,s;for(a&&a.values(),i=0,s=e.length;i<s;++i)t[e[i]]=r.num;if(!n)for(i=0,s=o.length;i<s;++i)o[i].set(t)},r.init=function(){r.num=0,a&&a.reset();for(let t=0;t<i;++t)o[t].init()},r}(l,c,f)),this.inputs=Object.keys(a)}const Da=Ta.prototype;function Fa(t){no.call(this,{},t),this._mlen=0,this._mods=[]}function ja(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=t.data(n),u=a.length,c=o?(0,qt.Z)(i):null,l={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||(0,g.a9)(-1)};e.init();for(let f=0;f<u;++f)La(l,s,f,u),o&&Ra(l,c),e.update(l,a[f])}function La(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Ra(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}function Ia(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Na(t){this._context=t}function Ba(){}function za(t){this._context=t}function $a(t){this._context=t}function Ua(t,e){this._basis=new Na(t),this._beta=e}Da.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},Da.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let s;if(n){for(s=t.p0;s<t.i0;++s)n.rem(i[s]);for(s=t.p1;s<t.i1;++s)n.add(i[s]);n.set(e)}for(s=0;s<o;++s)r[s].update(t,e)},Fa.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:ka.concat(ms)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},(0,g.XW)(Fa,no,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=Pi(t.sort),i=fs(t.groupby),o=t=>this.group(i(t));let s=this.state;s&&!n||(s=this.state=new Ta(t)),n||e.modified(s.inputs)?(this.value={},e.visit(e.SOURCE,(t=>o(t).add(t)))):(e.visit(e.REM,(t=>o(t).remove(t))),e.visit(e.ADD,(t=>o(t).add(t))));for(let a=0,u=this._mlen;a<u;++a)ja(this._mods[a],s,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(s.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=Ms(Ei),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),Na.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ia(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ia(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},za.prototype={areaStart:Ba,areaEnd:Ba,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Ia(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},$a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ia(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Ua.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],s=t[n]-i,a=e[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*s),this._beta*e[u]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Va=function t(e){function n(t){return 1===e?new Na(t):new Ua(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Za(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Wa(t,e){this._context=t,this._k=(1-e)/6}Wa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Za(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Za(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var qa=function t(e){function n(t){return new Wa(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Ga(t,e){this._context=t,this._k=(1-e)/6}Ga.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Za(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ha=function t(e){function n(t){return new Ga(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Xa(t,e){this._context=t,this._k=(1-e)/6}Xa.prototype={areaStart:Ba,areaEnd:Ba,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Za(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ya=function t(e){function n(t){return new Xa(t,e)}return n.tension=function(e){return t(+e)},n}(0),Ka=Math.abs,Ja=Math.atan2,Qa=Math.cos,tu=Math.max,eu=Math.min,nu=Math.sin,ru=Math.sqrt,iu=1e-12,ou=Math.PI,su=ou/2,au=2*ou;function uu(t){return t>1?0:t<-1?ou:Math.acos(t)}function cu(t){return t>=1?su:t<=-1?-su:Math.asin(t)}function lu(t,e,n){var r=t._x1,i=t._y1,o=t._x2,s=t._y2;if(t._l01_a>iu){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>iu){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*c+t._x1*t._l23_2a-e*t._l12_2a)/l,s=(s*c+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,o,s,t._x2,t._y2)}function fu(t,e){this._context=t,this._alpha=e}fu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:lu(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var hu=function t(e){function n(t){return e?new fu(t,e):new Wa(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function du(t,e){this._context=t,this._alpha=e}du.prototype={areaStart:Ba,areaEnd:Ba,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:lu(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var pu=function t(e){function n(t){return e?new du(t,e):new Xa(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function gu(t,e){this._context=t,this._alpha=e}gu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:lu(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var mu=function t(e){function n(t){return e?new gu(t,e):new Ga(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function yu(t){this._context=t}function vu(t){return new yu(t)}function bu(t){this._context=t}function xu(t){return t<0?-1:1}function wu(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),s=(n-t._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(xu(o)+xu(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function _u(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Eu(t,e,n){var r=t._x0,i=t._y0,o=t._x1,s=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*e,o-a,s-a*n,o,s)}function Au(t){this._context=t}function Ou(t){this._context=new Su(t)}function Su(t){this._context=t}function Cu(t){this._context=t}function Mu(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function Pu(t,e){this._context=t,this._t=e}yu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},bu.prototype={areaStart:Ba,areaEnd:Ba,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},Au.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Eu(this,this._t0,_u(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Eu(this,_u(this,n=wu(this,t,e)),n);break;default:Eu(this,this._t0,n=wu(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Ou.prototype=Object.create(Au.prototype)).point=function(t,e){Au.prototype.point.call(this,e,t)},Su.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},Cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=Mu(t),i=Mu(e),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Pu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const ku=Math.PI,Tu=2*ku,Du=1e-6,Fu=Tu-Du;function ju(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Lu(){return new ju}ju.prototype=Lu.prototype={constructor:ju,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,s=this._y1,a=n-t,u=r-e,c=o-t,l=s-e,f=c*c+l*l;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(f>Du)if(Math.abs(l*a-u*c)>Du&&i){var h=n-o,d=r-s,p=a*a+u*u,g=h*h+d*d,m=Math.sqrt(p),y=Math.sqrt(f),v=i*Math.tan((ku-Math.acos((p+f-g)/(2*m*y)))/2),b=v/y,x=v/m;Math.abs(b-1)>Du&&(this._+="L"+(t+b*c)+","+(e+b*l)),this._+="A"+i+","+i+",0,0,"+ +(l*h>c*d)+","+(this._x1=t+x*a)+","+(this._y1=e+x*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,o){t=+t,e=+e,o=!!o;var s=(n=+n)*Math.cos(r),a=n*Math.sin(r),u=t+s,c=e+a,l=1^o,f=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+c:(Math.abs(this._x1-u)>Du||Math.abs(this._y1-c)>Du)&&(this._+="L"+u+","+c),n&&(f<0&&(f=f%Tu+Tu),f>Fu?this._+="A"+n+","+n+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+n+","+n+",0,1,"+l+","+(this._x1=u)+","+(this._y1=c):f>Du&&(this._+="A"+n+","+n+",0,"+ +(f>=ku)+","+l+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Ru=Lu;function Iu(t){return function(){return t}}function Nu(t){return t.innerRadius}function Bu(t){return t.outerRadius}function zu(t){return t.startAngle}function $u(t){return t.endAngle}function Uu(t){return t&&t.padAngle}function Vu(t,e,n,r,i,o,s,a){var u=n-t,c=r-e,l=s-i,f=a-o,h=f*u-l*c;if(!(h*h<iu))return[t+(h=(l*(e-o)-f*(t-i))/h)*u,e+h*c]}function Zu(t,e,n,r,i,o,s){var a=t-n,u=e-r,c=(s?o:-o)/ru(a*a+u*u),l=c*u,f=-c*a,h=t+l,d=e+f,p=n+l,g=r+f,m=(h+p)/2,y=(d+g)/2,v=p-h,b=g-d,x=v*v+b*b,w=i-o,_=h*g-p*d,E=(b<0?-1:1)*ru(tu(0,w*w*x-_*_)),A=(_*b-v*E)/x,O=(-_*v-b*E)/x,S=(_*b+v*E)/x,C=(-_*v+b*E)/x,M=A-m,P=O-y,k=S-m,T=C-y;return M*M+P*P>k*k+T*T&&(A=S,O=C),{cx:A,cy:O,x01:-l,y01:-f,x11:A*(i/w-1),y11:O*(i/w-1)}}Array.prototype.slice;function Wu(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}function qu(t){return t[0]}function Gu(t){return t[1]}function Hu(t,e){var n=Iu(!0),r=null,i=vu,o=null;function s(s){var a,u,c,l=(s=Wu(s)).length,f=!1;for(null==r&&(o=i(c=Ru())),a=0;a<=l;++a)!(a<l&&n(u=s[a],a,s))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(u,a,s),+e(u,a,s));if(c)return o=null,c+""||null}return t="function"===typeof t?t:void 0===t?qu:Iu(t),e="function"===typeof e?e:void 0===e?Gu:Iu(e),s.x=function(e){return arguments.length?(t="function"===typeof e?e:Iu(+e),s):t},s.y=function(t){return arguments.length?(e="function"===typeof t?t:Iu(+t),s):e},s.defined=function(t){return arguments.length?(n="function"===typeof t?t:Iu(!!t),s):n},s.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),s):i},s.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),s):r},s}function Xu(t,e,n){var r=null,i=Iu(!0),o=null,s=vu,a=null;function u(u){var c,l,f,h,d,p=(u=Wu(u)).length,g=!1,m=new Array(p),y=new Array(p);for(null==o&&(a=s(d=Ru())),c=0;c<=p;++c){if(!(c<p&&i(h=u[c],c,u))===g)if(g=!g)l=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),f=c-1;f>=l;--f)a.point(m[f],y[f]);a.lineEnd(),a.areaEnd()}g&&(m[c]=+t(h,c,u),y[c]=+e(h,c,u),a.point(r?+r(h,c,u):m[c],n?+n(h,c,u):y[c]))}if(d)return a=null,d+""||null}function c(){return Hu().defined(i).curve(s).context(o)}return t="function"===typeof t?t:void 0===t?qu:Iu(+t),e="function"===typeof e?e:Iu(void 0===e?0:+e),n="function"===typeof n?n:void 0===n?Gu:Iu(+n),u.x=function(e){return arguments.length?(t="function"===typeof e?e:Iu(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"===typeof e?e:Iu(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:Iu(+t),u):r},u.y=function(t){return arguments.length?(e="function"===typeof t?t:Iu(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"===typeof t?t:Iu(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"===typeof t?t:Iu(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"===typeof t?t:Iu(!!t),u):i},u.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),u):s},u.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),u):o},u}var Yu={draw:function(t,e){var n=Math.sqrt(e/ou);t.moveTo(n,0),t.arc(0,0,n,0,au)}},Ku=(Math.sqrt(1/3),Math.sin(ou/10)/Math.sin(7*ou/10));Math.sin(au/10),Math.cos(au/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12);function Ju(t,e){if("undefined"!==typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const Qu=()=>"undefined"!==typeof Image?Image:null;var tc=n(4355);function ec(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function nc(t,e){switch(arguments.length){case 0:break;case 1:"function"===typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"===typeof e?this.interpolator(e):this.range(e)}return this}const rc=Symbol("implicit");function ic(){var t=new Map,e=[],n=[],r=rc;function i(i){var o=i+"",s=t.get(o);if(!s){if(r!==rc)return r;t.set(o,s=e.push(i))}return n[(s-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Map;for(const r of n){const n=r+"";t.has(n)||t.set(n,e.push(r))}return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return ic(e,n).unknown(r)},ec.apply(i,arguments),i}function oc(t,e,n,r){var i,o=(0,D.ly)(t,e,n);switch((r=j(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=N(o,s))||(r.precision=i),q(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=B(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=z(o))||(r.precision=i-2*("%"===r.type))}return W(r)}function sc(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function ac(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function uc(){}var cc=.7,lc=1/cc,fc="\\s*([+-]?\\d+)\\s*",hc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",dc="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",pc=/^#([0-9a-f]{3,8})$/,gc=new RegExp("^rgb\\("+[fc,fc,fc]+"\\)$"),mc=new RegExp("^rgb\\("+[dc,dc,dc]+"\\)$"),yc=new RegExp("^rgba\\("+[fc,fc,fc,hc]+"\\)$"),vc=new RegExp("^rgba\\("+[dc,dc,dc,hc]+"\\)$"),bc=new RegExp("^hsl\\("+[hc,dc,dc]+"\\)$"),xc=new RegExp("^hsla\\("+[hc,dc,dc,hc]+"\\)$"),wc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function _c(){return this.rgb().formatHex()}function Ec(){return this.rgb().formatRgb()}function Ac(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=pc.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?Oc(e):3===n?new Pc(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Sc(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Sc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=gc.exec(t))?new Pc(e[1],e[2],e[3],1):(e=mc.exec(t))?new Pc(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=yc.exec(t))?Sc(e[1],e[2],e[3],e[4]):(e=vc.exec(t))?Sc(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=bc.exec(t))?Fc(e[1],e[2]/100,e[3]/100,1):(e=xc.exec(t))?Fc(e[1],e[2]/100,e[3]/100,e[4]):wc.hasOwnProperty(t)?Oc(wc[t]):"transparent"===t?new Pc(NaN,NaN,NaN,0):null}function Oc(t){return new Pc(t>>16&255,t>>8&255,255&t,1)}function Sc(t,e,n,r){return r<=0&&(t=e=n=NaN),new Pc(t,e,n,r)}function Cc(t){return t instanceof uc||(t=Ac(t)),t?new Pc((t=t.rgb()).r,t.g,t.b,t.opacity):new Pc}function Mc(t,e,n,r){return 1===arguments.length?Cc(t):new Pc(t,e,n,null==r?1:r)}function Pc(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function kc(){return"#"+Dc(this.r)+Dc(this.g)+Dc(this.b)}function Tc(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Dc(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Fc(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Rc(t,e,n,r)}function jc(t){if(t instanceof Rc)return new Rc(t.h,t.s,t.l,t.opacity);if(t instanceof uc||(t=Ac(t)),!t)return new Rc;if(t instanceof Rc)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,u=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=u<.5?o+i:2-o-i,s*=60):a=u>0&&u<1?0:s,new Rc(s,a,u,t.opacity)}function Lc(t,e,n,r){return 1===arguments.length?jc(t):new Rc(t,e,n,null==r?1:r)}function Rc(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Ic(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Nc(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}function Bc(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],s=r>0?t[r-1]:2*i-o,a=r<e-1?t[r+2]:2*o-i;return Nc((n-r/e)*e,s,i,o,a)}}function zc(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],s=t[(r+1)%e],a=t[(r+2)%e];return Nc((n-r/e)*e,i,o,s,a)}}sc(uc,Ac,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:_c,formatHex:_c,formatHsl:function(){return jc(this).formatHsl()},formatRgb:Ec,toString:Ec}),sc(Pc,Mc,ac(uc,{brighter:function(t){return t=null==t?lc:Math.pow(lc,t),new Pc(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?cc:Math.pow(cc,t),new Pc(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:kc,formatHex:kc,formatRgb:Tc,toString:Tc})),sc(Rc,Lc,ac(uc,{brighter:function(t){return t=null==t?lc:Math.pow(lc,t),new Rc(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?cc:Math.pow(cc,t),new Rc(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Pc(Ic(t>=240?t-240:t+120,i,r),Ic(t,i,r),Ic(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var $c=t=>()=>t;function Uc(t,e){return function(n){return t+n*e}}function Vc(t,e){var n=e-t;return n?Uc(t,n>180||n<-180?n-360*Math.round(n/360):n):$c(isNaN(t)?e:t)}function Zc(t){return 1===(t=+t)?Wc:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):$c(isNaN(e)?n:e)}}function Wc(t,e){var n=e-t;return n?Uc(t,n):$c(isNaN(t)?e:t)}var qc=function t(e){var n=Zc(e);function r(t,e){var r=n((t=Mc(t)).r,(e=Mc(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=Wc(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function Gc(t){return function(e){var n,r,i=e.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=Mc(e[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=t(o),s=t(s),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=s(t),r.b=a(t),r+""}}}var Hc=Gc(Bc),Xc=Gc(zc);function Yc(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function Kc(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Jc(t,e){return(Kc(e)?Yc:Qc)(t,e)}function Qc(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=sl(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}function tl(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function el(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function nl(t,e){var n,r={},i={};for(n in null!==t&&"object"===typeof t||(t={}),null!==e&&"object"===typeof e||(e={}),e)n in t?r[n]=sl(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}var rl=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,il=new RegExp(rl.source,"g");function ol(t,e){var n,r,i,o=rl.lastIndex=il.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=rl.exec(t))&&(r=il.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:el(n,r)})),o=il.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)a[(n=u[r]).i]=n.x(t);return a.join("")})}function sl(t,e){var n,r=typeof e;return null==e||"boolean"===r?$c(e):("number"===r?el:"string"===r?(n=Ac(e))?(e=n,qc):ol:e instanceof Ac?qc:e instanceof Date?tl:Kc(e)?Yc:Array.isArray(e)?Qc:"function"!==typeof e.valueOf&&"function"!==typeof e.toString||isNaN(e)?nl:el)(t,e)}function al(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function ul(t){return+t}var cl=[0,1];function ll(t){return t}function fl(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function hl(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=fl(i,r),o=n(s,o)):(r=fl(r,i),o=n(o,s)),function(t){return o(r(t))}}function dl(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=fl(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=(0,tc.ZP)(t,e,1,r)-1;return o[n](i[n](e))}}function pl(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function gl(){var t,e,n,r,i,o,s=cl,a=cl,u=sl,c=ll;function l(){var t=Math.min(s.length,a.length);return c!==ll&&(c=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(s[0],s[t-1])),r=t>2?dl:hl,i=o=null,f}function f(e){return null==e||isNaN(e=+e)?n:(i||(i=r(s.map(t),a,u)))(t(c(e)))}return f.invert=function(n){return c(e((o||(o=r(a,s.map(t),el)))(n)))},f.domain=function(t){return arguments.length?(s=Array.from(t,ul),l()):s.slice()},f.range=function(t){return arguments.length?(a=Array.from(t),l()):a.slice()},f.rangeRound=function(t){return a=Array.from(t),u=al,l()},f.clamp=function(t){return arguments.length?(c=!!t||ll,l()):c!==ll},f.interpolate=function(t){return arguments.length?(u=t,l()):u},f.unknown=function(t){return arguments.length?(n=t,f):n},function(n,r){return t=n,e=r,l()}}function ml(){return gl()(ll,ll)}function yl(t){var e=t.domain;return t.ticks=function(t){var n=e();return(0,D.ZP)(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return oc(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),s=0,a=o.length-1,u=o[s],c=o[a],l=10;for(c<u&&(i=u,u=c,c=i,i=s,s=a,a=i);l-- >0;){if((i=(0,D.G9)(u,c,n))===r)return o[s]=u,o[a]=c,e(o);if(i>0)u=Math.floor(u/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;u=Math.ceil(u*i)/i,c=Math.floor(c*i)/i}r=i}return t},t}function vl(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],s=t[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),t[r]=e.floor(o),t[i]=e.ceil(s),t}function bl(t){return Math.log(t)}function xl(t){return Math.exp(t)}function wl(t){return-Math.log(-t)}function _l(t){return-Math.exp(-t)}function El(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Al(t){return function(e){return-t(-e)}}function Ol(t){var e,n,r=t(bl,xl),i=r.domain,o=10;function s(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(o),n=function(t){return 10===t?El:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(o),i()[0]<0?(e=Al(e),n=Al(n),t(wl,_l)):t(bl,xl),r}return r.base=function(t){return arguments.length?(o=+t,s()):o},r.domain=function(t){return arguments.length?(i(t),s()):i()},r.ticks=function(t){var r,s=i(),a=s[0],u=s[s.length-1];(r=u<a)&&(h=a,a=u,u=h);var c,l,f,h=e(a),d=e(u),p=null==t?10:+t,g=[];if(!(o%1)&&d-h<p){if(h=Math.floor(h),d=Math.ceil(d),a>0){for(;h<=d;++h)for(l=1,c=n(h);l<o;++l)if(!((f=c*l)<a)){if(f>u)break;g.push(f)}}else for(;h<=d;++h)for(l=o-1,c=n(h);l>=1;--l)if(!((f=c*l)<a)){if(f>u)break;g.push(f)}2*g.length<p&&(g=(0,D.ZP)(a,u,p))}else g=(0,D.ZP)(h,d,Math.min(d-h,p)).map(n);return r?g.reverse():g},r.tickFormat=function(t,i){if(null==i&&(i=10===o?".0e":","),"function"!==typeof i&&(i=W(i)),t===1/0)return i;null==t&&(t=10);var s=Math.max(1,o*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*o<o-.5&&(r*=o),r<=s?i(t):""}},r.nice=function(){return i(vl(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function Sl(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Cl(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Ml(t){return t<0?-t*t:t*t}function Pl(t){var e=t(ll,ll),n=1;function r(){return 1===n?t(ll,ll):.5===n?t(Cl,Ml):t(Sl(n),Sl(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},yl(e)}function kl(){var t=Pl(gl());return t.copy=function(){return pl(t,kl()).exponent(t.exponent())},ec.apply(t,arguments),t}function Tl(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Dl(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function Fl(t){var e=1,n=t(Tl(e),Dl(e));return n.constant=function(n){return arguments.length?t(Tl(e=+n),Dl(e)):e},yl(n)}function jl(t,e,n,r,i,o){const s=[[Lt,1,Q],[Lt,5,5e3],[Lt,15,15e3],[Lt,30,3e4],[o,1,tt],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,et],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,nt],[r,2,1728e5],[n,1,rt],[e,1,it],[e,3,7776e6],[t,1,ot]];function a(e,n,r){const i=Math.abs(n-e)/r,o=(0,qt.Z)((([,,t])=>t)).right(s,i);if(o===s.length)return t.every((0,D.ly)(e/ot,n/ot,r));if(0===o)return It.every(Math.max((0,D.ly)(e,n,r),1));const[a,u]=s[i/s[o-1][2]<s[o][2]/i?o-1:o];return a.every(u)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"===typeof n.range?n:a(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o},a]}const[Ll,Rl]=jl(Bt,$t,bt,yt,Vt,Wt),[Il,Nl]=jl(Ct,Pt,ct,at,Tt,Ft);function Bl(t){return new Date(t)}function zl(t){return t instanceof Date?+t:+new Date(+t)}function $l(t,e,n,r,i,o,s,a,u,c){var l=ml(),f=l.invert,h=l.domain,d=c(".%L"),p=c(":%S"),g=c("%I:%M"),m=c("%I %p"),y=c("%a %d"),v=c("%b %d"),b=c("%B"),x=c("%Y");function w(t){return(u(t)<t?d:a(t)<t?p:s(t)<t?g:o(t)<t?m:r(t)<t?i(t)<t?y:v:n(t)<t?b:x)(t)}return l.invert=function(t){return new Date(f(t))},l.domain=function(t){return arguments.length?h(Array.from(t,zl)):h().map(Bl)},l.ticks=function(e){var n=h();return t(n[0],n[n.length-1],null==e?10:e)},l.tickFormat=function(t,e){return null==e?w:c(e)},l.nice=function(t){var n=h();return t&&"function"===typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?h(vl(n,t)):l},l.copy=function(){return pl(l,$l(t,e,n,r,i,o,s,a,u,c))},l}function Ul(){var t,e,n,r,i,o=0,s=1,a=ll,u=!1;function c(e){return null==e||isNaN(e=+e)?i:a(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}function l(t){return function(e){var n,r;return arguments.length?([n,r]=e,a=t(n,r),c):[a(0),a(1)]}}return c.domain=function(i){return arguments.length?([o,s]=i,t=r(o=+o),e=r(s=+s),n=t===e?0:1/(e-t),c):[o,s]},c.clamp=function(t){return arguments.length?(u=!!t,c):u},c.interpolator=function(t){return arguments.length?(a=t,c):a},c.range=l(sl),c.rangeRound=l(al),c.unknown=function(t){return arguments.length?(i=t,c):i},function(i){return r=i,t=i(o),e=i(s),n=t===e?0:1/(e-t),c}}function Vl(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Zl(){var t=yl(Ul()(ll));return t.copy=function(){return Vl(t,Zl())},nc.apply(t,arguments)}function Wl(){var t=Pl(Ul());return t.copy=function(){return Vl(t,Wl()).exponent(t.exponent())},nc.apply(t,arguments)}function ql(t,e){void 0===e&&(e=t,t=sl);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function Gl(){var t,e,n,r,i,o,s,a=0,u=.5,c=1,l=1,f=ll,h=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+o(t))-e)*(l*t<l*e?r:i),f(h?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,f=ql(t,[n,r,i]),d):[f(0),f(.5),f(1)]}}return d.domain=function(s){return arguments.length?([a,u,c]=s,t=o(a=+a),e=o(u=+u),n=o(c=+c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,d):[a,u,c]},d.clamp=function(t){return arguments.length?(h=!!t,d):h},d.interpolator=function(t){return arguments.length?(f=t,d):f},d.range=p(sl),d.rangeRound=p(al),d.unknown=function(t){return arguments.length?(s=t,d):s},function(s){return o=s,t=s(a),e=s(u),n=s(c),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),l=e<t?-1:1,d}}function Hl(){var t=Pl(Gl());return t.copy=function(){return Vl(t,Hl()).exponent(t.exponent())},nc.apply(t,arguments)}function Xl(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function Yl(t,e){var n=Vc(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}var Kl,Jl=180/Math.PI,Ql={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function tf(t,e,n,r,i,o){var s,a,u;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,u/=a),t*r<e*n&&(t=-t,e=-e,u=-u,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*Jl,skewX:Math.atan(u)*Jl,scaleX:s,scaleY:a}}function ef(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],u=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var u=s.push("translate(",null,e,null,n);a.push({i:u-4,x:el(t,i)},{i:u-2,x:el(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,u),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:el(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,u),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:el(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,u),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:el(t,n)},{i:a-2,x:el(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,u),o=s=null,function(t){for(var e,n=-1,r=u.length;++n<r;)a[(e=u[n]).i]=e.x(t);return a.join("")}}}var nf=ef((function(t){const e=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Ql:tf(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),rf=ef((function(t){return null==t?Ql:(Kl||(Kl=document.createElementNS("http://www.w3.org/2000/svg","g")),Kl.setAttribute("transform",t),(t=Kl.transform.baseVal.consolidate())?tf((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Ql)}),", ",")",")");function of(t){return((t=Math.exp(t))+1/t)/2}var sf=function t(e,n,r){function i(t,i){var o,s,a=t[0],u=t[1],c=t[2],l=i[0],f=i[1],h=i[2],d=l-a,p=f-u,g=d*d+p*p;if(g<1e-12)s=Math.log(h/c)/e,o=function(t){return[a+t*d,u+t*p,c*Math.exp(e*t*s)]};else{var m=Math.sqrt(g),y=(h*h-c*c+r*g)/(2*c*n*m),v=(h*h-c*c-r*g)/(2*h*n*m),b=Math.log(Math.sqrt(y*y+1)-y),x=Math.log(Math.sqrt(v*v+1)-v);s=(x-b)/e,o=function(t){var r=t*s,i=of(b),o=c/(n*m)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+b)-function(t){return((t=Math.exp(t))-1/t)/2}(b));return[a+o*d,u+o*p,c*i/of(e*r+b)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function af(t){return function(e,n){var r=t((e=Lc(e)).h,(n=Lc(n)).h),i=Wc(e.s,n.s),o=Wc(e.l,n.l),s=Wc(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=s(t),e+""}}}var uf=af(Vc),cf=af(Wc);const lf=Math.PI/180,ff=180/Math.PI,hf=.96422,df=.82521,pf=4/29,gf=6/29,mf=3*gf*gf;function yf(t){if(t instanceof bf)return new bf(t.l,t.a,t.b,t.opacity);if(t instanceof Sf)return Cf(t);t instanceof Pc||(t=Cc(t));var e,n,r=Ef(t.r),i=Ef(t.g),o=Ef(t.b),s=xf((.2225045*r+.7168786*i+.0606169*o)/1);return r===i&&i===o?e=n=s:(e=xf((.4360747*r+.3850649*i+.1430804*o)/hf),n=xf((.0139322*r+.0971045*i+.7141733*o)/df)),new bf(116*s-16,500*(e-s),200*(s-n),t.opacity)}function vf(t,e,n,r){return 1===arguments.length?yf(t):new bf(t,e,n,null==r?1:r)}function bf(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function xf(t){return t>.008856451679035631?Math.pow(t,1/3):t/mf+pf}function wf(t){return t>gf?t*t*t:mf*(t-pf)}function _f(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ef(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Af(t){if(t instanceof Sf)return new Sf(t.h,t.c,t.l,t.opacity);if(t instanceof bf||(t=yf(t)),0===t.a&&0===t.b)return new Sf(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*ff;return new Sf(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Of(t,e,n,r){return 1===arguments.length?Af(t):new Sf(t,e,n,null==r?1:r)}function Sf(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Cf(t){if(isNaN(t.h))return new bf(t.l,0,0,t.opacity);var e=t.h*lf;return new bf(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function Mf(t,e){var n=Wc((t=vf(t)).l,(e=vf(e)).l),r=Wc(t.a,e.a),i=Wc(t.b,e.b),o=Wc(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function Pf(t){return function(e,n){var r=t((e=Of(e)).h,(n=Of(n)).h),i=Wc(e.c,n.c),o=Wc(e.l,n.l),s=Wc(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=s(t),e+""}}}sc(bf,vf,ac(uc,{brighter:function(t){return new bf(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new bf(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Pc(_f(3.1338561*(e=hf*wf(e))-1.6168667*(t=1*wf(t))-.4906146*(n=df*wf(n))),_f(-.9787684*e+1.9161415*t+.033454*n),_f(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),sc(Sf,Of,ac(uc,{brighter:function(t){return new Sf(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Sf(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return Cf(this).rgb()}}));var kf=Pf(Vc),Tf=Pf(Wc),Df=-.14861,Ff=1.78277,jf=-.29227,Lf=-.90649,Rf=1.97294,If=Rf*Lf,Nf=Rf*Ff,Bf=Ff*jf-Lf*Df;function zf(t){if(t instanceof Uf)return new Uf(t.h,t.s,t.l,t.opacity);t instanceof Pc||(t=Cc(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Bf*r+If*e-Nf*n)/(Bf+If-Nf),o=r-i,s=(Rf*(n-i)-jf*o)/Lf,a=Math.sqrt(s*s+o*o)/(Rf*i*(1-i)),u=a?Math.atan2(s,o)*ff-120:NaN;return new Uf(u<0?u+360:u,a,i,t.opacity)}function $f(t,e,n,r){return 1===arguments.length?zf(t):new Uf(t,e,n,null==r?1:r)}function Uf(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Vf(t){return function e(n){function r(e,r){var i=t((e=$f(e)).h,(r=$f(r)).h),o=Wc(e.s,r.s),s=Wc(e.l,r.l),a=Wc(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,r.gamma=e,r}(1)}sc(Uf,$f,ac(uc,{brighter:function(t){return t=null==t?lc:Math.pow(lc,t),new Uf(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?cc:Math.pow(cc,t),new Uf(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*lf,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Pc(255*(e+n*(Df*r+Ff*i)),255*(e+n*(jf*r+Lf*i)),255*(e+n*(Rf*r)),this.opacity)}}));var Zf=Vf(Vc),Wf=Vf(Wc);function qf(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Gf(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Hf="linear",Xf="log",Yf="pow",Kf="sqrt",Jf="symlog",Qf="time",th="utc",eh="sequential",nh="diverging",rh="quantile",ih="quantize",oh="threshold",sh="ordinal",ah="point",uh="band",ch="bin-ordinal",lh="continuous",fh="discrete",hh="discretizing",dh="interpolating",ph="temporal";function gh(){const t=ic().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],s=!1,a=0,u=0,c=.5;function l(){const t=e().length,l=o[1]<o[0],f=o[1-l],h=Gf(t,a,u);let d=o[l-0];r=(f-d)/(h||1),s&&(r=Math.floor(r)),d+=(f-d-r*(t-a))*c,i=r*(1-a),s&&(d=Math.round(d),i=Math.round(i));const p=ls(t).map((t=>d+r*t));return n(l?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),l()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],l()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],s=!0,l()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(s=!!t,l()):s},t.padding=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),a=u,l()):a},t.paddingInner=function(t){return arguments.length?(a=Math.max(0,Math.min(1,t)),l()):a},t.paddingOuter=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),l()):u},t.align=function(t){return arguments.length?(c=Math.max(0,Math.min(1,t)),l()):c},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],s=r?n().reverse():n(),a=s.length-1;let u,c,l,f=+t[0],h=+t[1];return f!==f||h!==h||(h<f&&(l=f,f=h,h=l),h<s[0]||f>o[1-r])?void 0:(u=Math.max(0,(0,tc.ml)(s,f)-1),c=f===h?u:(0,tc.ml)(s,h)-1,f-s[u]>i+1e-10&&++u,r&&(l=u,u=a-c,c=a-l),u>c?void 0:e().slice(u,c+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return gh().domain(e()).range(o).round(s).paddingInner(a).paddingOuter(u).align(c)},l()}function mh(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return mh(e())},t}var yh=Array.prototype.map;function vh(t){return yh.call(t,g.He)}const bh=Array.prototype.slice;const xh={};function wh(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,o,s,a=e[0],u=e[1],c=-1;for(u<a&&(i=a,a=u,u=i),o=0,s=n.length;o<s;++o)n[o]>=a&&n[o]<=u&&(c<0&&(c=o),r=o);if(!(c<0))return a=t.invertExtent(n[c]),u=t.invertExtent(n[r]),[void 0===a[0]?a[1]:a[0],void 0===u[1]?u[0]:u[1]]}}(n):void 0),n.type=t,n};return r.metadata=(0,g.Rg)((0,g.IX)(n)),r}function _h(t,e,n){return arguments.length>1?(xh[t]=wh(t,e,n),this):Eh(t)?xh[t]:void 0}function Eh(t){return(0,g.nr)(xh,t)}function Ah(t,e){const n=xh[t];return n&&n.metadata[e]}function Oh(t){return Ah(t,lh)}function Sh(t){return Ah(t,fh)}function Ch(t){return Ah(t,hh)}function Mh(t){return Ah(t,Xf)}function Ph(t){return Ah(t,dh)}function kh(t){return Ah(t,rh)}_h("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,ul),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,ul):[0,1],yl(r)})),_h(Hf,(function t(){var e=ml();return e.copy=function(){return pl(e,t())},ec.apply(e,arguments),yl(e)}),lh),_h(Xf,(function t(){var e=Ol(gl()).domain([1,10]);return e.copy=function(){return pl(e,t()).base(e.base())},ec.apply(e,arguments),e}),[lh,Xf]),_h(Yf,kl,lh),_h(Kf,(function(){return kl.apply(null,arguments).exponent(.5)}),lh),_h(Jf,(function t(){var e=Fl(gl());return e.copy=function(){return pl(e,t()).constant(e.constant())},ec.apply(e,arguments)}),lh),_h(Qf,(function(){return ec.apply($l(Il,Nl,Ct,Pt,ct,at,Tt,Ft,Lt,un).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[lh,ph]),_h(th,(function(){return ec.apply($l(Ll,Rl,Bt,$t,bt,yt,Vt,Wt,Lt,ln).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[lh,ph]),_h(eh,Zl,[lh,dh]),_h("".concat(eh,"-").concat(Hf),Zl,[lh,dh]),_h("".concat(eh,"-").concat(Xf),(function t(){var e=Ol(Ul()).domain([1,10]);return e.copy=function(){return Vl(e,t()).base(e.base())},nc.apply(e,arguments)}),[lh,dh,Xf]),_h("".concat(eh,"-").concat(Yf),Wl,[lh,dh]),_h("".concat(eh,"-").concat(Kf),(function(){return Wl.apply(null,arguments).exponent(.5)}),[lh,dh]),_h("".concat(eh,"-").concat(Jf),(function t(){var e=Fl(Ul());return e.copy=function(){return Vl(e,t()).constant(e.constant())},nc.apply(e,arguments)}),[lh,dh]),_h("".concat(nh,"-").concat(Hf),(function t(){var e=yl(Gl()(ll));return e.copy=function(){return Vl(e,t())},nc.apply(e,arguments)}),[lh,dh]),_h("".concat(nh,"-").concat(Xf),(function t(){var e=Ol(Gl()).domain([.1,1,10]);return e.copy=function(){return Vl(e,t()).base(e.base())},nc.apply(e,arguments)}),[lh,dh,Xf]),_h("".concat(nh,"-").concat(Yf),Hl,[lh,dh]),_h("".concat(nh,"-").concat(Kf),(function(){return Hl.apply(null,arguments).exponent(.5)}),[lh,dh]),_h("".concat(nh,"-").concat(Jf),(function t(){var e=Fl(Gl());return e.copy=function(){return Vl(e,t()).constant(e.constant())},nc.apply(e,arguments)}),[lh,dh]),_h(rh,(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=po(n,t/e);return s}function s(t){return null==t||isNaN(t=+t)?e:r[(0,tc.ZP)(i,t)]}return s.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},s.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(so.Z),o()},s.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return i.slice()},s.copy=function(){return t().domain(n).range(r).unknown(e)},ec.apply(s,arguments)}),[hh,rh]),_h(ih,(function t(){var e,n=0,r=1,i=1,o=[.5],s=[0,1];function a(t){return null!=t&&t<=t?s[(0,tc.ZP)(o,t,0,i)]:e}function u(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return a}return a.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,u()):[n,r]},a.range=function(t){return arguments.length?(i=(s=Array.from(t)).length-1,u()):s.slice()},a.invertExtent=function(t){var e=s.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return o.slice()},a.copy=function(){return t().domain([n,r]).range(s).unknown(e)},ec.apply(yl(a),arguments)}),hh),_h(oh,(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return null!=t&&t<=t?r[(0,tc.ZP)(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},ec.apply(o,arguments)}),hh),_h(ch,(function t(){let e=[],n=[];function r(t){return null==t||t!==t?void 0:n[((0,tc.ZP)(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=vh(t),r):e.slice()},r.range=function(t){return arguments.length?(n=bh.call(t),r):n.slice()},r.tickFormat=function(t,n){return oc(e[0],(0,g.fj)(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[fh,hh]),_h(sh,ic,fh),_h(uh,gh,fh),_h(ah,(function(){return mh(gh().paddingInner(1))}),fh);const Th=["clamp","base","constant","exponent"];function Dh(t,e){const n=e[0],r=(0,g.fj)(e)-n;return function(e){return t(n+e*r)}}function Fh(t,e,n){return ql(Rh(e||"rgb",n),t)}function jh(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function Lh(t,e,n){const r=n-e;let i,o,s;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=_h(o)().domain([e,n]).range([0,1]),Th.forEach((e=>t[e]?s[e](t[e]()):0)),s):(0,g.a9)(.5)}function Rh(t,e){const n=i[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function Ih(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function Nh(t,e){for(const n in t)zh(n,e(t[n]))}const Bh={};function zh(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Bh[t]=e,this):Bh[t]}Nh({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},Ih),Nh({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>Fh(Ih(t))));const $h="symbol",Uh=t=>(0,g.kJ)(t)?t.map((t=>String(t))):String(t),Vh=(t,e)=>t[1]-e[1],Zh=(t,e)=>e[1]-t[1];function Wh(t,e,n){let r;return(0,g.hj)(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor((0,g.yP)(t.domain())/n||1)))),(0,g.Kn)(e)&&(r=e.step,e=e.interval),(0,g.HD)(e)&&(e=t.type===Qf?Fe(e):t.type==th?je(e):(0,g.vU)("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function qh(t,e,n){let r=t.range(),i=r[0],o=(0,g.fj)(r),s=Vh;if(i>o&&(r=o,o=i,i=r,s=Zh),i=Math.floor(i),o=Math.ceil(o),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=o)).sort(s).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],(0,g.fj)(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function Gh(t,e){return t.bins?qh(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Hh(t,e,n,r,i,o){const s=e.type;let a=Uh;if(s===Qf||i===Qf)a=t.timeFormat(r);else if(s===th||i===th)a=t.utcFormat(r);else if(Mh(s)){const i=t.formatFloat(r);if(o||e.bins)a=i;else{const t=Xh(e,n,!1);a=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();a=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(a=t.format(r));return a}function Xh(t,e,n){const r=Gh(t,e),i=t.base(),o=Math.log(i),s=Math.max(1,i*e/r.length),a=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=s};return n?r.filter(a):a}const Yh={[rh]:"quantiles",[ih]:"thresholds",[oh]:"domain"},Kh={[rh]:"quantiles",[ih]:"domain"};function Jh(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=(0,g.fj)(t),e}(t.bins):t.type===Xf?Xh(t,e,!0):Yh[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[Yh[t.type]]()):Gh(t,e)}function Qh(t,e,n,r,i,o,s){const a=Kh[e.type]&&o!==Qf&&o!==th?function(t,e,n){const r=e[Kh[e.type]](),i=r.length;let o,s=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)s=Math.min(s,r[o]-r[o-1]);return t.formatSpan(0,s,30,n)}(t,e,i):Hh(t,e,n,i,o,s);return r===$h&&(t=>Yh[t.type]||t.bins)(e)?td(a):"discrete"===r?nd(a):rd(a)}const td=t=>(e,n,r)=>{const i=ed(r[n+1],ed(r.max,1/0)),o=id(e,t),s=id(i,t);return o&&s?o+" \u2013 "+s:s?"< "+s:"\u2265 "+o},ed=(t,e)=>null!=t?t:e,nd=t=>(e,n)=>n?t(e):null,rd=t=>e=>t(e),id=(t,e)=>Number.isFinite(t)?e(t):null;function od(t,e,n,r){const i=r||e.type;return(0,g.HD)(n)&&Ah(i,ph)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==Qf?n||i!==th?Qh(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}function sd(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=od(t,e,n.format,n.formatType);if(Ch(e.type)){const t=Jh(e).slice(1).map(i),n=t.length;return"".concat(n," boundar").concat(1===n?"y":"ies",": ").concat(t.join(", "))}if(Sh(e.type)){const t=e.domain(),n=t.length,o=n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ");return"".concat(n," value").concat(1===n?"":"s",": ").concat(o)}{const t=e.domain();return"values from ".concat(i(t[0])," to ").concat(i((0,g.fj)(t)))}}let ad=0;const ud="p_";function cd(t){return t&&t.gradient}function ld(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?ud:"";return i||(i=t.id="gradient_"+ad++,"radial"===r?(t.x1=fd(t.x1,.5),t.y1=fd(t.y1,.5),t.r1=fd(t.r1,0),t.x2=fd(t.x2,.5),t.y2=fd(t.y2,.5),t.r2=fd(t.r2,.5),o=ud):(t.x1=fd(t.x1,0),t.y1=fd(t.y1,0),t.x2=fd(t.x2,1),t.y2=fd(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function fd(t,e){return null!=t?t:e}function hd(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}const dd={basis:{curve:function(t){return new Na(t)}},"basis-closed":{curve:function(t){return new za(t)}},"basis-open":{curve:function(t){return new $a(t)}},bundle:{curve:Va,tension:"beta",value:.85},cardinal:{curve:qa,tension:"tension",value:0},"cardinal-open":{curve:Ha,tension:"tension",value:0},"cardinal-closed":{curve:Ya,tension:"tension",value:0},"catmull-rom":{curve:hu,tension:"alpha",value:.5},"catmull-rom-closed":{curve:pu,tension:"alpha",value:.5},"catmull-rom-open":{curve:mu,tension:"alpha",value:.5},linear:{curve:vu},"linear-closed":{curve:function(t){return new bu(t)}},monotone:{horizontal:function(t){return new Ou(t)},vertical:function(t){return new Au(t)}},natural:{curve:function(t){return new Cu(t)}},step:{curve:function(t){return new Pu(t,.5)}},"step-after":{curve:function(t){return new Pu(t,1)}},"step-before":{curve:function(t){return new Pu(t,0)}}};function pd(t,e,n){var r=(0,g.nr)(dd,t)&&dd[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const gd={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},md=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function yd(t){const e=[];let n,r,i,o,s,a,u,c,l,f;const h=t.slice().replace(md[0],"###$1").split(md[1]).slice(1);for(u=0,l=h.length;u<l;++u){for(n=h[u],r=n.slice(1).trim().replace(md[2],"$1###$2").replace(md[3],"$1###$2").split(md[4]),s=n.charAt(0),i=[s],c=0,f=r.length;c<f;++c)(o=+r[c])===o&&i.push(o);if(a=gd[s.toLowerCase()],i.length-1>a){const t=i.length;for(c=1,e.push([s].concat(i.slice(c,c+=a))),s="M"===s?"L":"m"===s?"l":s;c<t;c+=a)e.push([s].concat(i.slice(c,c+a)))}else e.push(i)}return e}const vd=Math.PI/180,bd=Math.PI/2,xd=2*Math.PI,wd=Math.sqrt(3)/2;var _d={},Ed={},Ad=[].join;function Od(t){const e=Ad.call(t);if(Ed[e])return Ed[e];var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7];const l=c*s,f=-u*a,h=u*s,d=c*a,p=Math.cos(i),g=Math.sin(i),m=Math.cos(o),y=Math.sin(o),v=.5*(o-i),b=Math.sin(.5*v),x=8/3*b*b/Math.sin(v),w=n+p-x*g,_=r+g+x*p,E=n+m,A=r+y,O=E+x*y,S=A-x*m;return Ed[e]=[l*w+f*_,h*w+d*_,l*O+f*S,h*O+d*S,l*E+f*A,h*E+d*A]}const Sd=["l",0,0,0,0,0,0,0];function Cd(t,e,n){const r=Sd[0]=t[0];if("a"===r||"A"===r)Sd[1]=e*t[1],Sd[2]=n*t[2],Sd[3]=t[3],Sd[4]=t[4],Sd[5]=t[5],Sd[6]=e*t[6],Sd[7]=n*t[7];else if("h"===r||"H"===r)Sd[1]=e*t[1];else if("v"===r||"V"===r)Sd[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)Sd[i]=(i%2==1?e:n)*t[i];return Sd}function Md(t,e,n,r,i,o){var s,a,u,c,l,f=null,h=0,d=0,p=0,g=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var m=0,y=e.length;m<y;++m){switch(s=e[m],1===i&&1===o||(s=Cd(s,i,o)),s[0]){case"l":h+=s[1],d+=s[2],t.lineTo(h+n,d+r);break;case"L":h=s[1],d=s[2],t.lineTo(h+n,d+r);break;case"h":h+=s[1],t.lineTo(h+n,d+r);break;case"H":h=s[1],t.lineTo(h+n,d+r);break;case"v":d+=s[1],t.lineTo(h+n,d+r);break;case"V":d=s[1],t.lineTo(h+n,d+r);break;case"m":h+=s[1],d+=s[2],t.moveTo(h+n,d+r);break;case"M":h=s[1],d=s[2],t.moveTo(h+n,d+r);break;case"c":a=h+s[5],u=d+s[6],p=h+s[3],g=d+s[4],t.bezierCurveTo(h+s[1]+n,d+s[2]+r,p+n,g+r,a+n,u+r),h=a,d=u;break;case"C":h=s[5],d=s[6],p=s[3],g=s[4],t.bezierCurveTo(s[1]+n,s[2]+r,p+n,g+r,h+n,d+r);break;case"s":a=h+s[3],u=d+s[4],p=2*h-p,g=2*d-g,t.bezierCurveTo(p+n,g+r,h+s[1]+n,d+s[2]+r,a+n,u+r),p=h+s[1],g=d+s[2],h=a,d=u;break;case"S":a=s[3],u=s[4],p=2*h-p,g=2*d-g,t.bezierCurveTo(p+n,g+r,s[1]+n,s[2]+r,a+n,u+r),h=a,d=u,p=s[1],g=s[2];break;case"q":a=h+s[3],u=d+s[4],p=h+s[1],g=d+s[2],t.quadraticCurveTo(p+n,g+r,a+n,u+r),h=a,d=u;break;case"Q":a=s[3],u=s[4],t.quadraticCurveTo(s[1]+n,s[2]+r,a+n,u+r),h=a,d=u,p=s[1],g=s[2];break;case"t":a=h+s[1],u=d+s[2],null===f[0].match(/[QqTt]/)?(p=h,g=d):"t"===f[0]?(p=2*h-c,g=2*d-l):"q"===f[0]&&(p=2*h-p,g=2*d-g),c=p,l=g,t.quadraticCurveTo(p+n,g+r,a+n,u+r),d=u,p=(h=a)+s[1],g=d+s[2];break;case"T":a=s[1],u=s[2],p=2*h-p,g=2*d-g,t.quadraticCurveTo(p+n,g+r,a+n,u+r),h=a,d=u;break;case"a":Pd(t,h+n,d+r,[s[1],s[2],s[3],s[4],s[5],s[6]+h+n,s[7]+d+r]),h+=s[6],d+=s[7];break;case"A":Pd(t,h+n,d+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),h=s[6],d=s[7];break;case"z":case"Z":t.closePath()}f=s}}function Pd(t,e,n,r){const i=function(t,e,n,r,i,o,s,a,u){const c=Ad.call(arguments);if(_d[c])return _d[c];const l=s*vd,f=Math.sin(l),h=Math.cos(l),d=h*(a-t)*.5+f*(u-e)*.5,p=h*(u-e)*.5-f*(a-t)*.5;let g=d*d/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);g>1&&(g=Math.sqrt(g),n*=g,r*=g);const m=h/n,y=f/n,v=-f/r,b=h/r,x=m*a+y*u,w=v*a+b*u,_=m*t+y*e,E=v*t+b*e;let A=1/((_-x)*(_-x)+(E-w)*(E-w))-.25;A<0&&(A=0);let O=Math.sqrt(A);o==i&&(O=-O);const S=.5*(x+_)-O*(E-w),C=.5*(w+E)+O*(_-x),M=Math.atan2(w-C,x-S);let P=Math.atan2(E-C,_-S)-M;P<0&&1===o?P+=xd:P>0&&0===o&&(P-=xd);const k=Math.ceil(Math.abs(P/(bd+.001))),T=[];for(let D=0;D<k;++D){const t=M+D*P/k,e=M+(D+1)*P/k;T[D]=[S,C,t,e,n,r,f,h]}return _d[c]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let o=0;o<i.length;++o){const e=Od(i[o]);t.bezierCurveTo(e[0],e[1],e[2],e[3],e[4],e[5])}}const kd=.5773502691896257,Td={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,xd)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=wd*n,i=r-n*kd,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=wd*n,i=r-n*kd;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=wd*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=wd*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=wd*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=wd*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function Dd(t){return(0,g.nr)(Td,t)?Td[t]:function(t){if(!(0,g.nr)(Fd,t)){const e=yd(t);Fd[t]={draw:function(t,n){Md(t,e,0,0,Math.sqrt(n)/2)}}}return Fd[t]}(t)}var Fd={};const jd=.448084975506;function Ld(t){return t.x}function Rd(t){return t.y}function Id(t){return t.width}function Nd(t){return t.height}function Bd(t){return"function"===typeof t?t:()=>+t}function zd(t,e,n){return Math.max(e,Math.min(t,n))}function $d(){var t=Ld,e=Rd,n=Id,r=Nd,i=Bd(0),o=i,s=i,a=i,u=null;function c(c,l,f){var h,d=null!=l?l:+t.call(this,c),p=null!=f?f:+e.call(this,c),g=+n.call(this,c),m=+r.call(this,c),y=Math.min(g,m)/2,v=zd(+i.call(this,c),0,y),b=zd(+o.call(this,c),0,y),x=zd(+s.call(this,c),0,y),w=zd(+a.call(this,c),0,y);if(u||(u=h=Ru()),v<=0&&b<=0&&x<=0&&w<=0)u.rect(d,p,g,m);else{var _=d+g,E=p+m;u.moveTo(d+v,p),u.lineTo(_-b,p),u.bezierCurveTo(_-jd*b,p,_,p+jd*b,_,p+b),u.lineTo(_,E-w),u.bezierCurveTo(_,E-jd*w,_-jd*w,E,_-w,E),u.lineTo(d+x,E),u.bezierCurveTo(d+jd*x,E,d,E-jd*x,d,E-x),u.lineTo(d,p+v),u.bezierCurveTo(d,p+jd*v,d+jd*v,p,d+v,p),u.closePath()}if(h)return u=null,h+""||null}return c.x=function(e){return arguments.length?(t=Bd(e),c):t},c.y=function(t){return arguments.length?(e=Bd(t),c):e},c.width=function(t){return arguments.length?(n=Bd(t),c):n},c.height=function(t){return arguments.length?(r=Bd(t),c):r},c.cornerRadius=function(t,e,n,r){return arguments.length?(i=Bd(t),o=null!=e?Bd(e):i,a=null!=n?Bd(n):i,s=null!=r?Bd(r):o,c):i},c.context=function(t){return arguments.length?(u=null==t?null:t,c):u},c}function Ud(){var t,e,n,r,i,o,s,a,u=null;function c(t,e,n){const r=n/2;if(i){var c=s-e,l=t-o;if(c||l){var f=Math.sqrt(c*c+l*l),h=(c/=f)*a,d=(l/=f)*a,p=Math.atan2(l,c);u.moveTo(o-h,s-d),u.lineTo(t-c*r,e-l*r),u.arc(t,e,r,p-Math.PI,p),u.lineTo(o+h,s+d),u.arc(o,s,a,p,p+Math.PI)}else u.arc(t,e,r,0,xd);u.closePath()}else i=1;o=t,s=e,a=r}function l(o){var s,a,l,f=o.length,h=!1;for(null==u&&(u=l=Ru()),s=0;s<=f;++s)!(s<f&&r(a=o[s],s,o))===h&&(h=!h)&&(i=0),h&&c(+t(a,s,o),+e(a,s,o),+n(a,s,o));if(l)return u=null,l+""||null}return l.x=function(e){return arguments.length?(t=e,l):t},l.y=function(t){return arguments.length?(e=t,l):e},l.size=function(t){return arguments.length?(n=t,l):n},l.defined=function(t){return arguments.length?(r=t,l):r},l.context=function(t){return arguments.length?(u=null==t?null:t,l):u},l}function Vd(t,e){return null!=t?t:e}const Zd=t=>t.x||0,Wd=t=>t.y||0,qd=t=>!(!1===t.defined),Gd=function(){var t=Nu,e=Bu,n=Iu(0),r=null,i=zu,o=$u,s=Uu,a=null;function u(){var u,c,l=+t.apply(this,arguments),f=+e.apply(this,arguments),h=i.apply(this,arguments)-su,d=o.apply(this,arguments)-su,p=Ka(d-h),g=d>h;if(a||(a=u=Ru()),f<l&&(c=f,f=l,l=c),f>iu)if(p>au-iu)a.moveTo(f*Qa(h),f*nu(h)),a.arc(0,0,f,h,d,!g),l>iu&&(a.moveTo(l*Qa(d),l*nu(d)),a.arc(0,0,l,d,h,g));else{var m,y,v=h,b=d,x=h,w=d,_=p,E=p,A=s.apply(this,arguments)/2,O=A>iu&&(r?+r.apply(this,arguments):ru(l*l+f*f)),S=eu(Ka(f-l)/2,+n.apply(this,arguments)),C=S,M=S;if(O>iu){var P=cu(O/l*nu(A)),k=cu(O/f*nu(A));(_-=2*P)>iu?(x+=P*=g?1:-1,w-=P):(_=0,x=w=(h+d)/2),(E-=2*k)>iu?(v+=k*=g?1:-1,b-=k):(E=0,v=b=(h+d)/2)}var T=f*Qa(v),D=f*nu(v),F=l*Qa(w),j=l*nu(w);if(S>iu){var L,R=f*Qa(b),I=f*nu(b),N=l*Qa(x),B=l*nu(x);if(p<ou&&(L=Vu(T,D,N,B,R,I,F,j))){var z=T-L[0],$=D-L[1],U=R-L[0],V=I-L[1],Z=1/nu(uu((z*U+$*V)/(ru(z*z+$*$)*ru(U*U+V*V)))/2),W=ru(L[0]*L[0]+L[1]*L[1]);C=eu(S,(l-W)/(Z-1)),M=eu(S,(f-W)/(Z+1))}}E>iu?M>iu?(m=Zu(N,B,T,D,f,M,g),y=Zu(R,I,F,j,f,M,g),a.moveTo(m.cx+m.x01,m.cy+m.y01),M<S?a.arc(m.cx,m.cy,M,Ja(m.y01,m.x01),Ja(y.y01,y.x01),!g):(a.arc(m.cx,m.cy,M,Ja(m.y01,m.x01),Ja(m.y11,m.x11),!g),a.arc(0,0,f,Ja(m.cy+m.y11,m.cx+m.x11),Ja(y.cy+y.y11,y.cx+y.x11),!g),a.arc(y.cx,y.cy,M,Ja(y.y11,y.x11),Ja(y.y01,y.x01),!g))):(a.moveTo(T,D),a.arc(0,0,f,v,b,!g)):a.moveTo(T,D),l>iu&&_>iu?C>iu?(m=Zu(F,j,R,I,l,-C,g),y=Zu(T,D,N,B,l,-C,g),a.lineTo(m.cx+m.x01,m.cy+m.y01),C<S?a.arc(m.cx,m.cy,C,Ja(m.y01,m.x01),Ja(y.y01,y.x01),!g):(a.arc(m.cx,m.cy,C,Ja(m.y01,m.x01),Ja(m.y11,m.x11),!g),a.arc(0,0,l,Ja(m.cy+m.y11,m.cx+m.x11),Ja(y.cy+y.y11,y.cx+y.x11),g),a.arc(y.cx,y.cy,C,Ja(y.y11,y.x11),Ja(y.y01,y.x01),!g))):a.arc(0,0,l,w,x,g):a.lineTo(F,j)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-ou/2;return[Qa(r)*n,nu(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"===typeof e?e:Iu(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"===typeof t?t:Iu(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"===typeof t?t:Iu(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"===typeof t?t:Iu(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"===typeof t?t:Iu(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"===typeof t?t:Iu(+t),u):o},u.padAngle=function(t){return arguments.length?(s="function"===typeof t?t:Iu(+t),u):s},u.context=function(t){return arguments.length?(a=null==t?null:t,u):a},u}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),Hd=Xu().x(Zd).y1(Wd).y0((t=>(t.y||0)+(t.height||0))).defined(qd),Xd=Xu().y(Wd).x1(Zd).x0((t=>(t.x||0)+(t.width||0))).defined(qd),Yd=Hu().x(Zd).y(Wd).defined(qd),Kd=$d().x(Zd).y(Wd).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>Vd(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>Vd(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>Vd(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>Vd(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),Jd=function(t,e){var n=null;function r(){var r;if(n||(n=r=Ru()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return t="function"===typeof t?t:Iu(t||Yu),e="function"===typeof e?e:Iu(void 0===e?64:+e),r.type=function(e){return arguments.length?(t="function"===typeof e?e:Iu(e),r):t},r.size=function(t){return arguments.length?(e="function"===typeof t?t:Iu(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r}().type((t=>Dd(t.shape||"circle"))).size((t=>Vd(t.size,64))),Qd=Ud().x(Zd).y(Wd).defined(qd).size((t=>t.size||1));function tp(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function ep(t,e,n,r){return Kd.context(t)(e,n,r)}var np=1;function rp(){np=1}function ip(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+np++),s=i.clipping[o]||(i.clipping[o]={id:o});return(0,g.mf)(r)?s.path=r(null):tp(n)?s.path=ep(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function op(t){this.clear(),t&&this.union(t)}function sp(t){this.mark=t,this.bounds=this.bounds||new op}function ap(t){sp.call(this,t),this.items=this.items||[]}function up(t){this._pending=0,this._loader=t||yi()}function cp(t){t._pending+=1}function lp(t){t._pending-=1}function fp(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}op.prototype={clone(){return new op(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(t),u=Math.sin(t),c=e-e*a+n*u,l=n-e*u-n*a;return[a*r-u*i+c,u*r+a*i+l,a*r-u*s+c,u*r+a*s+l,a*o-u*i+c,u*o+a*i+l,a*o-u*s+c,u*o+a*s+l]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},(0,g.XW)(ap,sp),up.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return cp(e),e._loader.sanitize(t,{context:"href"}).then((t=>(lp(e),t))).catch((()=>(lp(e),null)))},loadImage(t){const e=this,n=Qu();return cp(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=(0,g.nr)(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>lp(e),i.onerror=()=>lp(e),i.src=r,i})).catch((t=>(lp(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))},ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}};const hp=xd-1e-8;let dp,pp,gp,mp,yp,vp,bp,xp;const wp=(t,e)=>dp.add(t,e),_p=(t,e)=>wp(pp=t,gp=e),Ep=t=>wp(t,dp.y1),Ap=t=>wp(dp.x1,t),Op=(t,e)=>yp*t+bp*e,Sp=(t,e)=>vp*t+xp*e,Cp=(t,e)=>wp(Op(t,e),Sp(t,e)),Mp=(t,e)=>_p(Op(t,e),Sp(t,e));function Pp(t,e){return dp=t,e?(mp=e*vd,yp=xp=Math.cos(mp),vp=Math.sin(mp),bp=-vp):(yp=xp=1,mp=vp=bp=0),kp}const kp={beginPath(){},closePath(){},moveTo:Mp,lineTo:Mp,rect(t,e,n,r){mp?(Cp(t+n,e),Cp(t+n,e+r),Cp(t,e+r),Mp(t,e)):(wp(t+n,e+r),_p(t,e))},quadraticCurveTo(t,e,n,r){const i=Op(t,e),o=Sp(t,e),s=Op(n,r),a=Sp(n,r);Tp(pp,i,s,Ep),Tp(gp,o,a,Ap),_p(s,a)},bezierCurveTo(t,e,n,r,i,o){const s=Op(t,e),a=Sp(t,e),u=Op(n,r),c=Sp(n,r),l=Op(i,o),f=Sp(i,o);Dp(pp,s,u,l,Ep),Dp(gp,a,c,f,Ap),_p(l,f)},arc(t,e,n,r,i,o){if(r+=mp,i+=mp,pp=n*Math.cos(i)+t,gp=n*Math.sin(i)+e,Math.abs(i-r)>hp)wp(t-n,e-n),wp(t+n,e+n);else{const s=r=>wp(n*Math.cos(r)+t,n*Math.sin(r)+e);let a,u;if(s(r),s(i),i!==r)if((r%=xd)<0&&(r+=xd),(i%=xd)<0&&(i+=xd),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=xd,a=r-r%bd,u=0;u<4&&a>i;++u,a-=bd)s(a);else for(a=r-r%bd+bd,u=0;u<4&&a<i;++u,a+=bd)s(a)}}};function Tp(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function Dp(t,e,n,r,i){const o=r-t+3*e-3*n,s=t+n-2*e,a=t-e;let u,c=0,l=0;Math.abs(o)>1e-14?(u=s*s+a*o,u>=0&&(u=Math.sqrt(u),c=(-s+u)/o,l=(-s-u)/o)):c=.5*a/s,0<c&&c<1&&i(Fp(c,t,e,n,r)),0<l&&l<1&&i(Fp(l,t,e,n,r))}function Fp(t,e,n,r,i){const o=1-t,s=o*o,a=t*t;return s*o*e+3*s*t*n+3*o*a*r+a*t*i}var jp=(jp=Ju(1,1))?jp.getContext("2d"):null;const Lp=new op;function Rp(t){return function(e,n){if(!jp)return!0;t(jp,e),Lp.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=Lp;for(let t=i;t<=s;++t)for(let e=r;e<=o;++e)if(jp.isPointInPath(e,t))return!0;return!1}}function Ip(t,e){return e.contains(t.x||0,t.y||0)}function Np(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(Lp.set(n,r,n+i,r+o))}function Bp(t,e){const n=t.x||0,r=t.y||0;return zp(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function zp(t,e,n,r,i){const{x1:o,y1:s,x2:a,y2:u}=t,c=r-e,l=i-n;let f,h,d,p,g=0,m=1;for(p=0;p<4;++p){if(0===p&&(f=-c,h=-(o-e)),1===p&&(f=c,h=a-e),2===p&&(f=-l,h=-(s-n)),3===p&&(f=l,h=u-n),Math.abs(f)<1e-10&&h<0)return!1;if(d=h/f,f<0){if(d>m)return!1;d>g&&(g=d)}else if(f>0){if(d<g)return!1;d<m&&(m=d)}}return!0}function $p(t,e){t.globalCompositeOperation=e.blend||"source-over"}function Up(t,e){return null==t?e:t}function Vp(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function Zp(t,e,n){return cd(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+Up(e.x1,.5)*r,n.y1+Up(e.y1,.5)*i,Math.max(r,i)*Up(e.r1,0),n.x1+Up(e.x2,.5)*r,n.y1+Up(e.y2,.5)*i,Math.max(r,i)*Up(e.r2,.5));else{const s=Up(e.x1,0),a=Up(e.y1,0),u=Up(e.x2,1),c=Up(e.y2,0);if(s!==u&&a!==c&&r!==i){const n=Ju(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=Vp(o.createLinearGradient(s,a,u,c),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+u*r,n.y1+c*i)}return Vp(o,e.stops)}(t,n,e.bounds):n}function Wp(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=Zp(t,e,e.fill),!0)}var qp=[];function Gp(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&((n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=Zp(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||qp),t.lineDashOffset=e.strokeDashOffset||0),!0))}function Hp(t,e){return t.zindex-e.zindex||t.index-e.index}function Xp(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(Hp)}function Yp(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=Xp(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function Kp(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=Xp(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function Jp(t){return function(e,n,r){Yp(n,(n=>{r&&!r.intersects(n.bounds)||tg(t,e,n,n)}))}}function Qp(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||tg(t,e,n.items[0],n.items)}}function tg(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||($p(e,n),n.fill&&Wp(e,n,i)&&e.fill(),n.stroke&&Gp(e,n,i)&&e.stroke()))}function eg(t){return t=t||g.yb,function(e,n,r,i,o,s){return r*=e.pixelRatio,i*=e.pixelRatio,Kp(n,(n=>{const a=n.bounds;if((!a||a.contains(o,s))&&a)return t(e,n,r,i,o,s)?n:void 0}))}}function ng(t,e){return function(n,r,i,o){var s,a,u=Array.isArray(r)?r[0]:r,c=null==e?u.fill:e,l=u.stroke&&n.isPointInStroke;return l&&(s=u.strokeWidth,a=u.strokeCap,n.lineWidth=null!=s?s:1,n.lineCap=null!=a?a:"butt"),!t(n,r)&&(c&&n.isPointInPath(i,o)||l&&n.isPointInStroke(i,o))}}function rg(t){return eg(ng(t))}function ig(t,e){return"translate("+t+","+e+")"}function og(t){return"rotate("+t+")"}function sg(t){return ig(t.x||0,t.y||0)}function ag(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=vd),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return ig(t.x||0,t.y||0)+(t.angle?" "+og(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(Pp(t,n.angle),n),fp(t,n).translate(n.x||0,n.y||0)},draw:Jp(r),pick:rg(r),isect:n||Rp(r)}}var ug=ag("arc",(function(t,e){return Gd.context(t)(e)}));function cg(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=ng(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(Pp(t),r),fp(t,r[0]))},draw:Qp(r),pick:function(t,e,n,r,o,s){var a=e.items,u=e.bounds;return!a||!a.length||u&&!u.contains(o,s)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,a,n,r)?a[0]:null)},isect:Ip,tip:n}}var lg=cg("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?Xd:Hd).curve(pd(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",s=t.length,a=1/0;--s>=0;)!1!==t[s].defined&&(r=Math.abs(t[s][o]-i))<a&&(a=r,n=t[s]);return n}));function fg(t,e){t.beginPath(),tp(e)?ep(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function hg(t){const e=Up(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function dg(t,e){const n=hg(e);t("d",ep(null,e,n,n))}function pg(t,e,n,r){const i=hg(e);t.beginPath(),ep(t,e,(n||0)+i,(r||0)+i)}const gg=ng(pg),mg=ng(pg,!1),yg=ng(pg,!0);var vg={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",sg(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),fp(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n){Yp(e,(e=>{const r=e.x||0,i=e.y||0,o=e.strokeForeground,s=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&s&&(pg(t,e,r,i),$p(t,e),e.fill&&Wp(t,e,s)&&t.fill(),e.stroke&&!o&&Gp(t,e,s)&&t.stroke()),t.save(),t.translate(r,i),e.clip&&fg(t,e),n&&n.translate(-r,-i),Yp(e,(e=>{this.draw(t,e,n)})),n&&n.translate(r,i),t.restore(),o&&e.stroke&&s&&(pg(t,e,r,i),$p(t,e),Gp(t,e,s)&&t.stroke())}))},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const s=n*t.pixelRatio,a=r*t.pixelRatio;return Kp(e,(u=>{let c,l,f;const h=u.bounds;if(h&&!h.contains(i,o))return;l=u.x||0,f=u.y||0;const d=l+(u.width||0),p=f+(u.height||0),g=u.clip;if(g&&(i<l||i>d||o<f||o>p))return;if(t.save(),t.translate(l,f),l=i-l,f=o-f,g&&tp(u)&&!yg(t,u,s,a))return t.restore(),null;const m=u.strokeForeground,y=!1!==e.interactive;return y&&m&&u.stroke&&mg(t,u,s,a)?(t.restore(),u):(c=Kp(u,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,l,f)?this.pick(t,n,r,l,f):null)),!c&&y&&(u.fill||!m&&u.stroke)&&gg(t,u,s,a)&&(c=u),t.restore(),c||null)}))},isect:Np,content:function(t,e,n){t("clip-path",e.clip?ip(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),dg(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?dg(t,e):t("d","")}},bg={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function xg(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function wg(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function _g(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function Eg(t,e){return"center"===t?e/2:"right"===t?e:0}function Ag(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var Og={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=xg(e,n),i=wg(e,r),o=_g(e,r),s=(e.x||0)-Eg(e.align,i),a=(e.y||0)-Ag(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",bg["xmlns:xlink"],"xlink:href"),t("transform",ig(s,a)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=wg(e,n),i=_g(e,n),o=(e.x||0)-Eg(e.align,r),s=(e.y||0)-Ag(e.baseline,i);return t.set(o,s,o+r,s+i)},draw:function(t,e,n){Yp(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=xg(e,this);let i=wg(e,r),o=_g(e,r);if(0===i||0===o)return;let s,a,u,c,l=(e.x||0)-Eg(e.align,i),f=(e.y||0)-Ag(e.baseline,o);!1!==e.aspect&&(a=r.width/r.height,u=e.width/e.height,a===a&&u===u&&a!==u&&(u<a?(c=i/a,f+=(o-c)/2,o=c):(c=o*a,l+=(i-c)/2,i=c))),(r.complete||r.toDataURL)&&($p(t,e),t.globalAlpha=null!=(s=e.opacity)?s:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,l,f,i,o))}))},pick:eg(),isect:g.yb,get:xg,xOffset:Eg,yOffset:Ag},Sg=cg("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return Yd.curve(pd(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function Cg(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,s=e.scaleY||1,a=(e.angle||0)*vd,u=e.pathCache;u&&u.path===n||((e.pathCache=u=yd(n)).path=n),a&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(a),Md(t,u,0,0,o,s),t.rotate(-a),t.translate(-r,-i)):Md(t,u,r,i,o,s)}var Mg={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return ig(t.x||0,t.y||0)+(t.angle?" "+og(t.angle):"")+(t.scaleX||t.scaleY?" "+function(t,e){return"scale("+t+","+e+")"}(t.scaleX||1,t.scaleY||1):"")}(e)),t("d",e.path)},bound:function(t,e){return Cg(Pp(t,e.angle),e)?t.set(0,0,0,0):fp(t,e,!0)},draw:Jp(Cg),pick:rg(Cg),isect:Rp(Cg)};function Pg(t,e){t.beginPath(),ep(t,e)}var kg={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",ep(null,e))},bound:function(t,e){var n,r;return fp(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:Jp(Pg),pick:rg(Pg),isect:Np};function Tg(t,e,n){var r,i,o,s;return!(!e.stroke||!Gp(t,e,n))&&(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,s=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,s),!0)}var Dg={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",sg(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return fp(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){Yp(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&Tg(t,e,r)&&($p(t,e),t.stroke())}}))},pick:eg((function(t,e,n,r){return!!t.isPointInStroke&&(Tg(t,e,1)&&t.isPointInStroke(n,r))})),isect:Bp},Fg=ag("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),jg=ag("symbol",(function(t,e){return Jd.context(t)(e)}),Ip);const Lg=(0,g.$m)();var Rg={height:Ug,measureWidth:zg,estimateWidth:Ng,width:Ng,canvas:Ig};function Ig(t){Rg.width=t&&jp?zg:Ng}function Ng(t,e){return Bg(qg(t,e),Ug(t))}function Bg(t,e){return~~(.8*t.length*e)}function zg(t,e){return Ug(t)<=0||!(e=qg(t,e))?0:$g(e,Hg(t))}function $g(t,e){const n=`(${e}) ${t}`;let r=Lg.get(n);return void 0===r&&(jp.font=e,r=jp.measureText(t).width,Lg.set(n,r)),r}function Ug(t){return null!=t.fontSize?+t.fontSize||0:11}function Vg(t){return null!=t.lineHeight?t.lineHeight:Ug(t)+2}function Zg(t){return e=t.lineBreak&&t.text&&!(0,g.kJ)(t.text)?t.text.split(t.lineBreak):t.text,(0,g.kJ)(e)?e.length>1?e:e[0]:e;var e}function Wg(t){const e=Zg(t);return((0,g.kJ)(e)?e.length-1:0)*Vg(t)}function qg(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(Rg.width===zg){const e=Hg(t);return t=>$g(t,e)}{const e=Ug(t);return t=>Bg(t,e)}}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"\u2026",s="rtl"===t.dir,a=0,u=e.length;if(n-=r(o),s){for(;a<u;)i=a+u>>>1,r(e.slice(i))>n?a=i+1:u=i;return o+e.slice(a)}for(;a<u;)i=1+(a+u>>>1),r(e.slice(0,i))<n?a=i:u=i-1;return e.slice(0,a)+o}(t,n):n}function Gg(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function Hg(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Ug(t)+"px "+Gg(t,e)}function Xg(t){var e=t.baseline,n=Ug(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*Vg(t):"line-bottom"===e?.29*n-.5*Vg(t):0)}Ig(!0);const Yg={left:"start",center:"middle",right:"end"},Kg=new op;function Jg(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-bd,n+=i*Math.cos(e),r+=i*Math.sin(e)),Kg.x1=n,Kg.y1=r,Kg}function Qg(t,e,n){var r,i=Rg.height(e),o=e.align,s=Jg(e),a=s.x1,u=s.y1,c=e.dx||0,l=(e.dy||0)+Xg(e)-Math.round(.8*i),f=Zg(e);if((0,g.kJ)(f)?(i+=Vg(e)*(f.length-1),r=f.reduce(((t,n)=>Math.max(t,Rg.width(e,n))),0)):r=Rg.width(e,f),"center"===o?c-=r/2:"right"===o&&(c-=r),t.set(c+=a,l+=u,c+r,l+i),e.angle&&!n)t.rotate(e.angle*vd,a,u);else if(2===n)return t.rotatedPoints(e.angle*vd,a,u);return t}var tm={arc:ug,area:lg,group:vg,image:Og,line:Sg,path:Mg,rect:kg,rule:Dg,shape:Fg,symbol:jg,text:{type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+Xg(e),o=Jg(e),s=o.x1,a=o.y1,u=e.angle||0;t("text-anchor",Yg[e.align]||"start"),u?(n=ig(s,a)+" "+og(u),(r||i)&&(n+=" "+ig(r,i))):n=ig(s+r,a+i),t("transform",n)},bound:Qg,draw:function(t,e,n){Yp(e,(e=>{var r,i,o,s,a,u,c,l=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===l||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=Hg(e),t.textAlign=e.align||"left",i=(r=Jg(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*vd),i=o=0),i+=e.dx||0,o+=(e.dy||0)+Xg(e),u=Zg(e),$p(t,e),(0,g.kJ)(u))for(a=Vg(e),s=0;s<u.length;++s)c=qg(e,u[s]),e.fill&&Wp(t,e,l)&&t.fillText(c,i,o),e.stroke&&Gp(t,e,l)&&t.strokeText(c,i,o),o+=a;else c=qg(e,u),e.fill&&Wp(t,e,l)&&t.fillText(c,i,o),e.stroke&&Gp(t,e,l)&&t.strokeText(c,i,o);e.angle&&t.restore()}}))},pick:eg((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var s=Jg(e),a=s.x1,u=s.y1,c=Qg(Kg,e,1),l=-e.angle*vd,f=Math.cos(l),h=Math.sin(l),d=f*i-h*o+(a-f*a+h*u),p=h*i+f*o+(u-h*a-f*u);return c.contains(d,p)})),isect:function(t,e){const n=Qg(Kg,t,2);return zp(e,n[0],n[1],n[2],n[3])||zp(e,n[0],n[1],n[4],n[5])||zp(e,n[4],n[5],n[6],n[7])||zp(e,n[2],n[3],n[6],n[7])}},trail:cg("trail",(function(t,e){return Qd.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null}))};function em(t,e,n){var r=tm[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new op),t,n)}var nm={mark:null};function rm(t,e,n){var r,i,o,s,a=tm[t.marktype],u=a.bound,c=t.items,l=c&&c.length;if(a.nested)return l?o=c[0]:(nm.mark=t,o=nm),s=em(o,u,n),e=e&&e.union(s)||s;if(e=e||t.bounds&&t.bounds.clear()||new op,l)for(r=0,i=c.length;r<i;++r)e.union(em(c[r],u,n));return t.bounds=e}const im=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function om(t,e){return JSON.stringify(t,im,e)}function sm(t){return am("string"===typeof t?JSON.parse(t):t)}function am(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&am(o[n]);return i&&rm(t),t}function um(t){arguments.length?this.root=sm(t):(this.root=cm({marktype:"group",name:"root",role:"frame"}),this.root.items=[new ap(this.root)])}function cm(t,e){const n={bounds:new op,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function lm(t,e,n){return!t&&"undefined"!==typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function fm(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function hm(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=lm(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function dm(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function pm(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function gm(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function mm(t,e){this._active=null,this._handlers={},this._loader=t||yi(),this._tooltip=e||ym}function ym(t,e,n,r){t.element().setAttribute("title",r||"")}function vm(t){this._el=null,this._bgcolor=null,this._loader=new up(t)}um.prototype={toJSON(t){return om(this.root,t||0)},mark(t,e,n){const r=cm(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},mm.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=lm(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))},handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,o,s=t&&t.mark;if(s&&(i=tm[s.marktype]).tip){for((o=gm(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(s.items,o)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),s=i.height();let a=i.x1+r[0]+n.left,u=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)a+=t.x||0,u+=t.y||0;return{x:a,y:u,width:o,height:s,left:a,top:u,right:a+o,bottom:u+s}}},vm.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then((()=>e)):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const bm="dragenter",xm="dragleave",wm="dragover",_m="mousedown",Em="mousemove",Am="mouseout",Om="mouseover",Sm="click",Cm="mousewheel",Mm="touchstart",Pm="touchmove",km="touchend",Tm=["keydown","keypress","keyup",bm,xm,wm,_m,"mouseup",Em,Am,Om,Sm,"dblclick","wheel",Cm,Mm,Pm,km],Dm=Em,Fm=Am,jm=Sm;function Lm(t,e){mm.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}function Rm(t,e){(t=>t===Mm||t===Pm||t===km?[Mm,Pm,km]:[t])(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function Im(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||this.fire(n,r),this._active=o,this.fire(e,r)),this.fire(t,r)}}function Nm(t){return function(e){this.fire(t,e),this._active=null}}(0,g.XW)(Lm,mm,{initialize(t,e,n){return this._canvas=t&&fm(t,"canvas"),[Sm,_m,Em,Am,xm].forEach((t=>Rm(this,t))),mm.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:Tm,DOMMouseScroll(t){this.fire(Cm,t)},mousemove:Im(Em,Om,Am),dragover:Im(wm,bm,xm),mouseout:Nm(Am),dragleave:Nm(xm),mousedown(t){this._down=this._active,this.fire(_m,t)},click(t){this._down===this._active&&(this.fire(Sm,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Mm,t,!0)},touchmove(t){this.fire(Pm,t,!0)},touchend(t){this.fire(km,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===jm&&r&&r.href?this.handleHref(e,r,r.href):t!==Dm&&t!==Fm||this.handleTooltip(e,r,t!==Fm),i)for(let o=0,s=i.length;o<s;++o)i[o].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(Rm(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=gm(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const o=this.context();return tm[t.marktype].pick.call(this,o,t,e,n,r,i)}});var Bm="undefined"!==typeof window&&window.devicePixelRatio||1;function zm(t){vm.call(this,t),this._options={},this._redraw=!1,this._dirty=new op,this._tempb=new op}const $m=vm.prototype;function Um(t,e){mm.call(this,t,e);const n=this;n._hrefHandler=Vm(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=Vm(n,((t,e)=>{n.handleTooltip(t,e,t.type!==Fm)}))}(0,g.XW)(zm,vm,{initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:Ju(1,1,this._options.type),t&&this._canvas&&(dm(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),$m.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if($m.resize.call(this,t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const s="undefined"!==typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,a=t.getContext("2d"),u=s?Bm:i;t.width=e*u,t.height=n*u;for(const c in o)a[c]=o[c];s&&1!==u&&(t.style.width=e+"px",t.style.height=n+"px"),a.pixelRatio=u,a.setTransform(u,0,0,u,u*r[0],u*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||(0,g.vU)("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,o=this._dirty,s=((t,e,n)=>(new op).set(0,0,e,n).translate(-t[0],-t[1]))(n,r,i);e.save();const a=this._redraw||o.empty()?(this._redraw=!1,s.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(e,s.intersect(o),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,a),e.restore(),o.clear(),this},draw(t,e,n){const r=tm[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),(0,g.mf)(n)?(t.beginPath(),n(t),t.clip()):fg(t,e.group)}(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}});const Vm=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};(0,g.XW)(Um,mm,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(jm,this._hrefHandler),r.removeEventListener(Dm,this._tooltipHandler),r.removeEventListener(Fm,this._tooltipHandler)),this._svg=r=t&&fm(t,"svg"),r&&(r.addEventListener(jm,this._hrefHandler),r.addEventListener(Dm,this._tooltipHandler),r.addEventListener(Fm,this._tooltipHandler)),mm.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:Vm(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const Zm="aria-hidden",Wm="aria-label",qm="role",Gm="aria-roledescription",Hm="graphics-object",Xm="graphics-symbol",Ym=(t,e,n)=>({[qm]:t,[Gm]:e,[Wm]:n||void 0}),Km=(0,g.Rg)(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Jm={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?ry(t):null,i=t.context,o=i.scales[e.scale].value,s=i.dataflow.locale(),a=o.type;return("left"===n||"right"===n?"Y":"X")+"-axis"+(r?` titled '${r}'`:"")+` for a ${Sh(a)?"discrete":a} scale`+` with ${sd(s,o,t)}`}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?ry(t):null,r=`${e.type||""} legend`.trim(),i=e.scales,o=Object.keys(i),s=t.context,a=s.scales[i[o[0]]].value,u=s.dataflow.locale();return function(t){return t.length?t[0].toUpperCase()+t.slice(1):t}(r)+(n?` titled '${n}'`:"")+` for ${function(t){return(t=t.map((t=>t+("fill"===t||"stroke"===t?" color":"")))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+(0,g.fj)(t)}(o)}`+` with ${sd(u,a,t)}`}},"title-text":{desc:"title",caption:t=>`Title text '${ny(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${ny(t)}'`}},Qm={ariaRole:qm,ariaRoleDescription:Gm,description:Wm};function ty(t,e){const n=!1===e.aria;if(t(Zm,n||void 0),n||null==e.description)for(const r in Qm)t(Qm[r],void 0);else{const n=e.mark.marktype;t(Wm,e.description),t(qm,e.ariaRole||("group"===n?Hm:Xm)),t(Gm,e.ariaRoleDescription||`${n} mark`)}}function ey(t){return!1===t.aria?{[Zm]:!0}:Km[t.role]?null:Jm[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return Ym(e.role||Xm,e.desc,n.description||r(n))}catch(n){return null}}(t,Jm[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return Ym(n?Hm:Xm,`${e} mark container`,t.description)}(t)}function ny(t){return(0,g.IX)(t.text).join(" ")}function ry(t){try{return(0,g.IX)((0,g.fj)(t.items).items[0].text).join(" ")}catch(e){return null}}const iy=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");function oy(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>{var r;return null!=n&&(e+=` ${t}="${r=n,iy(r).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")}"`),s},s={open(a,...u){(o=>{e&&(t+=`${e}>${n}`,i()),r.push(o)})(a),e="<"+a;for(const t of u)for(const e in t)o(e,t[e]);return s},close(){const o=r.pop();return t+=e?e+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),s},attr:o,text:t=>(n+=iy(t),s),toString:()=>t};return s}const sy=t=>ay(oy(),t)+"";function ay(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes,r=n.length;for(let e=0;e<r;e++){const r=n[e];3===r.nodeType?t.text(r.nodeValue):ay(t,r)}}return t.close()}const uy={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},cy={fill:"none","stroke-miterlimit":10},ly="http://www.w3.org/2000/xmlns/",fy=bg.xmlns;function hy(t){vm.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const dy=vm.prototype;function py(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function gy(t,e,n){let r,i,o;if("radial"===e.gradient){let r=hm(t,n++,"pattern",fy);Ey(r,{id:ud+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=hm(r,0,"rect",fy),Ey(r,{width:1,height:1,fill:`url(${Oy()}#${e.id})`}),Ey(t=hm(t,n++,"radialGradient",fy),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else Ey(t=hm(t,n++,"linearGradient",fy),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=hm(t,r,"stop",fy),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return dm(t,r),n}function my(t,e,n){let r;return(t=hm(t,n,"clipPath",fy)).setAttribute("id",e.id),e.path?(r=hm(t,0,"path",fy),r.setAttribute("d",e.path)):(r=hm(t,0,"rect",fy),Ey(r,{x:0,y:0,width:e.width,height:e.height})),dm(t,1),n+1}function yy(t,e,n,r,i){let o,s=t._svg;if(!s&&(o=e.ownerDocument,s=lm(o,r,fy),t._svg=s,t.mark&&(s.__data__=t,s.__values__={fill:"default"},"g"===r))){const e=lm(o,"path",fy);s.appendChild(e),e.__data__=t;const n=lm(o,"g",fy);s.appendChild(n),n.__data__=t;const r=lm(o,"path",fy);s.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(s.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(s,n))&&e.insertBefore(s,n?n.nextSibling:e.firstChild),s}(0,g.XW)(hy,vm,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=hm(t,0,"svg",fy),this._svg.setAttributeNS(ly,"xmlns",fy),this._svg.setAttributeNS(ly,"xmlns:xlink",bg["xmlns:xlink"]),this._svg.setAttribute("version",bg.version),this._svg.setAttribute("class","marks"),dm(t,1),this._root=hm(this._svg,0,"g",fy),Ey(this._root,cy),dm(this._svg,1)),this.background(this._bgcolor),dy.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),dy.background.apply(this,arguments)},resize(t,e,n,r){return dy.resize.call(this,t,e,n,r),this._svg&&(Ey(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=hm(t,0,"rect",fy),Ey(n,{width:this._width,height:this._height,fill:e}));const r=sy(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),dm(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,s,a,u;for(s=0,a=t.length;s<a;++s)n=t[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=tm[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,py(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(u=r.items[0],u._svg&&this._update(o,u._svg,u)):n._svg&&(u=n._svg.parentNode,u&&u.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,py(n,e)),n._update=e)));return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=tm[e.marktype],o=!1===e.interactive?"none":null,s="g"===i.tag;let a=null,u=0;const c=yy(e,t,n,"g",r);c.setAttribute("class",pm(e));const l=ey(e);for(const h in l)Ay(c,h,l[h]);s||Ay(c,"pointer-events",o),Ay(c,"clip-path",e.clip?ip(this,e,e.group):null);const f=t=>{const e=this.isDirty(t),n=yy(t,c,a,i.tag,r);e&&(this._update(i,n,t),s&&function(t,e,n){e=e.lastChild.previousSibling;let r,i=0;Yp(n,(n=>{r=t.mark(e,n,r),++i})),dm(e,1+i)}(this,n,t)),a=n,++u};return i.nested?e.items.length&&f(e.items[0]):Yp(e,f),dm(c,u),c},_update(t,e,n){vy=e,by=e.__values__,ty(wy,n),t.attr(wy,n,this);const r=xy[t.type];r&&r.call(this,t,e,n),vy&&this.style(vy,n)},style(t,e){if(null!=e)for(const n in uy){let r="font"===n?Gg(e):e[n];if(r===by[n])continue;const i=uy[n];null==r?t.removeAttribute(i):(cd(r)&&(r=ld(r,this._defs.gradient,Oy())),t.setAttribute(i,r+"")),by[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=hm(t,1,"defs",fy)),r=gy(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=hm(t,1,"defs",fy)),r=my(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):dm(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});let vy=null,by=null;const xy={group(t,e,n){const r=vy=e.childNodes[2];by=r.__values__,t.foreground(wy,n,this),by=e.__values__,vy=e.childNodes[1],t.content(wy,n,this);const i=vy=e.childNodes[0];t.background(wy,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==by.events&&(Ay(r,"pointer-events",o),Ay(i,"pointer-events",o),by.events=o),n.strokeForeground&&n.stroke){const t=n.fill;Ay(r,"display",null),this.style(i,n),Ay(i,"stroke",null),t&&(n.fill=null),by=r.__values__,this.style(r,n),t&&(n.fill=t),vy=null}else Ay(r,"display","none")},image(t,e,n){!1===n.smooth?(_y(e,"image-rendering","optimizeSpeed"),_y(e,"image-rendering","pixelated")):_y(e,"image-rendering",null)},text(t,e,n){const r=Zg(n);let i,o,s,a;(0,g.kJ)(r)?(o=r.map((t=>qg(n,t))),i=o.join("\n"),i!==by.text&&(dm(e,0),s=e.ownerDocument,a=Vg(n),o.forEach(((t,r)=>{const i=lm(s,"tspan",fy);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",a)),e.appendChild(i)})),by.text=i)):(o=qg(n,r),o!==by.text&&(e.textContent=o,by.text=o)),Ay(e,"font-family",Gg(n)),Ay(e,"font-size",Ug(n)+"px"),Ay(e,"font-style",n.fontStyle),Ay(e,"font-variant",n.fontVariant),Ay(e,"font-weight",n.fontWeight)}};function wy(t,e,n){e!==by[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(vy,t,e,n):Ay(vy,t,e),by[t]=e)}function _y(t,e,n){n!==by[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),by[e]=n)}function Ey(t,e){for(const n in e)Ay(t,n,e[n])}function Ay(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function Oy(){let t;return"undefined"===typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Sy(t){vm.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}(0,g.XW)(Sy,vm,{svg(){return this._text},_render(t){const e=oy();e.open("svg",(0,g.l7)({},bg,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",cy,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=tm[e.marktype],r=n.tag,i=[ty,n.attr];t.open("g",{class:pm(e),"clip-path":e.clip?ip(this,e,e.group):null},ey(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const s=this.href(o);if(s&&t.open("a",s),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=Zg(o);if((0,g.kJ)(e)){const n={x:0,dy:Vg(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(qg(o,e[r])).close()}else t.text(qg(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,s=o.stroke;r&&s&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Yp(o,(e=>this.mark(t,e))),t.close(),r&&s?(i&&(o.fill=null),o.stroke=s,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),s&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):Yp(e,o),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null},attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(o,e,this))):n(o,e,this),r&&function(t,e,n,r,i){if(null==e)return t;"bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(t["font-family"]=Gg(e),t["font-size"]=Ug(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const o in uy){let n=e[o];const r=uy[o];("transparent"!==n||"fill"!==r&&"stroke"!==r)&&null!=n&&(cd(n)&&(n=ld(n,i.gradient,"")),t[r]=n)}}(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:ud+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}});const Cy="canvas",My="none",Py={Canvas:Cy,PNG:"png",SVG:"svg",None:My},ky={};function Ty(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(ky[t]=e,this):ky[t]}function Dy(t,e,n){const r=[],i=(new op).union(e),o=t.marktype;return o?Fy(t,i,n,r):"group"===o?jy(t,i,n,r):(0,g.vU)("Intersect scene must be mark node or group item.")}function Fy(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,s=i.length;let a=0;if("group"===o)for(;a<s;++a)jy(i[a],e,n,r);else for(const t=tm[o].isect;a<s;++a){const n=i[a];Ly(n,e,t)&&r.push(n)}}return r}function jy(t,e,n,r){n&&n(t.mark)&&Ly(t,e,tm.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const s=t.x||0,a=t.y||0;e.translate(-s,-a);for(let t=0;t<o;++t)Fy(i[t],e,n,r);e.translate(s,a)}return r}function Ly(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}ky.canvas=ky.png={renderer:zm,headless:zm,handler:Lm},ky.svg={renderer:hy,headless:Sy,handler:Um},ky.none={};const Ry=new op;function Iy(t){const e=t.clip;if((0,g.mf)(e))e(Pp(Ry.clear()));else{if(!e)return;Ry.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(Ry)}function Ny(t,e,n){return t===e||("path"===n?By(t,e):t instanceof Date&&e instanceof Date?+t===+e:(0,g.hj)(t)&&(0,g.hj)(e)?Math.abs(t-e)<=1e-9:t&&e&&((0,g.Kn)(t)||(0,g.Kn)(e))?function(t,e){var n,r,i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!Ny(t[n=i[r]],e[n],n))return!1;return typeof t===typeof e}(t,e):t==e)}function By(t,e){return Ny(yd(t),yd(e))}function zy(){rp(),ad=0}const $y="top",Uy="left",Vy="right",Zy="bottom",Wy="start",qy="middle",Gy="end",Hy="group",Xy="axis",Yy="title",Ky="frame",Jy="scope",Qy="legend",tv="row-header",ev="row-footer",nv="row-title",rv="column-header",iv="column-footer",ov="column-title",sv="padding",av="fit",uv="fit-x",cv="fit-y",lv="none",fv="all",hv="each",dv="flush",pv="column",gv="row";function mv(t){no.call(this,null,t)}function yv(t,e,n){return e(t.bounds.clear(),t,n)}(0,g.XW)(mv,no,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=tm[i],s=o.bound;let a,u=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),u=yv(r,s),r.items.forEach((t=>{t.bounds.clear().union(u)}));else if(i===Hy||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),u.clear(),r.items.forEach((t=>u.union(yv(t,s)))),r.role){case Xy:case Qy:case Yy:e.reflow()}else a=e.changed(e.REM),e.visit(e.ADD,(t=>{u.union(yv(t,s))})),e.visit(e.MOD,(t=>{a=a||u.alignsWith(t.bounds),n.dirty(t),u.union(yv(t,s))})),a&&(u.clear(),r.items.forEach((t=>u.union(t.bounds))));return Iy(r),e.modifies("bounds")}});const vv=":vega_identifier:";function bv(t){no.call(this,0,t)}function xv(t){no.call(this,null,t)}function wv(t){no.call(this,null,t)}bv.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},(0,g.XW)(bv,no,{transform(t,e){const n=(i=e.dataflow)._signals[vv]||(i._signals[vv]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++o)),n.set(this.value=o),e}}),(0,g.XW)(xv,no,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===Hy?ap:sp;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const _v={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&Ev(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},Ev=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),Av=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(Ev(o,n=t[r].bounds,e))return!0},Ov=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},Sv=t=>(t.forEach((t=>t.opacity=1)),t),Cv=(t,e)=>t.reflow(e.modified()).modifies("opacity");function Mv(t){no.call(this,null,t)}(0,g.XW)(wv,no,{transform(t,e){const n=_v[t.method]||_v.parity,r=t.separation||0;let i,o,s=e.materialize(e.SOURCE).source;if(!s||!s.length)return;if(!t.method)return t.modified("method")&&(Sv(s),e=Cv(e,t)),e;if(s=s.filter(Ov),!s.length)return;if(t.sort&&(s=s.slice().sort(t.sort)),i=Sv(s),e=Cv(e,t),i.length>=3&&Av(i,r)){do{i=n(i,r)}while(i.length>=3&&Av(i,r));i.length<3&&!(0,g.fj)(s).opacity&&(i.length>1&&((0,g.fj)(i).opacity=0),(0,g.fj)(s).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=((t,e,n)=>{var r=t.range(),i=new op;return e===$y||e===Zy?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),s.forEach((t=>{o(t)||(t.opacity=0)})));const a=i[0].mark.bounds.clear();return s.forEach((t=>{t.opacity&&a.union(t.bounds)})),e}}),(0,g.XW)(Mv,no,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const Pv=new op;function kv(t,e,n){return t[e]===n?0:(t[e]=n,1)}function Tv(t){var e=t.items[0].orient;return e===Uy||e===Vy}function Dv(t,e,n,r){var i,o,s=e.items[0],a=s.datum,u=null!=s.translate?s.translate:.5,c=s.orient,l=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(a),f=s.range,h=s.offset,d=s.position,p=s.minExtent,g=s.maxExtent,m=a.title&&s.items[l[2]].items[0],y=s.titlePadding,v=s.bounds,b=m&&Wg(m),x=0,w=0;switch(Pv.clear().union(v),v.clear(),(i=l[0])>-1&&v.union(s.items[i].bounds),(i=l[1])>-1&&v.union(s.items[i].bounds),c){case $y:x=d||0,w=-h,o=Math.max(p,Math.min(g,-v.y1)),v.add(0,-o).add(f,0),m&&Fv(t,m,o,y,b,0,-1,v);break;case Uy:x=-h,w=d||0,o=Math.max(p,Math.min(g,-v.x1)),v.add(-o,0).add(0,f),m&&Fv(t,m,o,y,b,1,-1,v);break;case Vy:x=n+h,w=d||0,o=Math.max(p,Math.min(g,v.x2)),v.add(0,0).add(o,f),m&&Fv(t,m,o,y,b,1,1,v);break;case Zy:x=d||0,w=r+h,o=Math.max(p,Math.min(g,v.y2)),v.add(0,0).add(f,o),m&&Fv(t,m,o,y,0,0,1,v);break;default:x=s.x,w=s.y}return fp(v.translate(x,w),s),kv(s,"x",x+u)|kv(s,"y",w+u)&&(s.bounds=Pv,t.dirty(s),s.bounds=v,t.dirty(s)),s.mark.bounds.clear().union(v)}function Fv(t,e,n,r,i,o,s,a){const u=e.bounds;if(e.auto){const a=s*(n+i+r);let c=0,l=0;t.dirty(e),o?c=(e.x||0)-(e.x=a):l=(e.y||0)-(e.y=a),e.mark.bounds.clear().union(u.translate(-c,-l)),t.dirty(e)}a.union(u)}const jv=(t,e)=>Math.floor(Math.min(t,e)),Lv=(t,e)=>Math.ceil(Math.max(t,e));function Rv(t){return(new op).set(0,0,t.width||0,t.height||0)}function Iv(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function Nv(t,e,n){const r=(0,g.Kn)(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function Bv(t){return t<0?Math.ceil(-t):0}function zv(t,e,n){var r,i,o,s,a,u,c,l,f,h,d,p=!n.nodirty,g=n.bounds===dv?Rv:Iv,m=Pv.set(0,0,0,0),y=Nv(n.align,pv),v=Nv(n.align,gv),b=Nv(n.padding,pv),x=Nv(n.padding,gv),w=n.columns||e.length,_=w<=0?1:Math.ceil(e.length/w),E=e.length,A=Array(E),O=Array(w),S=0,C=Array(E),M=Array(_),P=0,k=Array(E),T=Array(E),D=Array(E);for(i=0;i<w;++i)O[i]=0;for(i=0;i<_;++i)M[i]=0;for(i=0;i<E;++i)u=e[i],a=D[i]=g(u),u.x=u.x||0,k[i]=0,u.y=u.y||0,T[i]=0,o=i%w,s=~~(i/w),S=Math.max(S,c=Math.ceil(a.x2)),P=Math.max(P,l=Math.ceil(a.y2)),O[o]=Math.max(O[o],c),M[s]=Math.max(M[s],l),A[i]=b+Bv(a.x1),C[i]=x+Bv(a.y1),p&&t.dirty(e[i]);for(i=0;i<E;++i)i%w===0&&(A[i]=0),i<w&&(C[i]=0);if(y===hv)for(o=1;o<w;++o){for(d=0,i=o;i<E;i+=w)d<A[i]&&(d=A[i]);for(i=o;i<E;i+=w)A[i]=d+O[o-1]}else if(y===fv){for(d=0,i=0;i<E;++i)i%w&&d<A[i]&&(d=A[i]);for(i=0;i<E;++i)i%w&&(A[i]=d+S)}else for(y=!1,o=1;o<w;++o)for(i=o;i<E;i+=w)A[i]+=O[o-1];if(v===hv)for(s=1;s<_;++s){for(d=0,r=(i=s*w)+w;i<r;++i)d<C[i]&&(d=C[i]);for(i=s*w;i<r;++i)C[i]=d+M[s-1]}else if(v===fv){for(d=0,i=w;i<E;++i)d<C[i]&&(d=C[i]);for(i=w;i<E;++i)C[i]=d+P}else for(v=!1,s=1;s<_;++s)for(r=(i=s*w)+w;i<r;++i)C[i]+=M[s-1];for(f=0,i=0;i<E;++i)f=A[i]+(i%w?f:0),k[i]+=f-e[i].x;for(o=0;o<w;++o)for(h=0,i=o;i<E;i+=w)h+=C[i],T[i]+=h-e[i].y;if(y&&Nv(n.center,pv)&&_>1)for(i=0;i<E;++i)(f=(a=y===fv?S:O[i%w])-D[i].x2-e[i].x-k[i])>0&&(k[i]+=f/2);if(v&&Nv(n.center,gv)&&1!==w)for(i=0;i<E;++i)(h=(a=v===fv?P:M[~~(i/w)])-D[i].y2-e[i].y-T[i])>0&&(T[i]+=h/2);for(i=0;i<E;++i)m.union(D[i].translate(k[i],T[i]));switch(f=Nv(n.anchor,"x"),h=Nv(n.anchor,"y"),Nv(n.anchor,pv)){case Gy:f-=m.width();break;case qy:f-=m.width()/2}switch(Nv(n.anchor,gv)){case Gy:h-=m.height();break;case qy:h-=m.height()/2}for(f=Math.round(f),h=Math.round(h),m.clear(),i=0;i<E;++i)e[i].mark.bounds.clear();for(i=0;i<E;++i)(u=e[i]).x+=k[i]+=f,u.y+=T[i]+=h,m.union(u.mark.bounds.union(u.bounds.translate(k[i],T[i]))),p&&t.dirty(u);return m}function $v(t,e,n){var r,i,o,s,a,u,c,l=function(t){var e,n,r=t.items,i=r.length,o=0;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(e=r[o]).items,e.marktype===Hy)switch(e.role){case Xy:case Qy:case Yy:break;case tv:s.rowheaders.push(...n);break;case ev:s.rowfooters.push(...n);break;case rv:s.colheaders.push(...n);break;case iv:s.colfooters.push(...n);break;case nv:s.rowtitle=n[0];break;case ov:s.coltitle=n[0];break;default:s.marks.push(...n)}return s}(e),f=l.marks,h=n.bounds===dv?Uv:Vv,d=n.offset,p=n.columns||f.length,g=p<=0?1:Math.ceil(f.length/p),m=g*p;const y=zv(t,f,n);y.empty()&&y.set(0,0,0,0),l.rowheaders&&(u=Nv(n.headerBand,gv,null),r=Zv(t,l.rowheaders,f,p,g,-Nv(d,"rowHeader"),jv,0,h,"x1",0,p,1,u)),l.colheaders&&(u=Nv(n.headerBand,pv,null),i=Zv(t,l.colheaders,f,p,p,-Nv(d,"columnHeader"),jv,1,h,"y1",0,1,p,u)),l.rowfooters&&(u=Nv(n.footerBand,gv,null),o=Zv(t,l.rowfooters,f,p,g,Nv(d,"rowFooter"),Lv,0,h,"x2",p-1,p,1,u)),l.colfooters&&(u=Nv(n.footerBand,pv,null),s=Zv(t,l.colfooters,f,p,p,Nv(d,"columnFooter"),Lv,1,h,"y2",m-p,1,p,u)),l.rowtitle&&(a=Nv(n.titleAnchor,gv),c=Nv(d,"rowTitle"),c=a===Gy?o+c:r-c,u=Nv(n.titleBand,gv,.5),Wv(t,l.rowtitle,c,0,y,u)),l.coltitle&&(a=Nv(n.titleAnchor,pv),c=Nv(d,"columnTitle"),c=a===Gy?s+c:i-c,u=Nv(n.titleBand,pv,.5),Wv(t,l.coltitle,c,1,y,u))}function Uv(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function Vv(t,e){return t.bounds[e]}function Zv(t,e,n,r,i,o,s,a,u,c,l,f,h,d){var p,g,m,y,v,b,x,w,_,E=n.length,A=0,O=0;if(!E)return A;for(p=l;p<E;p+=f)n[p]&&(A=s(A,u(n[p],c)));if(!e.length)return A;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),A+=o,g=0,y=e.length;g<y;++g)t.dirty(e[g]),e[g].mark.bounds.clear();for(p=l,g=0,y=e.length;g<y;++g,p+=f){for(v=(b=e[g]).mark.bounds,m=p;m>=0&&null==(x=n[m]);m-=h);a?(w=null==d?x.x:Math.round(x.bounds.x1+d*x.bounds.width()),_=A):(w=A,_=null==d?x.y:Math.round(x.bounds.y1+d*x.bounds.height())),v.union(b.bounds.translate(w-(b.x||0),_-(b.y||0))),b.x=w,b.y=_,t.dirty(b),O=s(O,v[c])}return O}function Wv(t,e,n,r,i,o){if(e){t.dirty(e);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),e.bounds.translate(s-(e.x||0),a-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=s,e.y=a,t.dirty(e)}}function qv(t,e,n,r,i,o,s){const a=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),u=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,a("offset",0)),c=a("anchor",Wy),l=c===Gy?1:c===qy?.5:0,f={align:hv,bounds:a("bounds",dv),columns:"vertical"===a("direction")?1:t.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(e){case Uy:f.anchor={x:Math.floor(r.x1)-u,column:Gy,y:l*(s||r.height()+2*r.y1),row:c};break;case Vy:f.anchor={x:Math.ceil(r.x2)+u,y:l*(s||r.height()+2*r.y1),row:c};break;case $y:f.anchor={y:Math.floor(i.y1)-u,row:Gy,x:l*(o||i.width()+2*i.x1),column:c};break;case Zy:f.anchor={y:Math.ceil(i.y2)+u,x:l*(o||i.width()+2*i.x1),column:c};break;case"top-left":f.anchor={x:u,y:u};break;case"top-right":f.anchor={x:o-u,y:u,column:Gy};break;case"bottom-left":f.anchor={x:u,y:s-u,row:Gy};break;case"bottom-right":f.anchor={x:o-u,y:s-u,column:Gy,row:Gy}}return f}function Gv(t,e){var n,r,i=e.items[0],o=i.datum,s=i.orient,a=i.bounds,u=i.x,c=i.y;return i._bounds?i._bounds.clear().union(a):i._bounds=a.clone(),a.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var s=e.items[1].items[0],a=s.anchor,u=e.titlePadding||0,c=r-s.x,l=r-s.y;switch(s.orient){case Uy:i+=Math.ceil(s.bounds.width())+u;break;case Vy:case Zy:break;default:o+=s.bounds.height()+u}switch((i||o)&&Xv(t,n,i,o),s.orient){case Uy:l+=Hv(e,n,s,a,1,1);break;case Vy:c+=Hv(e,n,s,Gy,0,0)+u,l+=Hv(e,n,s,a,1,1);break;case Zy:c+=Hv(e,n,s,a,0,0),l+=Hv(e,n,s,Gy,-1,0,1)+u;break;default:c+=Hv(e,n,s,a,0,0)}(c||l)&&Xv(t,s,c,l),(c=Math.round(s.bounds.x1-r))<0&&(Xv(t,n,-c,0),Xv(t,s,-c,0))}else(i||o)&&Xv(t,n,i,o)}(t,i,i.items[0].items[0]),a=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,a),n=2*i.padding,r=2*i.padding,a.empty()||(n=Math.ceil(a.width()+n),r=Math.ceil(a.height()+r)),"symbol"===o.type&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),s!==lv&&(i.x=u=0,i.y=c=0),i.width=n,i.height=r,fp(a.set(u,c,u+n,c+r),i),i.mark.bounds.clear().union(a),i}function Hv(t,e,n,r,i,o,s){const a="symbol"!==t.datum.type,u=n.datum.vgrad,c=(!a||!o&&u||s?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,l=u&&o?c:0,f=u&&o?0:c,h=i<=0?0:Wg(n);return Math.round(r===Wy?l:r===Gy?f-h:.5*(c-h))}function Xv(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function Yv(t){no.call(this,null,t)}function Kv(t,e){let n=0;if(void 0===e)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function Jv(t){no.call(this,null,t)}function Qv(t){no.call(this,null,t)}function tb(){return Oi({})}function eb(t){no.call(this,null,t)}function nb(t){no.call(this,[],t)}(0,g.XW)(Yv,no,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&$v(n,e,t.layout),function(t,e,n){var r,i,o,s,a,u=e.items,c=Math.max(0,e.width||0),l=Math.max(0,e.height||0),f=(new op).set(0,0,c,l),h=f.clone(),d=f.clone(),p=[];for(s=0,a=u.length;s<a;++s)switch((i=u[s]).role){case Xy:(Tv(i)?h:d).union(Dv(t,i,c,l));break;case Yy:r=i;break;case Qy:p.push(Gv(t,i));break;case Ky:case Jy:case tv:case ev:case nv:case rv:case iv:case ov:h.union(i.bounds),d.union(i.bounds);break;default:f.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(o=t.orient||Vy)!==lv&&(e[o]||(e[o]=[])).push(t)}));for(const r in e){const i=e[r];zv(t,i,qv(i,r,n.legends,h,d,c,l))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),n.autosize&&n.autosize.type===av)switch(e.orient){case Uy:case Vy:f.add(r.x1,0).add(r.x2,0);break;case $y:case Zy:f.add(0,r.y1).add(0,r.y2)}else f.union(r)}))}f.union(h).union(d),r&&f.union(function(t,e,n,r,i){var o,s=e.items[0],a=s.frame,u=s.orient,c=s.anchor,l=s.offset,f=s.padding,h=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],p=u===Uy||u===Vy?r:n,g=0,m=0,y=0,v=0,b=0;if(a!==Hy?u===Uy?(g=i.y2,p=i.y1):u===Vy?(g=i.y1,p=i.y2):(g=i.x1,p=i.x2):u===Uy&&(g=r,p=0),o=c===Wy?g:c===Gy?p:(g+p)/2,d&&d.text){switch(u){case $y:case Zy:b=h.bounds.height()+f;break;case Uy:v=h.bounds.width()+f;break;case Vy:v=-h.bounds.width()-f}Pv.clear().union(d.bounds),Pv.translate(v-(d.x||0),b-(d.y||0)),kv(d,"x",v)|kv(d,"y",b)&&(t.dirty(d),d.bounds.clear().union(Pv),d.mark.bounds.clear().union(Pv),t.dirty(d)),Pv.clear().union(d.bounds)}else Pv.clear();switch(Pv.union(h.bounds),u){case $y:m=o,y=i.y1-Pv.height()-l;break;case Uy:m=i.x1-Pv.width()-l,y=o;break;case Vy:m=i.x2+Pv.width()+l,y=o;break;case Zy:m=o,y=i.y2+l;break;default:m=s.x,y=s.y}return kv(s,"x",m)|kv(s,"y",y)&&(Pv.translate(m,y),t.dirty(s),s.bounds.clear().union(Pv),e.bounds.clear().union(Pv),t.dirty(s)),s.bounds}(t,r,c,l,f));e.clip&&f.set(0,0,e.width||0,e.height||0);!function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let s=t._width,a=t._height,u=Math.max(0,e.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,e.height||0),f=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-u)),d=Math.max(0,Math.ceil(n.y2-l));if(i.contains===sv){const e=t.padding();s-=e.left+e.right,a-=e.top+e.bottom}o===lv?(c=0,f=0,u=s,l=a):o===av?(u=Math.max(0,s-c-h),l=Math.max(0,a-f-d)):o===uv?(u=Math.max(0,s-c-h),a=l+f+d):o===cv?(s=u+c+h,l=Math.max(0,a-f-d)):"pad"===o&&(s=u+c+h,a=l+f+d);t._resizeView(s,a,u,l,[c,f],i.resize)}(t,e,f,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}}),(0,g.XW)(Jv,no,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,s=Wh(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),a=t.format||Hh(n,o,s,t.formatSpecifier,t.formatType,!!t.values),u=t.values?qh(o,t.values,s):Gh(o,s);return i&&(r.rem=i),i=u.map(((t,e)=>Oi({index:e/(u.length-1||1),value:t,label:a(t)}))),t.extra&&i.length&&i.push(Oi({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),(0,g.XW)(Qv,no,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||tb,o=t.key||Ei,s=this.value;return(0,g.kJ)(r.encode)&&(r.encode=null),s&&(t.modified("key")||e.modified(o))&&(0,g.vU)("DataJoin does not support modified key function or fields."),s||(e=e.addAll(),this.value=s=function(t){const e=(0,g.Xr)().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,(t=>{const e=o(t);let n=s.get(e);n?n.exit?(s.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),s.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=o(t),n=s.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=o(t),n=s.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++s.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}}),(0,g.XW)(eb,no,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if((0,g.kJ)(o)){if(!n.changed()&&!o.every((t=>i[t])))return e.StopPropagation;o=o[0],n.encode=null}var s="enter"===o,a=i.update||g.k,u=i.enter||g.k,c=i.exit||g.k,l=(o&&!s?i[o]:a)||g.k;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{u(e,t),a(e,t)})),n.modifies(u.output),n.modifies(a.output),l!==g.k&&l!==a&&(e.visit(e.ADD,(e=>{l(e,t)})),n.modifies(l.output))),e.changed(e.REM)&&c!==g.k&&(e.visit(e.REM,(e=>{c(e,t)})),n.modifies(c.output)),s||l!==g.k){const i=e.MOD|(t.modified()?e.REFLOW:0);s?(e.visit(i,(e=>{const i=u(e,t)||r;(l(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(u.output)):e.visit(i,(e=>{(l(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)}return n.changed()?n:e.StopPropagation}}),(0,g.XW)(nb,no,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,s,a=e.dataflow.locale(),u=e.fork(e.NO_SOURCE|e.NO_FIELDS),c=this.value,l=t.type||$h,f=t.scale,h=+t.limit,d=Wh(f,null==t.count?5:t.count,t.minstep),p=!!t.values||l===$h,m=t.format||Qh(a,f,d,l,t.formatSpecifier,t.formatType,p),y=t.values||Jh(f,d);return c&&(u.rem=c),l===$h?(h&&y.length>h?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),c=y.slice(0,h-1),s=!0):c=y,(0,g.mf)(i=t.size)?(t.values||0!==f(c[0])||(c=c.slice(1)),o=c.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=(0,g.a9)(o=i||8),c=c.map(((e,n)=>Oi({index:n,label:m(e,n,c),value:e,offset:o,size:i(e,t)}))),s&&(s=y[c.length],c.push(Oi({index:c.length,label:"\u2026".concat(y.length-c.length," entries"),value:s,offset:o,size:i(s,t)})))):"gradient"===l?(n=f.domain(),r=Lh(f,n[0],(0,g.fj)(n)),y.length<3&&!t.values&&n[0]!==(0,g.fj)(n)&&(y=[n[0],(0,g.fj)(n)]),c=y.map(((t,e)=>Oi({index:e,label:m(t,e,y),value:t,perc:r(t)})))):(i=y.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+(0,g.fj)(e),o=i-r;if(t.type===oh){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(f),c=y.map(((t,e)=>Oi({index:e,label:m(t,e,y),value:t,perc:e?r(t):0,perc2:e===i?1:r(y[e+1])})))),u.source=c,u.add=c,this.value=c,u}});const rb=t=>t.source.x,ib=t=>t.source.y,ob=t=>t.target.x,sb=t=>t.target.y;function ab(t){no.call(this,{},t)}ab.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},(0,g.XW)(ab,no,{transform(t,e){var n=t.sourceX||rb,r=t.sourceY||ib,i=t.targetX||ob,o=t.targetY||sb,s=t.as||"path",a=t.orient||"vertical",u=t.shape||"line",c=fb.get(u+"-"+a)||fb.get(u);return c||(0,g.vU)("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[s]=c(n(t),r(t),i(t),o(t))})),e.reflow(t.modified()).modifies(s)}});const ub=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,cb=(t,e,n,r)=>{var i=n-t,o=r-e,s=Math.sqrt(i*i+o*o)/2;return"M"+t+","+e+"A"+s+","+s+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},lb=(t,e,n,r)=>{const i=n-t,o=r-e,s=.2*(i+o),a=.2*(o-i);return"M"+t+","+e+"C"+(t+s)+","+(e+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},fb=(0,g.Xr)({line:ub,"line-radial":(t,e,n,r)=>ub(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:cb,"arc-radial":(t,e,n,r)=>cb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:lb,"curve-radial":(t,e,n,r)=>lb(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*s+","+e*a+"L"+r*s+","+r*a},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n),u=(e+r)/2;return"M"+e*i+","+e*o+"C"+u*i+","+u*o+" "+u*s+","+u*a+" "+r*s+","+r*a}});function hb(t){no.call(this,null,t)}hb.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},(0,g.XW)(hb,no,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],s=o[0],a=o[1],u=t.field||g.kX,c=t.startAngle||0,l=null!=t.endAngle?t.endAngle:2*Math.PI,f=e.source,h=f.map(u),d=h.length,p=c,m=(l-c)/Kv(h),y=ls(d);for(t.sort&&y.sort(((t,e)=>h[t]-h[e])),n=0;n<d;++n)i=h[y[n]],(r=f[y[n]])[s]=p,r[a]=p+=i*m;return this.value=h,e.reflow(t.modified()).modifies(o)}});function db(t){return Oh(t)&&t!==eh}const pb=(0,g.Rg)(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function gb(t){no.call(this,null,t),this.modified(!0)}function mb(t,e,n){Mh(t)&&(Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+(0,g.m8)(e)));return e}function yb(t,e,n){return(0,g.mf)(t)&&(e||n)?Dh(t,vb(e||[0,1],n)):t}function vb(t,e){return e?t.slice().reverse():t}function bb(t){no.call(this,null,t)}(0,g.XW)(gb,no,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";if(n===eh)return"sequential-linear";(function(t){const e=t.type;return Oh(e)&&e!==Qf&&e!==th&&(t.scheme||t.range&&t.range.length&&t.range.every(g.HD))})(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?"sequential-":3===e?"diverging-":"");return(r+n||Hf).toLowerCase()}(t);for(i in r&&i===r.type||(this.value=r=_h(i)()),t)if(!pb[i]){if("padding"===i&&db(r.type))continue;(0,g.mf)(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){t!==uh&&t!==ah&&(0,g.vU)("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===ah?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Gf(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;(0,g.kJ)(e.scheme)?r=Fh(e.scheme,e.interpolate,e.interpolateGamma):(r=zh(e.scheme.toLowerCase()))||(0,g.vU)("Unrecognized scheme name: ".concat(e.scheme));return n=t===oh?n+1:t===ch?n-1:t===rh||t===ih?+e.schemeCount||5:n,Ph(t)?yb(r,i,e.reverse):(0,g.mf)(r)?jh(yb(r,i),n):t===sh?r:r.slice(0,n)}(r,e,n),(0,g.mf)(o))){if(t.interpolator)return t.interpolator(o);(0,g.vU)("Scale type ".concat(r," does not support interpolating color schemes."))}if(o&&Ph(r))return t.interpolator(Fh(vb(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(Rh(e.interpolate,e.interpolateGamma)):(0,g.mf)(t.round)?t.round(i):(0,g.mf)(t.rangeRound)&&t.interpolate(i?al:sl);o&&t.range(vb(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!(0,g.kJ)(r)){const e=t.domain(),n=e[0],i=(0,g.fj)(e),o=r.step;let s=null==r.start?n:r.start,a=null==r.stop?i:r.stop;o||(0,g.vU)("Scale bins parameter missing step property."),s<n&&(s=o*Math.ceil(n/o)),a>i&&(a=o*Math.floor(i/o)),r=ls(s,a+o/2,o)}r?t.bins=r:t.bins&&delete t.bins;t.type===ch&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain());return n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(mb(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,s=e.domain,a=t.type,u=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Hf||e===Yf||e===Kf)}(t);if(!s)return 0;db(a)&&e.padding&&s[0]!==(0,g.fj)(s)&&(s=function(t,e,n,r,i,o){var s=Math.abs((0,g.fj)(n)-n[0]),a=s/(s-2*r),u=t===Xf?(0,g.dH)(e,null,a):t===Kf?(0,g.mK)(e,null,a,.5):t===Yf?(0,g.mK)(e,null,a,i||1):t===Jf?(0,g.bV)(e,null,a,o||1):(0,g.ay)(e,null,a);return(e=e.slice())[0]=u[0],e[e.length-1]=u[1],e}(a,s,e.range,e.padding,e.exponent,e.constant));if((u||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(s=s.slice()).length-1||1,u&&(s[0]>0&&(s[0]=0),s[i]<0&&(s[i]=0)),null!=e.domainMin&&(s[0]=e.domainMin),null!=e.domainMax&&(s[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>s[i]?i+1:o<s[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),s.splice(t,0,o)}t.domain(mb(a,s,n)),a===sh&&t.unknown(e.domainImplicit?rc:void 0);e.nice&&t.nice&&t.nice(!0!==e.nice&&Wh(t,e.nice)||null);return s.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),(0,g.XW)(bb,no,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(Pi(t.sort)),this.modified(n),e}});const xb="zero",wb="center",_b="normalize",Eb=["y0","y1"];function Ab(t){no.call(this,null,t)}function Ob(t,e,n,r,i){for(var o,s=(e-t.sum)/2,a=t.length,u=0;u<a;++u)(o=t[u])[r]=s,o[i]=s+=Math.abs(n(o))}function Sb(t,e,n,r,i){for(var o,s=1/t.sum,a=0,u=t.length,c=0,l=0;c<u;++c)(o=t[c])[r]=a,o[i]=a=s*(l+=Math.abs(n(o)))}function Cb(t,e,n,r,i){for(var o,s,a=0,u=0,c=t.length,l=0;l<c;++l)(o=+n(s=t[l]))<0?(s[r]=u,s[i]=u+=o):(s[r]=a,s[i]=a+=o)}Ab.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:xb,values:[xb,wb,_b]},{name:"as",type:"string",array:!0,length:2,default:Eb}]},(0,g.XW)(Ab,no,{transform(t,e){var n,r,i,o,s=t.as||Eb,a=s[0],u=s[1],c=Pi(t.sort),l=t.field||g.kX,f=t.offset===wb?Ob:t.offset===_b?Sb:Cb;for(n=function(t,e,n,r){var i,o,s,a,u,c,l,f,h,d=[],p=t=>t(u);if(null==e)d.push(t.slice());else for(i={},o=0,s=t.length;o<s;++o)u=t[o],(l=i[c=e.map(p)])||(i[c]=l=[],d.push(l)),l.push(u);for(c=0,h=0,a=d.length;c<a;++c){for(o=0,f=0,s=(l=d[c]).length;o<s;++o)f+=Math.abs(r(l[o]));l.sum=f,f>h&&(h=f),n&&l.sort(n)}return d.max=h,d}(e.source,t.groupby,c,l),r=0,i=n.length,o=n.max;r<i;++r)f(n[r],o,l,a,u);return e.reflow(t.modified()).modifies(s)}});var Mb=t=>t;function Pb(t,e){t&&Tb.hasOwnProperty(t.type)&&Tb[t.type](t,e)}var kb={Feature:function(t,e){Pb(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Pb(n[r].geometry,e)}},Tb={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Db(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Db(n[r],e,0)},Polygon:function(t,e){Fb(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Fb(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Pb(n[r],e)}};function Db(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function Fb(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Db(t[n],e,1);e.polygonEnd()}function jb(t,e){t&&kb.hasOwnProperty(t.type)?kb[t.type](t,e):Pb(t,e)}class Lb{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,s=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);s&&(e[n++]=s),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var Rb=1e-6,Ib=1e-12,Nb=Math.PI,Bb=Nb/2,zb=Nb/4,$b=2*Nb,Ub=180/Nb,Vb=Nb/180,Zb=Math.abs,Wb=Math.atan,qb=Math.atan2,Gb=Math.cos,Hb=Math.ceil,Xb=Math.exp,Yb=(Math.floor,Math.hypot),Kb=Math.log,Jb=Math.pow,Qb=Math.sin,tx=Math.sign||function(t){return t>0?1:t<0?-1:0},ex=Math.sqrt,nx=Math.tan;function rx(t){return t>1?0:t<-1?Nb:Math.acos(t)}function ix(t){return t>1?Bb:t<-1?-Bb:Math.asin(t)}function ox(){}var sx,ax,ux,cx,lx=new Lb,fx=new Lb,hx={point:ox,lineStart:ox,lineEnd:ox,polygonStart:function(){hx.lineStart=dx,hx.lineEnd=mx},polygonEnd:function(){hx.lineStart=hx.lineEnd=hx.point=ox,lx.add(Zb(fx)),fx=new Lb},result:function(){var t=lx/2;return lx=new Lb,t}};function dx(){hx.point=px}function px(t,e){hx.point=gx,sx=ux=t,ax=cx=e}function gx(t,e){fx.add(cx*t-ux*e),ux=t,cx=e}function mx(){gx(sx,ax)}var yx=hx,vx=1/0,bx=vx,xx=-vx,wx=xx;var _x,Ex,Ax,Ox,Sx={point:function(t,e){t<vx&&(vx=t);t>xx&&(xx=t);e<bx&&(bx=e);e>wx&&(wx=e)},lineStart:ox,lineEnd:ox,polygonStart:ox,polygonEnd:ox,result:function(){var t=[[vx,bx],[xx,wx]];return xx=wx=-(bx=vx=1/0),t}},Cx=0,Mx=0,Px=0,kx=0,Tx=0,Dx=0,Fx=0,jx=0,Lx=0,Rx={point:Ix,lineStart:Nx,lineEnd:$x,polygonStart:function(){Rx.lineStart=Ux,Rx.lineEnd=Vx},polygonEnd:function(){Rx.point=Ix,Rx.lineStart=Nx,Rx.lineEnd=$x},result:function(){var t=Lx?[Fx/Lx,jx/Lx]:Dx?[kx/Dx,Tx/Dx]:Px?[Cx/Px,Mx/Px]:[NaN,NaN];return Cx=Mx=Px=kx=Tx=Dx=Fx=jx=Lx=0,t}};function Ix(t,e){Cx+=t,Mx+=e,++Px}function Nx(){Rx.point=Bx}function Bx(t,e){Rx.point=zx,Ix(Ax=t,Ox=e)}function zx(t,e){var n=t-Ax,r=e-Ox,i=ex(n*n+r*r);kx+=i*(Ax+t)/2,Tx+=i*(Ox+e)/2,Dx+=i,Ix(Ax=t,Ox=e)}function $x(){Rx.point=Ix}function Ux(){Rx.point=Zx}function Vx(){Wx(_x,Ex)}function Zx(t,e){Rx.point=Wx,Ix(_x=Ax=t,Ex=Ox=e)}function Wx(t,e){var n=t-Ax,r=e-Ox,i=ex(n*n+r*r);kx+=i*(Ax+t)/2,Tx+=i*(Ox+e)/2,Dx+=i,Fx+=(i=Ox*t-Ax*e)*(Ax+t),jx+=i*(Ox+e),Lx+=3*i,Ix(Ax=t,Ox=e)}var qx=Rx;function Gx(t){this._context=t}Gx.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,$b)}},result:ox};var Hx,Xx,Yx,Kx,Jx,Qx=new Lb,tw={point:ox,lineStart:function(){tw.point=ew},lineEnd:function(){Hx&&nw(Xx,Yx),tw.point=ox},polygonStart:function(){Hx=!0},polygonEnd:function(){Hx=null},result:function(){var t=+Qx;return Qx=new Lb,t}};function ew(t,e){tw.point=nw,Xx=Kx=t,Yx=Jx=e}function nw(t,e){Kx-=t,Jx-=e,Qx.add(ex(Kx*Kx+Jx*Jx)),Kx=t,Jx=e}var rw=tw;function iw(){this._string=[]}function ow(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function sw(t,e){var n,r,i=4.5;function o(t){return t&&("function"===typeof i&&r.pointRadius(+i.apply(this,arguments)),jb(t,n(r))),r.result()}return o.area=function(t){return jb(t,n(yx)),yx.result()},o.measure=function(t){return jb(t,n(rw)),rw.result()},o.bounds=function(t){return jb(t,n(Sx)),Sx.result()},o.centroid=function(t){return jb(t,n(qx)),qx.result()},o.projection=function(e){return arguments.length?(n=null==e?(t=null,Mb):(t=e).stream,o):t},o.context=function(t){return arguments.length?(r=null==t?(e=null,new iw):new Gx(e=t),"function"!==typeof i&&r.pointRadius(i),o):e},o.pointRadius=function(t){return arguments.length?(i="function"===typeof t?t:(r.pointRadius(+t),+t),o):i},o.projection(t).context(e)}function aw(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:ox,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function uw(t,e){return Zb(t[0]-e[0])<Rb&&Zb(t[1]-e[1])<Rb}function cw(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function lw(t,e,n,r,i){var o,s,a=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(uw(r,s)){if(!r[2]&&!s[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}s[0]+=2e-6}a.push(n=new cw(r,t,null,!0)),u.push(n.o=new cw(r,null,n,!1)),a.push(n=new cw(s,t,null,!1)),u.push(n.o=new cw(s,null,n,!0))}})),a.length){for(u.sort(e),fw(a),fw(u),o=0,s=u.length;o<s;++o)u[o].e=n=!n;for(var c,l,f=a[0];;){for(var h=f,d=!0;h.v;)if((h=h.n)===f)return;c=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,s=c.length;o<s;++o)i.point((l=c[o])[0],l[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(c=h.p.z,o=c.length-1;o>=0;--o)i.point((l=c[o])[0],l[1]);else r(h.x,h.p.x,-1,i);h=h.p}c=(h=h.o).z,d=!d}while(!h.v);i.lineEnd()}}}function fw(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function hw(t){return[qb(t[1],t[0]),ix(t[2])]}function dw(t){var e=t[0],n=t[1],r=Gb(n);return[r*Gb(e),r*Qb(e),Qb(n)]}function pw(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function gw(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function mw(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function yw(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function vw(t){var e=ex(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function bw(t){return Zb(t[0])<=Nb?t[0]:tx(t[0])*((Zb(t[0])+Nb)%$b-Nb)}function xw(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function ww(t,e,n,r){return function(i){var o,s,a,u=e(i),c=aw(),l=e(c),f=!1,h={point:d,lineStart:g,lineEnd:m,polygonStart:function(){h.point=y,h.lineStart=v,h.lineEnd=b,s=[],o=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=m,s=xw(s);var t=function(t,e){var n=bw(e),r=e[1],i=Qb(r),o=[Qb(n),-Gb(n),0],s=0,a=0,u=new Lb;1===i?r=Bb+Rb:-1===i&&(r=-Bb-Rb);for(var c=0,l=t.length;c<l;++c)if(h=(f=t[c]).length)for(var f,h,d=f[h-1],p=bw(d),g=d[1]/2+zb,m=Qb(g),y=Gb(g),v=0;v<h;++v,p=x,m=_,y=E,d=b){var b=f[v],x=bw(b),w=b[1]/2+zb,_=Qb(w),E=Gb(w),A=x-p,O=A>=0?1:-1,S=O*A,C=S>Nb,M=m*_;if(u.add(qb(M*O*Qb(S),y*E+M*Gb(S))),s+=C?A+O*$b:A,C^p>=n^x>=n){var P=gw(dw(d),dw(b));vw(P);var k=gw(o,P);vw(k);var T=(C^A>=0?-1:1)*ix(k[2]);(r>T||r===T&&(P[0]||P[1]))&&(a+=C^A>=0?1:-1)}}return(s<-1e-6||s<Rb&&u<-1e-12)^1&a}(o,r);s.length?(f||(i.polygonStart(),f=!0),lw(s,Ew,t,n,i)):t&&(f||(i.polygonStart(),f=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),f&&(i.polygonEnd(),f=!1),s=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function g(){h.point=p,u.lineStart()}function m(){h.point=d,u.lineEnd()}function y(t,e){a.push([t,e]),l.point(t,e)}function v(){l.lineStart(),a=[]}function b(){y(a[0][0],a[0][1]),l.lineEnd();var t,e,n,r,u=l.clean(),h=c.result(),d=h.length;if(a.pop(),o.push(a),a=null,d)if(1&u){if((e=(n=h[0]).length-1)>0){for(f||(i.polygonStart(),f=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&h.push(h.pop().concat(h.shift())),s.push(h.filter(_w))}return h}}function _w(t){return t.length>1}function Ew(t,e){return((t=t.x)[0]<0?t[1]-Bb-Rb:Bb-t[1])-((e=e.x)[0]<0?e[1]-Bb-Rb:Bb-e[1])}iw.prototype={_radius:4.5,_circle:ow(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=ow(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Aw=ww((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Nb:-Nb,u=Zb(o-n);Zb(u-Nb)<Rb?(t.point(n,r=(r+s)/2>0?Bb:-Bb),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),e=0):i!==a&&u>=Nb&&(Zb(n-i)<Rb&&(n-=i*Rb),Zb(o-a)<Rb&&(o-=a*Rb),r=function(t,e,n,r){var i,o,s=Qb(t-n);return Zb(s)>Rb?Wb((Qb(e)*(o=Gb(r))*Qb(n)-Qb(r)*(i=Gb(e))*Qb(t))/(i*o*s)):(e+r)/2}(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=o,r=s),i=a},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*Bb,r.point(-Nb,i),r.point(0,i),r.point(Nb,i),r.point(Nb,0),r.point(Nb,-i),r.point(0,-i),r.point(-Nb,-i),r.point(-Nb,0),r.point(-Nb,i);else if(Zb(t[0]-e[0])>Rb){var o=t[0]<e[0]?Nb:-Nb;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-Nb,-Bb]);function Ow(t,e,n,r,i,o){if(n){var s=Gb(e),a=Qb(e),u=r*n;null==i?(i=e+r*$b,o=e-u/2):(i=Sw(s,i),o=Sw(s,o),(r>0?i<o:i>o)&&(i+=r*$b));for(var c,l=i;r>0?l>o:l<o;l-=u)c=hw([s,-a*Gb(l),-a*Qb(l)]),t.point(c[0],c[1])}}function Sw(t,e){(e=dw(e))[0]-=t,vw(e);var n=rx(-e[1]);return((-e[2]<0?-n:n)+$b-Rb)%$b}function Cw(t){var e=Gb(t),n=6*Vb,r=e>0,i=Zb(e)>Rb;function o(t,n){return Gb(t)*Gb(n)>e}function s(t,n,r){var i=[1,0,0],o=gw(dw(t),dw(n)),s=pw(o,o),a=o[0],u=s-a*a;if(!u)return!r&&t;var c=e*s/u,l=-e*a/u,f=gw(i,o),h=yw(i,c);mw(h,yw(o,l));var d=f,p=pw(h,d),g=pw(d,d),m=p*p-g*(pw(h,h)-1);if(!(m<0)){var y=ex(m),v=yw(d,(-p-y)/g);if(mw(v,h),v=hw(v),!r)return v;var b,x=t[0],w=n[0],_=t[1],E=n[1];w<x&&(b=x,x=w,w=b);var A=w-x,O=Zb(A-Nb)<Rb;if(!O&&E<_&&(b=_,_=E,E=b),O||A<Rb?O?_+E>0^v[1]<(Zb(v[0]-x)<Rb?_:E):_<=v[1]&&v[1]<=E:A>Nb^(x<=v[0]&&v[0]<=w)){var S=yw(d,(-p+y)/g);return mw(S,h),[v,hw(S)]}}}function a(e,n){var i=r?t:Nb-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return ww(o,(function(t){var e,n,u,c,l;return{lineStart:function(){c=u=!1,l=1},point:function(f,h){var d,p=[f,h],g=o(f,h),m=r?g?0:a(f,h):g?a(f+(f<0?Nb:-Nb),h):0;if(!e&&(c=u=g)&&t.lineStart(),g!==u&&(!(d=s(e,p))||uw(e,d)||uw(p,d))&&(p[2]=1),g!==u)l=0,g?(t.lineStart(),d=s(p,e),t.point(d[0],d[1])):(d=s(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(i&&e&&r^g){var y;m&n||!(y=s(p,e,!0))||(l=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!g||e&&uw(e,p)||t.point(p[0],p[1]),e=p,u=g,n=m},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return l|(c&&u)<<1}}}),(function(e,r,i,o){Ow(o,t,n,i,e,r)}),r?[0,-t]:[-Nb,t-Nb])}var Mw=1e9,Pw=-Mw;function kw(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,c){var l=0,f=0;if(null==i||(l=s(i,a))!==(f=s(o,a))||u(i,o)<0^a>0)do{c.point(0===l||3===l?t:n,l>1?r:e)}while((l=(l+a+4)%4)!==f);else c.point(o[0],o[1])}function s(r,i){return Zb(r[0]-t)<Rb?i>0?0:3:Zb(r[0]-n)<Rb?i>0?2:1:Zb(r[1]-e)<Rb?i>0?1:0:i>0?3:2}function a(t,e){return u(t.x,e.x)}function u(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var u,c,l,f,h,d,p,g,m,y,v,b=s,x=aw(),w={point:_,lineStart:function(){w.point=E,c&&c.push(l=[]);y=!0,m=!1,p=g=NaN},lineEnd:function(){u&&(E(f,h),d&&m&&x.rejoin(),u.push(x.result()));w.point=_,m&&b.lineEnd()},polygonStart:function(){b=x,u=[],c=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=c.length;n<i;++n)for(var o,s,a=c[n],u=1,l=a.length,f=a[0],h=f[0],d=f[1];u<l;++u)o=h,s=d,h=(f=a[u])[0],d=f[1],s<=r?d>r&&(h-o)*(r-s)>(d-s)*(t-o)&&++e:d<=r&&(h-o)*(r-s)<(d-s)*(t-o)&&--e;return e}(),n=v&&e,i=(u=xw(u)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&lw(u,a,e,o,s),s.polygonEnd());b=s,u=c=l=null}};function _(t,e){i(t,e)&&b.point(t,e)}function E(o,s){var a=i(o,s);if(c&&l.push([o,s]),y)f=o,h=s,d=a,y=!1,a&&(b.lineStart(),b.point(o,s));else if(a&&m)b.point(o,s);else{var u=[p=Math.max(Pw,Math.min(Mw,p)),g=Math.max(Pw,Math.min(Mw,g))],x=[o=Math.max(Pw,Math.min(Mw,o)),s=Math.max(Pw,Math.min(Mw,s))];!function(t,e,n,r,i,o){var s,a=t[0],u=t[1],c=0,l=1,f=e[0]-a,h=e[1]-u;if(s=n-a,f||!(s>0)){if(s/=f,f<0){if(s<c)return;s<l&&(l=s)}else if(f>0){if(s>l)return;s>c&&(c=s)}if(s=i-a,f||!(s<0)){if(s/=f,f<0){if(s>l)return;s>c&&(c=s)}else if(f>0){if(s<c)return;s<l&&(l=s)}if(s=r-u,h||!(s>0)){if(s/=h,h<0){if(s<c)return;s<l&&(l=s)}else if(h>0){if(s>l)return;s>c&&(c=s)}if(s=o-u,h||!(s<0)){if(s/=h,h<0){if(s>l)return;s>c&&(c=s)}else if(h>0){if(s<c)return;s<l&&(l=s)}return c>0&&(t[0]=a+c*f,t[1]=u+c*h),l<1&&(e[0]=a+l*f,e[1]=u+l*h),!0}}}}}(u,x,t,e,n,r)?a&&(b.lineStart(),b.point(o,s),v=!1):(m||(b.lineStart(),b.point(u[0],u[1])),b.point(x[0],x[1]),a||b.lineEnd(),v=!1)}p=o,g=s,m=a}return w}}function Tw(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Dw(t,e){return[Zb(t)>Nb?t+Math.round(-t/$b)*$b:t,e]}function Fw(t,e,n){return(t%=$b)?e||n?Tw(Lw(t),Rw(e,n)):Lw(t):e||n?Rw(e,n):Dw}function jw(t){return function(e,n){return[(e+=t)>Nb?e-$b:e<-Nb?e+$b:e,n]}}function Lw(t){var e=jw(t);return e.invert=jw(-t),e}function Rw(t,e){var n=Gb(t),r=Qb(t),i=Gb(e),o=Qb(e);function s(t,e){var s=Gb(e),a=Gb(t)*s,u=Qb(t)*s,c=Qb(e),l=c*n+a*r;return[qb(u*i-l*o,a*n-c*r),ix(l*i+u*o)]}return s.invert=function(t,e){var s=Gb(e),a=Gb(t)*s,u=Qb(t)*s,c=Qb(e),l=c*i-u*o;return[qb(u*i+c*o,a*n+l*r),ix(l*n-a*r)]},s}function Iw(t){return function(e){var n=new Nw;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Nw(){}function Bw(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),jb(n,t.stream(Sx)),e(Sx.result()),null!=r&&t.clipExtent(r),t}function zw(t,e,n){return Bw(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])}),n)}function $w(t,e,n){return zw(t,[[0,0],e],n)}function Uw(t,e,n){return Bw(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];t.scale(150*i).translate([o,s])}),n)}function Vw(t,e,n){return Bw(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],s=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,s])}),n)}Dw.invert=Dw,Nw.prototype={constructor:Nw,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Zw=Gb(30*Vb);function Ww(t,e){return+e?function(t,e){function n(r,i,o,s,a,u,c,l,f,h,d,p,g,m){var y=c-r,v=l-i,b=y*y+v*v;if(b>4*e&&g--){var x=s+h,w=a+d,_=u+p,E=ex(x*x+w*w+_*_),A=ix(_/=E),O=Zb(Zb(_)-1)<Rb||Zb(o-f)<Rb?(o+f)/2:qb(w,x),S=t(O,A),C=S[0],M=S[1],P=C-r,k=M-i,T=v*P-y*k;(T*T/b>e||Zb((y*P+v*k)/b-.5)>.3||s*h+a*d+u*p<Zw)&&(n(r,i,o,s,a,u,C,M,O,x/=E,w/=E,_,g,m),m.point(C,M),n(C,M,O,x,w,_,c,l,f,h,d,p,g,m))}}return function(e){var r,i,o,s,a,u,c,l,f,h,d,p,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),g.lineStart=x},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){l=NaN,g.point=v,e.lineStart()}function v(r,i){var o=dw([r,i]),s=t(r,i);n(l,f,c,h,d,p,l=s[0],f=s[1],c=r,h=o[0],d=o[1],p=o[2],16,e),e.point(l,f)}function b(){g.point=m,e.lineEnd()}function x(){y(),g.point=w,g.lineEnd=_}function w(t,e){v(r=t,e),i=l,o=f,s=h,a=d,u=p,g.point=v}function _(){n(l,f,c,h,d,p,i,o,r,s,a,u,16,e),g.lineEnd=b,b()}return g}}(t,e):function(t){return Iw({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var qw=Iw({point:function(t,e){this.stream.point(t*Vb,e*Vb)}});function Gw(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,s){return[e+t*(o*=r),n-t*(s*=i)]}return o.invert=function(o,s){return[(o-e)/t*r,(n-s)/t*i]},o}(t,e,n,r,i);var s=Gb(o),a=Qb(o),u=s*t,c=a*t,l=s/t,f=a/t,h=(a*n-s*e)/t,d=(a*e+s*n)/t;function p(t,o){return[u*(t*=r)-c*(o*=i)+e,n-c*t-u*o]}return p.invert=function(t,e){return[r*(l*t-f*e+h),i*(d-f*t-l*e)]},p}function Hw(t){return Xw((function(){return t}))()}function Xw(t){var e,n,r,i,o,s,a,u,c,l,f=150,h=480,d=250,p=0,g=0,m=0,y=0,v=0,b=0,x=1,w=1,_=null,E=Aw,A=null,O=Mb,S=.5;function C(t){return u(t[0]*Vb,t[1]*Vb)}function M(t){return(t=u.invert(t[0],t[1]))&&[t[0]*Ub,t[1]*Ub]}function P(){var t=Gw(f,0,0,x,w,b).apply(null,e(p,g)),r=Gw(f,h-t[0],d-t[1],x,w,b);return n=Fw(m,y,v),a=Tw(e,r),u=Tw(n,a),s=Ww(a,S),k()}function k(){return c=l=null,C}return C.stream=function(t){return c&&l===t?c:c=qw(function(t){return Iw({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(E(s(O(l=t)))))},C.preclip=function(t){return arguments.length?(E=t,_=void 0,k()):E},C.postclip=function(t){return arguments.length?(O=t,A=r=i=o=null,k()):O},C.clipAngle=function(t){return arguments.length?(E=+t?Cw(_=t*Vb):(_=null,Aw),k()):_*Ub},C.clipExtent=function(t){return arguments.length?(O=null==t?(A=r=i=o=null,Mb):kw(A=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),k()):null==A?null:[[A,r],[i,o]]},C.scale=function(t){return arguments.length?(f=+t,P()):f},C.translate=function(t){return arguments.length?(h=+t[0],d=+t[1],P()):[h,d]},C.center=function(t){return arguments.length?(p=t[0]%360*Vb,g=t[1]%360*Vb,P()):[p*Ub,g*Ub]},C.rotate=function(t){return arguments.length?(m=t[0]%360*Vb,y=t[1]%360*Vb,v=t.length>2?t[2]%360*Vb:0,P()):[m*Ub,y*Ub,v*Ub]},C.angle=function(t){return arguments.length?(b=t%360*Vb,P()):b*Ub},C.reflectX=function(t){return arguments.length?(x=t?-1:1,P()):x<0},C.reflectY=function(t){return arguments.length?(w=t?-1:1,P()):w<0},C.precision=function(t){return arguments.length?(s=Ww(a,S=t*t),k()):ex(S)},C.fitExtent=function(t,e){return zw(C,t,e)},C.fitSize=function(t,e){return $w(C,t,e)},C.fitWidth=function(t,e){return Uw(C,t,e)},C.fitHeight=function(t,e){return Vw(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&M,P()}}function Yw(t){var e=0,n=Nb/3,r=Xw(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*Vb,n=t[1]*Vb):[e*Ub,n*Ub]},i}function Kw(t,e){var n=Qb(t),r=(n+Qb(e))/2;if(Zb(r)<Rb)return function(t){var e=Gb(t);function n(t,n){return[t*e,Qb(n)/e]}return n.invert=function(t,n){return[t/e,ix(n*e)]},n}(t);var i=1+n*(2*r-n),o=ex(i)/r;function s(t,e){var n=ex(i-2*r*Qb(e))/r;return[n*Qb(t*=r),o-n*Gb(t)]}return s.invert=function(t,e){var n=o-e,s=qb(t,Zb(n))*tx(n);return n*r<0&&(s-=Nb*tx(t)*tx(n)),[s/r,ix((i-(t*t+n*n)*r*r)/(2*r))]},s}function Jw(){return Yw(Kw).scale(155.424).center([0,33.6442])}function Qw(){return Jw().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function t_(t){return function(e,n){var r=Gb(e),i=Gb(n),o=t(r*i);return o===1/0?[2,0]:[o*i*Qb(e),o*Qb(n)]}}function e_(t){return function(e,n){var r=ex(e*e+n*n),i=t(r),o=Qb(i),s=Gb(i);return[qb(e*o,r*s),ix(r&&n*o/r)]}}var n_=t_((function(t){return ex(2/(1+t))}));n_.invert=e_((function(t){return 2*ix(t/2)}));var r_=t_((function(t){return(t=rx(t))&&t/Qb(t)}));function i_(t,e){return[t,Kb(nx((Bb+e)/2))]}function o_(t){var e,n,r,i=Hw(t),o=i.center,s=i.scale,a=i.translate,u=i.clipExtent,c=null;function l(){var o=Nb*s(),a=i(function(t){function e(e){return(e=t(e[0]*Vb,e[1]*Vb))[0]*=Ub,e[1]*=Ub,e}return t=Fw(t[0]*Vb,t[1]*Vb,t.length>2?t[2]*Vb:0),e.invert=function(e){return(e=t.invert(e[0]*Vb,e[1]*Vb))[0]*=Ub,e[1]*=Ub,e},e}(i.rotate()).invert([0,0]));return u(null==c?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===i_?[[Math.max(a[0]-o,c),e],[Math.min(a[0]+o,n),r]]:[[c,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),l()):s()},i.translate=function(t){return arguments.length?(a(t),l()):a()},i.center=function(t){return arguments.length?(o(t),l()):o()},i.clipExtent=function(t){return arguments.length?(null==t?c=e=n=r=null:(c=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),l()):null==c?null:[[c,e],[n,r]]},l()}function s_(t){return nx((Bb+t)/2)}function a_(t,e){var n=Gb(t),r=t===e?Qb(t):Kb(n/Gb(e))/Kb(s_(e)/s_(t)),i=n*Jb(s_(t),r)/r;if(!r)return i_;function o(t,e){i>0?e<-Bb+Rb&&(e=-Bb+Rb):e>Bb-Rb&&(e=Bb-Rb);var n=i/Jb(s_(e),r);return[n*Qb(r*t),i-n*Gb(r*t)]}return o.invert=function(t,e){var n=i-e,o=tx(r)*ex(t*t+n*n),s=qb(t,Zb(n))*tx(n);return n*r<0&&(s-=Nb*tx(t)*tx(n)),[s/r,2*Wb(Jb(i/o,1/r))-Bb]},o}function u_(t,e){return[t,e]}function c_(t,e){var n=Gb(t),r=t===e?Qb(t):(n-Gb(e))/(e-t),i=n/r+t;if(Zb(r)<Rb)return u_;function o(t,e){var n=i-e,o=r*t;return[n*Qb(o),i-n*Gb(o)]}return o.invert=function(t,e){var n=i-e,o=qb(t,Zb(n))*tx(n);return n*r<0&&(o-=Nb*tx(t)*tx(n)),[o/r,i-tx(r)*ex(t*t+n*n)]},o}r_.invert=e_((function(t){return t})),i_.invert=function(t,e){return[t,2*Wb(Xb(e))-Bb]},u_.invert=u_;var l_=1.340264,f_=-.081106,h_=893e-6,d_=.003796,p_=ex(3)/2;function g_(t,e){var n=ix(p_*Qb(e)),r=n*n,i=r*r*r;return[t*Gb(n)/(p_*(l_+3*f_*r+i*(7*h_+9*d_*r))),n*(l_+f_*r+i*(h_+d_*r))]}function m_(t,e){var n=Gb(e),r=Gb(t)*n;return[n*Qb(t)/r,Qb(e)/r]}function y_(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function v_(t,e){return[Gb(e)*Qb(t),Qb(e)]}function b_(t,e){var n=Gb(e),r=1+Gb(t)*n;return[n*Qb(t)/r,Qb(e)/r]}function x_(t,e){return[Kb(nx((Bb+e)/2)),-t]}g_.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,s=0;s<12&&(o=(i=(r-=n=(r*(l_+f_*i+o*(h_+d_*i))-e)/(l_+3*f_*i+o*(7*h_+9*d_*i)))*r)*i*i,!(Zb(n)<Ib));++s);return[p_*t*(l_+3*f_*i+o*(7*h_+9*d_*i))/Gb(r),ix(Qb(r)/p_)]},m_.invert=e_(Wb),y_.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(Zb(n)>Rb&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},v_.invert=e_(ix),b_.invert=e_((function(t){return 2*Wb(t)})),x_.invert=function(t,e){return[-e,2*Wb(Xb(t))-Bb]};var w_=Math.abs,__=(Math.atan,Math.atan2,Math.ceil,Math.cos),E_=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),A_=(Math.tan,Math.PI),O_=A_/2,S_=(Math.SQRT1_2,M_(2));M_(A_);function C_(t){return t>1?O_:t<-1?-O_:Math.asin(t)}function M_(t){return t>0?Math.sqrt(t):0}function P_(t,e){var n,r=t*E_(e),i=30;do{e-=n=(e+E_(e)-r)/(1+__(e))}while(w_(n)>1e-6&&--i>0);return e/2}var k_=function(t,e,n){function r(r,i){return[t*r*__(i=P_(n,i)),e*E_(i)]}return r.invert=function(r,i){return i=C_(i/e),[r/(t*__(i)),C_((2*i+E_(2*i))/n)]},r}(S_/O_,S_,A_);const T_=sw(),D_=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function F_(t,e){return function n(){const r=e();return r.type=t,r.path=sw().projection(r),r.copy=r.copy||function(){const t=n();return D_.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},r}}function j_(t,e){if(!t||"string"!==typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(R_[t]=F_(t,e),this):R_[t]||null}function L_(t){return t&&t.path||T_}const R_={albers:Qw,albersusa:function(){var t,e,n,r,i,o,s=Qw(),a=Jw().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=Jw().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(t,e){o=[t,e]}};function l(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function f(){return t=e=null,l}return l.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:s).invert(t)},l.stream=function(n){return t&&e===n?t:t=function(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}([s.stream(e=n),a.stream(n),u.stream(n)])},l.precision=function(t){return arguments.length?(s.precision(t),a.precision(t),u.precision(t),f()):s.precision()},l.scale=function(t){return arguments.length?(s.scale(t),a.scale(.35*t),u.scale(t),l.translate(s.translate())):s.scale()},l.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],l=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,l-.238*e],[o+.455*e,l+.238*e]]).stream(c),r=a.translate([o-.307*e,l+.201*e]).clipExtent([[o-.425*e+Rb,l+.12*e+Rb],[o-.214*e-Rb,l+.234*e-Rb]]).stream(c),i=u.translate([o-.205*e,l+.212*e]).clipExtent([[o-.214*e+Rb,l+.166*e+Rb],[o-.115*e-Rb,l+.234*e-Rb]]).stream(c),f()},l.fitExtent=function(t,e){return zw(l,t,e)},l.fitSize=function(t,e){return $w(l,t,e)},l.fitWidth=function(t,e){return Uw(l,t,e)},l.fitHeight=function(t,e){return Vw(l,t,e)},l.scale(1070)},azimuthalequalarea:function(){return Hw(n_).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return Hw(r_).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return Yw(a_).scale(109.5).parallels([30,30])},conicequalarea:Jw,conicequidistant:function(){return Yw(c_).scale(131.154).center([0,13.9389])},equalEarth:function(){return Hw(g_).scale(177.158)},equirectangular:function(){return Hw(u_).scale(152.63)},gnomonic:function(){return Hw(m_).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,s,a=1,u=0,c=0,l=1,f=1,h=0,d=null,p=1,g=1,m=Iw({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=Mb;function v(){return p=a*l,g=a*f,o=s=null,b}function b(n){var r=n[0]*p,i=n[1]*g;if(h){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+u,i+c]}return b.invert=function(n){var r=n[0]-u,i=n[1]-c;if(h){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/g]},b.stream=function(t){return o&&s===t?o:o=m(y(s=t))},b.postclip=function(t){return arguments.length?(y=t,d=n=r=i=null,v()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(d=n=r=i=null,Mb):kw(d=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),v()):null==d?null:[[d,n],[r,i]]},b.scale=function(t){return arguments.length?(a=+t,v()):a},b.translate=function(t){return arguments.length?(u=+t[0],c=+t[1],v()):[u,c]},b.angle=function(n){return arguments.length?(e=Qb(h=n%360*Vb),t=Gb(h),v()):h*Ub},b.reflectX=function(t){return arguments.length?(l=t?-1:1,v()):l<0},b.reflectY=function(t){return arguments.length?(f=t?-1:1,v()):f<0},b.fitExtent=function(t,e){return zw(b,t,e)},b.fitSize=function(t,e){return $w(b,t,e)},b.fitWidth=function(t,e){return Uw(b,t,e)},b.fitHeight=function(t,e){return Vw(b,t,e)},b},mercator:function(){return o_(i_).scale(961/$b)},mollweide:function(){return Hw(k_).scale(169.529)},naturalEarth1:function(){return Hw(y_).scale(175.295)},orthographic:function(){return Hw(v_).scale(249.5).clipAngle(90.000001)},stereographic:function(){return Hw(b_).scale(250).clipAngle(142)},transversemercator:function(){var t=o_(x_),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const xL in R_)j_(xL,R_[xL]);function I_(t,e,n){var r=ls(t,e-Rb,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function N_(t,e,n){var r=ls(t,e-Rb,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function B_(){var t,e,n,r,i,o,s,a,u,c,l,f,h=10,d=h,p=90,g=360,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return ls(Hb(r/p)*p,n,p).map(l).concat(ls(Hb(a/g)*g,s,g).map(f)).concat(ls(Hb(e/h)*h,t,h).filter((function(t){return Zb(t%p)>Rb})).map(u)).concat(ls(Hb(o/d)*d,i,d).filter((function(t){return Zb(t%g)>Rb})).map(c))}return y.lines=function(){return v().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[l(r).concat(f(s).slice(1),l(n).reverse().slice(1),f(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],a=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),a>s&&(t=a,a=s,s=t),y.precision(m)):[[r,a],[n,s]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(m)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],g=+t[1],y):[p,g]},y.stepMinor=function(t){return arguments.length?(h=+t[0],d=+t[1],y):[h,d]},y.precision=function(h){return arguments.length?(m=+h,u=I_(o,i,90),c=N_(e,t,m),l=I_(a,s,90),f=N_(r,n,m),y):m},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function z_(){}const $_=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function U_(){var t=1,e=1,n=s;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var s=[],a=[];return function(n,r,i){var s,a,u,c,l,f,h=new Array,d=new Array;s=a=-1,c=n[0]>=r,$_[c<<1].forEach(p);for(;++s<t-1;)u=c,c=n[s+1]>=r,$_[u|c<<1].forEach(p);$_[c<<0].forEach(p);for(;++a<e-1;){for(s=-1,c=n[a*t+t]>=r,l=n[a*t]>=r,$_[c<<1|l<<2].forEach(p);++s<t-1;)u=c,c=n[a*t+t+s+1]>=r,f=l,l=n[a*t+s+1]>=r,$_[u|c<<1|l<<2|f<<3].forEach(p);$_[c|l<<3].forEach(p)}s=-1,l=n[a*t]>=r,$_[l<<2].forEach(p);for(;++s<t-1;)f=l,l=n[a*t+s+1]>=r,$_[l<<2|f<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+s,t[0][1]+a],u=[t[1][0]+s,t[1][1]+a],c=o(r),l=o(u);(e=d[c])?(n=h[l])?(delete d[e.end],delete h[n.start],e===n?(e.ring.push(u),i(e.ring)):h[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(u),d[e.end=l]=e):(e=h[l])?(n=d[c])?(delete h[e.start],delete d[n.end],e===n?(e.ring.push(u),i(e.ring)):h[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete h[e.start],e.ring.unshift(r),h[e.start=c]=e):h[c]=d[l]={start:c,end:l,ring:[r,u]}}$_[l<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];for(;++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?s.push([t]):a.push(t)})),a.forEach((t=>{for(var e,n=0,r=s.length;n<r;++n)if(-1!==V_((e=s[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:s}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,i){n.forEach((n=>{var o,s=n[0],a=n[1],u=0|s,c=0|a,l=r[c*t+u];s>0&&s<t&&u===s&&(o=r[c*t+u-1],n[0]=s+(i-o)/(l-o)-.5),a>0&&a<e&&c===a&&(o=r[(c-1)*t+u],n[1]=a+(i-o)/(l-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||(0,g.vU)("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?s:z_,r):n===s},r}function V_(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=Z_(t,e[r]))return n;return 0}function Z_(t,e){for(var n=e[0],r=e[1],i=-1,o=0,s=t.length,a=s-1;o<s;a=o++){var u=t[o],c=u[0],l=u[1],f=t[a],h=f[0],d=f[1];if(W_(u,f,e))return 0;l>r!==d>r&&n<(h-c)*(r-l)/(d-l)+c&&(i=-i)}return i}function W_(t,e,n){var r,i,o,s;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],s=e[r],i<=o&&o<=s||s<=o&&o<=i)}function q_(t,e,n){return function(r){var i=(0,g.We)(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,u=e?(0,D.ly)(o,s,t):a/(t+1);return ls(o+u,s,u)}}function G_(t){no.call(this,null,t)}function H_(t,e,n,r,i){const o=t.x1||0,s=t.y1||0,a=e*n<0;function u(t){t.forEach(c)}function c(t){a&&t.reverse(),t.forEach(l)}function l(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-s)*n+i}return function(t){return t.coordinates.forEach(u),t}}function X_(t,e,n){const r=t>=0?t:bo(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Y_(t){return(0,g.mf)(t)?t:(0,g.a9)(+t)}function K_(){var t=t=>t[0],e=t=>t[1],n=g.kX,r=[-1,-1],i=960,o=500,s=2;function a(a,u){const c=X_(r[0],a,t)>>s,l=X_(r[1],a,e)>>s,f=c?c+2:0,h=l?l+2:0,d=2*f+(i>>s),p=2*h+(o>>s),g=new Float32Array(d*p),m=new Float32Array(d*p);let y=g;a.forEach((r=>{const i=f+(+t(r)>>s),o=h+(+e(r)>>s);i>=0&&i<d&&o>=0&&o<p&&(g[i+o*d]+=+n(r))})),c>0&&l>0?(J_(d,p,g,m,c),Q_(d,p,m,g,l),J_(d,p,g,m,c),Q_(d,p,m,g,l),J_(d,p,g,m,c),Q_(d,p,m,g,l)):c>0?(J_(d,p,g,m,c),J_(d,p,m,g,c),J_(d,p,g,m,c),y=m):l>0&&(Q_(d,p,g,m,l),Q_(d,p,m,g,l),Q_(d,p,g,m,l),y=m);const v=u?Math.pow(2,-2*s):1/Kv(y);for(let t=0,e=d*p;t<e;++t)y[t]*=v;return{values:y,scale:1<<s,width:d,height:p,x1:f,y1:h,x2:f+(i>>s),y2:h+(o>>s)}}return a.x=function(e){return arguments.length?(t=Y_(e),a):t},a.y=function(t){return arguments.length?(e=Y_(t),a):e},a.weight=function(t){return arguments.length?(n=Y_(t),a):n},a.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||(0,g.vU)("invalid size"),i=e,o=n,a},a.cellSize=function(t){return arguments.length?((t=+t)>=1||(0,g.vU)("invalid cell size"),s=Math.floor(Math.log(t)/Math.LN2),a):1<<s},a.bandwidth=function(t){return arguments.length?(1===(t=(0,g.IX)(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&(0,g.vU)("invalid bandwidth"),r=t,a):r},a}function J_(t,e,n,r,i){const o=1+(i<<1);for(let s=0;s<e;++s)for(let e=0,a=0;e<t+i;++e)e<t&&(a+=n[e+s*t]),e>=i&&(e>=o&&(a-=n[e-o+s*t]),r[e-i+s*t]=a/Math.min(e+1,t-1+o-e,o))}function Q_(t,e,n,r,i){const o=1+(i<<1);for(let s=0;s<t;++s)for(let a=0,u=0;a<e+i;++a)a<e&&(u+=n[s+a*t]),a>=i&&(a>=o&&(u-=n[s+(a-o)*t]),r[s+(a-i)*t]=u/Math.min(a+1,e-1+o-a,o))}function tE(t){no.call(this,null,t)}G_.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},(0,g.XW)(G_,no,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||g.yR,o=U_().smooth(!1!==t.smooth),s=t.thresholds||function(t,e,n){const r=q_(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>ao(e(t).values))))}(r,i,t),a=null===t.as?null:t.as||"contour",u=[];return r.forEach((e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,(0,g.kJ)(s)?s:s(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;(0,g.mf)(i)&&(i=i(n,r));(0,g.mf)(o)&&(o=o(n,r));if((1===i||null==i)&&!o)return;const s=((0,g.hj)(i)?i:i[0])||1,a=((0,g.hj)(i)?i:i[1])||1,u=o&&o[0]||0,c=o&&o[1]||0;t.forEach(H_(e,s,a,u,c))}(r,n,e,t),r.forEach((t=>{u.push(Ci(e,Oi(null!=a?{[a]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=u,n}}),tE.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const eE=["x","y","weight","size","cellSize","bandwidth"];function nE(t,e){return eE.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function rE(t){no.call(this,null,t)}(0,g.XW)(tE,no,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,s,a,u=[],c=t=>t(o);if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(a=n[s=e.map(c)])||(n[s]=a=[],a.dims=s,u.push(a)),a.push(o);return u}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(g.el),s=nE(K_(),t),a=t.as||"grid";return n=i.map((e=>Oi(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[a]:s(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),rE.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},(0,g.XW)(rE,no,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=U_().smooth(!1!==t.smooth),s=t.values,a=t.thresholds||q_(t.count||10,t.nice,!!s),u=t.size;return s||(s=e.materialize(e.SOURCE).source,r=H_(n=nE(K_(),t)(s,!0),n.scale||1,n.scale||1,0,0),u=[n.width,n.height],s=n.values),a=(0,g.kJ)(a)?a:a(s),s=o.size(u)(s,a),r&&s.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(s||[]).map(Oi),i}});const iE="Feature",oE="FeatureCollection";function sE(t){no.call(this,null,t)}function aE(t){no.call(this,null,t)}function uE(t){no.call(this,null,t)}function cE(t){no.call(this,null,t)}function lE(t){no.call(this,[],t),this.generator=B_()}function fE(t){no.call(this,null,t)}function hE(t){if(!(0,g.mf)(t))return!1;const e=(0,g.Rg)((0,g.Oj)(t));return e.$x||e.$y||e.$value||e.$max}function dE(t){no.call(this,null,t),this.modified(!0)}function pE(t,e,n){(0,g.mf)(t[e])&&t[e](n)}function gE(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,s,a,u,c,l,f,h,d=t._root,p={data:r},g=t._x0,m=t._y0,y=t._x1,v=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((c=e>=(o=(g+y)/2))?g=o:y=o,(l=n>=(s=(m+v)/2))?m=s:v=s,i=d,!(d=d[f=l<<1|c]))return i[f]=p,t;if(a=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===a&&n===u)return p.next=d,i?i[f]=p:t._root=p,t;do{i=i?i[f]=new Array(4):t._root=new Array(4),(c=e>=(o=(g+y)/2))?g=o:y=o,(l=n>=(s=(m+v)/2))?m=s:v=s}while((f=l<<1|c)===(h=(u>=s)<<1|a>=o));return i[h]=d,i[f]=p,t}function mE(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function yE(t){return t[0]}function vE(t){return t[1]}function bE(t,e,n){var r=new xE(null==e?yE:e,null==n?vE:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function xE(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function wE(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}sE.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},(0,g.XW)(sE,no,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,s=o&&o[0],a=o&&o[1],u=t.geojson||!o&&g.yR,c=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified((0,g.Oj)(u))||s&&e.modified((0,g.Oj)(s))||a&&e.modified((0,g.Oj)(a)),this.value&&!n||(c=e.SOURCE,this._features=r=[],this._points=i=[]),u&&e.visit(c,(t=>r.push(u(t)))),s&&a&&(e.visit(c,(t=>{var e=s(t),n=a(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:iE,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:oE,features:r}}}),aE.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},(0,g.XW)(aE,no,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||g.yR,o=t.as||"path",s=n.SOURCE;!r||t.modified()?(this.value=r=L_(t.projection),n.materialize().reflow()):s=i===g.yR||e.modified(i.fields)?n.ADD_MOD:n.ADD;const a=function(t,e){const n=t.pointRadius();t.context(null),null!=e&&t.pointRadius(e);return n}(r,t.pointRadius);return n.visit(s,(t=>t[o]=r(i(t)))),r.pointRadius(a),n.modifies(o)}}),uE.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},(0,g.XW)(uE,no,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],s=t.as||["x","y"],a=s[0],u=s[1];function c(t){const e=r([i(t),o(t)]);e?(t[a]=e[0],t[u]=e[1]):(t[a]=void 0,t[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,c):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,c)),e.modifies(s)}}),cE.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},(0,g.XW)(cE,no,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(L_(t.projection),t.field||(0,g.EP)("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(t=>t[i]=r)),n.modifies(i)}}),lE.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},(0,g.XW)(lE,no,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const o in t)(0,g.mf)(i[o])&&i[o](t[o]);return n=i(),r.length?e.mod.push(Mi(r[0],n)):e.add.push(Oi(n)),r[0]=n,e}}),fE.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},(0,g.XW)(fE,no,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||g.yR,o=function(t,e){let n;(0,g.mf)(t)?(n=n=>t(n,e),n.dep=hE(t)):t?n=(0,g.a9)(t):(n=t=>t.$value/t.$max||0,n.dep=!0);return n}(t.opacity,t),s=function(t,e){let n;(0,g.mf)(t)?(n=n=>Mc(t(n,e)),n.dep=hE(t)):n=(0,g.a9)(Mc(t||"#888"));return n}(t.color,t),a=t.as||"image",u={$x:0,$y:0,$value:0,$max:r?ao(n.map((t=>ao(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=(0,g.l7)({},t,u);r||(n.$max=ao(e.values||[])),t[a]=function(t,e,n,r){const i=t.width,o=t.height,s=t.x1||0,a=t.y1||0,u=t.x2||i,c=t.y2||o,l=t.values,f=l?t=>l[t]:g.bM,h=Ju(u-s,c-a),d=h.getContext("2d"),p=d.getImageData(0,0,u-s,c-a),m=p.data;for(let g=a,y=0;g<c;++g){e.$y=g-a;for(let t=s,o=g*i;t<u;++t,y+=4){e.$x=t-s,e.$value=f(t+o);const i=n(e);m[y+0]=i.r,m[y+1]=i.g,m[y+2]=i.b,m[y+3]=~~(255*r(e))}}return d.putImageData(p,0,0),h}(e,n,s.dep?s:(0,g.a9)(s(n)),o.dep?o:(0,g.a9)(o(n)))})),e.reflow(!0).modifies(a)}}),(0,g.XW)(dE,no,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=j_((t||"mercator").toLowerCase());e||(0,g.vU)("Unrecognized projection type: "+t);return e()}(t.type),D_.forEach((e=>{null!=t[e]&&pE(n,e,t[e])}))):D_.forEach((e=>{t.modified(e)&&pE(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return 1===(t=(0,g.IX)(t)).length?t[0]:{type:oE,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===oE?t.features:(0,g.IX)(t).filter((t=>null!=t)).map((t=>t.type===iE?t:{type:iE,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var _E=bE.prototype=xE.prototype;function EE(t){return function(){return t}}function AE(t){return 1e-6*(t()-.5)}function OE(t){return t.x+t.vx}function SE(t){return t.y+t.vy}_E.copy=function(){var t,e,n=new xE(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=wE(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=wE(e));return n},_E.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return gE(this.cover(e,n),e,n,t)},_E.addAll=function(t){var e,n,r,i,o=t.length,s=new Array(o),a=new Array(o),u=1/0,c=1/0,l=-1/0,f=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(s[n]=r,a[n]=i,r<u&&(u=r),r>l&&(l=r),i<c&&(c=i),i>f&&(f=i));if(u>l||c>f)return this;for(this.cover(u,c).cover(l,f),n=0;n<o;++n)gE(this,s[n],a[n],t[n]);return this},_E.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var s,a,u=i-n||1,c=this._root;n>t||t>=i||r>e||e>=o;)switch(a=(e<r)<<1|t<n,(s=new Array(4))[a]=c,c=s,u*=2,a){case 0:i=n+u,o=r+u;break;case 1:n=i-u,o=r+u;break;case 2:i=n+u,r=o-u;break;case 3:n=i-u,r=o-u}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},_E.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},_E.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},_E.find=function(t,e,n){var r,i,o,s,a,u,c,l=this._x0,f=this._y0,h=this._x1,d=this._y1,p=[],g=this._root;for(g&&p.push(new mE(g,l,f,h,d)),null==n?n=1/0:(l=t-n,f=e-n,h=t+n,d=e+n,n*=n);u=p.pop();)if(!(!(g=u.node)||(i=u.x0)>h||(o=u.y0)>d||(s=u.x1)<l||(a=u.y1)<f))if(g.length){var m=(i+s)/2,y=(o+a)/2;p.push(new mE(g[3],m,y,s,a),new mE(g[2],i,y,m,a),new mE(g[1],m,o,s,y),new mE(g[0],i,o,m,y)),(c=(e>=y)<<1|t>=m)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-c],p[p.length-1-c]=u)}else{var v=t-+this._x.call(null,g.data),b=e-+this._y.call(null,g.data),x=v*v+b*b;if(x<n){var w=Math.sqrt(n=x);l=t-w,f=e-w,h=t+w,d=e+w,r=g.data}}return r},_E.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,r,i,o,s,a,u,c,l,f,h,d=this._root,p=this._x0,g=this._y0,m=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((c=o>=(a=(p+m)/2))?p=a:m=a,(l=s>=(u=(g+y)/2))?g=u:y=u,e=d,!(d=d[f=l<<1|c]))return this;if(!d.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,h=f)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[f]=i:delete e[f],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[h]=d:this._root=d),this):(this._root=i,this)},_E.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},_E.root=function(){return this._root},_E.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},_E.visit=function(t){var e,n,r,i,o,s,a=[],u=this._root;for(u&&a.push(new mE(u,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,o=e.x1,s=e.y1)&&u.length){var c=(r+o)/2,l=(i+s)/2;(n=u[3])&&a.push(new mE(n,c,l,o,s)),(n=u[2])&&a.push(new mE(n,r,l,c,s)),(n=u[1])&&a.push(new mE(n,c,i,o,l)),(n=u[0])&&a.push(new mE(n,r,i,c,l))}return this},_E.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new mE(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,s=e.x0,a=e.y0,u=e.x1,c=e.y1,l=(s+u)/2,f=(a+c)/2;(o=i[0])&&n.push(new mE(o,s,a,l,f)),(o=i[1])&&n.push(new mE(o,l,a,u,f)),(o=i[2])&&n.push(new mE(o,s,f,l,c)),(o=i[3])&&n.push(new mE(o,l,f,u,c))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},_E.x=function(t){return arguments.length?(this._x=t,this):this._x},_E.y=function(t){return arguments.length?(this._y=t,this):this._y};var CE={value:()=>{}};function ME(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new PE(r)}function PE(t){this._=t}function kE(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function TE(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function DE(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=CE,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}PE.prototype=ME.prototype={constructor:PE,on:function(t,e){var n,r=this._,i=kE(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!==typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)r[n]=DE(r[n],t.name,e);else if(null==e)for(n in r)r[n]=DE(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=TE(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new PE(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var FE,jE,LE=ME,RE=0,IE=0,NE=0,BE=0,zE=0,$E=0,UE="object"===typeof performance&&performance.now?performance:Date,VE="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ZE(){return zE||(VE(WE),zE=UE.now()+$E)}function WE(){zE=0}function qE(){this._call=this._time=this._next=null}function GE(t,e,n){var r=new qE;return r.restart(t,e,n),r}function HE(){zE=(BE=UE.now())+$E,RE=IE=0;try{!function(){ZE(),++RE;for(var t,e=FE;e;)(t=zE-e._time)>=0&&e._call.call(null,t),e=e._next;--RE}()}finally{RE=0,function(){var t,e,n=FE,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:FE=e);jE=t,YE(r)}(),zE=0}}function XE(){var t=UE.now(),e=t-BE;e>1e3&&($E-=e,BE=t)}function YE(t){RE||(IE&&(IE=clearTimeout(IE)),t-zE>24?(t<1/0&&(IE=setTimeout(HE,t-UE.now()-$E)),NE&&(NE=clearInterval(NE))):(NE||(BE=UE.now(),NE=setInterval(XE,1e3)),RE=1,VE(HE)))}qE.prototype=GE.prototype={constructor:qE,restart:function(t,e,n){if("function"!==typeof t)throw new TypeError("callback is not a function");n=(null==n?ZE():+n)+(null==e?0:+e),this._next||jE===this||(jE?jE._next=this:FE=this,jE=this),this._call=t,this._time=n,YE()},stop:function(){this._call&&(this._call=null,this._time=1/0,YE())}};const KE=4294967296;function JE(t){return t.x}function QE(t){return t.y}var tA=Math.PI*(3-Math.sqrt(5));function eA(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,u=GE(f),c=LE("tick","end"),l=function(){let t=1;return()=>(t=(1664525*t+1013904223)%KE)/KE}();function f(){h(),c.call("tick",e),n<r&&(u.stop(),c.call("end",e))}function h(r){var u,c,l=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(o-n)*i,a.forEach((function(t){t(n)})),u=0;u<l;++u)null==(c=t[u]).fx?c.x+=c.vx*=s:(c.x=c.fx,c.vx=0),null==c.fy?c.y+=c.vy*=s:(c.y=c.fy,c.vy=0);return e}function d(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*tA;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,l),e}return null==t&&(t=[]),d(),e={tick:h,restart:function(){return u.restart(f),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(l=t,a.forEach(p),e):l},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,r){var i,o,s,a,u,c=0,l=t.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(s=(i=e-(a=t[c]).x)*i+(o=n-a.y)*o)<r&&(u=a,r=s);return u},on:function(t,n){return arguments.length>1?(c.on(t,n),e):c.on(t)}}}function nA(t){return t.index}function rA(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const iA={center:function(t,e){var n,r=1;function i(){var i,o,s=n.length,a=0,u=0;for(i=0;i<s;++i)a+=(o=n[i]).x,u+=o.y;for(a=(a/s-t)*r,u=(u/s-e)*r,i=0;i<s;++i)(o=n[i]).x-=a,o.y-=u}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function s(){for(var t,s,u,c,l,f,h,d=e.length,p=0;p<o;++p)for(s=bE(e,OE,SE).visitAfter(a),t=0;t<d;++t)u=e[t],f=n[u.index],h=f*f,c=u.x+u.vx,l=u.y+u.vy,s.visit(g);function g(t,e,n,o,s){var a=t.data,d=t.r,p=f+d;if(!a)return e>c+p||o<c-p||n>l+p||s<l-p;if(a.index>u.index){var g=c-a.x-a.vx,m=l-a.y-a.vy,y=g*g+m*m;y<p*p&&(0===g&&(y+=(g=AE(r))*g),0===m&&(y+=(m=AE(r))*m),y=(p-(y=Math.sqrt(y)))/y*i,u.vx+=(g*=y)*(p=(d*=d)/(h+d)),u.vy+=(m*=y)*p,a.vx-=g*(p=1-p),a.vy-=m*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!==typeof t&&(t=EE(null==t?1:+t)),s.initialize=function(t,n){e=t,r=n,u()},s.iterations=function(t){return arguments.length?(o=+t,s):o},s.strength=function(t){return arguments.length?(i=+t,s):i},s.radius=function(e){return arguments.length?(t="function"===typeof e?e:EE(+e),u(),s):t},s},nbody:function(){var t,e,n,r,i,o=EE(-30),s=1,a=1/0,u=.81;function c(n){var i,o=t.length,s=bE(t,JE,QE).visitAfter(f);for(r=n,i=0;i<o;++i)e=t[i],s.visit(h)}function l(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function f(t){var e,n,r,o,s,a=0,u=0;if(t.length){for(r=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,u+=n,r+=n*e.x,o+=n*e.y);t.x=r/u,t.y=o/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=i[e.data.index]}while(e=e.next)}t.value=a}function h(t,o,c,l){if(!t.value)return!0;var f=t.x-e.x,h=t.y-e.y,d=l-o,p=f*f+h*h;if(d*d/u<p)return p<a&&(0===f&&(p+=(f=AE(n))*f),0===h&&(p+=(h=AE(n))*h),p<s&&(p=Math.sqrt(s*p)),e.vx+=f*t.value*r/p,e.vy+=h*t.value*r/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===f&&(p+=(f=AE(n))*f),0===h&&(p+=(h=AE(n))*h),p<s&&(p=Math.sqrt(s*p)));do{t.data!==e&&(d=i[t.data.index]*r/p,e.vx+=f*d,e.vy+=h*d)}while(t=t.next)}}return c.initialize=function(e,r){t=e,n=r,l()},c.strength=function(t){return arguments.length?(o="function"===typeof t?t:EE(+t),l(),c):o},c.distanceMin=function(t){return arguments.length?(s=t*t,c):Math.sqrt(s)},c.distanceMax=function(t){return arguments.length?(a=t*t,c):Math.sqrt(a)},c.theta=function(t){return arguments.length?(u=t*t,c):Math.sqrt(u)},c},link:function(t){var e,n,r,i,o,s,a=nA,u=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},c=EE(30),l=1;function f(r){for(var i=0,a=t.length;i<l;++i)for(var u,c,f,h,d,p,g,m=0;m<a;++m)c=(u=t[m]).source,h=(f=u.target).x+f.vx-c.x-c.vx||AE(s),d=f.y+f.vy-c.y-c.vy||AE(s),h*=p=((p=Math.sqrt(h*h+d*d))-n[m])/p*r*e[m],d*=p,f.vx-=h*(g=o[m]),f.vy-=d*g,c.vx+=h*(g=1-g),c.vy+=d*g}function h(){if(r){var s,u,c=r.length,l=t.length,f=new Map(r.map(((t,e)=>[a(t,e,r),t])));for(s=0,i=new Array(c);s<l;++s)(u=t[s]).index=s,"object"!==typeof u.source&&(u.source=rA(f,u.source)),"object"!==typeof u.target&&(u.target=rA(f,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,o=new Array(l);s<l;++s)u=t[s],o[s]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(l),d(),n=new Array(l),p()}}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+u(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+c(t[e],e,t)}return null==t&&(t=[]),f.initialize=function(t,e){r=t,s=e,h()},f.links=function(e){return arguments.length?(t=e,h(),f):t},f.id=function(t){return arguments.length?(a=t,f):a},f.iterations=function(t){return arguments.length?(l=+t,f):l},f.strength=function(t){return arguments.length?(u="function"===typeof t?t:EE(+t),d(),f):u},f.distance=function(t){return arguments.length?(c="function"===typeof t?t:EE(+t),p(),f):c},f},x:function(t){var e,n,r,i=EE(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!==typeof t&&(t=EE(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"===typeof t?t:EE(+t),s(),o):i},o.x=function(e){return arguments.length?(t="function"===typeof e?e:EE(+e),s(),o):t},o},y:function(t){var e,n,r,i=EE(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!==typeof t&&(t=EE(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"===typeof t?t:EE(+t),s(),o):i},o.y=function(e){return arguments.length?(t="function"===typeof e?e:EE(+e),s(),o):t},o}},oA="forces",sA=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],aA=["static","iterations"],uA=["x","y","vx","vy"];function cA(t){no.call(this,null,t)}function lA(t,e,n,r){var i,o,s,a,u=(0,g.IX)(e.forces);for(i=0,o=sA.length;i<o;++i)(s=sA[i])!==oA&&e.modified(s)&&t[s](e[s]);for(i=0,o=u.length;i<o;++i)a=oA+i,(s=n||e.modified(oA,i)?hA(u[i]):r&&fA(u[i],r)?t.force(a):null)&&t.force(a,s);for(o=t.numForces||0;i<o;++i)t.force(oA+i,null);return t.numForces=u.length,t}function fA(t,e){var n,r;for(n in t)if((0,g.mf)(r=t[n])&&e.modified((0,g.Oj)(r)))return 1;return 0}function hA(t){var e,n;for(n in(0,g.nr)(iA,t.force)||(0,g.vU)("Unrecognized force: "+t.force),e=iA[t.force](),t)(0,g.mf)(e[n])&&dA(e[n],t[n],t);return e}function dA(t,e,n){t((0,g.mf)(e)?t=>e(t,n):e)}function pA(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function gA(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=yA)):void 0===e&&(e=mA);for(var n,r,i,o,s,a=new xA(t),u=[a];n=u.pop();)if((i=e(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,o=s-1;o>=0;--o)u.push(r=i[o]=new xA(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(bA)}function mA(t){return t.children}function yA(t){return Array.isArray(t)?t[1]:null}function vA(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function bA(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function xA(t){this.data=t,this.depth=this.height=0,this.parent=null}function wA(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(Array.from(t))).length,o=[];r<i;)e=t[r],n&&AA(n,e)?++r:(n=SA(o=_A(o,e)),r=0);return n}function _A(t,e){var n,r;if(OA(e,t))return[e];for(n=0;n<t.length;++n)if(EA(e,t[n])&&OA(CA(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(EA(CA(t[n],t[r]),e)&&EA(CA(t[n],e),t[r])&&EA(CA(t[r],e),t[n])&&OA(MA(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function EA(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function AA(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function OA(t,e){for(var n=0;n<e.length;++n)if(!AA(t,e[n]))return!1;return!0}function SA(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return CA(t[0],t[1]);case 3:return MA(t[0],t[1],t[2])}}function CA(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,s=e.y,a=e.r,u=o-n,c=s-r,l=a-i,f=Math.sqrt(u*u+c*c);return{x:(n+o+u/f*l)/2,y:(r+s+c/f*l)/2,r:(f+i+a)/2}}function MA(t,e,n){var r=t.x,i=t.y,o=t.r,s=e.x,a=e.y,u=e.r,c=n.x,l=n.y,f=n.r,h=r-s,d=r-c,p=i-a,g=i-l,m=u-o,y=f-o,v=r*r+i*i-o*o,b=v-s*s-a*a+u*u,x=v-c*c-l*l+f*f,w=d*p-h*g,_=(p*x-g*b)/(2*w)-r,E=(g*m-p*y)/w,A=(d*b-h*x)/(2*w)-i,O=(h*y-d*m)/w,S=E*E+O*O-1,C=2*(o+_*E+A*O),M=_*_+A*A-o*o,P=-(S?(C+Math.sqrt(C*C-4*S*M))/(2*S):M/C);return{x:r+_+E*P,y:i+A+O*P,r:P}}function PA(t,e,n){var r,i,o,s,a=t.x-e.x,u=t.y-e.y,c=a*a+u*u;c?(i=e.r+n.r,i*=i,s=t.r+n.r,i>(s*=s)?(r=(c+s-i)/(2*c),o=Math.sqrt(Math.max(0,s/c-r*r)),n.x=t.x-r*a-o*u,n.y=t.y-r*u+o*a):(r=(c+i-s)/(2*c),o=Math.sqrt(Math.max(0,i/c-r*r)),n.x=e.x+r*a-o*u,n.y=e.y+r*u+o*a)):(n.x=e.x+n.r,n.y=e.y)}function kA(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function TA(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function DA(t){this._=t,this.next=null,this.previous=null}function FA(t){if(!(i=(t=function(t){return"object"===typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var e,n,r,i,o,s,a,u,c,l,f;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;PA(n,e,r=t[2]),e=new DA(e),n=new DA(n),r=new DA(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(a=3;a<i;++a){PA(e._,n._,r=t[a]),r=new DA(r),u=n.next,c=e.previous,l=n._.r,f=e._.r;do{if(l<=f){if(kA(u._,r._)){n=u,e.next=n,n.previous=e,--a;continue t}l+=u._.r,u=u.next}else{if(kA(c._,r._)){(e=c).next=n,n.previous=e,--a;continue t}f+=c._.r,c=c.previous}}while(u!==c.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,o=TA(e);(r=r.next)!==n;)(s=TA(r))<o&&(e=r,o=s);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=wA(e),a=0;a<i;++a)(e=t[a]).x-=r.x,e.y-=r.y;return r.r}function jA(t){return null==t?null:LA(t)}function LA(t){if("function"!==typeof t)throw new Error;return t}function RA(){return 0}function IA(t){return function(){return t}}function NA(t){return Math.sqrt(t.value)}function BA(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function zA(t,e){return function(n){if(r=n.children){var r,i,o,s=r.length,a=t(n)*e||0;if(a)for(i=0;i<s;++i)r[i].r+=a;if(o=FA(r),a)for(i=0;i<s;++i)r[i].r-=a;n.r=o+a}}}function $A(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function UA(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function VA(t,e,n,r,i){for(var o,s=t.children,a=-1,u=s.length,c=t.value&&(r-e)/t.value;++a<u;)(o=s[a]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*c}cA.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:uA}]},(0,g.XW)(cA,no,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),s=t.modified(sA),a=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(s||e.changed(e.MOD))&&lA(i,t,0,e)):(this.value=i=function(t,e){const n=eA(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),lA(n,e,!0).on("end",(()=>o=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),s||o||t.modified(aA)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/a)),t.static)for(i.stop();--a>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let a,u=this._argops,c=0,l=u.length;c<l;++c)if(a=u[c],a.name===oA&&"link"===a.op._argval.force)for(var r,i=a.op._argops,o=0,s=i.length;o<s;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(uA)}}),xA.prototype=gA.prototype={constructor:xA,count:function(){return this.eachAfter(pA)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,s=[o],a=[],u=-1;o=s.pop();)if(a.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);for(;o=a.pop();)t.call(e,o,++u,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],s=-1;i=o.pop();)if(t.call(e,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return gA(this).eachBefore(vA)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};var ZA={depth:-1},WA={};function qA(t){return t.id}function GA(t){return t.parentId}function HA(){var t=qA,e=GA;function n(n){var r,i,o,s,a,u,c,l=Array.from(n),f=l.length,h=new Map;for(i=0;i<f;++i)r=l[i],a=l[i]=new xA(r),null!=(u=t(r,i,n))&&(u+="")&&(c=a.id=u,h.set(c,h.has(c)?WA:a)),null!=(u=e(r,i,n))&&(u+="")&&(a.parent=u);for(i=0;i<f;++i)if(u=(a=l[i]).parent){if(!(s=h.get(u)))throw new Error("missing: "+u);if(s===WA)throw new Error("ambiguous: "+u);s.children?s.children.push(a):s.children=[a],a.parent=s}else{if(o)throw new Error("multiple roots");o=a}if(!o)throw new Error("no root");if(o.parent=ZA,o.eachBefore((function(t){t.depth=t.parent.depth+1,--f})).eachBefore(bA),o.parent=null,f>0)throw new Error("cycle");return o}return n.id=function(e){return arguments.length?(t=LA(e),n):t},n.parentId=function(t){return arguments.length?(e=LA(t),n):e},n}function XA(t,e){return t.parent===e.parent?1:2}function YA(t){var e=t.children;return e?e[0]:t.t}function KA(t){var e=t.children;return e?e[e.length-1]:t.t}function JA(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function QA(t,e,n){return t.a.parent===e.parent?t.a:n}function tO(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function eO(t,e){return t.parent===e.parent?1:2}function nO(t,e){return t+e.x}function rO(t,e){return Math.max(t,e.y)}function iO(t,e,n,r,i){for(var o,s=t.children,a=-1,u=s.length,c=t.value&&(i-n)/t.value;++a<u;)(o=s[a]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*c}tO.prototype=Object.create(xA.prototype);var oO=(1+Math.sqrt(5))/2;function sO(t,e,n,r,i,o){for(var s,a,u,c,l,f,h,d,p,g,m,y=[],v=e.children,b=0,x=0,w=v.length,_=e.value;b<w;){u=i-n,c=o-r;do{l=v[x++].value}while(!l&&x<w);for(f=h=l,m=l*l*(g=Math.max(c/u,u/c)/(_*t)),p=Math.max(h/m,m/f);x<w;++x){if(l+=a=v[x].value,a<f&&(f=a),a>h&&(h=a),m=l*l*g,(d=Math.max(h/m,m/f))>p){l-=a;break}p=d}y.push(s={value:l,dice:u<c,children:v.slice(b,x)}),s.dice?VA(s,n,r,i,_?r+=c*l/_:o):iO(s,n,r,_?n+=u*l/_:i,o),_-=l,b=x}return y}var aO=function t(e){function n(t,n,r,i,o){sO(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(oO),uO=function t(e){function n(t,n,r,i,o){if((s=t._squarify)&&s.ratio===e)for(var s,a,u,c,l,f=-1,h=s.length,d=t.value;++f<h;){for(u=(a=s[f]).children,c=a.value=0,l=u.length;c<l;++c)a.value+=u[c].value;a.dice?VA(a,n,r,i,d?r+=(o-r)*a.value/d:o):iO(a,n,r,d?n+=(i-n)*a.value/d:i,o),d-=a.value}else t._squarify=s=sO(e,t,n,r,i,o),s.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(oO);function cO(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function lO(t){no.call(this,null,t)}lO.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const fO=t=>t.values;function hO(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],s={},a={};let u,c,l,f=-1;for(;++f<i;)u=o(c=e[f])+"",(l=s[u])?l.push(c):s[u]=[c];for(u in s)a[u]=n(s[u],r);return a}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function dO(t){no.call(this,null,t)}(0,g.XW)(lO,no,{transform(t,e){e.source||(0,g.vU)("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each((t=>{t.children&&_i(t.data)&&i.rem.push(t.data)})),this.value=o=gA({values:(0,g.IX)(t.keys).reduce(((t,e)=>(t.key(e),t)),hO()).entries(i.source)},fO),n&&o.each((t=>{t.children&&(t=Oi(t.data),i.add.push(t),i.source.push(t))})),cO(o,Ei,Ei)),i.source.root=o,i}});const pO=(t,e)=>t.parent===e.parent?1:2;(0,g.XW)(dO,no,{transform(t,e){e.source&&e.source.root||(0,g.vU)(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(Pi(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?pO:g.kX);try{this.value=n(i)}catch(s){(0,g.vU)(s)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o))),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const gO=["x","y","r","depth","children"];function mO(t){dO.call(this,t)}mO.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:gO.length,default:gO}]},(0,g.XW)(mO,dO,{layout:function(){var t=null,e=1,n=1,r=RA;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(BA(t)).eachAfter(zA(r,.5)).eachBefore($A(1)):i.eachBefore(BA(NA)).eachAfter(zA(RA,1)).eachAfter(zA(r,i.r/Math.min(e,n))).eachBefore($A(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=jA(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"===typeof t?t:IA(+t),i):r},i},params:["radius","size","padding"],fields:gO});const yO=["x0","y0","x1","y1","depth","children"];function vO(t){dO.call(this,t)}function bO(t){no.call(this,null,t)}vO.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:yO.length,default:yO}]},(0,g.XW)(vO,dO,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&VA(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,s=r.x1-n,a=r.y1-n;s<i&&(i=s=(i+s)/2),a<o&&(o=a=(o+a)/2),r.x0=i,r.y0=o,r.x1=s,r.y1=a}}(e,o)),r&&i.eachBefore(UA),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:yO}),bO.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},(0,g.XW)(bO,no,{transform(t,e){e.source||(0,g.vU)("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?cO(HA().id(t.key).parentId(t.parentKey)(i.source),t.key,g.yb):cO(HA()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const xO={tidy:function(){var t=XA,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,o,s=new tO(t,0),a=[s];e=a.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)a.push(n=e.children[i]=new tO(r[i],i)),n.parent=e;return(s.parent=new tO(null,0)).children=[s],s}(i);if(u.eachAfter(o),u.parent.m=-u.z,u.eachBefore(s),r)i.eachBefore(a);else{var c=i,l=i,f=i;i.eachBefore((function(t){t.x<c.x&&(c=t),t.x>l.x&&(l=t),t.depth>f.depth&&(f=t)}));var h=c===l?1:t(c,l)/2,d=h-c.x,p=e/(l.x+h+d),g=n/(f.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*g}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,s=e,a=n,u=o.parent.children[0],c=o.m,l=s.m,f=a.m,h=u.m;a=KA(a),o=YA(o),a&&o;)u=YA(u),(s=KA(s)).a=e,(i=a.z+f-o.z-c+t(a._,o._))>0&&(JA(QA(a,e,r),e,i),c+=i,l+=i),f+=a.m,c+=o.m,h+=u.m,l+=s.m;a&&!KA(s)&&(s.t=a,s.m+=f-l),o&&!YA(u)&&(u.t=o,u.m+=c-h,r=e)}return r}(e,i,e.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=eO,e=1,n=1,r=!1;function i(i){var o,s=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(nO,0)/t.length}(n),e.y=function(t){return 1+t.reduce(rO,0)}(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)}));var a=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),c=a.x-t(a,u)/2,l=u.x+t(u,a)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-c)/(l-c)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},wO=["x","y","depth","children"];function _O(t){dO.call(this,t)}function EO(t){no.call(this,[],t)}_O.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:wO.length,default:wO}]},(0,g.XW)(_O,dO,{layout(t){const e=t||"tidy";if((0,g.nr)(xO,e))return xO[e]();(0,g.vU)("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:wO}),EO.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},(0,g.XW)(EO,no,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||(0,g.vU)("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>o[Ei(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[Ei(e)]&&o[Ei(n)]&&i.add.push(Oi({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>o[Ei(t)]=1)),n.forEach((t=>{(o[Ei(t.source)]||o[Ei(t.target)])&&i.mod.push(t)}))),i}});const AO={binary:function(t,e,n,r,i){var o,s,a=t.children,u=a.length,c=new Array(u+1);for(c[0]=s=o=0;o<u;++o)c[o+1]=s+=a[o].value;!function t(e,n,r,i,o,s,u){if(e>=n-1){var l=a[e];return l.x0=i,l.y0=o,l.x1=s,void(l.y1=u)}var f=c[e],h=r/2+f,d=e+1,p=n-1;for(;d<p;){var g=d+p>>>1;c[g]<h?d=g+1:p=g}h-c[d-1]<c[d]-h&&e+1<d&&--d;var m=c[d]-f,y=r-m;if(s-i>u-o){var v=r?(i*y+s*m)/r:s;t(e,d,m,i,o,v,u),t(d,n,y,v,o,s,u)}else{var b=r?(o*y+u*m)/r:u;t(e,d,m,i,o,s,b),t(d,n,y,i,b,s,u)}}(0,u,t.value,e,n,r,i)},dice:VA,slice:iO,slicedice:function(t,e,n,r,i){(1&t.depth?iO:VA)(t,e,n,r,i)},squarify:aO,resquarify:uO},OO=["x0","y0","x1","y1","depth","children"];function SO(t){dO.call(this,t)}SO.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:OO.length,default:OO}]},(0,g.XW)(SO,dO,{layout(){const t=function(){var t=aO,e=!1,n=1,r=1,i=[0],o=RA,s=RA,a=RA,u=RA,c=RA;function l(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(f),i=[0],e&&t.eachBefore(UA),t}function f(e){var n=i[e.depth],r=e.x0+n,l=e.y0+n,f=e.x1-n,h=e.y1-n;f<r&&(r=f=(r+f)/2),h<l&&(l=h=(l+h)/2),e.x0=r,e.y0=l,e.x1=f,e.y1=h,e.children&&(n=i[e.depth+1]=o(e)/2,r+=c(e)-n,l+=s(e)-n,(f-=a(e)-n)<r&&(r=f=(r+f)/2),(h-=u(e)-n)<l&&(l=h=(l+h)/2),t(e,r,l,f,h))}return l.round=function(t){return arguments.length?(e=!!t,l):e},l.size=function(t){return arguments.length?(n=+t[0],r=+t[1],l):[n,r]},l.tile=function(e){return arguments.length?(t=LA(e),l):t},l.padding=function(t){return arguments.length?l.paddingInner(t).paddingOuter(t):l.paddingInner()},l.paddingInner=function(t){return arguments.length?(o="function"===typeof t?t:IA(+t),l):o},l.paddingOuter=function(t){return arguments.length?l.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):l.paddingTop()},l.paddingTop=function(t){return arguments.length?(s="function"===typeof t?t:IA(+t),l):s},l.paddingRight=function(t){return arguments.length?(a="function"===typeof t?t:IA(+t),l):a},l.paddingBottom=function(t){return arguments.length?(u="function"===typeof t?t:IA(+t),l):u},l.paddingLeft=function(t){return arguments.length?(c="function"===typeof t?t:IA(+t),l):c},l}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{(0,g.nr)(AO,e)?t.tile(AO[e]):(0,g.vU)("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:OO});function CO(t,e,n,r){const i=t.width,o=t.height,s=n||r,a=Ju(i,o).getContext("2d");e.forEach((t=>MO(a,t,s)));const u=new Uint32Array(a.getImageData(0,0,i,o).data.buffer),c=t.bitmap(),l=s&&t.bitmap();let f,h,d,p,g;for(h=0;h<o;++h)for(f=0;f<i;++f)g=4278190080&u[h*i+f],g&&(d=t(f),p=t(h),r||c.set(d,p),s&&268435456^g&&l.set(d,p));return[c,l]}function MO(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>MO(t,e.items,n)))})):tm[r].draw(t,{items:n?e.map(PO):e})}function PO(t){const e=Ci(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=.0625,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}const kO=31,TO=new Uint32Array(33),DO=new Uint32Array(33);DO[0]=0,TO[0]=~DO[0];for(let xL=1;xL<=32;++xL)DO[xL]=DO[xL-1]<<1|1,TO[xL]=~DO[xL];function FO(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),s=t=>~~((t+n)/r);return s.invert=t=>t*r-n,s.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+32)/32));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>5]&1<<(i&kO)},set:(e,n)=>{const i=n*t+e;r(i>>>5,1<<(i&kO))},clear:(e,n)=>{const r=n*t+e;i(r>>>5,~(1<<(r&kO)))},getRange:(e,r,i,o)=>{let s,a,u,c,l=o;for(;l>=r;--l)if(s=l*t+e,a=l*t+i,u=s>>>5,c=a>>>5,u===c){if(n[u]&TO[s&kO]&DO[1+(a&kO)])return!0}else{if(n[u]&TO[s&kO])return!0;if(n[c]&DO[1+(a&kO)])return!0;for(let t=u+1;t<c;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let s,a,u,c,l;for(;n<=o;++n)if(s=n*t+e,a=n*t+i,u=s>>>5,c=a>>>5,u===c)r(u,TO[s&kO]&DO[1+(a&kO)]);else for(r(u,TO[s&kO]),r(c,DO[1+(a&kO)]),l=u+1;l<c;++l)r(l,4294967295)},clearRange:(e,n,r,o)=>{let s,a,u,c,l;for(;n<=o;++n)if(s=n*t+e,a=n*t+r,u=s>>>5,c=a>>>5,u===c)i(u,DO[s&kO]|TO[1+(a&kO)]);else for(i(u,DO[s&kO]),i(c,TO[1+(a&kO)]),l=u+1;l<c;++l)i(l,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}(i,o),s.ratio=r,s.padding=n,s.width=t,s.height=e,s}function jO(t,e,n,r,i,o){let s=n/2;return t-s<0||t+s>i||e-(s=r/2)<0||e+s>o}function LO(){return!1}function RO(t,e,n,r,i,o,s,a){const u=i*o/(2*r),c=t(e-u),l=t(e+u),f=t(n-(o/=2)),h=t(n+o);return s.outOfBounds(c,f,l,h)||s.getRange(c,f,l,h)||a&&a.getRange(c,f,l,h)}function IO(t,e,n,r,i,o,s,a){const u=i*o/(2*r);let c=t(e-u),l=t(e+u),f=t(n-(o/=2)),h=t(n+o);return c=c>0?c:0,f=f>0?f:0,l=l<t.width?l:t.width-1,h=h<t.height?h:t.height-1,s.getRange(c,f,l,h)||a&&a.getRange(c,f,l,h)}function NO(t){return t?[IO,LO]:[RO,jO]}const BO=[-1,-1,1,1],zO=[-1,1,-1,1];const $O=["right","center","left"],UO=["bottom","middle","top"];function VO(t,e,n,r,i,o,s,a,u,c,l,f){return!(i.outOfBounds(t,n,e,r)||(f&&o?o.getRange(t,n,e,r)||!function(t,e,n,r,i){return i[0]<=t&&n<=i[2]&&i[3]<=e&&r<=i[5]}(s,u,a,c,l):i.getRange(t,n,e,r)))}const ZO={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},WO={naive:function(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,s=t.datum.fontSize,a=Rg.width(t.datum,t.datum.text);let u,c,l,f,h,d,p,g=0;for(let r=0;r<n;++r)u=e[r].x,l=e[r].y,c=void 0===e[r].x2?u:e[r].x2,f=void 0===e[r].y2?l:e[r].y2,h=(u+c)/2,d=(l+f)/2,p=Math.abs(c-u+f-l),p>=g&&(g=p,t.x=h,t.y=d);return h=a/2,d=s/2,u=t.x-h,c=t.x+h,l=t.y-d,f=t.y+d,t.align="center",u<0&&c<=i?t.align="left":0<=u&&i<c&&(t.align="right"),t.baseline="middle",l<0&&f<=o?t.baseline="top":0<=l&&o<f&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r,i){const o=t.width,s=t.height,[a,u]=NO(i),c=e[0],l=e[1];function f(e,n,r,i,f){const h=t.invert(e),d=t.invert(n);let p,g=r,m=s;if(!u(h,d,i,f,o,s)&&!a(t,h,d,f,i,g,c,l)&&!a(t,h,d,f,i,f,c,null)){for(;m-g>=1;)p=(g+m)/2,a(t,h,d,f,i,p,c,l)?m=p:g=p;if(g>r)return[h,d,g,!0]}}return function(e){const i=e.datum.datum.items[r].items,l=i.length,h=e.datum.fontSize,d=Rg.width(e.datum,e.datum.text);let p,g,m,y,v,b,x,w,_,E,A,O,S,C,M,P,k,T=n?h:0,D=!1,F=!1,j=0;for(let r=0;r<l;++r){for(p=i[r].x,m=i[r].y,g=void 0===i[r].x2?p:i[r].x2,y=void 0===i[r].y2?m:i[r].y2,p>g&&(k=p,p=g,g=k),m>y&&(k=m,m=y,y=k),_=t(p),A=t(g),E=~~((_+A)/2),O=t(m),C=t(y),S=~~((O+C)/2),x=E;x>=_;--x)for(w=S;w>=O;--w)P=f(x,w,T,d,h),P&&([e.x,e.y,T,D]=P);for(x=E;x<=A;++x)for(w=S;w<=C;++w)P=f(x,w,T,d,h),P&&([e.x,e.y,T,D]=P);D||n||(M=Math.abs(g-p+y-m),v=(p+g)/2,b=(m+y)/2,M>=j&&!u(v,b,d,h,o,s)&&!a(t,v,b,h,d,h,c,null)&&(j=M,e.x=v,e.y=b,F=!0))}return!(!D&&!F)&&(v=d/2,b=h/2,c.setRange(t(e.x-v),t(e.y-b),t(e.x+v),t(e.y+b)),e.align="center",e.baseline="middle",!0)}},floodfill:function(t,e,n,r,i){const o=t.width,s=t.height,[a,u]=NO(i),c=e[0],l=e[1],f=t.bitmap();return function(e){const i=e.datum.datum.items[r].items,h=i.length,d=e.datum.fontSize,p=Rg.width(e.datum,e.datum.text),g=[];let m,y,v,b,x,w,_,E,A,O,S,C,M=n?d:0,P=!1,k=!1,T=0;for(let r=0;r<h;++r){for(m=i[r].x,v=i[r].y,y=void 0===i[r].x2?m:i[r].x2,b=void 0===i[r].y2?v:i[r].y2,g.push([t((m+y)/2),t((v+b)/2)]);g.length;)if([_,E]=g.pop(),!(c.get(_,E)||l.get(_,E)||f.get(_,E))){f.set(_,E);for(let t=0;t<4;++t)x=_+BO[t],w=E+zO[t],f.outOfBounds(x,w,x,w)||g.push([x,w]);if(x=t.invert(_),w=t.invert(E),A=M,O=s,!u(x,w,p,d,o,s)&&!a(t,x,w,d,p,A,c,l)&&!a(t,x,w,d,p,d,c,null)){for(;O-A>=1;)S=(A+O)/2,a(t,x,w,d,p,S,c,l)?O=S:A=S;A>M&&(e.x=x,e.y=w,M=A,P=!0)}}P||n||(C=Math.abs(y-m+b-v),x=(m+y)/2,w=(v+b)/2,C>=T&&!u(x,w,p,d,o,s)&&!a(t,x,w,d,p,d,c,null)&&(T=C,e.x=x,e.y=w,k=!0))}return!(!P&&!k)&&(x=p/2,w=d/2,c.setRange(t(e.x-x),t(e.y-w),t(e.x+x),t(e.y+w)),e.align="center",e.baseline="middle",!0)}}};function qO(t,e,n,r,i,o,s,a,u,c,l){if(!t.length)return t;const f=Math.max(r.length,i.length),h=function(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}(r,f),d=function(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=ZO[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}(i,f),p=(w=t[0].datum)&&w.mark&&w.mark.marktype,g="group"===p&&t[0].datum.items[u].marktype,m="area"===g,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,g,a,u),v=null===c||c===1/0,b=FO(e[0],e[1],v?0:c),x=m&&"naive"===l;var w;const _=t.map((t=>({datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t)})));let E;if(!x){n&&_.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<d.length&&!e;++t)e=5===d[t]||h[t]<0;p&&(s||m)&&(o=[t.map((t=>t.datum))].concat(o)),E=o.length?CO(b,o,e,m):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(b,s&&_)}const A=m?WO[l](b,E,s,u,v):function(t,e,n,r,i){const o=t.width,s=t.height,a=e[0],u=e[1],c=r.length;return function(e){const l=e.boundary,f=e.datum.fontSize;if(!i&&(l[2]<0||l[5]<0||l[0]>o||l[3]>s))return!1;let h,d,p,g,m,y,v,b,x,w,_,E,A,O,S,C=0;for(let o=0;o<c;++o){if(h=(3&n[o])-1,d=(n[o]>>>2&3)-1,p=0===h&&0===d||r[o]<0,g=h&&d?Math.SQRT1_2:1,m=r[o]<0?-1:1,y=l[1+h]+r[o]*h*g,_=l[4+d]+m*f*d/2+r[o]*d*g,b=_-f/2,x=_+f/2,E=t(y),O=t(b),S=t(x),i&&(E=E<0?0:E,O=O<0?0:O,S=S>=t.height?t.height-1:S),!C){if(!VO(E,E,O,S,a,u,y,y,b,x,l,p))continue;C=Rg.width(e.datum,e.datum.text)}if(w=y+m*C*h/2,y=w-C/2,v=w+C/2,E=t(y),A=t(v),i&&(E=E<0?0:E,A=A>=t.width?t.width-1:A),VO(E,A,O,S,a,u,y,v,b,x,l,p))return e.x=h?h*m<0?v:y:w,e.y=d?d*m<0?x:b:_,e.align=$O[h*m+1],e.baseline=UO[d*m+1],a.setRange(E,O,A,S),!0}return!1}}(b,E,d,h,v);return _.forEach((t=>t.opacity=+A(t))),_}const GO=["x","y","opacity","align","baseline"],HO=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function XO(t){no.call(this,null,t)}function YO(t,e){var n,r,i,o,s,a,u=[],c=function(t){return t(o)};if(null==e)u.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(a=n[s=e.map(c)])||(n[s]=a=[],a.dims=s,u.push(a)),a.push(o);return u}function KO(t){no.call(this,null,t)}XO.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:HO},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:GO.length,default:GO}]},(0,g.XW)(XO,no,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t[n];return(0,g.mf)(r)&&e.modified(r.fields)}("sort")))return;t.size&&2===t.size.length||(0,g.vU)("Size parameter should be specified as a [width, height] array.");const r=t.as||GO;return qO(e.materialize(e.SOURCE).source||[],t.size,t.sort,(0,g.IX)(null==t.offset?1:t.offset),(0,g.IX)(t.anchor||HO),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),KO.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},(0,g.XW)(KO,no,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=YO(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(g.el),o=i.length,s=t.as||[(0,g.el)(t.x),(0,g.el)(t.y)],a=[];r.forEach((e=>{is(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let r=0;r<o;++r)n[i[r]]=e.dims[r];n[s[0]]=t[0],n[s[1]]=t[1],a.push(Oi(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a}return n}});const JO={linear:Ko,log:Jo,exp:Qo,pow:ts,quad:es,poly:ns};function QO(t){no.call(this,null,t)}QO.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(JO)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},(0,g.XW)(QO,no,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=YO(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(g.el),o=t.method||"linear",s=t.order||3,a=((t,e)=>"poly"===t?e:"quad"===t?2:1)(o,s),u=t.as||[(0,g.el)(t.x),(0,g.el)(t.y)],c=JO[o],l=[];let f=t.extent;(0,g.nr)(JO,o)||(0,g.vU)("Invalid regression method: "+o),null!=f&&"log"===o&&f[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),f=null),r.forEach((n=>{if(n.length<=a)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=c(n,t.x,t.y,s);if(t.params)return void l.push(Oi({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const h=f||(0,g.We)(n,t.x),d=t=>{const e={};for(let r=0;r<i.length;++r)e[i[r]]=n.dims[r];e[u[0]]=t[0],e[u[1]]=t[1],l.push(Oi(e))};"linear"===o?h.forEach((t=>d([t,r.predict(t)]))):us(r.predict,h,25,200).forEach(d)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});const tS=Math.pow(2,-52),eS=new Uint32Array(512);class nS{static from(t,e=lS,n=fS){const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new nS(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let s=1/0,a=1/0,u=-1/0,c=-1/0;for(let O=0;O<o;O++){const e=t[2*O],n=t[2*O+1];e<s&&(s=e),n<a&&(a=n),e>u&&(u=e),n>c&&(c=n),this._ids[O]=O}const l=(s+u)/2,f=(a+c)/2;let h,d,p,g=1/0;for(let O=0;O<o;O++){const e=rS(l,f,t[2*O],t[2*O+1]);e<g&&(h=O,g=e)}const m=t[2*h],y=t[2*h+1];g=1/0;for(let O=0;O<o;O++){if(O===h)continue;const e=rS(m,y,t[2*O],t[2*O+1]);e<g&&e>0&&(d=O,g=e)}let v=t[2*d],b=t[2*d+1],x=1/0;for(let O=0;O<o;O++){if(O===h||O===d)continue;const e=aS(m,y,v,b,t[2*O],t[2*O+1]);e<x&&(p=O,x=e)}let w=t[2*p],_=t[2*p+1];if(x===1/0){for(let r=0;r<o;r++)this._dists[r]=t[2*r]-t[0]||t[2*r+1]-t[1];uS(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t];this._dists[i]>r&&(e[n++]=i,r=this._dists[i])}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(oS(m,y,v,b,w,_)){const t=d,e=v,n=b;d=p,v=w,b=_,p=t,w=e,_=n}const E=function(t,e,n,r,i,o){const s=n-t,a=r-e,u=i-t,c=o-e,l=s*s+a*a,f=u*u+c*c,h=.5/(s*c-a*u);return{x:t+(c*l-a*f)*h,y:e+(s*f-u*l)*h}}(m,y,v,b,w,_);this._cx=E.x,this._cy=E.y;for(let O=0;O<o;O++)this._dists[O]=rS(t[2*O],t[2*O+1],E.x,E.y);uS(this._ids,this._dists,0,o-1),this._hullStart=h;let A=3;n[h]=e[p]=d,n[d]=e[h]=p,n[p]=e[d]=h,r[h]=0,r[d]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,y)]=h,i[this._hashKey(v,b)]=d,i[this._hashKey(w,_)]=p,this.trianglesLen=0,this._addTriangle(h,d,p,-1,-1,-1);for(let O,S,C=0;C<this._ids.length;C++){const o=this._ids[C],s=t[2*o],a=t[2*o+1];if(C>0&&Math.abs(s-O)<=tS&&Math.abs(a-S)<=tS)continue;if(O=s,S=a,o===h||o===d||o===p)continue;let u=0;for(let t=0,e=this._hashKey(s,a);t<this._hashSize&&(u=i[(e+t)%this._hashSize],-1===u||u===n[u]);t++);u=e[u];let c,l=u;for(;c=n[l],!oS(s,a,t[2*l],t[2*l+1],t[2*c],t[2*c+1]);)if(l=c,l===u){l=-1;break}if(-1===l)continue;let f=this._addTriangle(l,o,n[l],-1,-1,r[l]);r[o]=this._legalize(f+2),r[l]=f,A++;let g=n[l];for(;c=n[g],oS(s,a,t[2*g],t[2*g+1],t[2*c],t[2*c+1]);)f=this._addTriangle(g,o,c,r[o],-1,r[g]),r[o]=this._legalize(f+2),n[g]=g,A--,g=c;if(l===u)for(;c=e[l],oS(s,a,t[2*c],t[2*c+1],t[2*l],t[2*l+1]);)f=this._addTriangle(c,o,l,-1,r[l],r[c]),this._legalize(f+2),r[c]=f,n[l]=l,A--,l=c;this._hullStart=e[o]=l,n[l]=e[g]=o,n[o]=g,i[this._hashKey(s,a)]=o,i[this._hashKey(t[2*l],t[2*l+1])]=l}this.hull=new Uint32Array(A);for(let O=0,S=this._hullStart;O<A;O++)this.hull[O]=S,S=n[S];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const s=n[t],a=t-t%3;if(o=a+(t+2)%3,-1===s){if(0===i)break;t=eS[--i];continue}const u=s-s%3,c=a+(t+1)%3,l=u+(s+2)%3,f=e[o],h=e[t],d=e[c],p=e[l];if(sS(r[2*f],r[2*f+1],r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1])){e[t]=p,e[s]=f;const r=n[l];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===l){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(s,n[o]),this._link(o,l);const a=u+(s+1)%3;i<eS.length&&(eS[i++]=a)}else{if(0===i)break;t=eS[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=e,this._triangles[s+2]=n,this._link(s,r),this._link(s+1,i),this._link(s+2,o),this.trianglesLen+=3,s}}function rS(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function iS(t,e,n,r,i,o){const s=(r-e)*(i-t),a=(n-t)*(o-e);return Math.abs(s-a)>=33306690738754716e-32*Math.abs(s+a)?s-a:0}function oS(t,e,n,r,i,o){return(iS(i,o,t,e,n,r)||iS(t,e,n,r,i,o)||iS(n,r,i,o,t,e))<0}function sS(t,e,n,r,i,o,s,a){const u=t-s,c=e-a,l=n-s,f=r-a,h=i-s,d=o-a,p=l*l+f*f,g=h*h+d*d;return u*(f*g-p*d)-c*(l*g-p*h)+(u*u+c*c)*(l*d-f*h)<0}function aS(t,e,n,r,i,o){const s=n-t,a=r-e,u=i-t,c=o-e,l=s*s+a*a,f=u*u+c*c,h=.5/(s*c-a*u),d=(c*l-a*f)*h,p=(s*f-u*l)*h;return d*d+p*p}function uS(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let s=i-1;for(;s>=n&&e[t[s]]>o;)t[s+1]=t[s--];t[s+1]=r}else{let i=n+1,o=r;cS(t,n+r>>1,i),e[t[n]]>e[t[r]]&&cS(t,n,r),e[t[i]]>e[t[r]]&&cS(t,i,r),e[t[n]]>e[t[i]]&&cS(t,n,i);const s=t[i],a=e[s];for(;;){do{i++}while(e[t[i]]<a);do{o--}while(e[t[o]]>a);if(o<i)break;cS(t,i,o)}t[n+1]=t[o],t[o]=s,r-i+1>=o-n?(uS(t,e,i,r),uS(t,e,n,o-1)):(uS(t,e,n,o-1),uS(t,e,i,r))}}function cS(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function lS(t){return t[0]}function fS(t){return t[1]}const hS=1e-6;class dS{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>hS||Math.abs(this._y1-i)>hS)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class pS{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class gS{constructor(t,[e,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(e=+e))||!((i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this,i=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let h,d,p=0,g=0,m=n.length;p<m;p+=3,g+=2){const e=2*n[p],r=2*n[p+1],o=2*n[p+2],s=t[e],a=t[e+1],u=t[r],c=t[r+1],l=t[o],f=t[o+1],m=u-s,y=c-a,v=l-s,b=f-a,x=m*m+y*y,w=v*v+b*b,_=2*(m*b-y*v);if(_)if(Math.abs(_)<1e-8)h=(s+l)/2,d=(a+f)/2;else{const t=1/_;h=s+(b*x-y*w)*t,d=a+(m*w-v*x)*t}else h=(s+l)/2-1e8*b,d=(a+f)/2+1e8*v;i[g]=h,i[g+1]=d}let o,s,a,u=e[e.length-1],c=4*u,l=t[2*u],f=t[2*u+1];r.fill(0);for(let h=0;h<e.length;++h)u=e[h],o=c,s=l,a=f,c=4*u,l=t[2*u],f=t[2*u+1],r[o+2]=r[c]=a-f,r[o+3]=r[c+1]=l-s}render(t){const e=null==t?t=new dS:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:s}=this;if(i.length<=1)return null;for(let c=0,l=n.length;c<l;++c){const e=n[c];if(e<c)continue;const r=2*Math.floor(c/3),i=2*Math.floor(e/3),s=o[r],a=o[r+1],u=o[i],l=o[i+1];this._renderSegment(s,a,u,l,t)}let a,u=i[i.length-1];for(let c=0;c<i.length;++c){a=u,u=i[c];const e=2*Math.floor(r[u]/3),n=o[e],l=o[e+1],f=4*a,h=this._project(n,l,s[f+2],s[f+3]);h&&this._renderSegment(n,l,h[0],h[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new dS:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new dS:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let o=2;o<i;o+=2)r[o]===r[o-2]&&r[o+1]===r[o-1]||e.lineTo(r[o],r[o+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new pS;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const s=this._regioncode(t,e),a=this._regioncode(n,r);0===s&&0===a?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,s,a))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)===e&&(n=+n)===n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,s=t.length;o<s;o+=2)if(e[r]==t[o]&&e[r+1]==t[o+1]&&e[(r+2)%i]==t[(o+s-2)%s]&&e[(r+3)%i]==t[(o+s-1)%s]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const s=[];let a=o;do{const n=Math.floor(a/3);if(s.push(e[2*n],e[2*n+1]),a=a%3===2?a-2:a+1,i[a]!==t)break;a=r[a]}while(a!==o&&-1!==a);return s}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e)}_clipFinite(t,e){const n=e.length;let r,i,o,s,a,u=null,c=e[n-2],l=e[n-1],f=this._regioncode(c,l);for(let h=0;h<n;h+=2)if(r=c,i=l,c=e[h],l=e[h+1],o=f,f=this._regioncode(c,l),0===o&&0===f)s=a,a=0,u?u.push(c,l):u=[c,l];else{let e,n,h,d,p;if(0===o){if(null===(e=this._clipSegment(r,i,c,l,o,f)))continue;[n,h,d,p]=e}else{if(null===(e=this._clipSegment(c,l,r,i,f,o)))continue;[d,p,n,h]=e,s=a,a=this._edgecode(n,h),s&&a&&this._edge(t,s,a,u,u.length),u?u.push(n,h):u=[n,h]}s=a,a=this._edgecode(d,p),s&&a&&this._edge(t,s,a,u,u.length),u?u.push(d,p):u=[d,p]}if(u)s=a,a=this._edgecode(u[0],u[1]),s&&a&&this._edge(t,s,a,u,u.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}_clipSegment(t,e,n,r,i,o){for(;;){if(0===i&&0===o)return[t,e,n,r];if(i&o)return null;let s,a,u=i||o;8&u?(s=t+(n-t)*(this.ymax-e)/(r-e),a=this.ymax):4&u?(s=t+(n-t)*(this.ymin-e)/(r-e),a=this.ymin):2&u?(a=e+(r-e)*(this.xmax-t)/(n-t),s=this.xmax):(a=e+(r-e)*(this.xmin-t)/(n-t),s=this.xmin),i?(t=s,e=a,i=this._regioncode(t,e)):(n=s,r=a,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let s,a=Array.from(e);if((s=this._project(a[0],a[1],n,r))&&a.unshift(s[0],s[1]),(s=this._project(a[a.length-2],a[a.length-1],i,o))&&a.push(s[0],s[1]),a=this._clipFinite(t,a))for(let u,c=0,l=a.length,f=this._edgecode(a[l-2],a[l-1]);c<l;c+=2)u=f,f=this._edgecode(a[c],a[c+1]),u&&f&&(c=this._edge(t,u,f,a,c),l=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const t=(o+2)%r.length,e=(o+4)%r.length;(r[o]===r[t]&&r[t]===r[e]||r[o+1]===r[t+1]&&r[t+1]===r[e+1])&&(r.splice(t,2),o-=2)}return i}_project(t,e,n,r){let i,o,s,a=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<a&&(s=this.ymin,o=t+(a=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<a&&(s=this.ymax,o=t+(a=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<a&&(o=this.xmax,s=e+(a=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<a&&(o=this.xmin,s=e+(a=i)*r)}return[o,s]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}}const mS=2*Math.PI,yS=Math.pow;function vS(t){return t[0]}function bS(t){return t[1]}function xS(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class wS{static from(t,e=vS,n=bS,r){return new wS("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let s=0;s<i;++s){const i=t[s];o[2*s]=e.call(r,i,s,t),o[2*s+1]=n.call(r,i,s,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new nS(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const t=2*e[r],i=2*e[r+1],o=2*e[r+2];if((n[o]-n[t])*(n[i+1]-n[t+1])-(n[i]-n[t])*(n[o+1]-n[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let o=0,s=e.length/2;o<s;++o){const t=xS(e[2*o],e[2*o+1],i);e[2*o]=t[0],e[2*o+1]=t[1]}this._delaunator=new nS(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let a=0,u=n.length;a<u;++a){const t=i[a%3===2?a-2:a+1];-1!==n[a]&&-1!==o[t]||(o[t]=a)}for(let a=0,u=r.length;a<u;++a)s[r[a]]=a;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,2===r.length&&(o[r[1]]=0))}voronoi(t){return new gS(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:s}=this;if(s){const e=s.indexOf(t);return e>0&&(yield s[e-1]),void(e<s.length-1&&(yield s[e+1]))}const a=e[t];if(-1===a)return;let u=a,c=-1;do{if(yield c=o[u],u=u%3===2?u-2:u+1,o[u]!==t)return;if(u=i[u],-1===u){const e=n[(r[t]+1)%n.length];return void(e!==c&&(yield e))}}while(u!==a)}find(t,e,n=0){if((t=+t)!==t||(e=+e)!==e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:s,triangles:a,points:u}=this;if(-1===r[t]||!u.length)return(t+1)%(u.length>>1);let c=t,l=yS(e-u[2*t],2)+yS(n-u[2*t+1],2);const f=r[t];let h=f;do{let r=a[h];const f=yS(e-u[2*r],2)+yS(n-u[2*r+1],2);if(f<l&&(l=f,c=r),h=h%3===2?h-2:h+1,a[h]!==t)break;if(h=s[h],-1===h){if(h=i[(o[t]+1)%i.length],h!==r&&yS(e-u[2*h],2)+yS(n-u[2*h+1],2)<l)return h;break}}while(h!==f);return c}render(t){const e=null==t?t=new dS:void 0,{points:n,halfedges:r,triangles:i}=this;for(let o=0,s=r.length;o<s;++o){const e=r[o];if(e<o)continue;const s=2*i[o],a=2*i[e];t.moveTo(n[s],n[s+1]),t.lineTo(n[a],n[a+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e=2){const n=null==t?t=new dS:void 0,{points:r}=this;for(let i=0,o=r.length;i<o;i+=2){const n=r[i],o=r[i+1];t.moveTo(n+e,o),t.arc(n,o,e,0,mS)}return n&&n.value()}renderHull(t){const e=null==t?t=new dS:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let s=1;s<o;++s){const e=2*n[s];t.lineTo(r[e],r[e+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new pS;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new dS:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],s=2*i[t+1],a=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.lineTo(r[a],r[a+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new pS;return this.renderTriangle(t,e),e.value()}}function _S(t){no.call(this,null,t)}_S.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const ES=[-1e5,-1e5,1e5,1e5];function AS(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}(0,g.XW)(_S,no,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:ES;const o=this.value=wS.from(r,t.x,t.y).voronoi(i);for(let s=0,a=r.length;s<a;++s){const t=o.cellPolygon(s);r[s][n]=t?AS(t):null}return e.reflow(t.modified()).modifies(n)}});var OS=Math.PI/180,SS=2048;function CS(){var t,e,n,r,i,o,s,a=[256,256],u=DS,c=[],l=Math.random,f={};function h(t,e,n){for(var r,i,o,s=e.x,c=e.y,f=Math.sqrt(a[0]*a[0]+a[1]*a[1]),h=u(a),d=l()<.5?1:-1,p=-d;(r=h(p+=d))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=f));)if(e.x=s+i,e.y=c+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>a[0]||e.y+e.y1>a[1])&&(!n||!PS(e,t,a[0]))&&(!n||TS(e,n))){for(var g,m=e.sprite,y=e.width>>5,v=a[0]>>5,b=e.x-(y<<4),x=127&b,w=32-x,_=e.y1-e.y0,E=(e.y+e.y0)*v+(b>>5),A=0;A<_;A++){g=0;for(var O=0;O<=y;O++)t[E+O]|=g<<w|(O<y?(g=m[A*y+O])>>>x:0);E+=v}return e.sprite=null,!0}return!1}return f.layout=function(){for(var u=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=2048/e,t.height=SS/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(Ju()),f=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((a[0]>>5)*a[1]),d=null,p=c.length,g=-1,m=[],y=c.map((a=>({text:t(a),font:e(a),style:r(a),weight:i(a),rotate:o(a),size:~~(n(a)+1e-14),padding:s(a),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:a}))).sort(((t,e)=>e.size-t.size));++g<p;){var v=y[g];v.x=a[0]*(l()+.5)>>1,v.y=a[1]*(l()+.5)>>1,MS(u,v,y,g),v.hasText&&h(f,v,d)&&(m.push(v),d?kS(d,v):d=[{x:v.x+v.x0,y:v.y+v.y0},{x:v.x+v.x1,y:v.y+v.y1}],v.x-=a[0]>>1,v.y-=a[1]>>1)}return m},f.words=function(t){return arguments.length?(c=t,f):c},f.size=function(t){return arguments.length?(a=[+t[0],+t[1]],f):a},f.font=function(t){return arguments.length?(e=FS(t),f):e},f.fontStyle=function(t){return arguments.length?(r=FS(t),f):r},f.fontWeight=function(t){return arguments.length?(i=FS(t),f):i},f.rotate=function(t){return arguments.length?(o=FS(t),f):o},f.text=function(e){return arguments.length?(t=FS(e),f):t},f.spiral=function(t){return arguments.length?(u=jS[t]||t,f):u},f.fontSize=function(t){return arguments.length?(n=FS(t),f):n},f.padding=function(t){return arguments.length?(s=FS(t),f):s},f.random=function(t){return arguments.length?(l=t,f):l},f}function MS(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,2048/o,SS/o);var s,a,u,c,l,f=0,h=0,d=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,s=i.measureText(e.text+"m").width*o,u=e.size<<1,e.rotate){var g=Math.sin(e.rotate*OS),m=Math.cos(e.rotate*OS),y=s*m,v=s*g,b=u*m,x=u*g;s=Math.max(Math.abs(y+x),Math.abs(y-x))+31>>5<<5,u=~~Math.max(Math.abs(v+b),Math.abs(v-b))}else s=s+31>>5<<5;if(u>d&&(d=u),f+s>=2048&&(f=0,h+=d,d=0),h+u>=SS)break;i.translate((f+(s>>1))/o,(h+(u>>1))/o),e.rotate&&i.rotate(e.rotate*OS),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=s,e.height=u,e.xoff=f,e.yoff=h,e.x1=s>>1,e.y1=u>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=s}for(var w=i.getImageData(0,0,2048/o,SS/o).data,_=[];--r>=0;)if((e=n[r]).hasText){for(a=(s=e.width)>>5,u=e.y1-e.y0,c=0;c<u*a;c++)_[c]=0;if(null==(f=e.xoff))return;h=e.yoff;var E=0,A=-1;for(l=0;l<u;l++){for(c=0;c<s;c++){var O=a*l+(c>>5),S=w[2048*(h+l)+(f+c)<<2]?1<<31-c%32:0;_[O]|=S,E|=S}E?A=l:(e.y0++,u--,l--,h++)}e.y1=e.y0+A,e.sprite=_.slice(0,(e.y1-e.y0)*a)}}}function PS(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,s=t.x-(o<<4),a=127&s,u=32-a,c=t.y1-t.y0,l=(t.y+t.y0)*n+(s>>5),f=0;f<c;f++){r=0;for(var h=0;h<=o;h++)if((r<<u|(h<o?(r=i[f*o+h])>>>a:0))&e[l+h])return!0;l+=n}return!1}function kS(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function TS(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function DS(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function FS(t){return"function"===typeof t?t:function(){return t}}var jS={archimedean:DS,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const LS=["x","y","font","fontSize","fontStyle","fontWeight","angle"],RS=["text","font","rotate","fontSize","fontStyle","fontWeight"];function IS(t){no.call(this,CS(),t)}IS.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:LS}]},(0,g.XW)(IS,no,{transform(t,e){!t.size||t.size[0]&&t.size[1]||(0,g.vU)("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||RS.some((function(n){const r=t[n];return(0,g.mf)(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||LS;let s,a=t.fontSize||14;if((0,g.mf)(a)?s=t.fontSizeRange:a=(0,g.a9)(a),s){const t=a,e=_h("sqrt")().domain((0,g.We)(r,t)).range(s);a=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0}));const u=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(a).random(wo).layout(),c=i.size(),l=c[0]>>1,f=c[1]>>1,h=u.length;for(let d,p,g=0;g<h;++g)d=u[g],p=d.datum,p[o[0]]=d.x+l,p[o[1]]=d.y+f,p[o[2]]=d.font,p[o[3]]=d.size,p[o[4]]=d.style,p[o[5]]=d.weight,p[o[6]]=d.rotate;return e.reflow(n).modifies(o)}});const NS=t=>new Uint8Array(t),BS=t=>new Uint16Array(t),zS=t=>new Uint32Array(t);function $S(t,e,n){const r=(e<257?NS:e<65537?BS:zS)(t);return n&&r.set(n),r}function US(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,s=i[0],a=i[1],u=o.length;let c;for(c=0;c<s;++c)e[o[c]]|=r;for(c=a;c<u;++c)e[o[c]]|=r;return n}}}function VS(){let t=zS(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const s=n,a=i.length,u=zS(a);let c,l,f,h=Array(a);for(f=0;f<a;++f)h[f]=r(i[f]),u[f]=f;if(h=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),function(t,e){return Array.from(e,(e=>t[e]))}(t,e)}(h,u),s)c=e,l=t,e=Array(s+a),t=zS(s+a),function(t,e,n,r,i,o,s,a,u){let c,l=0,f=0;for(c=0;l<r&&f<s;++c)e[l]<i[f]?(a[c]=e[l],u[c]=n[l++]):(a[c]=i[f],u[c]=o[f++]+t);for(;l<r;++l,++c)a[c]=e[l],u[c]=n[l];for(;f<s;++f,++c)a[c]=i[f],u[c]=o[f]+t}(o,c,l,s,h,u,a,e,t);else{if(o>0)for(f=0;f<a;++f)u[f]+=o;e=h,t=u}return n=s+a,{index:u,value:h}},remove:function(r,i){const o=n;let s,a,u;for(a=0;!i[t[a]]&&a<o;++a);for(u=a;a<o;++a)i[s=t[a]]||(t[u]=s,e[u]=e[a],++u);n=o-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[(0,tc.Nw)(r,t[0],0,i),(0,tc.ml)(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function ZS(t){no.call(this,function(){let t=8,e=[],n=zS(0),r=$S(0,t),i=$S(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,s=Array(o-t),a=e;let u,c,l;for(c=0;!n[c]&&c<o;++c)s[c]=e[c],a[c]=c;for(l=c;c<o;++c)u=e[c],n[c]?a[c]=-1:(a[c]=l,r[l]=r[c],i[l]=i[c],s[l]=u,u._index=l++),r[c]=0;return e=s,a},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=$S(e,t,r),i=$S(e,t))}}}(),t),this._indices=null,this._dims=null}function WS(t){no.call(this,null,t)}ZS.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},(0,g.XW)(ZS,no,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],s=r.length;let a,u,c=0;for(;c<s;++c)a=n[c].fname,u=i[a]||(i[a]=VS()),o.push(US(u,c,r[c]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,s=this._dims,a=this.value,u=a.curr(),c=a.prev(),l=a.all(),f=n.rem=n.add,h=n.mod,d=i.length,p={};let g,m,y,v,b,x,w,_,E;if(c.set(u),e.rem.length&&(b=this.remove(t,e,n)),e.add.length&&a.add(e.add),e.mod.length)for(x={},v=e.mod,w=0,_=v.length;w<_;++w)x[v[w]._index]=1;for(w=0;w<d;++w)E=r[w],(!s[w]||t.modified("fields",w)||e.modified(E.fields))&&(y=E.fname,(g=p[y])||(o[y]=m=VS(),p[y]=g=m.insert(E,e.source,0)),s[w]=US(m,w,i[w]).onAdd(g,u));for(w=0,_=a.data().length;w<_;++w)b[w]||(c[w]!==u[w]?f.push(w):x[w]&&u[w]!==l&&h.push(w));return a.mask=(1<<d)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,s=this._indices,a=t.fields,u={},c=n.add,l=i.size()+r.length,f=o.length;let h,d,p,g=i.size();i.resize(l,f),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(h=0;h<f;++h)d=a[h].fname,p=u[d]||(u[d]=s[d].insert(a[h],r,g)),o[h].onAdd(p,m);for(;g<l;++g)y[g]=v,m[g]!==v&&c.push(g)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),s=t.mod;let a,u,c;for(a=0,u=s.length;a<u;++a)c=s[a]._index,i[c]!==o&&n.push(c)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),u={},c=n.rem,l=e.rem;let f,h,d,p;for(f=0,h=l.length;f<h;++f)d=l[f]._index,u[d]=1,s[d]=p=o[d],o[d]=a,p!==a&&c.push(d);for(d in r)r[d].remove(h,u);return this.reindex(e,h,u),u},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,s=r.length;let a,u,c=0;for(n.filters=0,u=0;u<s;++u)t.modified("query",u)&&(a=u,++c);if(1===c)c=r[a].one,this.incrementOne(r[a],i[a],n.add,n.rem);else for(u=0,c=0;u<s;++u)t.modified("query",u)&&(c|=r[u].one,this.incrementAll(r[u],i[u],o,n.add),n.rem=n.add);return c},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),u=t.index(),c=t.bisect(t.range),l=t.bisect(e),f=l[0],h=l[1],d=c[0],p=c[1],g=t.one;let m,y,v;if(f<d)for(m=f,y=Math.min(d,h);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(f>d)for(m=d,y=Math.min(f,p);m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;if(h>p)for(m=Math.max(f,p),y=h;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;else if(h<p)for(m=Math.max(d,h),y=p;m<y;++m)v=u[m],o[v]!==n&&(a[v]=s[v],o[v]=n,r.push(v)),s[v]^=g;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),o=t.index(),s=t.bisect(t.range),a=t.bisect(e),u=a[0],c=a[1],l=s[0],f=s[1],h=t.one;let d,p,g;if(u<l)for(d=u,p=Math.min(l,c);d<p;++d)g=o[d],i[g]^=h,n.push(g);else if(u>l)for(d=l,p=Math.min(u,f);d<p;++d)g=o[d],i[g]^=h,r.push(g);if(c>f)for(d=Math.max(u,f),p=c;d<p;++d)g=o[d],i[g]^=h,n.push(g);else if(c<f)for(d=Math.max(l,c),p=f;d<p;++d)g=o[d],i[g]^=h,r.push(g);t.range=e.slice()}}),WS.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},(0,g.XW)(WS,no,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(0===(i&n))return e.StopPropagation;const o=e.fork(e.ALL),s=r.data(),a=r.curr(),u=r.prev(),c=t=>a[t]&n?null:s[t];return o.filter(o.MOD,c),i&i-1?(o.filter(o.ADD,(t=>{const e=a[t]&n;return!e&&e^u[t]&n?s[t]:null})),o.filter(o.REM,(t=>{const e=a[t]&n;return e&&!(e^e^u[t]&n)?s[t]:null}))):(o.filter(o.ADD,c),o.filter(o.REM,(t=>(a[t]&n)===i?s[t]:null))),o.filter(o.SOURCE,(t=>c(t._index)))}});const qS="RawCode",GS="Literal",HS="Property",XS="Identifier",YS="ArrayExpression",KS="BinaryExpression",JS="CallExpression",QS="ConditionalExpression",tC="LogicalExpression",eC="MemberExpression",nC="ObjectExpression",rC="UnaryExpression";function iC(t){this.type=t}var oC,sC,aC,uC,cC;iC.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case YS:return t.elements;case KS:case tC:return[t.left,t.right];case JS:return[t.callee].concat(t.arguments);case QS:return[t.test,t.consequent,t.alternate];case eC:return[t.object,t.property];case nC:return t.properties;case HS:return[t.key,t.value];case rC:return[t.argument];case XS:case GS:case qS:default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};(oC={})[1]="Boolean",oC[2]="<end>",oC[3]="Identifier",oC[4]="Keyword",oC[5]="Null",oC[6]="Numeric",oC[7]="Punctuator",oC[8]="String",oC[9]="RegularExpression";var lC="Identifier",fC="Unexpected token %0",hC="Invalid regular expression",dC="Invalid regular expression: missing /",pC="Octal literals are not allowed in strict mode.",gC="ILLEGAL",mC="Disabled.",yC=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),vC=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function bC(t,e){if(!t)throw new Error("ASSERT: "+e)}function xC(t){return t>=48&&t<=57}function wC(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function _C(t){return"01234567".indexOf(t)>=0}function EC(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function AC(t){return 10===t||13===t||8232===t||8233===t}function OC(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&yC.test(String.fromCharCode(t))}function SC(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&vC.test(String.fromCharCode(t))}const CC={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function MC(){for(;aC<uC;){const t=sC.charCodeAt(aC);if(!EC(t)&&!AC(t))break;++aC}}function PC(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)aC<uC&&wC(sC[aC])?(r=sC[aC++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):WC({},fC,gC);return String.fromCharCode(i)}function kC(){var t,e,n,r;for(e=0,"}"===(t=sC[aC])&&WC({},fC,gC);aC<uC&&wC(t=sC[aC++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&WC({},fC,gC),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function TC(){var t,e;for(t=sC.charCodeAt(aC++),e=String.fromCharCode(t),92===t&&(117!==sC.charCodeAt(aC)&&WC({},fC,gC),++aC,(t=PC("u"))&&"\\"!==t&&OC(t.charCodeAt(0))||WC({},fC,gC),e=t);aC<uC&&SC(t=sC.charCodeAt(aC));)++aC,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==sC.charCodeAt(aC)&&WC({},fC,gC),++aC,(t=PC("u"))&&"\\"!==t&&SC(t.charCodeAt(0))||WC({},fC,gC),e+=t);return e}function DC(){var t,e;return t=aC,{type:1===(e=92===sC.charCodeAt(aC)?TC():function(){var t,e;for(t=aC++;aC<uC;){if(92===(e=sC.charCodeAt(aC)))return aC=t,TC();if(!SC(e))break;++aC}return sC.slice(t,aC)}()).length?3:CC.hasOwnProperty(e)?4:"null"===e?5:"true"===e||"false"===e?1:3,value:e,start:t,end:aC}}function FC(){var t,e,n,r,i=aC,o=sC.charCodeAt(aC),s=sC[aC];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++aC,{type:7,value:String.fromCharCode(o),start:i,end:aC};default:if(61===(t=sC.charCodeAt(aC+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return aC+=2,{type:7,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:aC};case 33:case 61:return aC+=2,61===sC.charCodeAt(aC)&&++aC,{type:7,value:sC.slice(i,aC),start:i,end:aC}}}return">>>="===(r=sC.substr(aC,4))?{type:7,value:r,start:i,end:aC+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:i,end:aC+=3}:s===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===e?{type:7,value:e,start:i,end:aC+=2}:("//"===e&&WC({},fC,gC),"<>=!+-*%&|^/".indexOf(s)>=0?{type:7,value:s,start:i,end:++aC}:void WC({},fC,gC))}function jC(){var t,e,n;if(bC(xC((n=sC[aC]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=aC,t="","."!==n){if(t=sC[aC++],n=sC[aC],"0"===t){if("x"===n||"X"===n)return++aC,function(t){let e="";for(;aC<uC&&wC(sC[aC]);)e+=sC[aC++];return 0===e.length&&WC({},fC,gC),OC(sC.charCodeAt(aC))&&WC({},fC,gC),{type:6,value:parseInt("0x"+e,16),start:t,end:aC}}(e);if(_C(n))return function(t){let e="0"+sC[aC++];for(;aC<uC&&_C(sC[aC]);)e+=sC[aC++];return(OC(sC.charCodeAt(aC))||xC(sC.charCodeAt(aC)))&&WC({},fC,gC),{type:6,value:parseInt(e,8),octal:!0,start:t,end:aC}}(e);n&&xC(n.charCodeAt(0))&&WC({},fC,gC)}for(;xC(sC.charCodeAt(aC));)t+=sC[aC++];n=sC[aC]}if("."===n){for(t+=sC[aC++];xC(sC.charCodeAt(aC));)t+=sC[aC++];n=sC[aC]}if("e"===n||"E"===n)if(t+=sC[aC++],"+"!==(n=sC[aC])&&"-"!==n||(t+=sC[aC++]),xC(sC.charCodeAt(aC)))for(;xC(sC.charCodeAt(aC));)t+=sC[aC++];else WC({},fC,gC);return OC(sC.charCodeAt(aC))&&WC({},fC,gC),{type:6,value:parseFloat(t),start:e,end:aC}}function LC(){var t,e,n,r;return cC=null,MC(),t=aC,e=function(){var t,e,n,r;for(bC("/"===(t=sC[aC]),"Regular expression literal must start with a slash"),e=sC[aC++],n=!1,r=!1;aC<uC;)if(e+=t=sC[aC++],"\\"===t)AC((t=sC[aC++]).charCodeAt(0))&&WC({},dC),e+=t;else if(AC(t.charCodeAt(0)))WC({},dC);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||WC({},dC),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";aC<uC&&SC((t=sC[aC]).charCodeAt(0));)++aC,"\\"===t&&aC<uC?WC({},fC,gC):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&WC({},hC,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";WC({},hC)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){WC({},hC)}try{return new RegExp(t,e)}catch(i){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:aC}}function RC(){if(MC(),aC>=uC)return{type:2,start:aC,end:aC};const t=sC.charCodeAt(aC);return OC(t)?DC():40===t||41===t||59===t?FC():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(bC("'"===(t=sC[aC])||'"'===t,"String literal must starts with a quote"),e=aC,++aC;aC<uC;){if((n=sC[aC++])===t){t="";break}if("\\"===n)if((n=sC[aC++])&&AC(n.charCodeAt(0)))"\r"===n&&"\n"===sC[aC]&&++aC;else switch(n){case"u":case"x":"{"===sC[aC]?(++aC,i+=kC()):i+=PC(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:_C(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),aC<uC&&_C(sC[aC])&&(o=!0,r=8*r+"01234567".indexOf(sC[aC++]),"0123".indexOf(n)>=0&&aC<uC&&_C(sC[aC])&&(r=8*r+"01234567".indexOf(sC[aC++]))),i+=String.fromCharCode(r)):i+=n}else{if(AC(n.charCodeAt(0)))break;i+=n}}return""!==t&&WC({},fC,gC),{type:8,value:i,octal:o,start:e,end:aC}}():46===t?xC(sC.charCodeAt(aC+1))?jC():FC():xC(t)?jC():FC()}function IC(){const t=cC;return aC=t.end,cC=RC(),aC=t.end,t}function NC(){const t=aC;cC=RC(),aC=t}function BC(t,e,n){const r=new iC("||"===t||"&&"===t?"LogicalExpression":"BinaryExpression");return r.operator=t,r.left=e,r.right=n,r}function zC(t,e){const n=new iC("CallExpression");return n.callee=t,n.arguments=e,n}function $C(t){const e=new iC(lC);return e.name=t,e}function UC(t){const e=new iC("Literal");return e.value=t.value,e.raw=sC.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function VC(t,e,n){const r=new iC("MemberExpression");return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function ZC(t,e,n){const r=new iC("Property");return r.key=e,r.value=n,r.kind=t,r}function WC(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(bC(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=aC,n.description=i,n}function qC(t){2===t.type&&WC(t,"Unexpected end of input"),6===t.type&&WC(t,"Unexpected number"),8===t.type&&WC(t,"Unexpected string"),3===t.type&&WC(t,"Unexpected identifier"),4===t.type&&WC(t,"Unexpected reserved word"),WC(t,fC,t.value)}function GC(t){const e=IC();7===e.type&&e.value===t||qC(e)}function HC(t){return 7===cC.type&&cC.value===t}function XC(t){return 4===cC.type&&cC.value===t}function YC(){const t=[];for(aC=cC.start,GC("[");!HC("]");)HC(",")?(IC(),t.push(null)):(t.push(uM()),HC("]")||GC(","));return IC(),function(t){const e=new iC("ArrayExpression");return e.elements=t,e}(t)}function KC(){aC=cC.start;const t=IC();return 8===t.type||6===t.type?(t.octal&&WC(t,pC),UC(t)):$C(t.value)}function JC(){var t,e,n;return aC=cC.start,3===(t=cC).type?(n=KC(),GC(":"),ZC("init",n,uM())):2!==t.type&&7!==t.type?(e=KC(),GC(":"),ZC("init",e,uM())):void qC(t)}function QC(){var t,e,n=[],r={},i=String;for(aC=cC.start,GC("{");!HC("}");)e="$"+((t=JC()).key.type===lC?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?WC({},"Duplicate data property in object literal not allowed in strict mode"):r[e]=!0,n.push(t),HC("}")||GC(",");return GC("}"),function(t){const e=new iC("ObjectExpression");return e.properties=t,e}(n)}const tM={if:1};function eM(){var t,e,n;if(HC("("))return function(){GC("(");const t=cM();return GC(")"),t}();if(HC("["))return YC();if(HC("{"))return QC();if(t=cC.type,aC=cC.start,3===t||tM[cC.value])n=$C(IC().value);else if(8===t||6===t)cC.octal&&WC(cC,pC),n=UC(IC());else{if(4===t)throw new Error(mC);1===t?((e=IC()).value="true"===e.value,n=UC(e)):5===t?((e=IC()).value=null,n=UC(e)):HC("/")||HC("/=")?(n=UC(LC()),NC()):qC(IC())}return n}function nM(){const t=[];if(GC("("),!HC(")"))for(;aC<uC&&(t.push(uM()),!HC(")"));)GC(",");return GC(")"),t}function rM(){return GC("."),function(){aC=cC.start;const t=IC();return function(t){return 3===t.type||4===t.type||1===t.type||5===t.type}(t)||qC(t),$C(t.value)}()}function iM(){GC("[");const t=cM();return GC("]"),t}function oM(){const t=function(){var t;for(t=eM();;)if(HC("."))t=VC(".",t,rM());else if(HC("("))t=zC(t,nM());else{if(!HC("["))break;t=VC("[",t,iM())}return t}();if(7===cC.type&&(HC("++")||HC("--")))throw new Error(mC);return t}function sM(){var t,e;if(7!==cC.type&&4!==cC.type)e=oM();else{if(HC("++")||HC("--"))throw new Error(mC);if(HC("+")||HC("-")||HC("~")||HC("!"))t=IC(),e=sM(),e=function(t,e){const n=new iC("UnaryExpression");return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(XC("delete")||XC("void")||XC("typeof"))throw new Error(mC);e=oM()}}return e}function aM(t){let e=0;if(7!==t.type&&4!==t.type)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function uM(){var t,e;return t=function(){var t,e,n,r,i,o,s,a,u,c;if(t=cC,u=sM(),0===(i=aM(r=cC)))return u;for(r.prec=i,IC(),e=[t,cC],o=[u,r,s=sM()];(i=aM(cC))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,u=o.pop(),e.pop(),n=BC(a,u,s),o.push(n);(r=IC()).prec=i,o.push(r),e.push(cC),n=sM(),o.push(n)}for(n=o[c=o.length-1],e.pop();c>1;)e.pop(),n=BC(o[c-1].value,o[c-2],n),c-=2;return n}(),HC("?")&&(IC(),e=uM(),GC(":"),t=function(t,e,n){const r=new iC("ConditionalExpression");return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,uM())),t}function cM(){const t=uM();if(HC(","))throw new Error(mC);return t}function lM(t){aC=0,uC=(sC=t).length,cC=null,NC();const e=cM();if(2!==cC.type)throw new Error("Unexpect token after expression.");return e}var fM={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function hM(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&(0,g.vU)("Missing arguments to clamp function."),e.length>3&&(0,g.vU)("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&(0,g.vU)("Missing arguments to if function."),e.length>3&&(0,g.vU)("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function dM(t){const e=(t=t||{}).allowed?(0,g.Rg)(t.allowed):{},n=t.forbidden?(0,g.Rg)(t.forbidden):{},r=t.constants||fM,i=(t.functions||hM)(f),o=t.globalvar,s=t.fieldvar,a=(0,g.mf)(o)?o:t=>`${o}["${t}"]`;let u={},c={},l=0;function f(t){if((0,g.HD)(t))return t;const e=h[t.type];return null==e&&(0,g.vU)("Unsupported type: "+t.type),e(t)}const h={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return l>0?i:(0,g.nr)(n,i)?(0,g.vU)("Illegal identifier: "+i):(0,g.nr)(r,i)?r[i]:(0,g.nr)(e,i)?i:(u[i]=1,a(i))},MemberExpression:t=>{const e=!t.computed,n=f(t.object);e&&(l+=1);const r=f(t.property);return n===s&&(c[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(l-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&(0,g.vU)("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=(0,g.nr)(i,e)&&i[e];return r||(0,g.vU)("Unrecognized function: "+e),(0,g.mf)(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(f).join(",")+"]",BinaryExpression:t=>"("+f(t.left)+" "+t.operator+" "+f(t.right)+")",UnaryExpression:t=>"("+t.operator+f(t.argument)+")",ConditionalExpression:t=>"("+f(t.test)+"?"+f(t.consequent)+":"+f(t.alternate)+")",LogicalExpression:t=>"("+f(t.left)+t.operator+f(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(f).join(",")+"}",Property:t=>{l+=1;const e=f(t.key);return l-=1,e+":"+f(t.value)}};function d(t){const e={code:f(t),globals:Object.keys(u),fields:Object.keys(c)};return u={},c={},e}return d.functions=i,d.constants=r,d}var pM,gM,mM,yM,vM,bM,xM,wM,_M,EM,AM,OM,SM,CM,MM,PM,kM=new Lb,TM=new Lb,DM={point:ox,lineStart:ox,lineEnd:ox,polygonStart:function(){kM=new Lb,DM.lineStart=FM,DM.lineEnd=jM},polygonEnd:function(){var t=+kM;TM.add(t<0?$b+t:t),this.lineStart=this.lineEnd=this.point=ox},sphere:function(){TM.add($b)}};function FM(){DM.point=LM}function jM(){RM(pM,gM)}function LM(t,e){DM.point=RM,pM=t,gM=e,mM=t*=Vb,yM=Gb(e=(e*=Vb)/2+zb),vM=Qb(e)}function RM(t,e){var n=(t*=Vb)-mM,r=n>=0?1:-1,i=r*n,o=Gb(e=(e*=Vb)/2+zb),s=Qb(e),a=vM*s,u=yM*o+a*Gb(i),c=a*r*Qb(i);kM.add(qb(c,u)),mM=t,yM=o,vM=s}var IM,NM,BM,zM,$M,UM,VM,ZM,WM,qM,GM,HM,XM,YM,KM,JM,QM={point:tP,lineStart:nP,lineEnd:rP,polygonStart:function(){QM.point=iP,QM.lineStart=oP,QM.lineEnd=sP,CM=new Lb,DM.polygonStart()},polygonEnd:function(){DM.polygonEnd(),QM.point=tP,QM.lineStart=nP,QM.lineEnd=rP,kM<0?(bM=-(wM=180),xM=-(_M=90)):CM>Rb?_M=90:CM<-1e-6&&(xM=-90),PM[0]=bM,PM[1]=wM},sphere:function(){bM=-(wM=180),xM=-(_M=90)}};function tP(t,e){MM.push(PM=[bM=t,wM=t]),e<xM&&(xM=e),e>_M&&(_M=e)}function eP(t,e){var n=dw([t*Vb,e*Vb]);if(SM){var r=gw(SM,n),i=gw([r[1],-r[0],0],r);vw(i),i=hw(i);var o,s=t-EM,a=s>0?1:-1,u=i[0]*Ub*a,c=Zb(s)>180;c^(a*EM<u&&u<a*t)?(o=i[1]*Ub)>_M&&(_M=o):c^(a*EM<(u=(u+360)%360-180)&&u<a*t)?(o=-i[1]*Ub)<xM&&(xM=o):(e<xM&&(xM=e),e>_M&&(_M=e)),c?t<EM?aP(bM,t)>aP(bM,wM)&&(wM=t):aP(t,wM)>aP(bM,wM)&&(bM=t):wM>=bM?(t<bM&&(bM=t),t>wM&&(wM=t)):t>EM?aP(bM,t)>aP(bM,wM)&&(wM=t):aP(t,wM)>aP(bM,wM)&&(bM=t)}else MM.push(PM=[bM=t,wM=t]);e<xM&&(xM=e),e>_M&&(_M=e),SM=n,EM=t}function nP(){QM.point=eP}function rP(){PM[0]=bM,PM[1]=wM,QM.point=tP,SM=null}function iP(t,e){if(SM){var n=t-EM;CM.add(Zb(n)>180?n+(n>0?360:-360):n)}else AM=t,OM=e;DM.point(t,e),eP(t,e)}function oP(){DM.lineStart()}function sP(){iP(AM,OM),DM.lineEnd(),Zb(CM)>Rb&&(bM=-(wM=180)),PM[0]=bM,PM[1]=wM,SM=null}function aP(t,e){return(e-=t)<0?e+360:e}function uP(t,e){return t[0]-e[0]}function cP(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var lP={sphere:ox,point:fP,lineStart:dP,lineEnd:mP,polygonStart:function(){lP.lineStart=yP,lP.lineEnd=vP},polygonEnd:function(){lP.lineStart=dP,lP.lineEnd=mP}};function fP(t,e){t*=Vb;var n=Gb(e*=Vb);hP(n*Gb(t),n*Qb(t),Qb(e))}function hP(t,e,n){++IM,BM+=(t-BM)/IM,zM+=(e-zM)/IM,$M+=(n-$M)/IM}function dP(){lP.point=pP}function pP(t,e){t*=Vb;var n=Gb(e*=Vb);YM=n*Gb(t),KM=n*Qb(t),JM=Qb(e),lP.point=gP,hP(YM,KM,JM)}function gP(t,e){t*=Vb;var n=Gb(e*=Vb),r=n*Gb(t),i=n*Qb(t),o=Qb(e),s=qb(ex((s=KM*o-JM*i)*s+(s=JM*r-YM*o)*s+(s=YM*i-KM*r)*s),YM*r+KM*i+JM*o);NM+=s,UM+=s*(YM+(YM=r)),VM+=s*(KM+(KM=i)),ZM+=s*(JM+(JM=o)),hP(YM,KM,JM)}function mP(){lP.point=fP}function yP(){lP.point=bP}function vP(){xP(HM,XM),lP.point=fP}function bP(t,e){HM=t,XM=e,t*=Vb,e*=Vb,lP.point=xP;var n=Gb(e);YM=n*Gb(t),KM=n*Qb(t),JM=Qb(e),hP(YM,KM,JM)}function xP(t,e){t*=Vb;var n=Gb(e*=Vb),r=n*Gb(t),i=n*Qb(t),o=Qb(e),s=KM*o-JM*i,a=JM*r-YM*o,u=YM*i-KM*r,c=Yb(s,a,u),l=ix(c),f=c&&-l/c;WM.add(f*s),qM.add(f*a),GM.add(f*u),NM+=l,UM+=l*(YM+(YM=r)),VM+=l*(KM+(KM=i)),ZM+=l*(JM+(JM=o)),hP(YM,KM,JM)}const wP="intersect",_P="union",EP="index:unit";function AP(t,e){for(var n,r,i=e.fields,o=e.values,s=i.length,a=0;a<s;++a)if((r=i[a]).getter=g.EP.getter||(0,g.EP)(r.field),n=r.getter(t),(0,g.J_)(n)&&(n=(0,g.He)(n)),(0,g.J_)(o[a])&&(o[a]=(0,g.He)(o[a])),(0,g.J_)(o[a][0])&&(o[a]=o[a].map(g.He)),"E"===r.type){if((0,g.kJ)(o[a])?o[a].indexOf(n)<0:n!==o[a])return!1}else if("R"===r.type){if(!(0,g.u5)(n,o[a]))return!1}else if("R-RE"===r.type){if(!(0,g.u5)(n,o[a],!0,!1))return!1}else if("R-E"===r.type){if(!(0,g.u5)(n,o[a],!1,!1))return!1}else if("R-LE"===r.type&&!(0,g.u5)(n,o[a],!1,!0))return!1;return!0}const OP=(0,g.EP)("_vgsid_"),SP=function(t){let e=t,n=t;function r(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r}return 1===t.length&&(e=(e,n)=>t(e)-n,n=function(t){return(e,n)=>function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}(t(e),n)}(t)),{left:r,center:function(t,n,i,o){null==i&&(i=0),null==o&&(o=t.length);const s=r(t,n,i,o-1);return s>i&&e(t[s-1],n)>-e(t[s],n)?s-1:s},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){const o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}}}(OP),CP=SP.left,MP=SP.right;var PP={E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=(0,g.He)(e[0]),r=(0,g.He)(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=(0,g.He)(e[0]),r=(0,g.He)(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function kP(t,e,n,r){e[0].type!==GS&&(0,g.vU)("First argument to selection functions must be a string literal.");const i=e[0].value,o="unit",s="@unit",a=":"+i;(e.length>=2&&(0,g.fj)(e).value)!==wP||(0,g.nr)(r,s)||(r["@unit"]=n.getData(i).indataRef(n,o)),(0,g.nr)(r,a)||(r[a]=n.getData(i).tuplesRef())}function TP(t){const e=this.context.data[t];return e?e.values.value:[]}const DP=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},FP=DP("format"),jP=DP("timeFormat"),LP=DP("utcFormat"),RP=DP("timeParse"),IP=DP("utcParse"),NP=new Date(2e3,0,1);function BP(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(NP.setYear(2e3),NP.setMonth(t),NP.setDate(e),jP.call(this,NP,n)):""}function zP(t,e,n,r){e[0].type!==GS&&(0,g.vU)("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!(0,g.nr)(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(s){}}function $P(t,e,n,r){if(e[0].type===GS)UP(n,r,e[0].value);else for(t in n.scales)UP(n,r,t)}function UP(t,e,n){const r="%"+n;if(!(0,g.nr)(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function VP(t,e){let n;return(0,g.mf)(t)?t:(0,g.HD)(t)?(n=e.scales[t])&&n.value:void 0}function ZP(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=$P,n._range=$P,n._scale=$P;const r=e=>"_["+(e.type===GS?(0,g.m8)("%"+e.value):(0,g.m8)("%")+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${r(t[0])})`,_range:t=>`${r(t[0])}.range()`,_scale:e=>`${r(e[0])}(${t(e[1])})`}}function WP(t,e){return function(n,r,i){if(n){const e=VP(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const qP=WP("area",(function(t){return TM=new Lb,jb(t,DM),2*TM})),GP=WP("bounds",(function(t){var e,n,r,i,o,s,a;if(_M=wM=-(bM=xM=1/0),MM=[],jb(t,QM),n=MM.length){for(MM.sort(uP),e=1,o=[r=MM[0]];e<n;++e)cP(r,(i=MM[e])[0])||cP(r,i[1])?(aP(r[0],i[1])>aP(r[0],r[1])&&(r[1]=i[1]),aP(i[0],r[1])>aP(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(a=aP(r[1],i[0]))>s&&(s=a,bM=i[0],wM=r[1])}return MM=PM=null,bM===1/0||xM===1/0?[[NaN,NaN],[NaN,NaN]]:[[bM,xM],[wM,_M]]})),HP=WP("centroid",(function(t){IM=NM=BM=zM=$M=UM=VM=ZM=0,WM=new Lb,qM=new Lb,GM=new Lb,jb(t,lP);var e=+WM,n=+qM,r=+GM,i=Yb(e,n,r);return i<Ib&&(e=UM,n=VM,r=ZM,NM<Rb&&(e=BM,n=zM,r=$M),(i=Yb(e,n,r))<Ib)?[NaN,NaN]:[qb(n,e)*Ub,ix(r/i)*Ub]}));function XP(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function YP(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function KP(t){const e=Mc(t);return.2126*YP(e.r)+.7152*YP(e.g)+.0722*YP(e.b)}function JP(t,e){return t===e||t!==t&&e!==e||((0,g.kJ)(t)?!(!(0,g.kJ)(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!JP(t[n],e[n]))return!1;return!0}(t,e):!(!(0,g.Kn)(t)||!(0,g.Kn)(e))&&QP(t,e))}function QP(t,e){for(const n in t)if(!JP(t[n],e[n]))return!1;return!0}function tk(t){return e=>QP(t,e)}const ek={};function nk(t){return(0,g.kJ)(t)||ArrayBuffer.isView(t)?t:null}function rk(t){return nk(t)||((0,g.HD)(t)?t:null)}const ik=t=>t.data;function ok(t,e){const n=TP.call(e,t);return n.root&&n.root.lookup||{}}const sk=()=>"undefined"!==typeof window&&window||null;const ak={random:()=>wo(),cumulativeNormal:Do,cumulativeLogNormal:No,cumulativeUniform:Zo,densityNormal:To,densityLogNormal:Io,densityUniform:Vo,quantileNormal:Fo,quantileLogNormal:Bo,quantileUniform:Wo,sampleNormal:ko,sampleLogNormal:Ro,sampleUniform:Uo,isArray:g.kJ,isBoolean:g.jn,isDate:g.J_,isDefined:t=>void 0!==t,isNumber:g.hj,isObject:g.Kn,isRegExp:g.Kj,isString:g.HD,isTuple:_i,isValid:t=>null!=t&&t===t,toBoolean:g.sw,toDate:g.ZU,toNumber:g.He,toString:g.BB,indexof:function(t,...e){return rk(t).indexOf(...e)},join:function(t,...e){return nk(t).join(...e)},lastindexof:function(t,...e){return rk(t).lastIndexOf(...e)},replace:function(t,e,n){return(0,g.mf)(n)&&(0,g.vU)("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return nk(t).slice().reverse()},slice:function(t,...e){return rk(t).slice(...e)},flush:g.yl,lerp:g.t7,merge:function(){const t=[].slice.call(arguments);return t.unshift({}),(0,g.l7)(...t)},pad:g.vk,peek:g.fj,pluck:function(t,e){const n=ek[e]||(ek[e]=(0,g.EP)(e));return(0,g.kJ)(t)?t.map(n):n(t)},span:g.yP,inrange:g.u5,truncate:g.$G,rgb:Mc,lab:vf,hcl:Of,hsl:Lc,luminance:KP,contrast:function(t,e){const n=KP(t),r=KP(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:ls,format:FP,utcFormat:LP,utcParse:IP,utcOffset:Ie,utcSequence:ze,timeFormat:jP,timeParse:RP,timeOffset:Re,timeSequence:Be,timeUnitSpecifier:ue,monthFormat:function(t){return BP.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return BP.call(this,t,1,"%b")},dayFormat:function(t){return BP.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return BP.call(this,0,2+t,"%a")},quarter:g.mS,utcquarter:g.N3,week:he,utcweek:ve,dayofyear:fe,utcdayofyear:ye,warn:function(){return XP(this.context.dataflow,"warn",arguments)},info:function(){return XP(this.context.dataflow,"info",arguments)},debug:function(){return XP(this.context.dataflow,"debug",arguments)},extent:g.We,inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:function(t,e,n){if(!t)return[];const[r,i]=t,o=(new op).set(r[0],r[1],i[0],i[1]);return Dy(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=(0,g.IX)(t.marktype),r=(0,g.IX)(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))},clampRange:g.l$,pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=sk();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=sk();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Gf(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(g.yb).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?Md(n,e=e||yd(t)):t}},panLinear:g.Dw,panLog:g.mJ,panPow:g.QA,panSymlog:g.Zw,zoomLinear:g.ay,zoomLog:g.dH,zoomPow:g.mK,zoomSymlog:g.bV,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){const s=this.context.dataflow,a=this.context.data[t],u=a.input,c=s.stamp();let l,f,h=a.changes;if(!1===s._trigger||!(u.value.length||e||r))return 0;if((!h||h.stamp<c)&&(a.changes=h=s.changeset(),h.stamp=c,s.runAfter((()=>{a.modified=!0,s.pulse(u,h).run()}),!0,1)),n&&(l=!0===n?g.yb:(0,g.kJ)(n)||_i(n)?n:tk(n),h.remove(l)),e&&h.insert(e),r&&(l=tk(r),u.value.some(l)?h.remove(l):h.insert(r)),i)for(f in o)h.modify(i,f,o[f]);return 1}},uk=["view","item","group","xy","x","y"],ck="this.",lk={},fk={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${(0,g.m8)("$"+t)}]`,functions:function(t){const e=hM(t);uk.forEach((t=>e[t]="event.vega."+t));for(const n in ak)e[n]=ck+n;return(0,g.l7)(e,ZP(t,ak,lk)),e},constants:fM,visitors:lk},hk=dM(fk);function dk(t,e,n){return 1===arguments.length?ak[t]:(ak[t]=e,n&&(lk[t]=n),hk&&(hk.functions[t]=ck+t),this)}function pk(t,e){const n={};let r;try{r=lM(t=(0,g.HD)(t)?t:(0,g.m8)(t)+"")}catch(o){(0,g.vU)("Expression parse error: "+t)}r.visit((t=>{if(t.type!==JS)return;const r=t.callee.name,i=fk.visitors[r];i&&i(r,t.arguments,e,n)}));const i=hk(r);return i.globals.forEach((t=>{const r="$"+t;!(0,g.nr)(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:(0,g.l7)({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}dk("bandwidth",(function(t,e){const n=VP(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),$P),dk("copy",(function(t,e){const n=VP(t,(e||this).context);return n?n.copy():void 0}),$P),dk("domain",(function(t,e){const n=VP(t,(e||this).context);return n?n.domain():[]}),$P),dk("range",(function(t,e){const n=VP(t,(e||this).context);return n&&n.range?n.range():[]}),$P),dk("invert",(function(t,e,n){const r=VP(t,(n||this).context);return r?(0,g.kJ)(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),$P),dk("scale",(function(t,e,n){const r=VP(t,(n||this).context);return r?r(e):void 0}),$P),dk("gradient",(function(t,e,n,r,i){t=VP(t,(i||this).context);const o=hd(e,n);let s=t.domain(),a=s[0],u=(0,g.fj)(s),c=g.yR;return u-a?c=Lh(t,a,u):t=(t.interpolator?_h("sequential")().interpolator(t.interpolator()):_h("linear")().interpolate(t.interpolate()).range(t.range())).domain([a=0,u=1]),t.ticks&&(s=t.ticks(+r||15),a!==s[0]&&s.unshift(a),u!==(0,g.fj)(s)&&s.push(u)),s.forEach((e=>o.stop(c(e),t(e)))),o}),$P),dk("geoArea",qP,$P),dk("geoBounds",GP,$P),dk("geoCentroid",HP,$P),dk("geoShape",(function(t,e,n){const r=VP(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),$P),dk("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==GS&&(0,g.vU)("First argument to indata must be a string literal."),e[1].type!==GS&&(0,g.vU)("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,s="@"+o;(0,g.nr)(s,r)||(r[s]=n.getData(i).indataRef(n,o))})),dk("data",TP,zP),dk("treePath",(function(t,e,n){const r=ok(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(ik):void 0}),zP),dk("treeAncestors",(function(t,e){const n=ok(t,this)[e];return n?n.ancestors().map(ik):void 0}),zP),dk("vlSelectionTest",(function(t,e,n){for(var r,i,o,s,a,u=this.context.data[t],c=u?u.values.value:[],l=u?u[EP]&&u[EP].value:void 0,f=n===wP,h=c.length,d=0;d<h;++d)if(r=c[d],l&&f){if(-1===(o=(i=i||{})[s=r.unit]||0))continue;if(a=AP(e,r),i[s]=a?-1:++o,a&&1===l.size)return!0;if(!a&&o===l.get(s).count)return!1}else if(f^(a=AP(e,r)))return a;return h&&f}),kP),dk("vlSelectionIdTest",(function(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[EP]&&r[EP].value:void 0,s=n===wP,a=OP(e),u=CP(i,a);if(u===i.length)return!1;if(OP(i[u])!==a)return!1;if(o&&s){if(1===o.size)return!0;if(MP(i,a)-u<o.size)return!1}return!0}),kP),dk("vlSelectionResolve",(function(t,e,n,r){for(var i,o,s,a,u,c,l,f,h,d,p,m=this.context.data[t],y=m?m.values.value:[],v={},b={},x={},w=y.length,_=0;_<w;++_){for(a=(i=y[_]).unit,o=i.fields,s=i.values,d=0,p=o.length;d<p;++d)u=o[d],l=(c=v[u.field]||(v[u.field]={}))[a]||(c[a]=[]),x[u.field]=f=u.type.charAt(0),h=PP[f+"_union"],c[a]=h(l,(0,g.IX)(s[d]));n&&(l=b[a]||(b[a]=[])).push((0,g.IX)(s).reduce(((t,e,n)=>(t[o[n].field]=e,t)),{}))}if(e=e||_P,Object.keys(v).forEach((t=>{v[t]=Object.keys(v[t]).map((e=>v[t][e])).reduce(((n,r)=>void 0===n?r:PP[x[t]+"_"+e](n,r)))})),y=Object.keys(b),n&&y.length){v[r?"vlPoint":"vlMulti"]=e===_P?{or:y.reduce(((t,e)=>(t.push(...b[e]),t)),[])}:{and:y.map((t=>({or:b[t]})))}}return v}),kP),dk("vlSelectionTuples",(function(t,e){return t.map((t=>(0,g.l7)({values:e.fields.map((e=>(e.getter||(e.getter=(0,g.EP)(e.field)))(t.datum)))},e)))}));const gk=(0,g.Rg)(["rule"]),mk=(0,g.Rg)(["group","image","rect"]);function yk(t){return(t+"").toLowerCase()}function vk(t,e,n){";"!==n[n.length-1]&&(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var bk={operator:(t,e)=>vk(t,["_"],e.code),parameter:(t,e)=>vk(t,["datum","_"],e.code),event:(t,e)=>vk(t,["event"],e.code),handler:(t,e)=>vk(t,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(e.code,";")),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const o in r){const t="o["+(0,g.m8)(o)+"]";i+="$=".concat(r[o].code,";if(").concat(t,"!==$)").concat(t,"=$,m=1;")}return i+=function(t,e){let n="";return gk[e]||(t.x2&&(t.x?(mk[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(mk[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",vk(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(g.m8).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let o,s;return t.path?(o="a".concat(t.path),s="b".concat(t.path)):((n=n||{})["f"+r]=t,o="this.f".concat(r,"(a)"),s="this.f".concat(r,"(b)")),function(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(o,s,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function xk(t,e,n){if(!t||!(0,g.Kn)(t))return t;for(let r,i=0,o=wk.length;i<o;++i)if(r=wk[i],(0,g.nr)(t,r.key))return r.parse(t,e,n);return t}var wk=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||(0,g.vU)("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=(0,g.Jy)(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code+"_"+t.$name;return e.fn[r]||(e.fn[r]=(0,g.ZE)(e.parameterExpression(t.$expr),t.$fields,t.$name))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=(0,g.EP)(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const i in n){const t=n[i];r[i]=(0,g.ZE)(e.encodeExpression(t.$expr),t.$fields),r[i].output=t.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=(0,g.IX)(t.$compare).map((t=>t&&t.$tupleid?Ei:t));return e.fn[n]||(e.fn[n]=(0,g.qu)(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),s=o.get(n.operators[0].id),a=o.signals.parent;return a&&a.set(i),s.detachSubflow=()=>e.detach(o),s}}},{key:"$tupleid",parse:function(){return Ei}}];const _k={skip:!0};function Ek(t,e,n,r){return new Ak(t,e,n,r)}function Ak(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||bk,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Ok(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function Sk(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}Ak.prototype=Ok.prototype={fork(){const t=new Ok(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),function(t){return"collect"===yk(t)}(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const o in t.data){const r=n.data[o]||(n.data[o]={});t.data[o].forEach((t=>r[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[yk(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;!function(t){return"operator"===yk(t)}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||(0,g.vU)("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=(0,g.kJ)(i)?i.map((t=>xk(t,n,e))):xk(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&(0,g.vU)("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=(0,g.Kn)(r=t.source)?r.$ref:r,i=n.get(r),o=t.update,s=void 0;i||(0,g.vU)("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),o&&o.$expr&&(o.$params&&(s=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(t,i,e,o,s)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],_k)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(g.yb).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const Ck="default";function Mk(t,e){const n=t.globalCursor()?"undefined"!==typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function Pk(t,e){var n=t._runtime.data;return(0,g.nr)(n,e)||(0,g.vU)("Unrecognized data set: "+e),n[e]}function kk(t,e){ki(e)||(0,g.vU)("Second argument to changes must be a changeset.");const n=Pk(this,t);return n.modified=!0,this.pulse(n.input,e)}function Tk(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function Dk(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Fk(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function jk(t,e,n){var r,i,o=t._renderer,s=o&&o.canvas();return s&&(i=Fk(t),(r=gm(e.changedTouches?e.changedTouches[0]:e,s))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;(0,g.HD)(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:(0,g.a9)(t),item:(0,g.a9)(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}(t,n,r),e}const Lk="view",Rk={trap:!1};function Ik(t,e,n,r){t._eventListeners.push({type:n,sources:(0,g.IX)(e),handler:r})}function Nk(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||(0,g.Kn)(r)&&!r[n])||(t.warn(`Blocked ${e} ${n} event listener.`),!1)}function Bk(t){return t.item}function zk(t){return t.item.mark.source}function $k(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function Uk(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return null!=n&&(r.textContent=n),r}function Vk(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),Ik(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!==typeof Event?new Event(t):{type:t}}(i))}}function Zk(t,e,n,r){const i=r.signal(n.signal),o=Uk("div",{class:"vega-bind"}),s="radio"===n.input?o:o.appendChild(Uk("label"));s.appendChild(Uk("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(o);let a=Wk;switch(n.input){case"checkbox":a=qk;break;case"select":a=Gk;break;case"radio":a=Hk;break;case"range":a=Xk}a(t,s,n,i)}function Wk(t,e,n,r){const i=Uk("input");for(const o in n)"signal"!==o&&"element"!==o&&i.setAttribute("input"===o?"type":o,n[o]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function qk(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=Uk("input",i);e.appendChild(o),o.addEventListener("change",(()=>t.update(o.checked))),t.elements=[o],t.set=t=>o.checked=!!t||null}function Gk(t,e,n,r){const i=Uk("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};Yk(t,r)&&(n.selected=!0),i.appendChild(Uk("option",n,(o[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(Yk(n.options[e],t))return void(i.selectedIndex=e)}}function Hk(t,e,n,r){const i=Uk("span",{class:"vega-bind-radio"}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,s)=>{const a={type:"radio",name:n.signal,value:e};Yk(e,r)&&(a.checked=!0);const u=Uk("input",a);u.addEventListener("change",(()=>t.update(e)));const c=Uk("label",{},(o[s]||e)+"");return c.prepend(u),i.appendChild(c),u})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)Yk(n[t].value,e)&&(n[t].checked=!0)}}function Xk(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||(0,D.ly)(o,i,100),a=Uk("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const u=Uk("span",{},+r);e.appendChild(a),e.appendChild(u);const c=()=>{u.textContent=a.value,t.update(+a.value)};a.addEventListener("input",c),a.addEventListener("change",c),t.elements=[a],t.set=t=>{a.value=t,u.textContent=t}}function Yk(t,e){return t===e||t+""===e+""}function Kk(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,Tk(t),Dk(t),Fk(t),i,o).background(t.background())}function Jk(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function Qk(t,e,n){if("string"===typeof e){if("undefined"===typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.innerHTML=""}catch(r){e=null,t.error(r)}return e}const tT=t=>+t||0;function eT(t){return(0,g.Kn)(t)?{top:tT(t.top),bottom:tT(t.bottom),left:tT(t.left),right:tT(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(tT(t))}async function nT(t,e,n,r){const i=Ty(e),o=i&&i.headless;return o||(0,g.vU)("Unrecognized renderer type: "+e),await t.runAsync(),Kk(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}var rT="width",iT="height",oT="padding",sT={skip:!0};function aT(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===oT?r.left+r.right:0)}function uT(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===oT?r.top+r.bottom:0)}function cT(t,e){return e.modified&&(0,g.kJ)(e.input.value)&&t.indexOf("_:vega:_")}function lT(t,e){return!("parent"===t||e instanceof ro.proxy)}function fT(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":(0,g.kJ)(t)?hT(t):(0,g.Kn)(t)&&!(0,g.J_)(t)?(e=t,Object.keys(e).map((t=>{const n=e[t];return t+": "+((0,g.kJ)(n)?hT(n):dT(n))})).join("\n")):t+"";var e}(r))}function hT(t){return"["+t.map(dT).join(", ")+"]"}function dT(t){return(0,g.kJ)(t)?"[\u2026]":(0,g.Kn)(t)&&!(0,g.J_)(t)?"{\u2026}":t}function pT(t,e){const n=this;if(e=e||{},to.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=(0,g.l7)({},t.locale,e.locale);n.locale(Ur(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||Py.Canvas,n._scenegraph=new um;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||fT,n._redraw=!0,n._handler=(new Lm).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=(0,g.l7)({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{(0,g.kJ)(t[e])&&(t[e]=(0,g.Rg)(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return Ek(t,ro,ak,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:(0,g.l7)({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=aT(n,n._width),n._viewHeight=uT(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e.width,r=e.height,i=e.padding;function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=aT(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=uT(t,e.size),o()}),{size:r});const s=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:Ck,item:null}));t.on(t.events("view","mousemove"),e,((t,n)=>{const r=e.value,i=r?(0,g.HD)(r)?r:r.user:Ck,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return(0,g.HD)(n)||(r=n.item,n=n.user),Mk(t,n&&n!==Ck?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function gT(t,e){return(0,g.nr)(t._signals,e)?t._signals[e]:(0,g.vU)("Unrecognized signal name: "+(0,g.m8)(e))}function mT(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function yT(t,e,n,r){let i=mT(n,r);return i||(i=Jk(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function vT(t,e,n){const r=mT(e,n);return r&&e._targets.remove(r),t}(0,g.XW)(pT,to,{async evaluate(t,e,n){if(await to.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,function(t){var e=Fk(t),n=Tk(t),r=Dk(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach((e=>{try{e(n,r)}catch(i){t.error(i)}}))}(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&bi(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&Sk(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=gT(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",eT(t)):eT(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Ty(t)||(0,g.vU)("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(to.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(gT(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(rT,n,sT),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(iT,r,sT),s._resizeHeight.skip(!0)),s._viewWidth!==t&&(s._resize=1,s._viewWidth=t),s._viewHeight!==e&&(s._resize=1,s._viewHeight=e),s._origin[0]===i[0]&&s._origin[1]===i[1]||(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=Jk(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return yT(this,t,gT(this,t),e)},removeSignalListener(t,e){return vT(this,gT(this,t),e)},addDataListener(t,e){return yT(this,t,Pk(this,t).values,e)},removeDataListener(t,e){return vT(this,Pk(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=Mk(this,null);this._globalCursor=!!t,e&&Mk(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new qE,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?ZE():+n,r._restart((function o(s){s+=i,r._restart(o,i+=e,n),t(s)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new Bi(n),s=function(n,r){i.runAsync(null,(()=>{t===Lk&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(jk(i,n,r))}))};if("timer"===t)Nk(i,"timer",e)&&i.timer(s,e);else if(t===Lk)Nk(i,"view",e)&&i.addEventListener(e,s,Rk);else if("window"===t?Nk(i,"window",e)&&"undefined"!==typeof window&&(r=[window]):"undefined"!==typeof document&&Nk(i,"selector",e)&&(r=document.querySelectorAll(t)),r){for(var a=0,u=r.length;a<u;++a)r[a].addEventListener(e,s);Ik(i,r,e,s)}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r=this._tooltip,i=this._timers,o=this._eventListeners;for(t=i.length;--t>=0;)i[t].stop();for(t=o.length;--t>=0;)for(e=(n=o[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","mouseover",Bk),zk,$k(t)),this.on(this.events("view","mouseout",Bk),zk,$k(e)),this},data:function(t,e){return arguments.length<2?Pk(this,t).values.value:kk.call(this,t,Ti().remove(g.yb).insert(e))},change:kk,insert:function(t,e){return kk.call(this,t,Ti().insert(e))},remove:function(t,e){return kk.call(this,t,Ti().remove(e))},scale:function(t){var e=this._runtime.scales;return(0,g.nr)(e,t)||(0,g.vU)("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=Ty(r);t=n._el=t?Qk(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),Sk(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||Lm,a=t?o.renderer:o.headless;return n._renderer=a?Kk(n,n._renderer,t,a):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),Jk(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,Fk(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,s),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=Qk(n,e,!0):t.appendChild(Uk("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=Qk(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=(0,g.Ds)(r.debounce,i.update))),(null==r.input&&r.element?Vk:Zk)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==Py.Canvas&&t!==Py.SVG&&t!==Py.PNG&&(0,g.vU)("Unrecognized image type: "+t);const n=await nT(this,t,e);return t===Py.SVG?function(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await nT(this,Py.Canvas,t,e)).canvas()},toSVG:async function(t){return(await nT(this,Py.SVG,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:cT,signals:lT,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this}});const bT="[",xT="]",wT=/[[\]{}]/,_T={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let ET,AT;function OT(t,e,n){return ET=e||"view",AT=n||_T,CT(t.trim()).map(MT)}function ST(t,e,n,r,i){const o=t.length;let s,a=0;for(;e<o;++e){if(s=t[e],!a&&s===n)return e;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return e}function CT(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=ST(t,i,",","[{","]}"),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function MT(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=ST(t,r,xT,bT,xT),r===e)throw"Empty between selector: "+t;if(n=CT(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if(">"!==(t=t.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+t;n=n.map(MT);const i=MT(t.slice(1).trim());if(i.between)return{between:n,stream:i};i.between=n;return i}(t):function(t){const e={source:ET},n=[];let r,i,o=[0,0],s=0,a=0,u=t.length,c=0;if("}"===t[u-1]){if(c=t.lastIndexOf("{"),!(c>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(",");if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!==n)throw t;return n}))}(t.substring(c+1,u-1))}catch(l){throw"Invalid throttle specification: "+t}u=(t=t.slice(0,c).trim()).length,c=0}if(!u)throw t;"@"===t[0]&&(s=++c);r=ST(t,c,":"),r<u&&(n.push(t.substring(a,r).trim()),a=c=++r);if(c=ST(t,c,bT),c===u)n.push(t.substring(a,u).trim());else if(n.push(t.substring(a,c).trim()),i=[],a=++c,a===u)throw"Unmatched left bracket: "+t;for(;c<u;){if(c=ST(t,c,xT),c===u)throw"Unmatched left bracket: "+t;if(i.push(t.substring(a,c).trim()),c<u-1&&t[++c]!==bT)throw"Expected left bracket: "+t;a=++c}if(!(u=n.length)||wT.test(n[u-1]))throw"Invalid event selector: "+t;u>1?(e.type=n[1],s?e.markname=n[0].slice(1):!function(t){return AT[t]}(n[0])?e.source=n[0]:e.marktype=n[0]):e.type=n[0];"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1));null!=i&&(e.filter=i);o[0]&&(e.throttle=o[0]);o[1]&&(e.debounce=o[1]);return e}(t)}function PT(t){return(0,g.Kn)(t)?t:{type:t||"pad"}}const kT=t=>+t||0;function TT(t){return(0,g.Kn)(t)?t.signal?t:{top:kT(t.top),bottom:kT(t.bottom),left:kT(t.left),right:kT(t.right)}:{top:e=kT(t),bottom:e,left:e,right:e};var e}const DT=t=>(0,g.Kn)(t)&&!(0,g.kJ)(t)?(0,g.l7)({},t):{value:t};function FT(t,e,n,r){if(null!=n){return(0,g.Kn)(n)&&!(0,g.kJ)(n)||(0,g.kJ)(n)&&n.length&&(0,g.Kn)(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1}return 0}function jT(t,e,n){for(const r in e)FT(t,r,e[r]);for(const r in n)FT(t,r,n[r],"update")}function LT(t,e,n){for(const r in e)n&&(0,g.nr)(n,r)||(t[r]=(0,g.l7)(t[r]||{},e[r]));return t}function RT(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const IT="mark",NT="frame",BT="scope",zT="legend-label",$T="title-text",UT="title-subtitle";function VT(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const ZT=t=>(0,g.HD)(t)?(0,g.m8)(t):t.signal?`(${t.signal})`:HT(t);function WT(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:(0,g.m8)(t)));for(;e.length&&null==(0,g.fj)(e);)e.pop();return e.unshift(ZT(t.gradient)),`gradient(${e.join(",")})`}(t);let e=t.signal?`(${t.signal})`:t.color?function(t){return t.c?qT("hcl",t.h,t.c,t.l):t.h||t.s?qT("hsl",t.h,t.s,t.l):t.l||t.a?qT("lab",t.l,t.a,t.b):t.r||t.g||t.b?qT("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?HT(t.field):void 0!==t.value?(0,g.m8)(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=ZT(t.scale);null!=t.range?e=`lerp(_range(${n}), ${+t.range})`:(void 0!==e&&(e=`_scale(${n}, ${e})`),t.band&&(e=(e?e+"+":"")+`_bandwidth(${n})`+(1===+t.band?"":"*"+GT(t.band)),t.extra&&(e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`)),null==e&&(e="0"));return e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e=`pow(${e},${GT(t.exponent)})`),null!=t.mult&&(e+=`*${GT(t.mult)}`),null!=t.offset&&(e+=`+${GT(t.offset)}`),t.round&&(e=`round(${e})`),e}const qT=(t,e,n,r)=>`(${t}(${[e,n,r].map(WT).join(",")})+'')`;function GT(t){return(0,g.Kn)(t)?"("+WT(t)+")":t}function HT(t){return XT((0,g.Kn)(t)?t:{datum:t})}function XT(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):(0,g.vU)("Invalid field reference: "+(0,g.m8)(t));return t.signal||(r=(0,g.HD)(r)?(0,g._k)(r).map(g.m8).join("]["):XT(r)),e+"["+r+"]"}function YT(t,e,n,r,i,o){const s={};(o=o||{}).encoders={$encode:s},t=function(t,e,n,r,i){const o={},s={};let a,u,c,l;for(u in u="lineBreak","text"!==e||null==i[u]||RT(u,t)||VT(o,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),l=n===NT?i.group:n===IT?(0,g.l7)({},i.mark,i[e]):null,l)c=RT(u,t)||("fill"===u||"stroke"===u)&&(RT("fill",t)||RT("stroke",t)),c||VT(o,u,l[u]);for(u in(0,g.IX)(r).forEach((e=>{const n=i.style&&i.style[e];for(const r in n)RT(r,t)||VT(o,r,n[r])})),t=(0,g.l7)({},t),o)l=o[u],l.signal?(a=a||{})[u]=l:s[u]=l;return t.enter=(0,g.l7)(s,t.enter),a&&(t.update=(0,g.l7)(a,t.update)),t}(t,e,n,r,i.config);for(const a in t)s[a]=KT(t[a],e,o,i);return o}function KT(t,e,n,r){const i={},o={};for(const a in t)null!=t[a]&&(i[a]=JT((s=t[a],(0,g.kJ)(s)?function(t){let e="";return t.forEach((t=>{const n=WT(t);e+=t.test?`(${t.test})?${n}:`:n})),":"===(0,g.fj)(e)&&(e+="null"),e}(s):WT(s)),r,n,o));var s;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function JT(t,e,n,r){const i=pk(t,e);return i.$fields.forEach((t=>r[t]=1)),(0,g.l7)(n,i.$params),i.$expr}const QT=["value","update","init","react","bind"];function tD(t,e){(0,g.vU)(t+' for "outer" push: '+(0,g.m8)(e))}function eD(t,e){const n=t.name;if("outer"===t.push)e.signals[n]||tD("No prior signal definition",n),QT.forEach((e=>{void 0!==t[e]&&tD("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function nD(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function rD(t,e,n,r){return new nD(t,e,n,r)}function iD(t,e){return rD("operator",t,e)}function oD(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function sD(t,e){return e?{$field:t,$name:e}:{$field:t}}const aD=sD("key");function uD(t,e){return{$compare:t,$order:e}}function cD(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const lD="scope",fD="view";function hD(t){return t&&t.signal}function dD(t){if(hD(t))return!0;if((0,g.Kn)(t))for(const e in t)if(dD(t[e]))return!0;return!1}function pD(t,e){return null!=t?t:e}function gD(t){return t&&t.signal||t}const mD="timer";function yD(t,e){return(t.merge?vD:t.stream?bD:t.type?xD:(0,g.vU)("Invalid stream specification: "+(0,g.m8)(t)))(t,e)}function vD(t,e){const n=wD({merge:t.merge.map((t=>yD(t,e)))},t,e);return e.addStream(n).id}function bD(t,e){const n=wD({stream:yD(t.stream,e)},t,e);return e.addStream(n).id}function xD(t,e){let n;t.type===mD?(n=e.event(mD,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(function(t){return t===lD?fD:t||fD}(t.source),t.type);const r=wD({stream:n},t,e);return 1===Object.keys(r).length?n:e.addStream(r).id}function wD(t,e,n){let r=e.between;return r&&(2!==r.length&&(0,g.vU)('Stream "between" parameter must have 2 entries: '+(0,g.m8)(e)),t.between=[yD(r[0],n),yD(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===lD&&r.push("inScope(event.item)"),r.length&&(t.filter=pk("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const _D={code:"_.$value",ast:{type:"Identifier",value:"value"}};function ED(t,e,n){const r=t.encode,i={target:n};let o=t.events,s=t.update,a=[];o||(0,g.vU)("Signal update missing events specification."),(0,g.HD)(o)&&(o=OT(o,e.isSubscope()?lD:fD)),o=(0,g.IX)(o).filter((t=>t.signal||t.scale?(a.push(t),0):1)),a.length>1&&(a=[AD(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),null!=r&&(s&&(0,g.vU)("Signal encode and update are mutually exclusive."),s="encode(item(),"+(0,g.m8)(r)+")"),i.update=(0,g.HD)(s)?pk(s,e):null!=s.expr?pk(s.expr,e):null!=s.value?s.value:null!=s.signal?{$expr:_D,$params:{$value:e.signalRef(s.signal)}}:(0,g.vU)("Invalid signal update specification."),t.force&&(i.options={force:!0}),a.forEach((t=>e.addUpdate((0,g.l7)(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):yD(t,e)}}(t,e),i))))}function AD(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const OD=t=>(e,n,r)=>rD(t,n,e||void 0,r),SD=OD("aggregate"),CD=OD("axisticks"),MD=OD("bound"),PD=OD("collect"),kD=OD("compare"),TD=OD("datajoin"),DD=OD("encode"),FD=OD("expression"),jD=OD("facet"),LD=OD("field"),RD=OD("key"),ID=OD("legendentries"),ND=OD("load"),BD=OD("mark"),zD=OD("multiextent"),$D=OD("multivalues"),UD=OD("overlap"),VD=OD("params"),ZD=OD("prefacet"),WD=OD("projection"),qD=OD("proxy"),GD=OD("relay"),HD=OD("render"),XD=OD("scale"),YD=OD("sieve"),KD=OD("sortitems"),JD=OD("viewlayout"),QD=OD("values");let tF=0;const eF={min:"min",max:"max",count:"sum"};function nF(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=sF(t.domain,t,e),null!=t.range&&(n.range=pF(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=rF(t.type||t),null!=t.gamma&&(e.interpolateGamma=rF(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t){return(0,g.Kn)(t)?{interval:rF(t.interval),step:rF(t.step)}:rF(t)}(t.nice)),null!=t.bins&&(n.bins=function(t,e){return t.signal||(0,g.kJ)(t)?iF(t,e):e.objectProperty(t)}(t.bins,e)),t)(0,g.nr)(n,r)||"name"===r||(n[r]=rF(t[r],e))}function rF(t,e){return(0,g.Kn)(t)?t.signal?e.signalRef(t.signal):(0,g.vU)("Unsupported object: "+(0,g.m8)(t)):t}function iF(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>rF(t,e)))}function oF(t){(0,g.vU)("Can not find data set: "+(0,g.m8)(t))}function sF(t,e,n){if(t)return t.signal?n.signalRef(t.signal):((0,g.kJ)(t)?aF:t.fields?cF:uF)(t,e,n);null==e.domainMin&&null==e.domainMax||(0,g.vU)("No scale domain defined for domainMin/domainMax to override.")}function aF(t,e,n){return t.map((t=>rF(t,n)))}function uF(t,e,n){const r=n.getData(t.data);return r||oF(t.data),Sh(e.type)?r.valuesRef(n,t.field,fF(t.sort,!1)):kh(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function cF(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=(0,g.HD)(e)?{data:r,field:e}:(0,g.kJ)(e)||e.signal?function(t,e){const n="_:vega:_"+tF++,r=PD({});if((0,g.kJ)(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+(0,g.m8)(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,YD({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(Sh(e.type)?lF:kh(e.type)?hF:dF)(t,n,i)}function lF(t,e,n){const r=fF(t.sort,!0);let i,o;const s=n.map((t=>{const n=e.getData(t.data);return n||oF(t.data),n.countsRef(e,t.field,r)})),a={groupby:aD,pulse:s};r&&(i=r.op||"count",o=r.field?cD(i,r.field):"count",a.ops=[eF[i]],a.fields=[e.fieldRef(o)],a.as=[o]),i=e.add(SD(a));const u=e.add(PD({pulse:oD(i)}));return o=e.add(QD({field:aD,sort:e.sortRef(r),pulse:oD(u)})),oD(o)}function fF(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!eF[t.op]&&(0,g.vU)("Multiple domain scales can not be sorted using "+t.op):(0,g.vU)("No field provided for sort aggregate op: "+t.op):(0,g.Kn)(t)?t.field="key":t={field:"key"}),t}function hF(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||oF(t.data),n.domainRef(e,t.field)}));return oD(e.add($D({values:r})))}function dF(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||oF(t.data),n.extentRef(e,t.field)}));return oD(e.add(zD({extents:r})))}function pF(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if((0,g.HD)(i)){if(r&&(0,g.nr)(r,i))return pF(t=(0,g.l7)({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=Sh(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:(0,g.vU)("Unrecognized scale range value: "+(0,g.m8)(i))}else{if(i.scheme)return n.scheme=(0,g.kJ)(i.scheme)?iF(i.scheme,e):rF(i.scheme,e),i.extent&&(n.schemeExtent=iF(i.extent,e)),void(i.count&&(n.schemeCount=rF(i.count,e)));if(i.step)return void(n.rangeStep=rF(i.step,e));if(Sh(t.type)&&!(0,g.kJ)(i))return sF(i,t,e);(0,g.kJ)(i)||(0,g.vU)("Unsupported range type: "+(0,g.m8)(i))}return i.map((t=>((0,g.kJ)(t)?iF:rF)(t,e)))}function gF(t,e,n){return(0,g.kJ)(t)?t.map((t=>gF(t,e,n))):(0,g.Kn)(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:(0,g.vU)("Unsupported parameter object: "+(0,g.m8)(t)):t}const mF="top",yF="left",vF="right",bF="bottom",xF="center",wF="index",_F="label",EF="perc",AF="value",OF="guide-label",SF="guide-title",CF="group-title",MF="group-subtitle",PF="symbol",kF="gradient",TF="discrete",DF="size",FF=[DF,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],jF={name:1,style:1,interactive:1},LF={value:0},RF={value:1},IF="group",NF="rect",BF="rule",zF="text";function $F(t){return t.type=IF,t.interactive=t.interactive||!1,t}function UF(t,e){const n=(n,r)=>pD(t[n],pD(e[n],r));return n.isVertical=n=>"vertical"===pD(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>pD(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>pD(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>pD(t.columns,pD(e.columns,+n.isVertical(!0))),n}function VF(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function ZF(t,e,n){return`item.anchor === 'start' ? ${t} : item.anchor === 'end' ? ${e} : ${n}`}const WF=ZF((0,g.m8)(yF),(0,g.m8)(vF),(0,g.m8)(xF));function qF(t,e){return e?t?(0,g.Kn)(t)?Object.assign({},t,{offset:qF(t.offset,e)}):{value:t,offset:e}:e:t}function GF(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=LT(t.encode,e,jF)):t.interactive=!1,t}function HF(t,e,n,r){const i=UF(t,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let u,c,l,f,h;o?(c=[0,1],l=[0,0],f=s,h=a):(c=[0,0],l=[1,0],f=a,h=s);const d={enter:u={opacity:LF,x:LF,y:LF,width:DT(f),height:DT(h)},update:(0,g.l7)({},u,{opacity:RF,fill:{gradient:e,start:c,stop:l}}),exit:{opacity:LF}};return jT(d,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),GF({type:NF,role:"legend-gradient",encode:d},r)}function XF(t,e,n,r,i){const o=UF(t,n),s=o.isVertical(),a=o.gradientThickness(),u=o.gradientLength();let c,l,f,h,d="";s?(c="y",f="y2",l="x",h="width",d="1-"):(c="x",f="x2",l="y",h="height");const p={opacity:LF,fill:{scale:e,field:AF}};p[c]={signal:d+"datum."+EF,mult:u},p[l]=LF,p[f]={signal:d+"datum.perc2",mult:u},p[h]=DT(a);const m={enter:p,update:(0,g.l7)({},p,{opacity:RF}),exit:{opacity:LF}};return jT(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),GF({type:NF,role:"legend-band",key:AF,from:i,encode:m},r)}function YF(t,e,n,r){const i=UF(t,e),o=i.isVertical(),s=DT(i.gradientThickness()),a=i.gradientLength();let u,c,l,f,h=i("labelOverlap"),d="";const p={enter:u={opacity:LF},update:c={opacity:RF,text:{field:_F}},exit:{opacity:LF}};return jT(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:pD(t.labelLimit,e.gradientLabelLimit)}),o?(u.align={value:"left"},u.baseline=c.baseline={signal:'datum.perc<=0?"bottom":datum.perc>=1?"top":"middle"'},l="y",f="x",d="1-"):(u.align=c.align={signal:'datum.perc<=0?"left":datum.perc>=1?"right":"center"'},u.baseline={value:"top"},l="x",f="y"),u[l]=c[l]={signal:d+"datum."+EF,mult:a},u[f]=c[f]=s,s.offset=pD(t.labelOffset,e.gradientLabelOffset)||0,h=h?{separation:i("labelSeparation"),method:h,order:"datum.index"}:void 0,GF({type:zF,role:zT,style:OF,key:AF,from:r,encode:p,overlap:h},n)}function KF(t,e,n,r,i){const o=UF(t,e),s=n.entries,a=!(!s||!s.interactive),u=s?s.name:void 0,c=o("clipHeight"),l=o("symbolOffset"),f={data:"value"},h=`(${i}) ? datum.offset : datum.size`,d=c?DT(c):{field:DF},p="datum.index",g=`max(1, ${i})`;let m,y,v,b,x;d.mult=.5,m={enter:y={opacity:LF,x:{signal:h,mult:.5,offset:l},y:d},update:v={opacity:RF,x:y.x,y:y.y},exit:{opacity:LF}};let w=null,_=null;t.fill||(w=e.symbolBaseFillColor,_=e.symbolBaseStrokeColor),jT(m,{fill:o("symbolFillColor",w),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",_),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),FF.forEach((e=>{t[e]&&(v[e]=y[e]={scale:t[e],field:AF})}));const E=GF({type:"symbol",role:"legend-symbol",key:AF,from:f,clip:!!c||void 0,encode:m},n.symbols),A=DT(l);A.offset=o("labelOffset"),m={enter:y={opacity:LF,x:{signal:h,offset:A},y:d},update:v={opacity:RF,text:{field:_F},x:y.x,y:y.y},exit:{opacity:LF}},jT(m,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const O=GF({type:zF,role:zT,style:OF,key:AF,from:f,encode:m},n.labels);return m={enter:{noBound:{value:!c},width:LF,height:c?DT(c):LF,opacity:LF},exit:{opacity:LF},update:v={opacity:RF,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(b=`ceil(item.mark.items.length / ${g})`,v.row.signal=`${p}%${b}`,v.column.signal=`floor(${p} / ${b})`,x={field:["row",p]}):(v.row.signal=`floor(${p} / ${g})`,v.column.signal=`${p} % ${g}`,x={field:p}),v.column.signal=`(${i})?${v.column.signal}:${p}`,$F({role:BT,from:r={facet:{data:r,name:"value",groupby:wF}},encode:LT(m,s,jF),marks:[E,O],name:u,interactive:a,sort:x})}const JF='item.orient === "left"',QF='item.orient === "right"',tj=`(${JF} || ${QF})`,ej=`datum.vgrad && ${tj}`,nj=ZF('"top"','"bottom"','"middle"'),rj=`datum.vgrad && ${QF} ? (${ZF('"right"','"left"','"center"')}) : (${tj} && !(datum.vgrad && ${JF})) ? "left" : ${WF}`,ij=`item._anchor || (${tj} ? "middle" : "start")`,oj=`${ej} ? (${JF} ? -90 : 90) : 0`,sj=`${tj} ? (datum.vgrad ? (${QF} ? "bottom" : "top") : ${nj}) : "top"`;function aj(t,e){let n;return(0,g.Kn)(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+uj(t.path)+")":t.sphere&&(n="geoShape("+uj(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function uj(t){return(0,g.Kn)(t)&&t.signal?t.signal:(0,g.m8)(t)}function cj(t){const e=t.role||"";return e.indexOf("axis")&&e.indexOf("legend")&&e.indexOf("title")?t.type===IF?BT:e||IT:e}function lj(t){return{marktype:t.type,name:t.name||void 0,role:t.role||cj(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function fj(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function hj(t,e){const n=io(t.type);n||(0,g.vU)("Unrecognized transform type: "+(0,g.m8)(t.type));const r=rD(n.type.toLowerCase(),null,dj(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function dj(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=pj(i,e,n)}return r}function pj(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){(0,g.HD)(e.from)||(0,g.vU)('Lookup "from" parameter must be a string literal.');return n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?((0,g.kJ)(r)||(0,g.vU)("Expected an array of sub-parameters. Instead: "+(0,g.m8)(r)),r.map((e=>mj(t,e,n)))):mj(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!hD(i)?i.map((e=>gj(t,e,n))):gj(t,i,n):void(t.required&&(0,g.vU)("Missing required "+(0,g.m8)(e.type)+" parameter: "+(0,g.m8)(t.name)))}function gj(t,e,n){const r=t.type;if(hD(e))return xj(r)?(0,g.vU)("Expression references can not be signals."):wj(r)?n.fieldRef(e):_j(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||wj(r);return i&&yj(e)?n.exprRef(e.expr,e.as):i&&vj(e)?sD(e.field,e.as):xj(r)?pk(e,n):bj(r)?oD(n.getData(e).values):wj(r)?sD(e):_j(r)?n.compareRef(e):e}}function mj(t,e,n){const r=t.params.length;let i;for(let s=0;s<r;++s){i=t.params[s];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||(0,g.vU)("Unsupported parameter: "+(0,g.m8)(e));const o=(0,g.l7)(dj(i,e,n),i.key);return oD(n.add(VD(o)))}const yj=t=>t&&t.expr,vj=t=>t&&t.field,bj=t=>"data"===t,xj=t=>"expr"===t,wj=t=>"field"===t,_j=t=>"compare"===t;function Ej(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:oD(e.getData(t.data).output)}function Aj(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function Oj(t){return(0,g.HD)(t)?t:null}function Sj(t,e,n){const r=cD(n.op,n.field);let i;if(e.ops){for(let o=0,s=e.as.length;o<s;++o)if(e.as[o]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function Cj(t,e,n,r,i,o,s){const a=e[n]||(e[n]={}),u=function(t){return(0,g.Kn)(t)?("descending"===t.order?"-":"+")+cD(t.op,t.field):""}(o);let c,l,f=Oj(i);if(null!=f&&(t=e.scope,f+=u?"|"+u:"",c=a[f]),!c){const n=o?{field:aD,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:oD(e.output)};u&&(n.sort=t.sortRef(o)),l=t.add(rD(r,void 0,n)),s&&(e.index[i]=l),c=oD(l),null!=f&&(a[f]=c)}return c}function Mj(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,s=t.modify,a=t.values,u=e.add(iD()),c=pk("if("+t.trigger+',modify("'+n+'",'+[i,r,o,s,a].map((t=>null==t?"null":t)).join(",")+"),0)",e);u.update=c.$expr,u.params=c.$params}function Pj(t,e){const n=cj(t),r=t.type===IF,i=t.from&&t.from.facet,o=t.overlap;let s,a,u,c,l,f,h,d=t.layout||n===BT||n===NT;const p=n===IT||d||i,m=function(t,e,n){let r,i,o,s,a;return t?(r=t.facet)&&(e||(0,g.vU)("Only group marks can be faceted."),null!=r.field?s=a=Ej(r,n):(t.data?a=oD(n.getData(t.data).aggregate):(o=hj((0,g.l7)({type:"aggregate",groupby:(0,g.IX)(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=Ej(r,n),s=a=oD(n.add(o))),i=n.keyRef(r.groupby,!0))):s=oD(n.add(PD(null,[{}]))),s||(s=Ej(t,n)),{key:i,pulse:s,parent:a}}(t.from,r,e);a=e.add(TD({key:m.key||(t.key?sD(t.key):void 0),pulse:m.pulse,clean:!r}));const y=oD(a);a=u=e.add(PD({pulse:y})),a=e.add(BD({markdef:lj(t),interactive:fj(t.interactive,e),clip:aj(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:oD(a)}));const v=oD(a);a=c=e.add(DD(YT(t.encode,t.type,n,t.style,e,{mod:!1,pulse:v}))),a.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=hj(t,e),r=n.metadata;(r.generates||r.changes)&&(0,g.vU)("Mark transforms should not generate new data."),r.nomod||(c.params.mod=!0),n.params.pulse=oD(a),e.add(a=n)})),t.sort&&(a=e.add(KD({sort:e.compareRef(t.sort),pulse:oD(a)})));const b=oD(a);(i||d)&&(d=e.add(JD({layout:e.objectProperty(t.layout),legends:e.legends,mark:v,pulse:b})),f=oD(d));const x=e.add(MD({mark:v,pulse:f||b}));h=oD(x),r&&(p&&(s=e.operators,s.pop(),d&&s.pop()),e.pushState(b,f||h,y),i?function(t,e,n){const r=t.from.facet,i=r.name,o=Ej(r,e);let s;r.name||(0,g.vU)("Facet must have a name: "+(0,g.m8)(r)),r.data||(0,g.vU)("Facet must reference a data set: "+(0,g.m8)(r)),r.field?s=e.add(ZD({field:e.fieldRef(r.field),pulse:o})):r.groupby?s=e.add(jD({key:e.keyRef(r.groupby),group:oD(e.proxy(n.parent)),pulse:o})):(0,g.vU)("Facet must specify groupby or field: "+(0,g.m8)(r));const a=e.fork(),u=a.add(PD()),c=a.add(YD({pulse:oD(u)}));a.addData(i,new Aj(a,u,u,c)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(ZD({pulse:n.pulse})),i=e.fork();i.add(YD()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(d&&s.push(d),s.push(x))),o&&(h=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,s={separation:hD(o)?n.signalRef(o.signal):o,method:hD(r)?n.signalRef(r.signal):r,pulse:e};t.order&&(s.sort=n.compareRef({field:t.order}));if(i){const t=i.tolerance;s.boundTolerance=hD(t)?n.signalRef(t.signal):+t,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return oD(n.add(UD(s)))}(o,h,e));const w=e.add(HD({pulse:h})),_=e.add(YD({pulse:oD(w)},void 0,e.parent()));null!=t.name&&(l=t.name,e.addData(l,new Aj(e,u,w,_)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&(0,g.vU)("Marks only support modify triggers."),Mj(t,e,l)})))}function kj(t,e){const n=e.config.legend,r=t.encode||{},i=UF(t,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,u=o.style,c={};let l,f,h,d=0;FF.forEach((e=>t[e]?(c[e]=t[e],d=d||t[e]):0)),d||(0,g.vU)("Missing valid scale for legend.");const p=function(t,e){let n=t.type||PF;t.type||1!==function(t){return FF.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=Oh(e)?kF:Ch(e)?TF:PF);return n!==kF?n:Ch(e)?TF:kF}(t,e.scaleType(d)),m={title:null!=t.title,scales:c,type:p,vgrad:"symbol"!==p&&i.isVertical()},y=oD(e.add(PD(null,[m]))),v=oD(e.add(ID(f={type:p,scale:e.scaleRef(d),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===kF?(h=[HF(t,d,n,r.gradient),YF(t,n,r.labels,v)],f.count=f.count||e.signalRef(`max(2,2*floor((${gD(i.gradientLength())})/100))`)):p===TF?h=[XF(t,d,n,r.gradient,v),YF(t,n,r.labels,v)]:(l=function(t,e){const n=UF(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),h=[KF(t,n,r,v,gD(l.columns))],f.size=function(t,e,n){const r=gD(Dj("size",t,n)),i=gD(Dj("strokeWidth",t,n)),o=gD(function(t,e,n){return VF("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r[t]}("fontSize",e,n)}(n[1].encode,e,OF));return pk(`max(ceil(sqrt(${r})+${i}),${o})`,e)}(t,e,h[0].marks)),h=[$F({role:"legend-entry",from:y,encode:{enter:{x:{value:0},y:{value:0}}},marks:h,layout:l,interactive:a})],m.title&&h.push(function(t,e,n,r){const i=UF(t,e),o={enter:{opacity:LF},update:{opacity:RF,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:LF}};return jT(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:ij},angle:{signal:oj},align:{signal:rj},baseline:{signal:sj},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),GF({type:zF,role:"legend-title",style:SF,from:r,encode:o},n)}(t,n,r.title,y)),Pj($F({role:"legend",from:y,encode:LT(Tj(i,t,n),o,jF),marks:h,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:u}),e)}function Tj(t,e,n){const r={enter:{},update:{}};return jT(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function Dj(t,e,n){return e[t]?`scale("${e[t]}",datum)`:VF(t,n[0].encode)}Aj.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],s=null,a=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);a<n;++a)e[a].params.pulse=oD(e[a-1]),t.add(e[a]),"aggregate"===e[a].type&&(s=e[a]);return new Aj(t,o,i,r,s)},Aj.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=Oj(e);let s,a,u;return null!=o&&(t=r.scope,s=i[o]),s?n&&n.field&&Sj(t,s.agg.params,n):(u={groupby:t.fieldRef(e,"key"),pulse:oD(r.output)},n&&n.field&&Sj(t,u,n),a=t.add(SD(u)),s=t.add(PD({pulse:oD(a)})),s={agg:a,ref:oD(s)},null!=o&&(i[o]=s)),s.ref},tuplesRef(){return oD(this.values)},extentRef(t,e){return Cj(t,this,"extent","extent",e,!1)},domainRef(t,e){return Cj(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return Cj(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return Cj(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return Cj(t,this,"indata","tupleindex",e,!0,!0)}};function Fj(t,e){const n=UF(t=(0,g.HD)(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,u=[],c=oD(e.add(PD(null,[{}])));return u.push(function(t,e,n,r){const i={value:0},o=t.text,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return jT(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),GF({type:zF,role:$T,style:CF,from:r,encode:s},n)}(t,n,function(t){const e=t.encode;return e&&e.title||(0,g.l7)({name:t.name,interactive:t.interactive,style:t.style},e)}(t),c)),t.subtitle&&u.push(function(t,e,n,r){const i={value:0},o=t.subtitle,s={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return jT(s,{text:o,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),GF({type:zF,role:UT,style:MF,from:r,encode:s},n)}(t,n,r.subtitle,c)),Pj($F({role:"title",from:c,encode:jj(n,i),marks:u,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),e)}function jj(t,e){const n={enter:{},update:{}};return jT(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:WF},angle:{signal:'item.orient==="left"?-90:item.orient==="right"?90:0'},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),LT(n,e,jF)}function Lj(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(hj(t,e))})),t.on&&t.on.forEach((n=>{Mj(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,o,s,a,u,c=null,l=!1,f=!1;t.values?hD(t.values)||dD(t.format)?(r.push(Ij(e,t)),r.push(c=Rj())):r.push(c=Rj({$ingest:t.values,$format:t.format})):t.url?dD(t.url)||dD(t.format)?(r.push(Ij(e,t)),r.push(c=Rj())):r.push(c=Rj({$request:t.url,$format:t.format})):t.source&&(c=i=(0,g.IX)(t.source).map((t=>oD(e.getData(t).output))),r.push(null));for(o=0,s=n.length;o<s;++o)a=n[o],u=a.metadata,c||u.source||r.push(c=Rj()),r.push(a),u.generates&&(f=!0),u.modifies&&!f&&(l=!0),u.source?c=a:u.changes&&(c=null);i&&(s=i.length-1,r[0]=GD({derive:l,pulse:s?i:i[0]}),(l||s)&&r.splice(1,0,Rj()));c||r.push(Rj());return r.push(YD({})),r}(t,e,n))}function Rj(t){const e=PD({},t);return e.metadata={source:!0},e}function Ij(t,e){return ND({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const Nj=t=>t===bF||t===mF,Bj=(t,e,n)=>hD(t)?Wj(t.signal,e,n):t===yF||t===mF?e:n,zj=(t,e,n)=>hD(t)?Vj(t.signal,e,n):Nj(t)?e:n,$j=(t,e,n)=>hD(t)?Zj(t.signal,e,n):Nj(t)?n:e,Uj=(t,e,n)=>hD(t)?qj(t.signal,e,n):t===mF?{value:e}:{value:n},Vj=(t,e,n)=>Hj(`${t} === 'top' || ${t} === 'bottom'`,e,n),Zj=(t,e,n)=>Hj(`${t} !== 'top' && ${t} !== 'bottom'`,e,n),Wj=(t,e,n)=>Yj(`${t} === 'left' || ${t} === 'top'`,e,n),qj=(t,e,n)=>Yj(`${t} === 'top'`,e,n),Gj=(t,e,n)=>Yj(`${t} === 'right'`,e,n),Hj=(t,e,n)=>(e=null!=e?DT(e):e,n=null!=n?DT(n):n,Xj(e)&&Xj(n)?{signal:`${t} ? (${e=e?e.signal||(0,g.m8)(e.value):null}) : (${n=n?n.signal||(0,g.m8)(n.value):null})`}:[(0,g.l7)({test:t},e)].concat(n||[])),Xj=t=>null==t||1===Object.keys(t).length,Yj=(t,e,n)=>({signal:`${t} ? (${Jj(e)}) : (${Jj(n)})`}),Kj=(t,e,n,r,i)=>({signal:(null!=r?`${t} === 'left' ? (${Jj(r)}) : `:"")+(null!=n?`${t} === 'bottom' ? (${Jj(n)}) : `:"")+(null!=i?`${t} === 'right' ? (${Jj(i)}) : `:"")+(null!=e?`${t} === 'top' ? (${Jj(e)}) : `:"")+"(null)"}),Jj=t=>hD(t)?t.signal:null==t?null:(0,g.m8)(t),Qj=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function tL(t,e,n,r){let i;if(e&&(0,g.nr)(e,t))return e[t];if((0,g.nr)(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r["guide-title"][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r["guide-label"][i]}return null}function eL(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function nL(t,e){return{scale:t.scale,range:e}}function rL(t,e,n,r,i){const o=UF(t,e),s=t.orient,a=t.gridScale,u=Bj(s,1,-1),c=function(t,e){if(1===e);else if((0,g.Kn)(t)){let n=t=(0,g.l7)({},t);for(;null!=n.mult;){if(!(0,g.Kn)(n.mult))return n.mult=hD(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e,t;n=n.mult=(0,g.l7)({},n.mult)}n.mult=e}else t=hD(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0);return t}(t.offset,u);let l,f,h;const d={enter:l={opacity:LF},update:h={opacity:RF},exit:f={opacity:LF}};jT(d,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:AF,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=zj(s,{signal:"height"},{signal:"width"}),y=a?{scale:a,range:0,mult:u,offset:c}:{value:0,offset:c},v=a?{scale:a,range:1,mult:u,offset:c}:(0,g.l7)(m,{mult:u,offset:c});return l.x=h.x=zj(s,p,y),l.y=h.y=$j(s,p,y),l.x2=h.x2=$j(s,v),l.y2=h.y2=zj(s,v),f.x=zj(s,p),f.y=$j(s,p),GF({type:BF,role:"axis-grid",key:AF,from:r,encode:d},n)}function iL(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function oL(t,e,n,r,i,o){const s=UF(t,e),a=t.orient,u=t.scale,c=Bj(a,-1,1),l=gD(s("labelFlush")),f=gD(s("labelFlushOffset")),h=s("labelAlign"),d=s("labelBaseline");let p,g=0===l||!!l;const m=DT(i);m.mult=c,m.offset=DT(s("labelPadding")||0),m.offset.mult=c;const y={scale:u,field:AF,band:.5,offset:qF(o.offset,s("labelOffset"))},v=zj(a,g?iL(u,l,'"left"','"right"','"center"'):{value:"center"},((t,e,n)=>hD(t)?Gj(t.signal,e,n):t===vF?{value:e}:{value:n})(a,"left","right")),b=zj(a,Uj(a,"bottom","top"),g?iL(u,l,'"top"','"bottom"','"middle"'):{value:"middle"}),x=iL(u,l,`-(${f})`,f,0);g=g&&f;const w={opacity:LF,x:zj(a,y,m),y:$j(a,y,m)},_={enter:w,update:p={opacity:RF,text:{field:_F},x:w.x,y:w.y,align:v,baseline:b},exit:{opacity:LF,x:w.x,y:w.y}};jT(_,{dx:!h&&g?zj(a,x):null,dy:!d&&g?$j(a,x):null}),jT(_,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:h,baseline:d});const E=s("labelBound");let A=s("labelOverlap");return A=A||E?{separation:s("labelSeparation"),method:A,order:"datum.index",bound:E?{scale:u,orient:a,tolerance:E}:null}:void 0,p.align!==v&&(p.align=Qj(p.align,v)),p.baseline!==b&&(p.baseline=Qj(p.baseline,b)),GF({type:zF,role:"axis-label",style:OF,key:AF,from:r,encode:_,overlap:A},n)}function sL(t,e,n,r){const i=UF(t,e),o=t.orient,s=Bj(o,-1,1);let a,u;const c={enter:a={opacity:LF,anchor:DT(i("titleAnchor",null)),align:{signal:WF}},update:u=(0,g.l7)({},a,{opacity:RF,text:DT(t.title)}),exit:{opacity:LF}},l={signal:`lerp(range("${t.scale}"), ${ZF(0,1,.5)})`};return u.x=zj(o,l),u.y=$j(o,l),a.angle=zj(o,LF,((t,e)=>0===e?0:hD(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e})(s,90)),a.baseline=zj(o,Uj(o,bF,mF),{value:bF}),u.angle=a.angle,u.baseline=a.baseline,jT(c,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=Qj(DT(t),n.update[e]),!1):!RT(e,r),o=i(t("titleX"),"x"),s=i(t("titleY"),"y");n.enter.auto=s===o?DT(s):zj(e,DT(s),DT(o))}(i,o,c,n),c.update.align=Qj(c.update.align,a.align),c.update.angle=Qj(c.update.angle,a.angle),c.update.baseline=Qj(c.update.baseline,a.baseline),GF({type:zF,role:"axis-title",style:SF,from:r,encode:c},n)}function aL(t,e){const n=function(t,e){var n,r,i,o=e.config,s=o.style,a=o.axis,u="band"===e.scaleType(t.scale)&&o.axisBand,c=t.orient;if(hD(c)){const t=eL([o.axisX,o.axisY]),e=eL([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=zj(c,tL(i,o.axisX,a,s),tL(i,o.axisY,a,s));for(i of(r={},e))r[i]=Kj(c.signal,tL(i,o.axisTop,a,s),tL(i,o.axisBottom,a,s),tL(i,o.axisLeft,a,s),tL(i,o.axisRight,a,s))}else n=c===mF||c===bF?o.axisX:o.axisY,r=o["axis"+c[0].toUpperCase()+c.slice(1)];return n||r||u?(0,g.l7)({},a,n,r,u):a}(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,u=UF(t,n),c=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:`(${e.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${e.signal}) === 'extent'`},(0,g.Kn)(i)||(i={signal:`(${e.signal}) === 'extent' ? 0 : ${i}`})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(u),l={scale:t.scale,ticks:!!u("ticks"),labels:!!u("labels"),grid:!!u("grid"),domain:!!u("domain"),title:null!=t.title},f=oD(e.add(PD({},[l]))),h=oD(e.add(CD({scale:e.scaleRef(t.scale),extra:e.property(c.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),d=[];let p;return l.grid&&d.push(rL(t,n,r.grid,h,c)),l.ticks&&(p=u("tickSize"),d.push(function(t,e,n,r,i,o){const s=UF(t,e),a=t.orient,u=Bj(a,-1,1);let c,l,f;const h={enter:c={opacity:LF},update:f={opacity:RF},exit:l={opacity:LF}};jT(h,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const d=DT(i);d.mult=u;const p={scale:t.scale,field:AF,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return f.y=c.y=zj(a,LF,p),f.y2=c.y2=zj(a,d),l.x=zj(a,p),f.x=c.x=$j(a,LF,p),f.x2=c.x2=$j(a,d),l.y=$j(a,p),GF({type:BF,role:"axis-tick",key:AF,from:r,encode:h},n)}(t,n,r.ticks,h,p,c))),l.labels&&(p=l.ticks?p:0,d.push(oL(t,n,r.labels,h,p,c))),l.domain&&d.push(function(t,e,n,r){const i=UF(t,e),o=t.orient;let s,a;const u={enter:s={opacity:LF},update:a={opacity:RF},exit:{opacity:LF}};jT(u,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const c=nL(t,0),l=nL(t,1);return s.x=a.x=zj(o,c,LF),s.x2=a.x2=zj(o,l),s.y=a.y=$j(o,c,LF),s.y2=a.y2=$j(o,l),GF({type:BF,role:"axis-domain",from:r,encode:u},n)}(t,n,r.domain,f)),l.title&&d.push(sL(t,n,r.title,f)),Pj($F({role:"axis",from:f,encode:LT(uL(u,t),i,jF),marks:d,aria:u("aria"),description:u("description"),zindex:u("zindex"),name:o,interactive:s,style:a}),e)}function uL(t,e){const n={enter:{},update:{}};return jT(n,{orient:t("orient"),offset:t("offset")||0,position:pD(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function cL(t,e,n){const r=(0,g.IX)(t.signals),i=(0,g.IX)(t.scales);return n||r.forEach((t=>eD(t,e))),(0,g.IX)(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const i in t)"name"!==i&&(r[i]=gF(t[i],i,e));for(const i in n)null==r[i]&&(r[i]=gF(n[i],i,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";Eh(n)||(0,g.vU)("Unrecognized scale type: "+(0,g.m8)(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),(0,g.IX)(t.data).forEach((t=>Lj(t,e))),i.forEach((t=>nF(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?(0,g.vU)("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=pk(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>ED(t,e,n.id)))}(t,e))),(0,g.IX)(t.axes).forEach((t=>aL(t,e))),(0,g.IX)(t.marks).forEach((t=>Pj(t,e))),(0,g.IX)(t.legends).forEach((t=>kj(t,e))),t.title&&Fj(t.title,e),e.parseLambdas(),e}function lL(t,e){const n=e.config,r=oD(e.root=e.add(iD())),i=function(t,e){const n=n=>pD(t[n],e[n]),r=[fL("background",n("background")),fL("autosize",PT(n("autosize"))),fL("padding",TT(n("padding"))),fL("width",n("width")||0),fL("height",n("height")||0)],i=r.reduce(((t,e)=>(t[e.name]=e,t)),{}),o={};return(0,g.IX)(t.signals).forEach((t=>{(0,g.nr)(i,t.name)?t=(0,g.l7)(i[t.name],t):r.push(t),o[t.name]=t})),(0,g.IX)(e.signals).forEach((t=>{(0,g.nr)(o,t.name)||(0,g.nr)(i,t.name)||r.push(t)})),r}(t,n);i.forEach((t=>eD(t,e))),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const o=e.add(PD()),s=e.add(DD(YT((t=>LT({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t))(t.encode),IF,NT,t.style,e,{pulse:oD(o)}))),a=e.add(JD({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:oD(s)}));e.operators.pop(),e.pushState(oD(s),oD(a),null),cL(t,e,i),e.operators.push(a);let u=e.add(MD({mark:r,pulse:oD(a)}));return u=e.add(HD({pulse:oD(u)})),u=e.add(YD({pulse:oD(u)})),e.addData("root",new Aj(e,o,o,u)),e}function fL(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function hL(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function dL(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function pL(t){return((0,g.kJ)(t)?gL:mL)(t)}function gL(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+((0,g.Kn)(e)?e.signal||pL(e):(0,g.m8)(e))}return n+"]"}function mL(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+(0,g.m8)(e)+":"+((0,g.Kn)(n)?n.signal||pL(n):(0,g.m8)(n));return r+"}"}function yL(t,e,n){return(0,g.Kn)(t)||(0,g.vU)("Input Vega specification must be an object."),lL(t,new hL(e=(0,g.fE)(function(){const t="sans-serif",e="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:e},area:{fill:e},image:null,line:{stroke:e,strokeWidth:2},path:{stroke:e},rect:{fill:e},rule:{stroke:n},shape:{stroke:e},symbol:{fill:e,size:64},text:{fill:n,font:t,fontSize:11},trail:{fill:e,size:2},style:{"guide-label":{fill:n,font:t,fontSize:10},"guide-title":{fill:n,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),n)).toRuntime()}hL.prototype=dL.prototype={parse(t){return cL(t,this)},fork(){return new dL(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof nD?oD(t):t;return this.add(qD({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(oD(this.add(YD({pulse:t})))),this._parent.push(e),this._lookup.push(n?oD(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return(0,g.fj)(this._parent)},encode(){return(0,g.fj)(this._encode)},lookup(){return(0,g.fj)(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if((0,g.HD)(t))return sD(t,e);t.signal||(0,g.vU)("Unsupported field reference: "+(0,g.m8)(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=oD(this.add(LD(t)))}return r},compareRef(t){let e=!1;const n=t=>hD(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=(0,g.IX)(t.field).map(n),i=(0,g.IX)(t.order).map(n);return e?oD(this.add(kD({fields:r,orders:i}))):uD(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=(0,g.IX)(t).map((t=>hD(t)?(n=!0,oD(r[t.signal])):t)),n?oD(this.add(RD({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=cD(t.op,t.field),n=t.order||"ascending";return n.signal?oD(this.add(kD({fields:e,orders:this.signalRef(n.signal)}))):uD(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return(0,g.nr)(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&(0,g.vU)("Duplicate signal name: "+(0,g.m8)(t));const n=e instanceof nD?e:this.add(iD(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||(0,g.vU)("Unrecognized signal name: "+(0,g.m8)(t)),this.signals[t]},signalRef(t){return this.signals[t]?oD(this.signals[t]):((0,g.nr)(this.lambdas,t)||(this.lambdas[t]=this.add(iD(null))),oD(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=pk(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&(0,g.Kn)(t)?this.signalRef(t.signal||pL(t)):t},exprRef(t,e){const n={expr:pk(t,this)};return e&&(n.expr.$name=e),oD(this.add(FD(n)))},addBinding(t,e){this.bindings||(0,g.vU)("Nested signals do not support binding: "+(0,g.m8)(t)),this.bindings.push((0,g.l7)({signal:t},e))},addScaleProj(t,e){(0,g.nr)(this.scales,t)&&(0,g.vU)("Duplicate scale or projection name: "+(0,g.m8)(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,XD(e))},addProjection(t,e){this.addScaleProj(t,WD(e))},getScale(t){return this.scales[t]||(0,g.vU)("Unrecognized scale name: "+(0,g.m8)(t)),this.scales[t]},scaleRef(t){return oD(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return(0,g.nr)(this.data,t)&&(0,g.vU)("Duplicate data set name: "+(0,g.m8)(t)),this.data[t]=e},getData(t){return this.data[t]||(0,g.vU)("Undefined data set name: "+(0,g.m8)(t)),this.data[t]},addDataPipeline(t,e){return(0,g.nr)(this.data,t)&&(0,g.vU)("Duplicate data set name: "+(0,g.m8)(t)),this.addData(t,Aj.fromEntries(this,e))}};var vL="5.21.0";(0,g.l7)(ro,r,o,s,a,u,l,c,f,h,d,p);const bL=vL},9602:function(t){"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},320:function(t,e,n){"use strict";function r(t){var e=this;if(e instanceof r||(e=new r),e.tail=null,e.head=null,e.length=0,t&&"function"===typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)e.push(arguments[n]);return e}function i(t,e,n){var r=e===t.head?new a(n,null,e,t):new a(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function o(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function s(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,n,r){if(!(this instanceof a))return new a(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}t.exports=r,r.Node=a,r.create=r,r.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},r.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},r.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},r.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},r.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)s(this,arguments[t]);return this.length},r.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},r.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},r.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},r.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},r.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},r.prototype.map=function(t,e){e=e||this;for(var n=new r,i=this.head;null!==i;)n.push(t.call(e,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(t,e){e=e||this;for(var n=new r,i=this.tail;null!==i;)n.push(t.call(e,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},r.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},r.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;for(;null!==o&&i<e;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new r;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,o=this.head;null!==o&&r<t;r++)o=o.next;var s=[];for(r=0;o&&r<e;r++)s.push(o.value),o=this.removeNode(o);null===o&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(r=0;r<n.length;r++)o=i(this,o,n[r]);return s},r.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{n(9602)(r)}catch(u){}},1801:function(t){"use strict";var e=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),i=""===r?1/0:void 0===n.maxLength?80:n.maxLength,o=n.replacer,function t(n,s,a){var u,c,l,f,h,d,p,g,m,y,v,b;if(n&&"function"===typeof n.toJSON&&(n=n.toJSON()),void 0===(v=JSON.stringify(n,o)))return v;if(p=i-s.length-a,v.length<=p&&(m=v.replace(e,(function(t,e){return e||t+" "}))).length<=p)return m;if(null!=o&&(n=JSON.parse(v),o=void 0),"object"===typeof n&&null!==n){if(g=s+r,l=[],c=0,Array.isArray(n))for(y="[",u="]",p=n.length;c<p;c++)l.push(t(n[c],g,c===p-1?0:1)||"null");else for(y="{",u="}",p=(d=Object.keys(n)).length;c<p;c++)f=d[c],h=JSON.stringify(f)+": ",void 0!==(b=t(n[f],g,h.length+(c===p-1?0:1)))&&l.push(h+b);if(l.length>0)return[y,r+l.join(",\n"+g),u].join("\n"+s)}return v}(t,"",0)}},4942:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,{Z:function(){return r}})},7462:function(t,e,n){"use strict";function r(){return(r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}n.d(e,{Z:function(){return r}})},4578:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(9611);function i(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,(0,r.Z)(t,e)}},3366:function(t,e,n){"use strict";function r(t,e){if(null==t)return{};var n,r,i={},o=Object.keys(t);for(r=0;r<o.length;r++)n=o[r],e.indexOf(n)>=0||(i[n]=t[n]);return i}n.d(e,{Z:function(){return r}})},9611:function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,{Z:function(){return r}})},4375:function(t,e,n){"use strict";n.d(e,{Ud:function(){return f}});const r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),o=Symbol("Comlink.releaseProxy"),s=Symbol("Comlink.thrown"),a=t=>"object"===typeof t&&null!==t||"function"===typeof t,u=new Map([["proxy",{canHandle:t=>a(t)&&t[r],serialize(t){const{port1:e,port2:n}=new MessageChannel;return c(t,e),[n,[n]]},deserialize:t=>(t.start(),f(t))}],["throw",{canHandle:t=>a(t)&&s in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function c(t,e=self){e.addEventListener("message",(function n(i){if(!i||!i.data)return;const{id:o,type:a,path:u}=Object.assign({path:[]},i.data),f=(i.data.argumentList||[]).map(y);let h;try{const e=u.slice(0,-1).reduce(((t,e)=>t[e]),t),n=u.reduce(((t,e)=>t[e]),t);switch(a){case"GET":h=n;break;case"SET":e[u.slice(-1)[0]]=y(i.data.value),h=!0;break;case"APPLY":h=n.apply(e,f);break;case"CONSTRUCT":h=function(t){return Object.assign(t,{[r]:!0})}(new n(...f));break;case"ENDPOINT":{const{port1:e,port2:n}=new MessageChannel;c(t,n),h=function(t,e){return g.set(t,e),t}(e,[e])}break;case"RELEASE":h=void 0;break;default:return}}catch(d){h={value:d,[s]:0}}Promise.resolve(h).catch((t=>({value:t,[s]:0}))).then((t=>{const[r,i]=m(t);e.postMessage(Object.assign(Object.assign({},r),{id:o}),i),"RELEASE"===a&&(e.removeEventListener("message",n),l(e))}))})),e.start&&e.start()}function l(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function f(t,e){return d(t,[],e)}function h(t){if(t)throw new Error("Proxy has been released and is not useable")}function d(t,e=[],n=function(){}){let r=!1;const s=new Proxy(n,{get(n,i){if(h(r),i===o)return()=>v(t,{type:"RELEASE",path:e.map((t=>t.toString()))}).then((()=>{l(t),r=!0}));if("then"===i){if(0===e.length)return{then:()=>s};const n=v(t,{type:"GET",path:e.map((t=>t.toString()))}).then(y);return n.then.bind(n)}return d(t,[...e,i])},set(n,i,o){h(r);const[s,a]=m(o);return v(t,{type:"SET",path:[...e,i].map((t=>t.toString())),value:s},a).then(y)},apply(n,o,s){h(r);const a=e[e.length-1];if(a===i)return v(t,{type:"ENDPOINT"}).then(y);if("bind"===a)return d(t,e.slice(0,-1));const[u,c]=p(s);return v(t,{type:"APPLY",path:e.map((t=>t.toString())),argumentList:u},c).then(y)},construct(n,i){h(r);const[o,s]=p(i);return v(t,{type:"CONSTRUCT",path:e.map((t=>t.toString())),argumentList:o},s).then(y)}});return s}function p(t){const e=t.map(m);return[e.map((t=>t[0])),(n=e.map((t=>t[1])),Array.prototype.concat.apply([],n))];var n}const g=new WeakMap;function m(t){for(const[e,n]of u)if(n.canHandle(t)){const[r,i]=n.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},g.get(t)||[]]}function y(t){switch(t.type){case"HANDLER":return u.get(t.name).deserialize(t.value);case"RAW":return t.value}}function v(t,e,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(n){n.data&&n.data.id&&n.data.id===i&&(t.removeEventListener("message",e),r(n.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:i},e),n)}))}},6586:function(t,e,n){"use strict";function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}n.d(e,{Z:function(){return r}})},2296:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,{Z:function(){return r}})},266:function(t,e,n){"use strict";function r(t,e,n,r,i,o,s){try{var a=t[o](s),u=a.value}catch(c){return void n(c)}a.done?e(u):Promise.resolve(u).then(r,i)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(i,o){var s=t.apply(e,n);function a(t){r(s,i,o,a,u,"next",t)}function u(t){r(s,i,o,a,u,"throw",t)}a(void 0)}))}}n.d(e,{Z:function(){return i}})},9846:function(t,e,n){"use strict";function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}n.d(e,{Z:function(){return r}})},5243:function(t,e,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(e,{Z:function(){return r}})},9056:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(2296);var i=n(6988),o=n(5243);function s(t,e){return(0,r.Z)(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(t);!(s=(r=n.next()).done)&&(o.push(r.value),!e||o.length!==e);s=!0);}catch(u){a=!0,i=u}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(t,e)||(0,i.Z)(t,e)||(0,o.Z)()}},7120:function(t,e,n){"use strict";n.d(e,{Z:function(){return a}});var r=n(2296),i=n(9846),o=n(6988),s=n(5243);function a(t){return(0,r.Z)(t)||(0,i.Z)(t)||(0,o.Z)(t)||(0,s.Z)()}},7131:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var r=n(6586);var i=n(9846),o=n(6988);function s(t){return function(t){if(Array.isArray(t))return(0,r.Z)(t)}(t)||(0,i.Z)(t)||(0,o.Z)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},6988:function(t,e,n){"use strict";n.d(e,{Z:function(){return i}});var r=n(6586);function i(t,e){if(t){if("string"===typeof t)return(0,r.Z)(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(t,e):void 0}}},8809:function(t,e,n){"use strict";function r(t){var e,n,r=t.length;if(1===r)e=0,n=t[0][1];else{for(var i,o,s,a=0,u=0,c=0,l=0,f=0;f<r;f++)a+=o=(i=t[f])[0],u+=s=i[1],c+=o*o,l+=o*s;n=u/r-(e=(r*l-a*u)/(r*c-a*a))*a/r}return{m:e,b:n}}function i(t){return function(e){return t.b+t.m*e}}function o(t){if(0===t.length)throw new Error("mean requires at least one data point");return function(t){if(0===t.length)return 0;for(var e,n=t[0],r=0,i=1;i<t.length;i++)e=n+t[i],Math.abs(n)>=Math.abs(t[i])?r+=n-e+t[i]:r+=t[i]-e+n,n=e;return n+r}(t)/t.length}function s(t,e){var n,r,i=o(t),s=0;if(2===e)for(r=0;r<t.length;r++)s+=(n=t[r]-i)*n;else for(r=0;r<t.length;r++)s+=Math.pow(t[r]-i,e);return s}function a(t){if(1===t.length)return 0;var e=function(t){if(0===t.length)throw new Error("variance requires at least one data point");return s(t,2)/t.length}(t);return Math.sqrt(e)}function u(t,e){e=e||Math.random;for(var n,r,i=t.length;i>0;)r=Math.floor(e()*i--),n=t[i],t[i]=t[r],t[r]=n;return t}function c(t,e,n){return function(t,e){return u(t.slice(),e)}(t,n).slice(0,e)}function l(t,e){for(var n=[],r=0;r<t;r++){for(var i=[],o=0;o<e;o++)i.push(0);n.push(i)}return n}n.d(e,{h0:function(){return b},N1:function(){return r},Z3:function(){return i},J6:function(){return o},IN:function(){return a},Nn:function(){return d}});var f=function(){this.totalCount=0,this.data={}};f.prototype.train=function(t,e){for(var n in this.data[e]||(this.data[e]={}),t){var r=t[n];void 0===this.data[e][n]&&(this.data[e][n]={}),void 0===this.data[e][n][r]&&(this.data[e][n][r]=0),this.data[e][n][r]++}this.totalCount++},f.prototype.score=function(t){var e,n={};for(var r in t){var i=t[r];for(e in this.data)n[e]={},this.data[e][r]?n[e][r+"_"+i]=(this.data[e][r][i]||0)/this.totalCount:n[e][r+"_"+i]=0}var o={};for(e in n)for(var s in o[e]=0,n[e])o[e]+=n[e][s];return o};var h=function(){this.weights=[],this.bias=0};h.prototype.predict=function(t){if(t.length!==this.weights.length)return null;for(var e=0,n=0;n<this.weights.length;n++)e+=this.weights[n]*t[n];return(e+=this.bias)>0?1:0},h.prototype.train=function(t,e){if(0!==e&&1!==e)return null;t.length!==this.weights.length&&(this.weights=t,this.bias=1);var n=this.predict(t);if("number"===typeof n&&n!==e){for(var r=e-n,i=0;i<this.weights.length;i++)this.weights[i]+=r*t[i];this.bias+=r}return this};Math.log(Math.sqrt(2*Math.PI));Math.sqrt(2*Math.PI);function d(t,e,n){return(t-e)/n}var p=Math.sqrt(2*Math.PI);function g(t){for(var e=t,n=t,r=1;r<15;r++)e+=n*=t*t/(2*r+1);return Math.round(1e4*(.5+e/p*Math.exp(-t*t/2)))/1e4}for(var m=[],y=0;y<=3.09;y+=.01)m.push(g(y));function v(t,e){for(var n=0,r=0;r<t.length;r++){var i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}function b(t,e,n){void 0===n&&(n=Math.random);for(var r=null,i=c(t,e,n),o=null,s=Number.MAX_VALUE;0!==s;)r=i,s=_(i=w(t,o=x(t,i),e),r);return{labels:o,centroids:i}}function x(t,e){return t.map((function(t){for(var n=Number.MAX_VALUE,r=-1,i=0;i<e.length;i++){var o=v(t,e[i]);o<n&&(n=o,r=i)}return r}))}function w(t,e,n){for(var r=t[0].length,i=l(n,r),o=Array(n).fill(0),s=t.length,a=0;a<s;a++){for(var u=t[a],c=e[a],f=i[c],h=0;h<r;h++)f[h]+=u[h];o[c]+=1}for(var d=0;d<n;d++){if(0===o[d])throw new Error("Centroid "+d+" has no friends");for(var p=i[d],g=0;g<r;g++)p[g]/=o[d]}return i}function _(t,e){for(var n=0,r=0;r<t.length;r++)n+=v(t[r],e[r]);return n}}}]);